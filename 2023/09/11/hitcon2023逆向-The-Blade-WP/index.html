



<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta name="google-site-verification" content="tcK6frO9MMMjv-s9v_SHFiAvsW8YHyINmZlIiYn3a4g" />


<link rel="alternate" type="application/rss+xml" title="3clyの博客" href="https://3cly.github.io/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="3clyの博客" href="https://3cly.github.io/atom.xml" />
<link rel="alternate" type="application/json" title="3clyの博客" href="https://3cly.github.io/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="笔记" />


<link rel="canonical" href="https://3cly.github.io/2023/09/11/hitcon2023%E9%80%86%E5%90%91-The-Blade-WP/">



  <title>
hitcon2023逆向 The Blade WP - 学习 |
静かな港 = 3clyの博客 = 从来如此,便对么?</title>
<meta name="generator" content="Hexo 6.3.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">hitcon2023逆向 The Blade WP
  </h1>
  
<div class="meta">
  <span class="item" title="创建时间：2023-09-11 00:35:32">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">发表于</span>
    <time itemprop="dateCreated datePublished" datetime="2023-09-11T00:35:32+08:00">2023-09-11</time>
  </span>
  <span class="item" title="本文字数">
    <span class="icon">
      <i class="ic i-pen"></i>
    </span>
    <span class="text">本文字数</span>
    <span>16k</span>
    <span class="text">字</span>
  </span>
  <span class="item" title="阅读时长">
    <span class="icon">
      <i class="ic i-clock"></i>
    </span>
    <span class="text">阅读时长</span>
    <span>14 分钟</span>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="切换导航栏">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">静かな港</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://pic.imgdb.cn/item/63bec31dbe43e0d30e52a4d4.webp"></li>
          <li class="item" data-background-image="https://pic.imgdb.cn/item/640da8e2f144a010074ada1e.jpg"></li>
          <li class="item" data-background-image="https://pic.imgdb.cn/item/640da97bf144a010074bf4e4.jpg"></li>
          <li class="item" data-background-image="https://pic.imgdb.cn/item/640da918f144a010074b42d6.jpg"></li>
          <li class="item" data-background-image="https://pic.imgdb.cn/item/63bec39fbe43e0d30e53fdec.png"></li>
          <li class="item" data-background-image="https://pic.imgdb.cn/item/63bec2b8be43e0d30e517780.png"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">首页</a></span><i class="ic i-angle-right"></i>
<span  class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E5%AD%A6%E4%B9%A0/" itemprop="item" rel="index" title="分类于 学习"><span itemprop="name">学习</span></a>
<meta itemprop="position" content="1" /></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="https://3cly.github.io/2023/09/11/hitcon2023%E9%80%86%E5%90%91-The-Blade-WP/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.png">
    <meta itemprop="name" content="3cly">
    <meta itemprop="description" content="从来如此,便对么?, 一只菜狗的博客">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="3clyの博客">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h1 id="hitcon2023逆向-the-blade-wp"><a class="markdownIt-Anchor" href="#hitcon2023逆向-the-blade-wp">#</a> hitcon2023 逆向 The Blade WP</h1>
<p><img data-src="/images/image-20230908230559788.png" alt="image-20230908230559788"></p>
<p>运行所给的程序 socket 通信相关</p>
<p><img data-src="/images/image-20230909162510993.png" alt="image-20230909162510993"></p>
<p><img data-src="/images/image-20230910145732886.png" alt="image-20230910145732886"></p>
<p>由题目描述 A Rust tool for executing shellcode in a seccomp environment.</p>
<p>字符串查找定位 发现其中 verify 方法可疑</p>
<p><img data-src="/images/image-20230910150509237.png" alt="image-20230910150509237"></p>
<p>发现隐藏了一个命令 flag 是以添加命令行参数的方式输入 flag 调试得知输入 flag 长度为 64 位</p>
<p><img data-src="/images/image-20230909181940256.png" alt="image-20230909181940256"></p>
<p>F7 进入 verify 发现加密逻辑 简单来讲 是一个大的 256 次 while 循环 里面有好几个通过固定的表对输入进行打乱，然后一个有点复杂的加密逻辑，有取余有除有异或，于是就有个骚操作的想法，既然逆向加密算法比较复杂，就找出 00-ff 的映射就行了 因为是按位加密的伐然后前面的几次打乱顺序由于是固定的表所以可以看成一次打乱顺序 找出索引交换的顺序即可</p>
<figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">do</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token operator">++</span>v8<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token function">memcpy</span><span class="token punctuation">(</span>dest<span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token number">0x200uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    v9 <span class="token operator">=</span> <span class="token number">64LL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    v10 <span class="token operator">=</span> <span class="token operator">&amp;</span>dest<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">do</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>      v11 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>v10 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v11 <span class="token operator">>=</span> <span class="token number">64</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token operator">||</span> <span class="token punctuation">(</span>v12 <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v9 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> flagg<span class="token punctuation">[</span>v9 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v11<span class="token punctuation">]</span><span class="token punctuation">,</span> flagg<span class="token punctuation">[</span>v11<span class="token punctuation">]</span> <span class="token operator">=</span> v12<span class="token punctuation">,</span> v13 <span class="token operator">=</span> <span class="token operator">*</span>v10<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int64<span class="token punctuation">)</span><span class="token operator">*</span>v10 <span class="token operator">></span> <span class="token number">0x3F</span><span class="token punctuation">)</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>LABEL_53<span class="token operator">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        core<span class="token operator">::</span>panicking<span class="token operator">::</span>panic_bounds_check<span class="token operator">::</span><span class="token function">h7d0e683548e4cb10</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>      v14 <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v9 <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>      flagg<span class="token punctuation">[</span>v9 <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v13<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      flagg<span class="token punctuation">[</span>v13<span class="token punctuation">]</span> <span class="token operator">=</span> v14<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>      v10 <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>      v9 <span class="token operator">-=</span> <span class="token number">2LL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span> v9 <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token function">memcpy</span><span class="token punctuation">(</span>dest<span class="token punctuation">,</span> <span class="token operator">&amp;</span>unk_55C3745E9D20<span class="token punctuation">,</span> <span class="token number">0x200uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    v15 <span class="token operator">=</span> <span class="token number">64LL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    v16 <span class="token operator">=</span> <span class="token operator">&amp;</span>dest<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">do</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>      v17 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>v16 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v17 <span class="token operator">></span> <span class="token number">63</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token keyword">goto</span> LABEL_53<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>      v18 <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v15 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>      flagg<span class="token punctuation">[</span>v15 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v17<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>      flagg<span class="token punctuation">[</span>v17<span class="token punctuation">]</span> <span class="token operator">=</span> v18<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>      v19 <span class="token operator">=</span> <span class="token operator">*</span>v16<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int64<span class="token punctuation">)</span><span class="token operator">*</span>v16 <span class="token operator">></span> <span class="token number">63</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        <span class="token keyword">goto</span> LABEL_53<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>      v20 <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v15 <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>      flagg<span class="token punctuation">[</span>v15 <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v19<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>      flagg<span class="token punctuation">[</span>v19<span class="token punctuation">]</span> <span class="token operator">=</span> v20<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>      v16 <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>      v15 <span class="token operator">-=</span> <span class="token number">2LL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span> v15 <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token function">memcpy</span><span class="token punctuation">(</span>dest<span class="token punctuation">,</span> <span class="token operator">&amp;</span>unk_55C3745E9F20<span class="token punctuation">,</span> <span class="token number">0x200uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    v21 <span class="token operator">=</span> <span class="token number">64LL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>    v22 <span class="token operator">=</span> <span class="token operator">&amp;</span>dest<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token keyword">do</span></pre></td></tr><tr><td data-num="48"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>      v23 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>v22 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v23 <span class="token operator">></span> <span class="token number">0x3F</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="51"></td><td><pre>        <span class="token keyword">goto</span> LABEL_53<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>      v24 <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v21 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>      flagg<span class="token punctuation">[</span>v21 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v23<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>      flagg<span class="token punctuation">[</span>v23<span class="token punctuation">]</span> <span class="token operator">=</span> v24<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>      v25 <span class="token operator">=</span> <span class="token operator">*</span>v22<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int64<span class="token punctuation">)</span><span class="token operator">*</span>v22 <span class="token operator">></span> <span class="token number">0x3F</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="57"></td><td><pre>        <span class="token keyword">goto</span> LABEL_53<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>      v26 <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v21 <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre>      flagg<span class="token punctuation">[</span>v21 <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v25<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>      flagg<span class="token punctuation">[</span>v25<span class="token punctuation">]</span> <span class="token operator">=</span> v26<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>      v22 <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="62"></td><td><pre>      v21 <span class="token operator">-=</span> <span class="token number">2LL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="63"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span> v21 <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="65"></td><td><pre>    <span class="token function">memcpy</span><span class="token punctuation">(</span>dest<span class="token punctuation">,</span> <span class="token operator">&amp;</span>unk_55C3745EA120<span class="token punctuation">,</span> <span class="token number">0x200uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>    v27 <span class="token operator">=</span> <span class="token number">64LL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="67"></td><td><pre>    v28 <span class="token operator">=</span> <span class="token operator">&amp;</span>dest<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="68"></td><td><pre>    <span class="token keyword">do</span></pre></td></tr><tr><td data-num="69"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="70"></td><td><pre>      v29 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>v28 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="71"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v29 <span class="token operator">></span> <span class="token number">0x3F</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="72"></td><td><pre>        <span class="token keyword">goto</span> LABEL_53<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="73"></td><td><pre>      v30 <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v27 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="74"></td><td><pre>      flagg<span class="token punctuation">[</span>v27 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v29<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="75"></td><td><pre>      flagg<span class="token punctuation">[</span>v29<span class="token punctuation">]</span> <span class="token operator">=</span> v30<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="76"></td><td><pre>      v31 <span class="token operator">=</span> <span class="token operator">*</span>v28<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="77"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int64<span class="token punctuation">)</span><span class="token operator">*</span>v28 <span class="token operator">></span> <span class="token number">0x3F</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="78"></td><td><pre>        <span class="token keyword">goto</span> LABEL_53<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="79"></td><td><pre>      v32 <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v27 <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="80"></td><td><pre>      flagg<span class="token punctuation">[</span>v27 <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v31<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="81"></td><td><pre>      flagg<span class="token punctuation">[</span>v31<span class="token punctuation">]</span> <span class="token operator">=</span> v32<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="82"></td><td><pre>      v28 <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="83"></td><td><pre>      v27 <span class="token operator">-=</span> <span class="token number">2LL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="84"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="85"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span> v27 <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="86"></td><td><pre>    <span class="token function">memcpy</span><span class="token punctuation">(</span>dest<span class="token punctuation">,</span> <span class="token operator">&amp;</span>unk_55C3745EA320<span class="token punctuation">,</span> <span class="token number">0x200uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="87"></td><td><pre>    v33 <span class="token operator">=</span> <span class="token number">64LL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="88"></td><td><pre>    v34 <span class="token operator">=</span> <span class="token operator">&amp;</span>dest<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="89"></td><td><pre>    <span class="token keyword">do</span></pre></td></tr><tr><td data-num="90"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="91"></td><td><pre>      v35 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>v34 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="92"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v35 <span class="token operator">></span> <span class="token number">0x3F</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="93"></td><td><pre>        <span class="token keyword">goto</span> LABEL_53<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="94"></td><td><pre>      v36 <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v33 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="95"></td><td><pre>      flagg<span class="token punctuation">[</span>v33 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v35<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="96"></td><td><pre>      flagg<span class="token punctuation">[</span>v35<span class="token punctuation">]</span> <span class="token operator">=</span> v36<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="97"></td><td><pre>      v37 <span class="token operator">=</span> <span class="token operator">*</span>v34<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="98"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int64<span class="token punctuation">)</span><span class="token operator">*</span>v34 <span class="token operator">></span> <span class="token number">0x3F</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="99"></td><td><pre>        <span class="token keyword">goto</span> LABEL_53<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="100"></td><td><pre>      v38 <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v33 <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="101"></td><td><pre>      flagg<span class="token punctuation">[</span>v33 <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v37<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="102"></td><td><pre>      flagg<span class="token punctuation">[</span>v37<span class="token punctuation">]</span> <span class="token operator">=</span> v38<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="103"></td><td><pre>      v34 <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="104"></td><td><pre>      v33 <span class="token operator">-=</span> <span class="token number">2LL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="105"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="106"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span> v33 <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="107"></td><td><pre>    <span class="token function">memcpy</span><span class="token punctuation">(</span>dest<span class="token punctuation">,</span> <span class="token operator">&amp;</span>unk_55C3745EA520<span class="token punctuation">,</span> <span class="token number">0x200uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="108"></td><td><pre>    v39 <span class="token operator">=</span> <span class="token number">64LL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="109"></td><td><pre>    v40 <span class="token operator">=</span> <span class="token operator">&amp;</span>dest<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="110"></td><td><pre>    <span class="token keyword">do</span></pre></td></tr><tr><td data-num="111"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="112"></td><td><pre>      v41 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>v40 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="113"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v41 <span class="token operator">></span> <span class="token number">0x3F</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="114"></td><td><pre>        <span class="token keyword">goto</span> LABEL_53<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="115"></td><td><pre>      v42 <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v39 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="116"></td><td><pre>      flagg<span class="token punctuation">[</span>v39 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v41<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="117"></td><td><pre>      flagg<span class="token punctuation">[</span>v41<span class="token punctuation">]</span> <span class="token operator">=</span> v42<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="118"></td><td><pre>      v43 <span class="token operator">=</span> <span class="token operator">*</span>v40<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="119"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int64<span class="token punctuation">)</span><span class="token operator">*</span>v40 <span class="token operator">></span> <span class="token number">0x3F</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="120"></td><td><pre>        <span class="token keyword">goto</span> LABEL_53<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="121"></td><td><pre>      v44 <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v39 <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="122"></td><td><pre>      flagg<span class="token punctuation">[</span>v39 <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v43<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="123"></td><td><pre>      flagg<span class="token punctuation">[</span>v43<span class="token punctuation">]</span> <span class="token operator">=</span> v44<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="124"></td><td><pre>      v40 <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="125"></td><td><pre>      v39 <span class="token operator">-=</span> <span class="token number">2LL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="126"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="127"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span> v39 <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="128"></td><td><pre>    <span class="token function">memcpy</span><span class="token punctuation">(</span>dest<span class="token punctuation">,</span> <span class="token operator">&amp;</span>unk_55C3745EA720<span class="token punctuation">,</span> <span class="token number">0x200uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="129"></td><td><pre>    v45 <span class="token operator">=</span> <span class="token number">64LL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="130"></td><td><pre>    v46 <span class="token operator">=</span> <span class="token operator">&amp;</span>dest<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="131"></td><td><pre>    <span class="token keyword">do</span></pre></td></tr><tr><td data-num="132"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="133"></td><td><pre>      v47 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>v46 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="134"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v47 <span class="token operator">></span> <span class="token number">0x3F</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="135"></td><td><pre>        <span class="token keyword">goto</span> LABEL_53<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="136"></td><td><pre>      v48 <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v45 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="137"></td><td><pre>      flagg<span class="token punctuation">[</span>v45 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v47<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="138"></td><td><pre>      flagg<span class="token punctuation">[</span>v47<span class="token punctuation">]</span> <span class="token operator">=</span> v48<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="139"></td><td><pre>      v49 <span class="token operator">=</span> <span class="token operator">*</span>v46<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="140"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int64<span class="token punctuation">)</span><span class="token operator">*</span>v46 <span class="token operator">></span> <span class="token number">0x3F</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="141"></td><td><pre>        <span class="token keyword">goto</span> LABEL_53<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="142"></td><td><pre>      v50 <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v45 <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="143"></td><td><pre>      flagg<span class="token punctuation">[</span>v45 <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v49<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="144"></td><td><pre>      flagg<span class="token punctuation">[</span>v49<span class="token punctuation">]</span> <span class="token operator">=</span> v50<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="145"></td><td><pre>      v46 <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="146"></td><td><pre>      v45 <span class="token operator">-=</span> <span class="token number">2LL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="147"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="148"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span> v45 <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="149"></td><td><pre>    <span class="token function">memcpy</span><span class="token punctuation">(</span>dest<span class="token punctuation">,</span> <span class="token operator">&amp;</span>unk_55C3745EA920<span class="token punctuation">,</span> <span class="token number">0x200uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="150"></td><td><pre>    v52 <span class="token operator">=</span> <span class="token number">64LL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="151"></td><td><pre>    v53 <span class="token operator">=</span> <span class="token operator">&amp;</span>dest<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="152"></td><td><pre>    <span class="token keyword">do</span></pre></td></tr><tr><td data-num="153"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="154"></td><td><pre>      v54 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>v53 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="155"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v54 <span class="token operator">></span> <span class="token number">0x3F</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="156"></td><td><pre>        <span class="token keyword">goto</span> LABEL_53<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="157"></td><td><pre>      v55 <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v52 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="158"></td><td><pre>      flagg<span class="token punctuation">[</span>v52 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v54<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="159"></td><td><pre>      flagg<span class="token punctuation">[</span>v54<span class="token punctuation">]</span> <span class="token operator">=</span> v55<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="160"></td><td><pre>      v56 <span class="token operator">=</span> <span class="token operator">*</span>v53<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="161"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int64<span class="token punctuation">)</span><span class="token operator">*</span>v53 <span class="token operator">></span> <span class="token number">0x3F</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="162"></td><td><pre>        <span class="token keyword">goto</span> LABEL_53<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="163"></td><td><pre>      v57 <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v52 <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="164"></td><td><pre>      flagg<span class="token punctuation">[</span>v52 <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> flagg<span class="token punctuation">[</span>v56<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="165"></td><td><pre>      flagg<span class="token punctuation">[</span>v56<span class="token punctuation">]</span> <span class="token operator">=</span> v57<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="166"></td><td><pre>      v53 <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="167"></td><td><pre>      v52 <span class="token operator">-=</span> <span class="token number">2LL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="168"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="169"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span> v52 <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="170"></td><td><pre>    v58 <span class="token operator">=</span> <span class="token number">0LL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="171"></td><td><pre>    <span class="token keyword">do</span></pre></td></tr><tr><td data-num="172"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="173"></td><td><pre>      v59 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8<span class="token punctuation">)</span>flagg<span class="token punctuation">[</span>v58<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="174"></td><td><pre>      <span class="token function">LOWORD</span><span class="token punctuation">(</span>v51<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="175"></td><td><pre>      <span class="token function">LOWORD</span><span class="token punctuation">(</span>v52<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">257</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="176"></td><td><pre>      v60 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="177"></td><td><pre>      <span class="token keyword">do</span></pre></td></tr><tr><td data-num="178"></td><td><pre>      <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="179"></td><td><pre>        v62 <span class="token operator">=</span> v52<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="180"></td><td><pre>        <span class="token function">LOWORD</span><span class="token punctuation">(</span>v52<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int16<span class="token punctuation">)</span>v52 <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int16<span class="token punctuation">)</span>v59<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="181"></td><td><pre>        v61 <span class="token operator">=</span> v62 <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int16<span class="token punctuation">)</span>v59<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="182"></td><td><pre>        v63 <span class="token operator">=</span> v51<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="183"></td><td><pre>        v51 <span class="token operator">=</span> v60 <span class="token operator">-</span> v51 <span class="token operator">*</span> v52<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="184"></td><td><pre>        <span class="token function">LODWORD</span><span class="token punctuation">(</span>v52<span class="token punctuation">)</span> <span class="token operator">=</span> v59<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="185"></td><td><pre>        v59 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int16<span class="token punctuation">)</span><span class="token punctuation">(</span>v62 <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int16<span class="token punctuation">)</span>v59<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="186"></td><td><pre>        v60 <span class="token operator">=</span> v63<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="187"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="188"></td><td><pre>      <span class="token keyword">while</span> <span class="token punctuation">(</span> v61 <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="189"></td><td><pre>      v64 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="190"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>__int16<span class="token punctuation">)</span>v63 <span class="token operator">></span> <span class="token number">0</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="191"></td><td><pre>        v64 <span class="token operator">=</span> v63<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="192"></td><td><pre>      flagg<span class="token punctuation">[</span>v58<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int16<span class="token punctuation">)</span><span class="token punctuation">(</span>v64 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>__int16<span class="token punctuation">)</span>v63 <span class="token operator">>></span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">-</span> v63<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">0x101u</span></pre></td></tr><tr><td data-num="193"></td><td><pre>                  <span class="token operator">+</span> v63</pre></td></tr><tr><td data-num="194"></td><td><pre>                  <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int16<span class="token punctuation">)</span>v63 <span class="token operator">>></span> <span class="token number">15</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="195"></td><td><pre>                  <span class="token operator">+</span> <span class="token number">113</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x89</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="196"></td><td><pre>      v52 <span class="token operator">=</span> v58 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="197"></td><td><pre>      v58 <span class="token operator">=</span> v52<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="198"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="199"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span> v52 <span class="token operator">!=</span> <span class="token number">64</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="200"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="201"></td><td><pre>  <span class="token keyword">while</span> <span class="token punctuation">(</span> v8 <span class="token operator">!=</span> <span class="token number">256</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 提取出的总的加密</span></pre></td></tr></table></figure><p><img data-src="/images/image-20230910153409350.png" alt="image-20230910153409350"></p>
<p>不出意外的话 64 位比较数据是 cmp=[0xA7, 0x51, 0x68, 0x52, 0x85, 0x27, 0xFF, 0x31, 0x88, 0x87, 0xD2, 0xC7, 0xD3, 0x23, 0x3F, 0x52, 0x55, 0x10, 0x1F, 0xAF, 0x27, 0xF0, 0x94, 0x5C, 0xCD, 0x3F, 0x7A, 0x79, 0x9F, 0x2F, 0xF0, 0xE7, 0x45, 0xF0, 0x86, 0x3C, 0xF9, 0xB0, 0xEA, 0x6D, 0x90, 0x42, 0xF7, 0x91, 0xED, 0x3A, 0x9A, 0x7C, 0x01, 0x6B, 0x84, 0xDC, 0x6C, 0xC8, 0x43, 0x07, 0x5C, 0x08, 0xF7, 0xDF, 0xEB, 0xE3, 0xAE, 0xA4]    (也就是这 64 位的 4 个 xmmword)</p>
<p><strong>原顺序 0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ {}</strong></p>
<p><strong>打乱后的顺序 HfVl {qPcCYNMoRi6D7Jr} espOL3FhwdWAtTGZba4Ugjvnx1QkKE2IS9yuz5BX08m</strong></p>
<p>字符的加密逻辑:</p>
<pre><code>do
    &#123;
      v59 = (unsigned __int8)flagg[v58] + 1;
      LOWORD(v51) = 1;
      LOWORD(v52) = 257;
      v60 = 0;
      do
      &#123;
        v62 = v52;
        LOWORD(v52) = (unsigned __int16)v52 / (unsigned __int16)v59;
        v61 = v62 % (unsigned __int16)v59;
        v63 = v51;
        v51 = v60 - v51 * v52;
        LODWORD(v52) = v59;
        v59 = (unsigned __int16)(v62 % (unsigned __int16)v59);
        v60 = v63;
      &#125;
      while ( v61 );
      v64 = 0;
      if ( (__int16)v63 &gt; 0 )
        v64 = v63;
      flagg[v58] = ((unsigned __int16)(v64 + ((__int16)v63 &gt;&gt; 15) - v63) / 0x101u
                  + v63
                  + ((unsigned __int16)v63 &gt;&gt; 15)
                  + 113) ^ 0x89;
      v52 = v58 + 1;
      v58 = v52;
    &#125;
    while ( v52 != 64 );
</code></pre>
<p>一阶段脚本</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">,</span> table<span class="token punctuation">:</span> <span class="token builtin">dict</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    tmp<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> data<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        tmp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>table<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">return</span> tmp</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">def</span> <span class="token function">reverse_order</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span><span class="token builtin">list</span><span class="token punctuation">,</span> table<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    tmp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        tmp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>data<span class="token punctuation">[</span>table<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">return</span> tmp</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">#get crypto table</span></pre></td></tr><tr><td data-num="14"></td><td><pre>s0_255 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0xFB</span><span class="token punctuation">,</span> <span class="token number">0x7B</span><span class="token punctuation">,</span> <span class="token number">0x4E</span><span class="token punctuation">,</span> <span class="token number">0xBB</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span> <span class="token number">0x8D</span><span class="token punctuation">,</span> <span class="token number">0xDB</span><span class="token punctuation">,</span> <span class="token number">0xB0</span><span class="token punctuation">,</span> <span class="token number">0xAC</span><span class="token punctuation">,</span> <span class="token number">0xA5</span><span class="token punctuation">,</span> <span class="token number">0x8E</span><span class="token punctuation">,</span> <span class="token number">0xAA</span><span class="token punctuation">,</span> <span class="token number">0xB2</span><span class="token punctuation">,</span> <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0xEB</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0x5C</span><span class="token punctuation">,</span> <span class="token number">0xDE</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0x2B</span><span class="token punctuation">,</span> <span class="token number">0xC6</span><span class="token punctuation">,</span> <span class="token number">0xA6</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0xD6</span><span class="token punctuation">,</span> <span class="token number">0x5F</span><span class="token punctuation">,</span> <span class="token number">0xBD</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">,</span> <span class="token number">0xB1</span><span class="token punctuation">,</span> <span class="token number">0xE3</span><span class="token punctuation">,</span> <span class="token number">0x8C</span><span class="token punctuation">,</span> <span class="token number">0xA7</span><span class="token punctuation">,</span> <span class="token number">0xD5</span><span class="token punctuation">,</span> <span class="token number">0x2A</span><span class="token punctuation">,</span> <span class="token number">0x7C</span><span class="token punctuation">,</span> <span class="token number">0x6D</span><span class="token punctuation">,</span> <span class="token number">0x8B</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">,</span> <span class="token number">0x9D</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0xFE</span><span class="token punctuation">,</span> <span class="token number">0x69</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x59</span><span class="token punctuation">,</span> <span class="token number">0xA9</span><span class="token punctuation">,</span> <span class="token number">0x9E</span><span class="token punctuation">,</span> <span class="token number">0x0F</span><span class="token punctuation">,</span> <span class="token number">0x1C</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0x5B</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0xED</span><span class="token punctuation">,</span> <span class="token number">0xAD</span><span class="token punctuation">,</span> <span class="token number">0xE0</span><span class="token punctuation">,</span> <span class="token number">0xDA</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0xDC</span><span class="token punctuation">,</span> <span class="token number">0x5E</span><span class="token punctuation">,</span> <span class="token number">0xE7</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0xD2</span><span class="token punctuation">,</span> <span class="token number">0xD9</span><span class="token punctuation">,</span> <span class="token number">0x8F</span><span class="token punctuation">,</span> <span class="token number">0xEE</span><span class="token punctuation">,</span> <span class="token number">0xAF</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0x93</span><span class="token punctuation">,</span> <span class="token number">0x3A</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0xA2</span><span class="token punctuation">,</span> <span class="token number">0xE1</span><span class="token punctuation">,</span> <span class="token number">0xB3</span><span class="token punctuation">,</span> <span class="token number">0xEC</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0x9F</span><span class="token punctuation">,</span> <span class="token number">0xCA</span><span class="token punctuation">,</span> <span class="token number">0x58</span><span class="token punctuation">,</span> <span class="token number">0xB7</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span> <span class="token number">0xFD</span><span class="token punctuation">,</span> <span class="token number">0x3B</span><span class="token punctuation">,</span> <span class="token number">0xA0</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x0C</span><span class="token punctuation">,</span> <span class="token number">0xCB</span><span class="token punctuation">,</span> <span class="token number">0xA8</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0xC0</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">,</span> <span class="token number">0x4D</span><span class="token punctuation">,</span> <span class="token number">0x2F</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span> <span class="token number">0x71</span><span class="token punctuation">,</span> <span class="token number">0x0A</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xC1</span><span class="token punctuation">,</span> <span class="token number">0x9C</span><span class="token punctuation">,</span> <span class="token number">0xAB</span><span class="token punctuation">,</span> <span class="token number">0xEF</span><span class="token punctuation">,</span> <span class="token number">0xA4</span><span class="token punctuation">,</span> <span class="token number">0xD8</span><span class="token punctuation">,</span> <span class="token number">0xE2</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0xC2</span><span class="token punctuation">,</span> <span class="token number">0x6C</span><span class="token punctuation">,</span> <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token number">0x1E</span><span class="token punctuation">,</span> <span class="token number">0x6B</span><span class="token punctuation">,</span> <span class="token number">0x7E</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x2E</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0x0B</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0x6A</span><span class="token punctuation">,</span> <span class="token number">0xC4</span><span class="token punctuation">,</span> <span class="token number">0x2D</span><span class="token punctuation">,</span> <span class="token number">0x4F</span><span class="token punctuation">,</span> <span class="token number">0xF9</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token number">0xFA</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0xB6</span><span class="token punctuation">,</span> <span class="token number">0x1F</span><span class="token punctuation">,</span> <span class="token number">0x89</span><span class="token punctuation">,</span> <span class="token number">0x6F</span><span class="token punctuation">,</span> <span class="token number">0x5D</span><span class="token punctuation">,</span> <span class="token number">0xE8</span><span class="token punctuation">,</span> <span class="token number">0xEA</span><span class="token punctuation">,</span> <span class="token number">0xB5</span><span class="token punctuation">,</span> <span class="token number">0x5A</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0xC5</span><span class="token punctuation">,</span> <span class="token number">0x7F</span><span class="token punctuation">,</span> <span class="token number">0x77</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0xCF</span><span class="token punctuation">,</span> <span class="token number">0xF1</span><span class="token punctuation">,</span> <span class="token number">0x1B</span><span class="token punctuation">,</span> <span class="token number">0x3F</span><span class="token punctuation">,</span> <span class="token number">0xF4</span><span class="token punctuation">,</span> <span class="token number">0x48</span><span class="token punctuation">,</span> <span class="token number">0x47</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0xE4</span><span class="token punctuation">,</span> <span class="token number">0xBA</span><span class="token punctuation">,</span> <span class="token number">0xDF</span><span class="token punctuation">,</span> <span class="token number">0xE9</span><span class="token punctuation">,</span> <span class="token number">0x62</span><span class="token punctuation">,</span> <span class="token number">0x6E</span><span class="token punctuation">,</span> <span class="token number">0xB4</span><span class="token punctuation">,</span> <span class="token number">0x96</span><span class="token punctuation">,</span> <span class="token number">0xCD</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0x4B</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">,</span> <span class="token number">0xD7</span><span class="token punctuation">,</span> <span class="token number">0xD1</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0xB8</span><span class="token punctuation">,</span> <span class="token number">0xE6</span><span class="token punctuation">,</span> <span class="token number">0x7A</span><span class="token punctuation">,</span> <span class="token number">0x2C</span><span class="token punctuation">,</span> <span class="token number">0x9B</span><span class="token punctuation">,</span> <span class="token number">0x29</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0xF7</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0xF2</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0xD3</span><span class="token punctuation">,</span> <span class="token number">0xB9</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0xD0</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">,</span> <span class="token number">0xF5</span><span class="token punctuation">,</span> <span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0x1A</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0xA1</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token number">0xFC</span><span class="token punctuation">,</span> <span class="token number">0x85</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">0xBE</span><span class="token punctuation">,</span> <span class="token number">0xDD</span><span class="token punctuation">,</span> <span class="token number">0xBC</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0xF3</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0xF6</span><span class="token punctuation">,</span> <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0x98</span><span class="token punctuation">,</span> <span class="token number">0x4C</span><span class="token punctuation">,</span> <span class="token number">0x7D</span><span class="token punctuation">,</span> <span class="token number">0xC7</span><span class="token punctuation">,</span> <span class="token number">0xD4</span><span class="token punctuation">,</span> <span class="token number">0x45</span><span class="token punctuation">,</span> <span class="token number">0x4A</span><span class="token punctuation">,</span> <span class="token number">0x9A</span><span class="token punctuation">,</span> <span class="token number">0xC3</span><span class="token punctuation">,</span> <span class="token number">0x8A</span><span class="token punctuation">,</span> <span class="token number">0xE5</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0x46</span><span class="token punctuation">,</span> <span class="token number">0xCC</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0xC9</span><span class="token punctuation">,</span> <span class="token number">0x0E</span><span class="token punctuation">,</span> <span class="token number">0x3C</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0xF0</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0xBF</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">,</span> <span class="token number">0x84</span><span class="token punctuation">,</span> <span class="token number">0x0D</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0xA3</span><span class="token punctuation">,</span> <span class="token number">0xAE</span><span class="token punctuation">,</span> <span class="token number">0x3D</span><span class="token punctuation">,</span> <span class="token number">0x1D</span><span class="token punctuation">,</span> <span class="token number">0xC8</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0x87</span><span class="token punctuation">,</span> <span class="token number">0x70</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x73</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">,</span> <span class="token number">0x49</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x3E</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span> <span class="token number">0xCE</span><span class="token punctuation">,</span> <span class="token number">0x82</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0x95</span><span class="token punctuation">,</span> <span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token number">0xF8</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="18"></td><td><pre>load_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0xA7</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x85</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x87</span><span class="token punctuation">,</span> <span class="token number">0xD2</span><span class="token punctuation">,</span> <span class="token number">0xC7</span><span class="token punctuation">,</span> <span class="token number">0xD3</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span> <span class="token number">0x3F</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x1F</span><span class="token punctuation">,</span> <span class="token number">0xAF</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">,</span> <span class="token number">0xF0</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0x5C</span><span class="token punctuation">,</span> <span class="token number">0xCD</span><span class="token punctuation">,</span> <span class="token number">0x3F</span><span class="token punctuation">,</span> <span class="token number">0x7A</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span> <span class="token number">0x9F</span><span class="token punctuation">,</span> <span class="token number">0x2F</span><span class="token punctuation">,</span> <span class="token number">0xF0</span><span class="token punctuation">,</span> <span class="token number">0xE7</span><span class="token punctuation">,</span> <span class="token number">0x45</span><span class="token punctuation">,</span> <span class="token number">0xF0</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0x3C</span><span class="token punctuation">,</span> <span class="token number">0xF9</span><span class="token punctuation">,</span> <span class="token number">0xB0</span><span class="token punctuation">,</span> <span class="token number">0xEA</span><span class="token punctuation">,</span> <span class="token number">0x6D</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0xF7</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0xED</span><span class="token punctuation">,</span> <span class="token number">0x3A</span><span class="token punctuation">,</span> <span class="token number">0x9A</span><span class="token punctuation">,</span> <span class="token number">0x7C</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x6B</span><span class="token punctuation">,</span> <span class="token number">0x84</span><span class="token punctuation">,</span> <span class="token number">0xDC</span><span class="token punctuation">,</span> <span class="token number">0x6C</span><span class="token punctuation">,</span> <span class="token number">0xC8</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">0x5C</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0xF7</span><span class="token punctuation">,</span> <span class="token number">0xDF</span><span class="token punctuation">,</span> <span class="token number">0xEB</span><span class="token punctuation">,</span> <span class="token number">0xE3</span><span class="token punctuation">,</span> <span class="token number">0xAE</span><span class="token punctuation">,</span> <span class="token number">0xA4</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="19"></td><td><pre>crypto_table <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>s0_255<span class="token punctuation">,</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0x100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token comment">#get order table</span></pre></td></tr><tr><td data-num="22"></td><td><pre>source <span class="token operator">=</span> <span class="token string">'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#123;&#125;'</span></pre></td></tr><tr><td data-num="23"></td><td><pre>replaced <span class="token operator">=</span> <span class="token string">'HfVl&#123;qPcCYNMoRi6D7Jr&#125;espOL3FhwdWAtTGZba4Ugjvnx1QkKE2IS9yuz5BX08m'</span></pre></td></tr><tr><td data-num="24"></td><td><pre>revsere_table <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">#index 是 source 在 replace 中的下标</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> source<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    revsere_table<span class="token punctuation">.</span>append<span class="token punctuation">(</span>replaced<span class="token punctuation">.</span>find<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre>tmp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0xCB</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x7E</span><span class="token punctuation">,</span> <span class="token number">0xD3</span><span class="token punctuation">,</span> <span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">,</span> <span class="token number">0xC2</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0xFA</span><span class="token punctuation">,</span> <span class="token number">0xEE</span><span class="token punctuation">,</span> <span class="token number">0xC3</span><span class="token punctuation">,</span> <span class="token number">0x0A</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0xB9</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x3D</span><span class="token punctuation">,</span> <span class="token number">0x0E</span><span class="token punctuation">,</span> <span class="token number">0xE9</span><span class="token punctuation">,</span> <span class="token number">0xBE</span><span class="token punctuation">,</span> <span class="token number">0xF6</span><span class="token punctuation">,</span> <span class="token number">0x2B</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0xA8</span><span class="token punctuation">,</span> <span class="token number">0x87</span><span class="token punctuation">,</span> <span class="token number">0xAE</span><span class="token punctuation">,</span> <span class="token number">0x1D</span><span class="token punctuation">,</span> <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0x62</span><span class="token punctuation">,</span> <span class="token number">0xEC</span><span class="token punctuation">,</span> <span class="token number">0xFC</span><span class="token punctuation">,</span> <span class="token number">0x5C</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span> <span class="token number">0x5B</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0xFB</span><span class="token punctuation">,</span> <span class="token number">0xD7</span><span class="token punctuation">,</span> <span class="token number">0xCA</span><span class="token punctuation">,</span> <span class="token number">0x7A</span><span class="token punctuation">,</span> <span class="token number">0xBD</span><span class="token punctuation">,</span> <span class="token number">0xD9</span><span class="token punctuation">,</span> <span class="token number">0x69</span><span class="token punctuation">,</span> <span class="token number">0x6A</span><span class="token punctuation">,</span> <span class="token number">0xE4</span><span class="token punctuation">,</span> <span class="token number">0x2A</span><span class="token punctuation">,</span> <span class="token number">0x6C</span><span class="token punctuation">,</span> <span class="token number">0x9D</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0xE0</span><span class="token punctuation">,</span> <span class="token number">0xA4</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0xBA</span><span class="token punctuation">,</span> <span class="token number">0x3B</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    tmp <span class="token operator">=</span> decrypt<span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> crypto_table<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    tmp <span class="token operator">=</span> reverse_order<span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> revsere_table<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> tmp<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token comment"># 0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#123;&#125;</span></pre></td></tr></table></figure><p>以上脚本用于还原 排序 + 加密，tmp 的值就是经历过完整的打乱顺序和加密后 dump 出的，并不是最终的 cmp_data</p>
<p>说明要么是比较数据还有操作 要么是 input 还有操作</p>
<p>继续往后面看 比较逻辑</p>
<p><img data-src="/images/image-20230910153719912.png" alt="image-20230910153719912"></p>
<figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre>like_i <span class="token operator">=</span> <span class="token number">4LL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token keyword">do</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    v77 <span class="token operator">=</span> v84<span class="token punctuation">;</span>                                  <span class="token comment">// 0xff</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span> v84 <span class="token operator">&lt;</span> <span class="token number">205</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>      <span class="token keyword">goto</span> LABEL_74<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span>v78 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>dest <span class="token operator">+</span> like_i<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    v79 <span class="token operator">=</span> v82<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    v82<span class="token punctuation">[</span><span class="token number">204</span><span class="token punctuation">]</span> <span class="token operator">=</span> input<span class="token punctuation">[</span>like_i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span> v77 <span class="token operator">&lt;</span> <span class="token number">224</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      <span class="token keyword">goto</span> LABEL_74<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    v79<span class="token punctuation">[</span><span class="token number">223</span><span class="token punctuation">]</span> <span class="token operator">=</span> v78<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    v79<span class="token punctuation">[</span><span class="token number">205</span><span class="token punctuation">]</span> <span class="token operator">=</span> input<span class="token punctuation">[</span>like_i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span> v77 <span class="token operator">==</span> <span class="token number">224</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>      <span class="token keyword">goto</span> LABEL_74<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    v79<span class="token punctuation">[</span><span class="token number">224</span><span class="token punctuation">]</span> <span class="token operator">=</span> v78<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    v79<span class="token punctuation">[</span><span class="token number">206</span><span class="token punctuation">]</span> <span class="token operator">=</span> input<span class="token punctuation">[</span>like_i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span> v77 <span class="token operator">&lt;</span> <span class="token number">226</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>      <span class="token keyword">goto</span> LABEL_74<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    v79<span class="token punctuation">[</span><span class="token number">225</span><span class="token punctuation">]</span> <span class="token operator">=</span> v78<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    v79<span class="token punctuation">[</span><span class="token number">207</span><span class="token punctuation">]</span> <span class="token operator">=</span> input<span class="token punctuation">[</span>like_i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span> v77 <span class="token operator">==</span> <span class="token number">226</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>      <span class="token keyword">goto</span> LABEL_74<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    v79<span class="token punctuation">[</span><span class="token number">226</span><span class="token punctuation">]</span> <span class="token operator">=</span> v78<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    _$LT$$RF$std<span class="token punctuation">.</span><span class="token punctuation">.</span>net<span class="token punctuation">.</span><span class="token punctuation">.</span>tcp<span class="token punctuation">.</span><span class="token punctuation">.</span>TcpStream$u20$as$u20$std<span class="token punctuation">.</span><span class="token punctuation">.</span>io<span class="token punctuation">.</span><span class="token punctuation">.</span>Write$GT$<span class="token double-colon punctuation">::</span>write<span class="token double-colon punctuation">::</span><span class="token function">h0bbfc2d1fa700c7a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span> v81<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>      <span class="token keyword">goto</span> LABEL_50<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    v81<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0LL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    v75 <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span>io<span class="token double-colon punctuation">::</span>default_read_exact<span class="token double-colon punctuation">::</span><span class="token function">h61fb53e2a02eb302</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v85<span class="token punctuation">,</span> v81<span class="token punctuation">,</span> <span class="token number">8LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span> v75 <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>      <span class="token keyword">goto</span> LABEL_55<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>v81<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre>      <span class="token keyword">goto</span> LABEL_70<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    v80 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int64<span class="token punctuation">)</span><span class="token punctuation">(</span>like_i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">60</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    like_i <span class="token operator">+=</span> <span class="token number">4LL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>  <span class="token keyword">while</span> <span class="token punctuation">(</span> v80 <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>每次是赋值了 input 的 4 个字节 和比较数据的四个字节 但是不清楚跑哪里去了</p>
<p>而 v79 [204]  v79 [205]  v79 [206]  v79 [207] 是栈中固定的位置，为什么下标怎么奇怪呢？</p>
<p>通过查找交叉引用可以发现</p>
<p><img data-src="/images/image-20230910154028581.png" alt="image-20230910154028581"></p>
<p>v79 是一开始 255 字节长的 shellcode</p>
<p><img data-src="/images/image-20230910154115378.png" alt="image-20230910154115378"></p>
<p>IDA 有些识别不太准确 在汇编中查看</p>
<pre><code class="language-assembly">.rodata:000055E808DA1B2B sub_55E808DA1B2B proc near              ; DATA XREF: seccomp_shell::shell::verify::h898bf5fa26dafbab+44D↑o
.rodata:000055E808DA1B2B push    rsp
.rodata:000055E808DA1B2C pop     rbp
.rodata:000055E808DA1B2D xor     esi, esi                        ; flags
.rodata:000055E808DA1B2F mov     rcx, 379F3A62B80657A1h
.rodata:000055E808DA1B39 mov     rdx, 37F7494DD66F358Eh
.rodata:000055E808DA1B43 xor     rcx, rdx
.rodata:000055E808DA1B46 push    rcx
.rodata:000055E808DA1B47 push    rsp
.rodata:000055E808DA1B48 pop     rdi                             ; filename
.rodata:000055E808DA1B49 push    2
.rodata:000055E808DA1B4B pop     rax
.rodata:000055E808DA1B4C cdq                                     ; mode
.rodata:000055E808DA1B4D syscall                                 ; LINUX - sys_open
.rodata:000055E808DA1B4F xchg    rax, rdi                        ; fd
.rodata:000055E808DA1B51 xor     eax, eax
.rodata:000055E808DA1B53 push    rax
.rodata:000055E808DA1B54 push    rsp
.rodata:000055E808DA1B55 pop     rsi                             ; buf
.rodata:000055E808DA1B56 push    4
.rodata:000055E808DA1B58 pop     rdx                             ; count
.rodata:000055E808DA1B59 syscall                                 ; LINUX - sys_read
.rodata:000055E808DA1B5B pop     r12
.rodata:000055E808DA1B5D push    3
.rodata:000055E808DA1B5F pop     rax
.rodata:000055E808DA1B60 syscall                                 ; LINUX - sys_close
.rodata:000055E808DA1B62 xor     esi, esi                        ; flags
.rodata:000055E808DA1B64 mov     rcx, 0AAC06463C36F3B3Bh
.rodata:000055E808DA1B6E mov     rdx, 0AAC06463C30B4C48h
.rodata:000055E808DA1B78 xor     rcx, rdx
.rodata:000055E808DA1B7B push    rcx
.rodata:000055E808DA1B7C mov     rcx, 7DA9F8D67582578Ch
.rodata:000055E808DA1B86 mov     rdx, 0EC888F916F632A3h
.rodata:000055E808DA1B90 xor     rcx, rdx
.rodata:000055E808DA1B93 push    rcx
.rodata:000055E808DA1B94 push    rsp
.rodata:000055E808DA1B95 pop     rdi                             ; filename
.rodata:000055E808DA1B96 push    2
.rodata:000055E808DA1B98 pop     rax
.rodata:000055E808DA1B99 cdq                                     ; mode
.rodata:000055E808DA1B9A syscall                                 ; LINUX - sys_open
.rodata:000055E808DA1B9C xchg    rax, rdi                        ; fd
.rodata:000055E808DA1B9E xor     eax, eax
.rodata:000055E808DA1BA0 push    rax
.rodata:000055E808DA1BA1 push    rsp
.rodata:000055E808DA1BA2 pop     rsi                             ; buf
.rodata:000055E808DA1BA3 push    4
.rodata:000055E808DA1BA5 pop     rdx                             ; count
.rodata:000055E808DA1BA6 syscall                                 ; LINUX - sys_read
.rodata:000055E808DA1BA8 pop     r13
.rodata:000055E808DA1BAA push    3
.rodata:000055E808DA1BAC pop     rax
.rodata:000055E808DA1BAD syscall                                 ; LINUX - sys_close
.rodata:000055E808DA1BAF xor     esi, esi                        ; flags
.rodata:000055E808DA1BB1 push    6Fh ; 'o'
.rodata:000055E808DA1BB3 mov     rcx, 77D9F62D0C06E559h
.rodata:000055E808DA1BBD mov     rdx, 5BC8C027A638176h
.rodata:000055E808DA1BC7 xor     rcx, rdx
.rodata:000055E808DA1BCA push    rcx
.rodata:000055E808DA1BCB push    rsp
.rodata:000055E808DA1BCC pop     rdi                             ; filename
.rodata:000055E808DA1BCD push    2
.rodata:000055E808DA1BCF pop     rax
.rodata:000055E808DA1BD0 cdq                                     ; mode
.rodata:000055E808DA1BD1 syscall                                 ; LINUX - sys_open
.rodata:000055E808DA1BD3 xchg    rax, rdi                        ; fd
.rodata:000055E808DA1BD5 xor     eax, eax
.rodata:000055E808DA1BD7 push    rax
.rodata:000055E808DA1BD8 push    rsp
.rodata:000055E808DA1BD9 pop     rsi                             ; buf
.rodata:000055E808DA1BDA push    4
.rodata:000055E808DA1BDC pop     rdx                             ; count
.rodata:000055E808DA1BDD syscall                                 ; LINUX - sys_read
.rodata:000055E808DA1BDF pop     rax
.rodata:000055E808DA1BE0 not     rax
.rodata:000055E808DA1BE3 shr     rax, 1Dh
.rodata:000055E808DA1BE7 cqo
.rodata:000055E808DA1BE9 push    29h ; ')'
.rodata:000055E808DA1BEB pop     rcx
.rodata:000055E808DA1BEC div     rcx
.rodata:000055E808DA1BEF xchg    rax, r14
.rodata:000055E808DA1BF1 push    3
.rodata:000055E808DA1BF3 pop     rax
.rodata:000055E808DA1BF4 syscall                                 ; LINUX - sys_close
.rodata:000055E808DA1BF6 mov     eax, 267814C2h
.rodata:000055E808DA1BFB add     eax, r12d
.rodata:000055E808DA1BFE xor     eax, r13d
.rodata:000055E808DA1C01 ror     eax, 0Bh
.rodata:000055E808DA1C04 not     eax
.rodata:000055E808DA1C06 xor     eax, r14d
.rodata:000055E808DA1C09 cmp     eax, 31FF2788h
.rodata:000055E808DA1C0E jnz     short loc_55E808DA1C15
.rodata:000055E808DA1C0E
.rodata:000055E808DA1C10 push    1
.rodata:000055E808DA1C12 pop     rax
.rodata:000055E808DA1C13 jmp     short loc_55E808DA1C18
.rodata:000055E808DA1C13
.rodata:000055E808DA1C15 ; ---------------------------------------------------------------------------
.rodata:000055E808DA1C15
.rodata:000055E808DA1C15 loc_55E808DA1C15:                       ; CODE XREF: sub_55E808DA1B2B+E3↑j
.rodata:000055E808DA1C15 xor     rax, rax
.rodata:000055E808DA1C15
.rodata:000055E808DA1C18
.rodata:000055E808DA1C18 loc_55E808DA1C18:                       ; CODE XREF: sub_55E808DA1B2B+E8↑j
.rodata:000055E808DA1C18 push    rax
.rodata:000055E808DA1C19 push    rbx
.rodata:000055E808DA1C1A pop     rdi                             ; fd
.rodata:000055E808DA1C1B push    rsp
.rodata:000055E808DA1C1C pop     rsi                             ; buf
.rodata:000055E808DA1C1D push    8
.rodata:000055E808DA1C1F pop     rdx                             ; count
.rodata:000055E808DA1C20 push    1
.rodata:000055E808DA1C22 pop     rax
.rodata:000055E808DA1C23 syscall                                 ; LINUX - sys_write
.rodata:000055E808DA1C25 push    rbp
.rodata:000055E808DA1C26 pop     rsp
.rodata:000055E808DA1C27 jmp     r15
.rodata:000055E808DA1C27
.rodata:000055E808DA1C27 sub_55E808DA1B2B endp
.rodata:000055E808DA1C27
</code></pre>
<p>发现之前赋值的 input 和比较数据都跑这里来了</p>
<p><img data-src="/images/image-20230910154637077.png" alt="image-20230910154637077"></p>
<p><strong>add     eax, r12d</strong> #首先将 eax 与 r12d 相加<br>
<strong> xor     eax, r13d</strong> #然后将 eax 与 r13d 进行异或运算<br>
<strong> ror     eax, 0Bh</strong> #接着将 eax 向右旋转 11 位<br>
<strong> not     eax</strong># 然后对 eax 求反<br>
<strong> xor     eax, r14d</strong># 再将 eax 与 r14d 进行异或运算</p>
<p>关键就是上面几条汇编指令了 对 input 还进行了操作</p>
<p>关键就是找到 r12 r13 r14 的值</p>
<p>但这个 shellcode 在程序中好像没有拿出来执行 (也可能是因为我不会调)</p>
<p>而且这个程序好像就单纯的验证了服务器端和客服端的输入是否相同 有点闹麻</p>
<p><img data-src="/images/image-20230910163931689.png" alt="image-20230910163931689"></p>
<p>(有一个 std::io::default_read_exact 是从客服端接受，从 IDA 动态调试会卡住也能发现这一点)</p>
<p>分析 shellcode 可以得出 r12 r13 r14 是定值</p>
<p>分析方法：随便找一个简单的程序 用 IDApatch 成 shellcode 执行一下就行了</p>
<p>直接用 lazyIDA paste data</p>
<p><img data-src="/images/image-20230910180732823.png" alt="image-20230910180732823"></p>
<p><img data-src="/images/image-20230910181123412.png" alt="image-20230910181123412"></p>
<p>可以发现 r12 r13 r14 的定值是多少 然后就直接写 exp 脚本解得 flag 就 OK 了</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">,</span> table<span class="token punctuation">:</span> <span class="token builtin">dict</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    tmp<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> data<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        tmp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>table<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">return</span> tmp</pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">def</span> <span class="token function">reverse_order</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span><span class="token builtin">list</span><span class="token punctuation">,</span> table<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    tmp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        tmp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>data<span class="token punctuation">[</span>table<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">return</span> tmp</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment"># 定义一个函数，接受一个参数，返回解密后的值</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">def</span> <span class="token function">de_cmp</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token comment"># 定义 r12, r13, r14 的值</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    r12 <span class="token operator">=</span> <span class="token number">0x0000000464C457F</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    r13 <span class="token operator">=</span> <span class="token number">0x0000000746F6F72</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    r14 <span class="token operator">=</span> <span class="token number">0x000000031F3831F</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token comment"># 将 x 转换为无符号 32 位整数</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    x <span class="token operator">=</span> np<span class="token punctuation">.</span>uint32<span class="token punctuation">(</span>x<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token comment"># 将 x 与 r14 异或</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    x <span class="token operator">=</span> np<span class="token punctuation">.</span>uint32<span class="token punctuation">(</span>x <span class="token operator">^</span> r14<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token comment"># 将 x 取反</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    x <span class="token operator">=</span> np<span class="token punctuation">.</span>uint32<span class="token punctuation">(</span><span class="token operator">~</span>x<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token comment"># 将 x 左旋 11 位</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    x <span class="token operator">=</span> np<span class="token punctuation">.</span>uint32<span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">&lt;&lt;</span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>x <span class="token operator">>></span> <span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">-</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token comment"># 将 x 与 r13 异或</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    x <span class="token operator">=</span> np<span class="token punctuation">.</span>uint32<span class="token punctuation">(</span>x <span class="token operator">^</span> r13<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token comment"># 将 x 减去 r12</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    x <span class="token operator">=</span> np<span class="token punctuation">.</span>uint32<span class="token punctuation">(</span>x <span class="token operator">-</span> r12<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token comment"># 打印 x 的十六进制表示</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token comment"># 将 x 转换为有符号 32 位整数</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    x <span class="token operator">=</span> np<span class="token punctuation">.</span>int32<span class="token punctuation">(</span>x<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token comment"># 返回 x 的四个字节</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token keyword">return</span> <span class="token punctuation">[</span>x <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x <span class="token operator">&amp;</span> <span class="token number">0xff00</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x <span class="token operator">&amp;</span> <span class="token number">0xff0000</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x <span class="token operator">&amp;</span> <span class="token number">0xff000000</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token comment">#get crypto table</span></pre></td></tr><tr><td data-num="41"></td><td><pre>s0_255 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0xFB</span><span class="token punctuation">,</span> <span class="token number">0x7B</span><span class="token punctuation">,</span> <span class="token number">0x4E</span><span class="token punctuation">,</span> <span class="token number">0xBB</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span> <span class="token number">0x8D</span><span class="token punctuation">,</span> <span class="token number">0xDB</span><span class="token punctuation">,</span> <span class="token number">0xB0</span><span class="token punctuation">,</span> <span class="token number">0xAC</span><span class="token punctuation">,</span> <span class="token number">0xA5</span><span class="token punctuation">,</span> <span class="token number">0x8E</span><span class="token punctuation">,</span> <span class="token number">0xAA</span><span class="token punctuation">,</span> <span class="token number">0xB2</span><span class="token punctuation">,</span> <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0xEB</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0x5C</span><span class="token punctuation">,</span> <span class="token number">0xDE</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0x2B</span><span class="token punctuation">,</span> <span class="token number">0xC6</span><span class="token punctuation">,</span> <span class="token number">0xA6</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0xD6</span><span class="token punctuation">,</span> <span class="token number">0x5F</span><span class="token punctuation">,</span> <span class="token number">0xBD</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">,</span> <span class="token number">0xB1</span><span class="token punctuation">,</span> <span class="token number">0xE3</span><span class="token punctuation">,</span> <span class="token number">0x8C</span><span class="token punctuation">,</span> <span class="token number">0xA7</span><span class="token punctuation">,</span> <span class="token number">0xD5</span><span class="token punctuation">,</span> <span class="token number">0x2A</span><span class="token punctuation">,</span> <span class="token number">0x7C</span><span class="token punctuation">,</span> <span class="token number">0x6D</span><span class="token punctuation">,</span> <span class="token number">0x8B</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">,</span> <span class="token number">0x9D</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0xFE</span><span class="token punctuation">,</span> <span class="token number">0x69</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x59</span><span class="token punctuation">,</span> <span class="token number">0xA9</span><span class="token punctuation">,</span> <span class="token number">0x9E</span><span class="token punctuation">,</span> <span class="token number">0x0F</span><span class="token punctuation">,</span> <span class="token number">0x1C</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0x5B</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0xED</span><span class="token punctuation">,</span> <span class="token number">0xAD</span><span class="token punctuation">,</span> <span class="token number">0xE0</span><span class="token punctuation">,</span> <span class="token number">0xDA</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0xDC</span><span class="token punctuation">,</span> <span class="token number">0x5E</span><span class="token punctuation">,</span> <span class="token number">0xE7</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="42"></td><td><pre>        <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0xD2</span><span class="token punctuation">,</span> <span class="token number">0xD9</span><span class="token punctuation">,</span> <span class="token number">0x8F</span><span class="token punctuation">,</span> <span class="token number">0xEE</span><span class="token punctuation">,</span> <span class="token number">0xAF</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0x93</span><span class="token punctuation">,</span> <span class="token number">0x3A</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0xA2</span><span class="token punctuation">,</span> <span class="token number">0xE1</span><span class="token punctuation">,</span> <span class="token number">0xB3</span><span class="token punctuation">,</span> <span class="token number">0xEC</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0x9F</span><span class="token punctuation">,</span> <span class="token number">0xCA</span><span class="token punctuation">,</span> <span class="token number">0x58</span><span class="token punctuation">,</span> <span class="token number">0xB7</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span> <span class="token number">0xFD</span><span class="token punctuation">,</span> <span class="token number">0x3B</span><span class="token punctuation">,</span> <span class="token number">0xA0</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x0C</span><span class="token punctuation">,</span> <span class="token number">0xCB</span><span class="token punctuation">,</span> <span class="token number">0xA8</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0xC0</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">,</span> <span class="token number">0x4D</span><span class="token punctuation">,</span> <span class="token number">0x2F</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span> <span class="token number">0x71</span><span class="token punctuation">,</span> <span class="token number">0x0A</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xC1</span><span class="token punctuation">,</span> <span class="token number">0x9C</span><span class="token punctuation">,</span> <span class="token number">0xAB</span><span class="token punctuation">,</span> <span class="token number">0xEF</span><span class="token punctuation">,</span> <span class="token number">0xA4</span><span class="token punctuation">,</span> <span class="token number">0xD8</span><span class="token punctuation">,</span> <span class="token number">0xE2</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0xC2</span><span class="token punctuation">,</span> <span class="token number">0x6C</span><span class="token punctuation">,</span> <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token number">0x1E</span><span class="token punctuation">,</span> <span class="token number">0x6B</span><span class="token punctuation">,</span> <span class="token number">0x7E</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x2E</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0x0B</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0x6A</span><span class="token punctuation">,</span> <span class="token number">0xC4</span><span class="token punctuation">,</span> <span class="token number">0x2D</span><span class="token punctuation">,</span> <span class="token number">0x4F</span><span class="token punctuation">,</span> <span class="token number">0xF9</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="43"></td><td><pre>        <span class="token number">0xFA</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0xB6</span><span class="token punctuation">,</span> <span class="token number">0x1F</span><span class="token punctuation">,</span> <span class="token number">0x89</span><span class="token punctuation">,</span> <span class="token number">0x6F</span><span class="token punctuation">,</span> <span class="token number">0x5D</span><span class="token punctuation">,</span> <span class="token number">0xE8</span><span class="token punctuation">,</span> <span class="token number">0xEA</span><span class="token punctuation">,</span> <span class="token number">0xB5</span><span class="token punctuation">,</span> <span class="token number">0x5A</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0xC5</span><span class="token punctuation">,</span> <span class="token number">0x7F</span><span class="token punctuation">,</span> <span class="token number">0x77</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0xCF</span><span class="token punctuation">,</span> <span class="token number">0xF1</span><span class="token punctuation">,</span> <span class="token number">0x1B</span><span class="token punctuation">,</span> <span class="token number">0x3F</span><span class="token punctuation">,</span> <span class="token number">0xF4</span><span class="token punctuation">,</span> <span class="token number">0x48</span><span class="token punctuation">,</span> <span class="token number">0x47</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0xE4</span><span class="token punctuation">,</span> <span class="token number">0xBA</span><span class="token punctuation">,</span> <span class="token number">0xDF</span><span class="token punctuation">,</span> <span class="token number">0xE9</span><span class="token punctuation">,</span> <span class="token number">0x62</span><span class="token punctuation">,</span> <span class="token number">0x6E</span><span class="token punctuation">,</span> <span class="token number">0xB4</span><span class="token punctuation">,</span> <span class="token number">0x96</span><span class="token punctuation">,</span> <span class="token number">0xCD</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0x4B</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">,</span> <span class="token number">0xD7</span><span class="token punctuation">,</span> <span class="token number">0xD1</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0xB8</span><span class="token punctuation">,</span> <span class="token number">0xE6</span><span class="token punctuation">,</span> <span class="token number">0x7A</span><span class="token punctuation">,</span> <span class="token number">0x2C</span><span class="token punctuation">,</span> <span class="token number">0x9B</span><span class="token punctuation">,</span> <span class="token number">0x29</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0xF7</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0xF2</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0xD3</span><span class="token punctuation">,</span> <span class="token number">0xB9</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0xD0</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">,</span> <span class="token number">0xF5</span><span class="token punctuation">,</span> <span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0x1A</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0xA1</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="44"></td><td><pre>        <span class="token number">0xFC</span><span class="token punctuation">,</span> <span class="token number">0x85</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">0xBE</span><span class="token punctuation">,</span> <span class="token number">0xDD</span><span class="token punctuation">,</span> <span class="token number">0xBC</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0xF3</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0xF6</span><span class="token punctuation">,</span> <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0x98</span><span class="token punctuation">,</span> <span class="token number">0x4C</span><span class="token punctuation">,</span> <span class="token number">0x7D</span><span class="token punctuation">,</span> <span class="token number">0xC7</span><span class="token punctuation">,</span> <span class="token number">0xD4</span><span class="token punctuation">,</span> <span class="token number">0x45</span><span class="token punctuation">,</span> <span class="token number">0x4A</span><span class="token punctuation">,</span> <span class="token number">0x9A</span><span class="token punctuation">,</span> <span class="token number">0xC3</span><span class="token punctuation">,</span> <span class="token number">0x8A</span><span class="token punctuation">,</span> <span class="token number">0xE5</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0x46</span><span class="token punctuation">,</span> <span class="token number">0xCC</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0xC9</span><span class="token punctuation">,</span> <span class="token number">0x0E</span><span class="token punctuation">,</span> <span class="token number">0x3C</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0xF0</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0xBF</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">,</span> <span class="token number">0x84</span><span class="token punctuation">,</span> <span class="token number">0x0D</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0xA3</span><span class="token punctuation">,</span> <span class="token number">0xAE</span><span class="token punctuation">,</span> <span class="token number">0x3D</span><span class="token punctuation">,</span> <span class="token number">0x1D</span><span class="token punctuation">,</span> <span class="token number">0xC8</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0x87</span><span class="token punctuation">,</span> <span class="token number">0x70</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x73</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">,</span> <span class="token number">0x49</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x3E</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span> <span class="token number">0xCE</span><span class="token punctuation">,</span> <span class="token number">0x82</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0x95</span><span class="token punctuation">,</span> <span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token number">0xF8</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token comment">#load_data = [0xA7, 0x51, 0x68, 0x52, 0x85, 0x27, 0xFF, 0x31, 0x88, 0x87, 0xD2, 0xC7, 0xD3, 0x23, 0x3F, 0x52, 0x55, 0x10, 0x1F, 0xAF, 0x27, 0xF0, 0x94, 0x5C, 0xCD, 0x3F, 0x7A, 0x79, 0x9F, 0x2F, 0xF0, 0xE7, 0x45, 0xF0, 0x86, 0x3C, 0xF9, 0xB0, 0xEA, 0x6D, 0x90, 0x42, 0xF7, 0x91, 0xED, 0x3A, 0x9A, 0x7C, 0x01, 0x6B, 0x84, 0xDC, 0x6C, 0xC8, 0x43, 0x07, 0x5C, 0x08, 0xF7, 0xDF, 0xEB, 0xE3, 0xAE, 0xA4]</span></pre></td></tr><tr><td data-num="46"></td><td><pre>crypto_table <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>s0_255<span class="token punctuation">,</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0x100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token comment">#get order table</span></pre></td></tr><tr><td data-num="49"></td><td><pre>source <span class="token operator">=</span> <span class="token string">'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#123;&#125;'</span></pre></td></tr><tr><td data-num="50"></td><td><pre>replaced <span class="token operator">=</span> <span class="token string">'HfVl&#123;qPcCYNMoRi6D7Jr&#125;espOL3FhwdWAtTGZba4Ugjvnx1QkKE2IS9yuz5BX08m'</span></pre></td></tr><tr><td data-num="51"></td><td><pre>revsere_table <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">#index 是 source 在 replace 中的下标</span></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> source<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="53"></td><td><pre>    revsere_table<span class="token punctuation">.</span>append<span class="token punctuation">(</span>replaced<span class="token punctuation">.</span>find<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="54"></td><td><pre></pre></td></tr><tr><td data-num="55"></td><td><pre></pre></td></tr><tr><td data-num="56"></td><td><pre></pre></td></tr><tr><td data-num="57"></td><td><pre>cmp_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x526851A7</span><span class="token punctuation">,</span> <span class="token number">0x31FF2785</span><span class="token punctuation">,</span> <span class="token number">0xC7D28788</span><span class="token punctuation">,</span> <span class="token number">0x523F23D3</span><span class="token punctuation">,</span> <span class="token number">0xAF1F1055</span><span class="token punctuation">,</span> <span class="token number">0x5C94F027</span><span class="token punctuation">,</span> <span class="token number">0x797A3FCD</span><span class="token punctuation">,</span> <span class="token number">0xE7F02F9F</span><span class="token punctuation">,</span> <span class="token number">0x3C86F045</span><span class="token punctuation">,</span> <span class="token number">0x6DEAB0F9</span><span class="token punctuation">,</span> <span class="token number">0x91F74290</span><span class="token punctuation">,</span> <span class="token number">0x7C9A3AED</span><span class="token punctuation">,</span> <span class="token number">0xDC846B01</span><span class="token punctuation">,</span> <span class="token number">0x0743C86C</span><span class="token punctuation">,</span> <span class="token number">0xDFF7085C</span><span class="token punctuation">,</span> <span class="token number">0xA4AEE3EB</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="58"></td><td><pre>tmp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> cmp_data<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="60"></td><td><pre>    tmp<span class="token operator">+=</span>de_cmp<span class="token punctuation">(</span>i<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="61"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="62"></td><td><pre></pre></td></tr><tr><td data-num="63"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="64"></td><td><pre>    tmp <span class="token operator">=</span> decrypt<span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> crypto_table<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="65"></td><td><pre>    tmp <span class="token operator">=</span> reverse_order<span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> revsere_table<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="66"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> tmp<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>其中 python 和 C 语言的位运算有所不同 (对于符号位的处理) 所以需要使用 np 库</p>
<p>运行即可得到 flag</p>
<p>flag 是一个音乐网址 也算是一个小彩蛋吧</p>
<h2 id="总结"><a class="markdownIt-Anchor" href="#总结">#</a> 总结</h2>
<p>有关加密算法由于太菜了不会逆 采用的是暴力的做法 相当于是 00-ff 的一个表 感觉以后遇到复杂的运算但又是按位加密的都可以这样做？</p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>
      <div class="tags">
          <a href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag"><i class="ic i-tag"></i> 笔记</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">更新于</span>
    <time title="修改时间：2023-09-11 00:39:40" itemprop="dateModified" datetime="2023-09-11T00:39:40+08:00">2023-09-11</time>
  </span>
  <span id="2023/09/11/hitcon2023逆向-The-Blade-WP/" class="item leancloud_visitors" data-flag-title="hitcon2023逆向 The Blade WP" title="阅读次数">
      <span class="icon">
        <i class="ic i-eye"></i>
      </span>
      <span class="text">阅读次数</span>
      <span class="leancloud-visitors-count"></span>
      <span class="text">次</span>
  </span>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>本文作者： </strong>3cly <i class="ic i-at"><em>@</em></i>3clyの博客
  </li>
  <li class="link">
    <strong>本文链接：</strong>
    <a href="https://3cly.github.io/2023/09/11/hitcon2023%E9%80%86%E5%90%91-The-Blade-WP/" title="hitcon2023逆向 The Blade WP">https://3cly.github.io/2023/09/11/hitcon2023逆向-The-Blade-WP/</a>
  </li>
  <li class="license">
    <strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2023/09/08/Xposed%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;pic.imgdb.cn&#x2F;item&#x2F;63bec1d4be43e0d30e4f1a79.jpg" title="Xposed学习">
  <span class="type">上一篇</span>
  <span class="category"><i class="ic i-flag"></i> 学习</span>
  <h3>Xposed学习</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2023/09/21/IDA%E6%93%8D%E4%BD%9C%E3%81%AE%E6%9C%9D%E8%8A%B1%E5%A4%95%E6%8B%BE/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;pic.imgdb.cn&#x2F;item&#x2F;640da88af144a010074a43a4.jpg" title="IDA操作の朝花夕拾">
  <span class="type">下一篇</span>
  <span class="category"><i class="ic i-flag"></i> 学习</span>
  <h3>IDA操作の朝花夕拾</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="文章目录">
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#hitcon2023%E9%80%86%E5%90%91-the-blade-wp"><span class="toc-number">1.</span> <span class="toc-text"> hitcon2023 逆向 The Blade WP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.1.</span> <span class="toc-text"> 总结</span></a></li></ol></li></ol>
      </div>
      <div class="related panel pjax" data-title="系列文章">
        <ul>
          <li><a href="/2023/01/07/CSAPP%E3%81%AE%E5%AD%A6%E7%BF%92%E8%A8%98%E9%8C%B2/" rel="bookmark" title="CSAPPの学習記録">CSAPPの学習記録</a></li><li><a href="/2023/02/04/N1CTF%20Junior%20%20WP%20%20by%203cly/" rel="bookmark" title="N1CTF Junior  WP">N1CTF Junior  WP</a></li><li><a href="/2023/02/04/hgame2023%20%E9%83%A8%E5%88%86%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/" rel="bookmark" title="hgame2023 部分做题记录">hgame2023 部分做题记录</a></li><li><a href="/2023/02/26/shellcode&&vm/" rel="bookmark" title="shellcode&&vm">shellcode&&vm</a></li><li><a href="/2023/02/26/VNCTF/" rel="bookmark" title="VNCTF">VNCTF</a></li><li><a href="/2023/03/19/JAVA%E5%AD%A6%E4%B9%A0/" rel="bookmark" title="JAVA学习">JAVA学习</a></li><li><a href="/2023/03/19/Write-Virtual-Machine/" rel="bookmark" title="Write Virtual Machine">Write Virtual Machine</a></li><li><a href="/2023/03/26/CMake/" rel="bookmark" title="=CMake=">=CMake=</a></li><li><a href="/2023/04/02/%E5%87%A0%E9%81%93RE%E9%A2%98/" rel="bookmark" title="几道RE题">几道RE题</a></li><li><a href="/2023/04/16/Angr%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="bookmark" title="Angr符号执行学习笔记">Angr符号执行学习笔记</a></li><li><a href="/2023/04/25/pixel-4a-root/" rel="bookmark" title="pixel 4a root">pixel 4a root</a></li><li><a href="/2023/05/28/%E5%88%9D%E8%AF%86Frida/" rel="bookmark" title="初识Frida">初识Frida</a></li><li><a href="/2023/05/28/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF%E4%B8%8E%E7%A0%94%E7%A9%B6%E8%BF%9B%E5%B1%95/" rel="bookmark" title="区块链技术与研究进展">区块链技术与研究进展</a></li><li><a href="/2023/06/18/%E7%A0%B4%E8%A7%A3010Editor/" rel="bookmark" title="破解010Editor">破解010Editor</a></li><li><a href="/2023/06/18/DSACTF%E9%80%86%E5%90%91%E4%B8%93%E9%A1%B9/" rel="bookmark" title="DSACTF逆向专项">DSACTF逆向专项</a></li><li><a href="/2023/07/03/Google-CTF-2023/" rel="bookmark" title="Google CTF 2023">Google CTF 2023</a></li><li><a href="/2023/07/03/UIUCTF2023/" rel="bookmark" title="UIUCTF2023">UIUCTF2023</a></li><li><a href="/2023/07/15/ollvm%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/" rel="bookmark" title="ollvm环境配置">ollvm环境配置</a></li><li><a href="/2023/07/20/HWSCTF-WP/" rel="bookmark" title="HWSCTF_WP">HWSCTF_WP</a></li><li><a href="/2023/07/30/andriodlabs-%E6%9B%B4%E6%96%B0%E4%B8%AD/" rel="bookmark" title="andriodlabs_更新中">andriodlabs_更新中</a></li><li><a href="/2023/09/08/%E6%9B%B4%E6%96%B0%E5%90%8E%E6%9F%90%E7%94%B5%E8%A7%86%E9%A2%91APP%E5%8E%BB%E5%B9%BF%E5%91%8A%E7%A0%B4%E8%A7%A3/" rel="bookmark" title="更新后某电视频APP去广告破解">更新后某电视频APP去广告破解</a></li><li><a href="/2023/09/08/Xposed%E5%AD%A6%E4%B9%A0/" rel="bookmark" title="Xposed学习">Xposed学习</a></li><li class="active"><a href="/2023/09/11/hitcon2023%E9%80%86%E5%90%91-The-Blade-WP/" rel="bookmark" title="hitcon2023逆向 The Blade WP">hitcon2023逆向 The Blade WP</a></li><li><a href="/2023/09/21/IDA%E6%93%8D%E4%BD%9C%E3%81%AE%E6%9C%9D%E8%8A%B1%E5%A4%95%E6%8B%BE/" rel="bookmark" title="IDA操作の朝花夕拾">IDA操作の朝花夕拾</a></li><li><a href="/2023/12/26/llvmpass%E5%AD%A6%E4%B9%A0%E5%8F%8A%E6%8C%87%E4%BB%A4%E6%9B%BF%E6%8D%A2/" rel="bookmark" title="llvmpass学习及指令替换">llvmpass学习及指令替换</a></li><li><a href="/2023/12/26/TPCTF/" rel="bookmark" title="TPCTF">TPCTF</a></li>
        </ul>
      </div>
      <div class="overview panel" data-title="站点概览">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="3cly"
      data-src="/images/avatar.png">
  <p class="name" itemprop="name">3cly</p>
  <div class="description" itemprop="description">一只菜狗的博客</div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">31</span>
        <span class="name">文章</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">4</span>
        <span class="name">分类</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">2</span>
        <span class="name">标签</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tLzNjbHk=" title="https:&#x2F;&#x2F;github.com&#x2F;3cly"><i class="ic i-github"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>首页</a>
  </li>

    
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a>
  </li>

    
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a>
  </li>

    
  <li class="item">
    <a href="/link/" rel="section"><i class="ic i-magic"></i>links</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2023/09/08/Xposed%E5%AD%A6%E4%B9%A0/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2023/09/21/IDA%E6%93%8D%E4%BD%9C%E3%81%AE%E6%9C%9D%E8%8A%B1%E5%A4%95%E6%8B%BE/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>随机文章</h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/pwn%E3%81%AE%E5%AD%A6%E4%B9%A0/" title="分类于 pwnの学习">pwnの学习</a>
</div>

    <span><a href="/2022/12/30/%E2%80%9CPLT%E8%A1%A8%E4%B8%8EGOT%E8%A1%A8%E3%81%AE%E5%BB%B6%E8%BF%9F%E7%BB%91%E5%AE%9A%E6%9C%BA%E5%88%B6%E5%AD%A6%E4%B9%A0%E2%80%9D/" title="PLT表与GOT表の延迟绑定机制学习">PLT表与GOT表の延迟绑定机制学习</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%AD%A6%E4%B9%A0/" title="分类于 学习">学习</a>
</div>

    <span><a href="/2023/07/15/ollvm%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/" title="ollvm环境配置">ollvm环境配置</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%AD%A6%E4%B9%A0/" title="分类于 学习">学习</a>
</div>

    <span><a href="/2023/07/03/Google-CTF-2023/" title="Google CTF 2023">Google CTF 2023</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%AD%A6%E4%B9%A0/" title="分类于 学习">学习</a>
</div>

    <span><a href="/2023/12/26/llvmpass%E5%AD%A6%E4%B9%A0%E5%8F%8A%E6%8C%87%E4%BB%A4%E6%9B%BF%E6%8D%A2/" title="llvmpass学习及指令替换">llvmpass学习及指令替换</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%AD%A6%E4%B9%A0/" title="分类于 学习">学习</a>
</div>

    <span><a href="/2023/09/08/Xposed%E5%AD%A6%E4%B9%A0/" title="Xposed学习">Xposed学习</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/pwn%E3%81%AE%E5%AD%A6%E4%B9%A0/" title="分类于 pwnの学习">pwnの学习</a>
</div>

    <span><a href="/2022/12/15/%E5%9F%BA%E6%9C%ACROP%E5%AD%A6%E4%B9%A0/" title="基本ROP学习">基本ROP学习</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%AD%A6%E4%B9%A0/" title="分类于 学习">学习</a>
</div>

    <span><a href="/2023/04/25/pixel-4a-root/" title="pixel 4a root">pixel 4a root</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%AD%A6%E4%B9%A0/" title="分类于 学习">学习</a>
</div>

    <span><a href="/2023/03/19/JAVA%E5%AD%A6%E4%B9%A0/" title="JAVA学习">JAVA学习</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%AD%A6%E4%B9%A0/" title="分类于 学习">学习</a>
</div>

    <span><a href="/2023/02/04/hgame2023%20%E9%83%A8%E5%88%86%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/" title="hgame2023 部分做题记录">hgame2023 部分做题记录</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%AD%A6%E4%B9%A0/" title="分类于 学习">学习</a>
</div>

    <span><a href="/2023/05/28/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF%E4%B8%8E%E7%A0%94%E7%A9%B6%E8%BF%9B%E5%B1%95/" title="区块链技术与研究进展">区块链技术与研究进展</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>最新评论</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2022 – 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">3cly @ 静かな港</span>
  </div>
  <div class="count">
    <span class="post-meta-item-icon">
      <i class="ic i-chart-area"></i>
    </span>
    <span title="站点总字数">150k 字</span>

    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="ic i-coffee"></i>
    </span>
    <span title="站点阅读时长">2:16</span>
  </div>
  <div class="powered-by">
    基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2023/09/11/hitcon2023逆向-The-Blade-WP/',
    favicon: {
      show: "（●´3｀●）やれやれだぜ",
      hide: "(´Д｀)大変だ！"
    },
    search : {
      placeholder: "文章搜索",
      empty: "关于 「 ${query} 」，什么也没搜到",
      stats: "${time} ms 内找到 ${hits} 条结果"
    },
    valine: true,fancybox: true,
    copyright: '复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
